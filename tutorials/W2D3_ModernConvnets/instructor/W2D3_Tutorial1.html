
<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="Docutils 0.18.1: http://docutils.sourceforge.net/" name="generator"/>
<title>Tutorial 1: Learn how to use modern convnets — Neuromatch Academy: Deep Learning (instructor's version)</title>
<script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
<!-- Loaded before other Sphinx assets -->
<link href="../../../_static/styles/theme.css?digest=796348d33e8b1d947c94" rel="stylesheet"/>
<link href="../../../_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel="stylesheet"/>
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel="stylesheet"/>
<link href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel="stylesheet"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" rel="preload" type="font/woff2"/>
<link href="../../../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../../../_static/styles/sphinx-book-theme.css?digest=4ec06e9971c5264fbd345897d5258098f11cc577" rel="stylesheet" type="text/css">
<link href="../../../_static/togglebutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/copybutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" rel="stylesheet" type="text/css">
<link href="../../../_static/sphinx-thebe.css" rel="stylesheet" type="text/css">
<link href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" rel="stylesheet" type="text/css">
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../../../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94" rel="preload"/>
<link as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94" rel="preload"/>
<script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
<script src="../../../_static/jquery.js"></script>
<script src="../../../_static/underscore.js"></script>
<script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
<script src="../../../_static/doctools.js"></script>
<script src="../../../_static/clipboard.min.js"></script>
<script src="../../../_static/copybutton.js"></script>
<script src="../../../_static/scripts/sphinx-book-theme.js?digest=8bf782fb4ee92b3d3646425e50f299c4e1fd152d"></script>
<script>let toggleHintShow = 'Click to show';</script>
<script>let toggleHintHide = 'Click to hide';</script>
<script>let toggleOpenOnPrint = 'true';</script>
<script src="../../../_static/togglebutton.js"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
<script src="../../../_static/design-tabs.js"></script>
<script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
<script async="async" src="../../../_static/sphinx-thebe.js"></script>
<script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
<script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>DOCUMENTATION_OPTIONS.pagename = 'tutorials/W2D3_ModernConvnets/instructor/W2D3_Tutorial1';</script>
<link href="../../../_static/nma-dl-logo-square-4xp.png" rel="shortcut icon">
<link href="../../../genindex.html" rel="index" title="Index">
<link href="../../../search.html" rel="search" title="Search"/>
<link href="W2D3_Tutorial2.html" rel="next" title="Bonus Tutorial: Facial recognition using modern convnets"/>
<link href="../chapter_title.html" rel="prev" title="Modern Convnets"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="en" name="docsearch:language"/>
</link></link></link></link></link></link></link></link></link></head>
<body data-default-mode="" data-offset="180" data-spy="scroll" data-target="#bd-toc-nav">
<a class="skip-link" href="#main-content">Skip to main content</a>
<input class="sidebar-toggle" id="__primary" name="__primary" type="checkbox"/>
<label class="overlay overlay-primary" for="__primary"></label>
<input class="sidebar-toggle" id="__secondary" name="__secondary" type="checkbox"/>
<label class="overlay overlay-secondary" for="__secondary"></label>
<div class="search-button__wrapper">
<div class="search-button__overlay"></div>
<div class="search-button__search-container">
<form action="../../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="fa-solid fa-magnifying-glass"></i>
<input aria-label="Search this book..." autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." spellcheck="false" type="search"/>
<span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
</div>
</div>
<nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
<label class="sidebar-toggle primary-toggle" for="__primary">
<span class="fa-solid fa-bars"></span>
</label>
<div id="navbar-start">
<a class="navbar-brand logo" href="../../intro.html">
<img alt="Logo image" class="logo__image only-light" src="../../../_static/nma-dl-logo-square-4xp.png"/>
<img alt="Logo image" class="logo__image only-dark" src="../../../_static/nma-dl-logo-square-4xp.png"/>
</a>
</div>
<div class="col-lg-9 navbar-header-items">
<div class="mr-auto" id="navbar-center">
<div class="navbar-center-item">
<nav class="navbar-nav">
<p aria-label="Site Navigation" aria-level="1" class="sidebar-header-items__title" role="heading">
        Site Navigation
    </p>
<ul class="navbar-nav" id="navbar-main-elements">
<li class="nav-item">
<a class="nav-link nav-internal" href="../../Schedule/schedule_intro.html">
                        Schedule
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../TechnicalHelp/tech_intro.html">
                        Technical Help
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../TechnicalHelp/Links_Policy.html">
                        Quick links and policies
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W1D1_BasicsAndPytorch/chapter_title.html">
                        Basics And Pytorch (W1D1)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W1D2_LinearDeepLearning/chapter_title.html">
                        Linear Deep Learning (W1D2)
                      </a>
</li>
<div class="nav-item dropdown">
<button aria-expanded="false" aria-haspopup="true" class="btn dropdown-toggle nav-item" data-toggle="dropdown" type="button">
                    More
                </button>
<div class="dropdown-menu">
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W1D3_MultiLayerPerceptrons/chapter_title.html">
                        Multi Layer Perceptrons (W1D3)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W1D5_Optimization/chapter_title.html">
                        Optimization (W1D5)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W2D1_Regularization/chapter_title.html">
                        Regularization (W2D1)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../Module_WrapUps/FineTuning.html">
                        Deep Learning: The Basics and Fine Tuning Wrap-up
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W2D2_ConvnetsAndDlThinking/chapter_title.html">
                        Convnets And Dl Thinking (W2D2)
                      </a>
</li>
<li class="nav-item current active">
<a class="nav-link nav-internal" href="../chapter_title.html">
                        Modern Convnets (W2D3)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W2D4_GenerativeModels/chapter_title.html">
                        Generative Models (W2D4)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W2D5_AttentionAndTransformers/chapter_title.html">
                        Attention And Transformers (W2D5)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/chapter_title.html">
                        Time Series And Natural Language Processing (W3D1)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W3D2_DlThinking2/chapter_title.html">
                        Dl Thinking2 (W3D2)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../Module_WrapUps/NaturalLanguageProcessing.html">
                        Deep Learning: Convnets and NLP
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W3D3_UnsupervisedAndSelfSupervisedLearning/chapter_title.html">
                        Unsupervised And Self Supervised Learning (W3D3)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W3D4_BasicReinforcementLearning/chapter_title.html">
                        Basic Reinforcement Learning (W3D4)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W3D5_ReinforcementLearningForGamesAndDlThinking3/chapter_title.html">
                        Reinforcement Learning For Games And Dl Thinking3 (W3D5)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../Bonus_DeployModels/chapter_title.html">
                        Deploy Models (Bonus)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/README.html">
                        Introduction
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/docs/project_guidance.html">
                        Daily guide for projects
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/modelingsteps/intro.html">
                        Modeling Step-by-Step Guide
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/docs/projects_overview.html">
                        Project Templates
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/docs/datasets_and_models.html">
                        Models and Data sets
                      </a>
</li>
</div>
</div>
</ul>
</nav>
</div>
</div>
<div id="navbar-end">
<div class="navbar-end-item navbar-persistent--container">
<button aria-label="Search" class="btn btn-sm navbar-btn search-button search-button__button" data-toggle="tooltip" title="Search">
<i class="fa-solid fa-magnifying-glass"></i>
</button>
</div>
<div class="navbar-end-item">
<button aria-label="light/dark" class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" data-toggle="tooltip" title="light/dark">
<span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
<span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
<span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
</div>
<div class="navbar-end-item">
<ul aria-label="Icon Links" class="navbar-nav" id="navbar-icon-links">
</ul>
</div>
</div>
</div>
<div class="navbar-persistent--mobile">
<button aria-label="Search" class="btn btn-sm navbar-btn search-button search-button__button" data-toggle="tooltip" title="Search">
<i class="fa-solid fa-magnifying-glass"></i>
</button>
</div>
<label class="sidebar-toggle secondary-toggle" for="__secondary">
<span class="fa-solid fa-outdent"></span>
</label>
</div>
</nav>
<div class="bd-container">
<div class="bd-container__inner bd-page-width">
<div class="bd-sidebar-primary bd-sidebar">
<div class="sidebar-header-items sidebar-primary__section">
<div class="sidebar-header-items__center">
<div class="navbar-center-item">
<nav class="navbar-nav">
<p aria-label="Site Navigation" aria-level="1" class="sidebar-header-items__title" role="heading">
        Site Navigation
    </p>
<ul class="navbar-nav" id="navbar-main-elements">
<li class="nav-item">
<a class="nav-link nav-internal" href="../../Schedule/schedule_intro.html">
                        Schedule
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../TechnicalHelp/tech_intro.html">
                        Technical Help
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../TechnicalHelp/Links_Policy.html">
                        Quick links and policies
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W1D1_BasicsAndPytorch/chapter_title.html">
                        Basics And Pytorch (W1D1)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W1D2_LinearDeepLearning/chapter_title.html">
                        Linear Deep Learning (W1D2)
                      </a>
</li>
<div class="nav-item dropdown">
<button aria-expanded="false" aria-haspopup="true" class="btn dropdown-toggle nav-item" data-toggle="dropdown" type="button">
                    More
                </button>
<div class="dropdown-menu">
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W1D3_MultiLayerPerceptrons/chapter_title.html">
                        Multi Layer Perceptrons (W1D3)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W1D5_Optimization/chapter_title.html">
                        Optimization (W1D5)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W2D1_Regularization/chapter_title.html">
                        Regularization (W2D1)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../Module_WrapUps/FineTuning.html">
                        Deep Learning: The Basics and Fine Tuning Wrap-up
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W2D2_ConvnetsAndDlThinking/chapter_title.html">
                        Convnets And Dl Thinking (W2D2)
                      </a>
</li>
<li class="nav-item current active">
<a class="nav-link nav-internal" href="../chapter_title.html">
                        Modern Convnets (W2D3)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W2D4_GenerativeModels/chapter_title.html">
                        Generative Models (W2D4)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W2D5_AttentionAndTransformers/chapter_title.html">
                        Attention And Transformers (W2D5)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/chapter_title.html">
                        Time Series And Natural Language Processing (W3D1)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W3D2_DlThinking2/chapter_title.html">
                        Dl Thinking2 (W3D2)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../Module_WrapUps/NaturalLanguageProcessing.html">
                        Deep Learning: Convnets and NLP
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W3D3_UnsupervisedAndSelfSupervisedLearning/chapter_title.html">
                        Unsupervised And Self Supervised Learning (W3D3)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W3D4_BasicReinforcementLearning/chapter_title.html">
                        Basic Reinforcement Learning (W3D4)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W3D5_ReinforcementLearningForGamesAndDlThinking3/chapter_title.html">
                        Reinforcement Learning For Games And Dl Thinking3 (W3D5)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../Bonus_DeployModels/chapter_title.html">
                        Deploy Models (Bonus)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/README.html">
                        Introduction
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/docs/project_guidance.html">
                        Daily guide for projects
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/modelingsteps/intro.html">
                        Modeling Step-by-Step Guide
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/docs/projects_overview.html">
                        Project Templates
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/docs/datasets_and_models.html">
                        Models and Data sets
                      </a>
</li>
</div>
</div>
</ul>
</nav>
</div>
</div>
<div class="sidebar-header-items__end">
<div class="navbar-end-item">
<button aria-label="light/dark" class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" data-toggle="tooltip" title="light/dark">
<span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
<span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
<span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
</div>
<div class="navbar-end-item">
<ul aria-label="Icon Links" class="navbar-nav" id="navbar-icon-links">
</ul>
</div>
</div>
</div>
<div class="sidebar-start-items sidebar-primary__section">
<div class="sidebar-start-items__item">
<a class="navbar-brand logo" href="../../intro.html">
<img alt="Logo image" class="logo__image only-light" src="../../../_static/nma-dl-logo-square-4xp.png"/>
<img alt="Logo image" class="logo__image only-dark" src="../../../_static/nma-dl-logo-square-4xp.png"/>
</a>
</div>
<div class="sidebar-start-items__item">
<form action="../../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="fa-solid fa-magnifying-glass"></i>
<input aria-label="Search this book..." autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." spellcheck="false" type="search"/>
<span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
</div>
<div class="sidebar-start-items__item"><nav aria-label="Main" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item navbar-nav active">
<ul class="nav bd-sidenav bd-sidenav__home-link">
<li class="toctree-l1">
<a class="reference internal" href="../../intro.html">
                    Introduction
                </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Schedule/schedule_intro.html">Schedule</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Schedule/daily_schedules.html">General schedule</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Schedule/shared_calendars.html">Shared calendars</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Schedule/timezone_widget.html">Timezone widget</a></li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TechnicalHelp/tech_intro.html">Technical Help</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../TechnicalHelp/Jupyterbook.html">Using jupyterbook</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../TechnicalHelp/Tutorial_colab.html">Using Google Colab</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../TechnicalHelp/Tutorial_kaggle.html">Using Kaggle</a></li>
</ul>
</input></li>
<li class="toctree-l2"><a class="reference internal" href="../../TechnicalHelp/Discord.html">Using Discord</a></li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../TechnicalHelp/Links_Policy.html">Quick links and policies</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Basics Module</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W1D1_BasicsAndPytorch/chapter_title.html">Basics And Pytorch (W1D1)</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W1D1_BasicsAndPytorch/instructor/W1D1_Tutorial1.html">Tutorial 1: PyTorch</a></li>
</ul>
</input></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W1D2_LinearDeepLearning/chapter_title.html">Linear Deep Learning (W1D2)</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W1D2_LinearDeepLearning/instructor/W1D2_Tutorial1.html">Tutorial 1: Gradient Descent and AutoGrad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W1D2_LinearDeepLearning/instructor/W1D2_Tutorial2.html">Tutorial 2: Learning Hyperparameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W1D2_LinearDeepLearning/instructor/W1D2_Tutorial3.html">Tutorial 3: Deep linear neural networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W1D2_LinearDeepLearning/instructor/W1D2_BonusLecture.html">Bonus Lecture: Yoshua Bengio</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W1D3_MultiLayerPerceptrons/chapter_title.html">Multi Layer Perceptrons (W1D3)</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W1D3_MultiLayerPerceptrons/instructor/W1D3_Tutorial1.html">Tutorial 1: Biological vs. Artificial Neural Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W1D3_MultiLayerPerceptrons/instructor/W1D3_Tutorial2.html">Tutorial 2: Deep MLPs</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Fine Tuning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W1D5_Optimization/chapter_title.html">Optimization (W1D5)</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W1D5_Optimization/instructor/W1D5_Tutorial1.html">Tutorial 1: Optimization techniques</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W2D1_Regularization/chapter_title.html">Regularization (W2D1)</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W2D1_Regularization/instructor/W2D1_Tutorial1.html">Tutorial 1: Regularization techniques part 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W2D1_Regularization/instructor/W2D1_Tutorial2.html">Tutorial 2: Regularization techniques part 2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Module_WrapUps/FineTuning.html">Deep Learning: The Basics and Fine Tuning Wrap-up</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ConvNets and Generative Models</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W2D2_ConvnetsAndDlThinking/chapter_title.html">Convnets And Dl Thinking (W2D2)</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W2D2_ConvnetsAndDlThinking/instructor/W2D2_Tutorial1.html">Tutorial 1: Introduction to CNNs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W2D2_ConvnetsAndDlThinking/instructor/W2D2_Tutorial2.html">Tutorial 2: Deep Learning Thinking 1: Cost Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W2D2_ConvnetsAndDlThinking/instructor/W2D2_BonusLecture.html">Bonus Lecture: Kyunghyun Cho</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../chapter_title.html">Modern Convnets (W2D3)</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Tutorial 1: Learn how to use modern convnets</a></li>
<li class="toctree-l2"><a class="reference internal" href="W2D3_Tutorial2.html">Bonus Tutorial: Facial recognition using modern convnets</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W2D4_GenerativeModels/chapter_title.html">Generative Models (W2D4)</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W2D4_GenerativeModels/instructor/W2D4_Tutorial1.html">Tutorial 1: Variational Autoencoders (VAEs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W2D4_GenerativeModels/instructor/W2D4_Tutorial2.html">Tutorial 2: Diffusion models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W2D4_GenerativeModels/instructor/W2D4_Tutorial3.html">Tutorial 3: Image, Conditional Diffusion and Beyond</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W2D4_GenerativeModels/instructor/W2D4_BonusLecture.html">Bonus Lecture: Geoffrey Hinton</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Natural Language Processing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W2D5_AttentionAndTransformers/chapter_title.html">Attention And Transformers (W2D5)</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W2D5_AttentionAndTransformers/instructor/W2D5_Tutorial1.html">Tutorial 1: Learn how to work with Transformers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W2D5_AttentionAndTransformers/instructor/W2D5_Tutorial2.html">Bonus Tutorial: Understanding Pre-training, Fine-tuning and Robustness of Transformers</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/chapter_title.html">Time Series And Natural Language Processing (W3D1)</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/instructor/W3D1_Tutorial1.html">Tutorial 1: Introduction to processing time series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/instructor/W3D1_Tutorial2.html">Tutorial 2: Natural Language Processing and LLMs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/instructor/W3D1_Tutorial3.html">Bonus Tutorial: Multilingual Embeddings</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W3D2_DlThinking2/chapter_title.html">Dl Thinking2 (W3D2)</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W3D2_DlThinking2/instructor/W3D2_Tutorial1.html">Tutorial 1: Deep Learning Thinking 2: Architectures and Multimodal DL thinking</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Module_WrapUps/NaturalLanguageProcessing.html">Deep Learning: Convnets and NLP</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unsupervised and Reinforcement Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W3D3_UnsupervisedAndSelfSupervisedLearning/chapter_title.html">Unsupervised And Self Supervised Learning (W3D3)</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W3D3_UnsupervisedAndSelfSupervisedLearning/instructor/W3D3_Tutorial1.html">Tutorial 1: Un/Self-supervised learning methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W3D3_UnsupervisedAndSelfSupervisedLearning/instructor/W3D3_BonusLecture.html">Bonus Lecture: Melanie Mitchell</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W3D4_BasicReinforcementLearning/chapter_title.html">Basic Reinforcement Learning (W3D4)</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W3D4_BasicReinforcementLearning/instructor/W3D4_Tutorial1.html">Tutorial 1: Basic Reinforcement Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W3D4_BasicReinforcementLearning/instructor/W3D4_BonusLecture.html">Bonus Lecture: Chealsea Finn</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W3D5_ReinforcementLearningForGamesAndDlThinking3/chapter_title.html">Reinforcement Learning For Games And Dl Thinking3 (W3D5)</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W3D5_ReinforcementLearningForGamesAndDlThinking3/instructor/W3D5_Tutorial1.html">Tutorial 1: Reinforcement Learning For Games</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W3D5_ReinforcementLearningForGamesAndDlThinking3/instructor/W3D5_Tutorial2.html">Tutorial 2: Deep Learning Thinking 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W3D5_ReinforcementLearningForGamesAndDlThinking3/instructor/W3D5_Tutorial3.html">Bonus Tutorial: Planning with Monte Carlo Tree Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W3D5_ReinforcementLearningForGamesAndDlThinking3/instructor/W3D5_BonusLecture.html">Bonus Lecture: Amita Kapoor</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Deploy Models on the Web</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Bonus_DeployModels/chapter_title.html">Deploy Models (Bonus)</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Bonus_DeployModels/instructor/Bonus_Tutorial1.html">Bonus Tutorial: Deploying Neural Networks on the Web</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Project Booklet</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../projects/README.html">Introduction to projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../projects/docs/project_guidance.html">Daily guide for projects</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../projects/modelingsteps/intro.html">Modeling Step-by-Step Guide</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_1through2_DL.html">Modeling Steps 1 - 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_3through4_DL.html">Modeling Steps 3 - 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_5through6_DL.html">Modeling Steps 5 - 6</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_7through9_DL.html">Modeling Steps 7 - 9</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_10_DL.html">Modeling Steps 10</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionDataProjectDL.html">Example Data Project: the Train Illusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionModelingProjectDL.html">Example Model Project: the Train Illusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../projects/modelingsteps/Example_Deep_Learning_Project.html">Example Deep Learning Project</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../projects/docs/projects_overview.html">Project Templates</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../projects/ComputerVision/README.html">Computer Vision</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-21"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/ComputerVision/slides.html">Slides</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/ComputerVision/ideas_and_datasets.html">Ideas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/ComputerVision/em_synapses.html">Knowledge Extraction from a Convolutional Neural Network</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/ComputerVision/spectrogram_analysis.html">Music classification and generation with spectrograms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/ComputerVision/screws.html">Something Screwy - image recognition, detection, and classification of screws</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/ComputerVision/data_augmentation.html">Data Augmentation in image classification models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/ComputerVision/transfer_learning.html">Transfer Learning</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../projects/ReinforcementLearning/README.html">Reinforcement Learning</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-22"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/ReinforcementLearning/slides.html">Slides</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/ReinforcementLearning/ideas_and_datasets.html">Ideas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/ReinforcementLearning/robolympics.html">NMA Robolympics: Controlling robots using reinforcement learning</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/ReinforcementLearning/lunar_lander.html">Performance Analysis of DQN Algorithm on the Lunar Lander task</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/ReinforcementLearning/human_rl.html">Using RL to Model Cognitive Tasks</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../projects/NaturalLanguageProcessing/README.html">Natural Language Processing</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-23"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/NaturalLanguageProcessing/slides.html">Slides</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/NaturalLanguageProcessing/ideas_and_datasets.html">Ideas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/NaturalLanguageProcessing/sentiment_analysis.html">Twitter Sentiment Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/NaturalLanguageProcessing/machine_translation.html">Machine Translation</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../projects/Neuroscience/README.html">Neuroscience</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-24"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/Neuroscience/slides.html">Slides</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/Neuroscience/ideas_and_datasets.html">Ideas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/Neuroscience/pose_estimation.html">Animal Pose Estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/Neuroscience/cellular_segmentation.html">Segmentation and Denoising</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/Neuroscience/algonauts_videos.html">Load algonauts videos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/Neuroscience/blurry_vision.html">Vision with Lost Glasses: Modelling how the brain deals with noisy input</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/Neuroscience/finetuning_fmri.html">Moving beyond Labels: Finetuning CNNs on BOLD response</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/Neuroscience/neuro_seq_to_seq.html">Focus on what matters: inferring low-dimensional dynamics from neural recordings</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../projects/docs/datasets_and_models.html">Models and Data sets</a></li>
</ul>
</div>
</nav>
</div>
</div>
<div class="sidebar-end-items sidebar-primary__section">
<div class="sidebar-end-items__item">
</div>
</div>
<div id="rtd-footer-container"></div>
</div>
<main class="bd-main" id="main-content">
<div class="sbt-scroll-pixel-helper"></div>
<div class="bd-content">
<div class="bd-article-container">
<div class="bd-header-article">
<div class="col py-1 d-flex header-article-main">
<div class="header-article__left">
<label class="sidebar-toggle primary-toggle btn btn-sm" data-placement="right" data-toggle="tooltip" for="__primary" title="Toggle primary sidebar">
<span class="fa-solid fa-bars"></span>
</label>
</div>
<div class="header-article__right">
<div class="dropdown dropdown-launch-buttons">
<button aria-expanded="false" aria-label="Launch interactive content" class="btn dropdown-toggle" data-bs-toggle="dropdown" type="button">
<i class="fas fa-rocket"></i>
</button>
<ul class="dropdown-menu">
</ul>
</div>
<button class="btn btn-sm" data-placement="bottom" data-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode">
<span class="btn__icon-container">
<i class="fas fa-expand"></i>
</span>
</button>
<div class="dropdown dropdown-repository-buttons">
<button aria-expanded="false" aria-label="Source repositories" class="btn dropdown-toggle" data-bs-toggle="dropdown" type="button">
<i class="fab fa-github"></i>
</button>
<ul class="dropdown-menu">
<li><a class="btn btn-sm dropdown-item" data-placement="left" data-toggle="tooltip" href="https://github.com/NeuromatchAcademy/instructor-course-content-dl" target="_blank" title="Source repository">
<span class="btn__icon-container">
<i class="fab fa-github"></i>
</span>
<span class="btn__text-container">repository</span>
</a>

<li><a class="btn btn-sm dropdown-item" data-placement="left" data-toggle="tooltip" href="https://github.com/NeuromatchAcademy/instructor-course-content-dl/issues/new?title=Issue%20on%20page%20%2Ftutorials/W2D3_ModernConvnets/instructor/W2D3_Tutorial1.html&amp;body=Your%20issue%20content%20here." target="_blank" title="Open an issue">
<span class="btn__icon-container">
<i class="fas fa-lightbulb"></i>
</span>
<span class="btn__text-container">open issue</span>
</a>

</li></li></ul>
</div>
<div class="dropdown dropdown-download-buttons">
<button aria-expanded="false" aria-label="Download this page" class="btn dropdown-toggle" data-bs-toggle="dropdown" type="button">
<i class="fas fa-download"></i>
</button>
<ul class="dropdown-menu">
<li><a class="btn btn-sm dropdown-item" data-placement="left" data-toggle="tooltip" href="../../../_sources/tutorials/W2D3_ModernConvnets/instructor/W2D3_Tutorial1.ipynb" target="_blank" title="Download source file">
<span class="btn__icon-container">
<i class="fas fa-file"></i>
</span>
<span class="btn__text-container">.ipynb</span>
</a>

<li>
<button class="btn btn-sm dropdown-item" data-placement="left" data-toggle="tooltip" onclick="printPdf(this)" title="Print to PDF">
<span class="btn__icon-container">
<i class="fas fa-file-pdf"></i>
</span>
<span class="btn__text-container">.pdf</span>
</button>

</li></li></ul>
</div>
<label class="sidebar-toggle secondary-toggle btn btn-sm" data-placement="left" data-toggle="tooltip" for="__secondary" title="Toggle secondary sidebar">
<span class="fa-solid fa-list"></span>
</label>
</div>
</div>
</div>
<div class="onlyprint" id="jb-print-docs-body">
<h1>Tutorial 1: Learn how to use modern convnets</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Tutorial 1: Learn how to use modern convnets
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#install-dependencies">
     Install dependencies
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#install-and-import-feedback-gadget">
     Install and import feedback gadget
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure settings
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#set-random-seed">
     Set random seed
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#set-device-gpu-or-cpu-execute-set-device">
     Set device (GPU or CPU). Execute
     <code class="docutils literal notranslate">
<span class="pre">
       set_device()
      </span>
</code>
</a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-modern-cnns-and-transfer-learning">
   Section 1: Modern CNNs and Transfer Learning
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-modern-cnns-and-transfer-learning">
     Video 1: Modern CNNs and Transfer Learning
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#submit-your-feedback">
     Submit your feedback
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1-calculate-number-of-parameters-in-fcnn-vs-convnet">
     Coding Exercise 1: Calculate number of parameters in FCNN vs ConvNet
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id1">
       Submit your feedback
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-1-check-your-results">
     Interactive Demo 1: Check your results
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#parameter-calculator">
       Parameter Calculator
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id2">
       Submit your feedback
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-the-history-of-convnets">
   Section 2: The History of Convnets
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-2-history-of-convnets">
     Video 2: History of convnets
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id3">
     Submit your feedback
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-2-challenges-of-improving-cnns">
     Think! 2: Challenges of improving CNNs
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id4">
       Submit your feedback
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-big-and-deep-convnets">
   Section 3: Big and Deep Convnets
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-3-alexnet-vgg">
     Video 3: AlexNet &amp; VGG
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id5">
     Submit your feedback
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-1-introduction-to-alexnet">
     Section 3.1: Introduction to AlexNet
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#import-alexnet">
       Import Alexnet
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-2-what-does-alexnet-learn">
     Section 3.2: What does AlexNet learn?
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-3-2-1-filter-similarity">
       Think! 3.2.1: Filter Similarity
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id6">
         Submit your feedback
        </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-3-2-what-does-alexnet-see">
       Interactive Demo 3.2: What does AlexNet see?
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id7">
         Submit your feedback
        </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-3-2-2-filter-purpose">
       Think! 3.2.2 Filter Purpose
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id8">
         Submit your feedback
        </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#further-reading">
     Further Reading
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-4-convnets-after-alexnet">
   Section 4: Convnets After AlexNet
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-4-residual-networks-resnets">
     Video 4: Residual Networks (ResNets)
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id9">
     Submit your feedback
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#download-imagenette">
     Download imagenette
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#set-up-textual-imagenet-labels">
     Set Up Textual ImageNet labels
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#map-imagenette-labels-to-imagenet-labels">
     Map Imagenette Labels to Imagenet Labels
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#prepare-imagenette-data">
     Prepare Imagenette Data
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#eval-imagenette-function">
     eval_imagenette function
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#imagenette-train-loop">
     Imagenette Train Loop
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-4-1-use-the-resnet-model">
     Coding Exercise 4.1: Use the ResNet model
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id10">
       Submit your feedback
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#out-of-distribution-examples">
     Out-of-distribution examples
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-5-inception-resnext">
   Section 5: Inception + ResNeXt
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-5-improving-efficiency-inception-and-resnext">
     Video 5: Improving efficiency: Inception and ResNeXt
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id11">
     Submit your feedback
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#resnet-vs-resnext">
     ResNet vs ResNeXt
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-5-resnet-vs-resnext">
     Interactive Demo 5: ResNet vs. ResNeXt
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id12">
       Parameter Calculator
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id13">
       Submit your feedback
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-5-resnet-vs-resnext">
     Think! 5: ResNet vs. ResNeXt
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id14">
       Submit your feedback
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-6-depthwise-separable-convolutions">
   Section 6: Depthwise separable convolutions
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-6-improving-efficiency-mobilenet">
     Video 6: Improving efficiency: MobileNet
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id15">
     Submit your feedback
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-6-1-depthwise-separable-convolutions">
     Section 6.1: Depthwise separable convolutions
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-6-1-calculation-of-parameters">
       Coding Exercise 6.1: Calculation of parameters
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id16">
         Submit your feedback
        </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-6-1-how-do-parameter-savings-depend-the-on-number-of-input-feature-maps-4-vs-64">
       Think! 6.1: How do parameter savings depend the on number of input feature maps, 4 vs. 64?
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id17">
         Submit your feedback
        </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-7-transfer-learning">
   Section 7: Transfer Learning
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-7-transfer-learning">
     Video 7: Transfer Learning
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id18">
     Submit your feedback
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-7-1-download-and-prepare-the-data">
     Section 7.1: Download and prepare the data
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#download-data">
       Download Data
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#determine-number-of-classes">
       Determine number of classes
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#display-example-images">
       Display Example Images
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-7-2-fine-tuning-a-resnet">
     Section 7.2: Fine-tuning a ResNet
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#finetune-resnet">
       Finetune ResNet
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-7-3-train-only-classification-layer">
     Section 7.3: Train only classification layer
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#finetune-readout-of-resnet">
       Finetune readout of ResNet
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-7-4-training-resnet-from-scratch">
     Section 7.4: Training ResNet from scratch
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#train-resnet-from-scratch">
       Train ResNet from scratch
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-7-5-head-to-head-comparison">
     Section 7.5: Head to Head Comparison
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#plot-accuracies">
       Plot Accuracies
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#exercise-7-5-1-pretrained-resnet-vs-resnet-trained-from-scratch">
       Exercise 7.5.1: Pretrained ResNet vs. ResNet trained from scratch
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id19">
         Submit your feedback
        </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#exercise-7-5-2-training-only-the-classification-layer">
       Exercise 7.5.2: Training only the classification layer
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id20">
         Submit your feedback
        </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id21">
     Further Reading
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#summary">
   Summary
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-8-summary-and-outlook">
     Video 8: Summary and Outlook
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id22">
     Submit your feedback
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#daily-survey">
   Daily survey
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-speed-accuracy-trade-off-different-backbones">
   Bonus: Speed-Accuracy Trade-Off / Different Backbones
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-9-speed-accuracy-trade-off">
     Video 9: Speed-accuracy trade-off
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id23">
     Submit your feedback
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-coding-exercise-compare-accuracy-and-training-speed-of-different-models">
     Bonus Coding Exercise: Compare accuracy and training speed of different models
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#imagenette-train-loop-train-loop-model-optimizer-train-loader-loss-fn-device">
       Imagenette Train Loop:
       <code class="docutils literal notranslate">
<span class="pre">
         train_loop(model,
        </span>
<span class="pre">
         optimizer,
        </span>
<span class="pre">
         train_loader,
        </span>
<span class="pre">
         loss_fn,
        </span>
<span class="pre">
         device)
        </span>
</code>
</a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#run-the-models-run-models-models-lr-rates">
       Run the models:
       <code class="docutils literal notranslate">
<span class="pre">
         run_models(models,
        </span>
<span class="pre">
         lr_rates)
        </span>
</code>
</a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#plot-accuracies-vs-training-speed">
       Plot accuracies vs. training speed
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id24">
       Submit your feedback
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-exercise-1-finding-the-best-model">
     Bonus Exercise 1: Finding the best model
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id25">
       Submit your feedback
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-exercise-2-speed-and-accuracy-correlation">
       Bonus Exercise 2: Speed and accuracy correlation
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id26">
         Submit your feedback
        </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</div>
<article class="bd-article" role="main">
<p><a href="https://colab.research.google.com/github/NeuromatchAcademy/course-content-dl/blob/main/tutorials/W2D3_ModernConvnets/instructor/W2D3_Tutorial1.ipynb" target="_blank"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"/></a>   <a href="https://kaggle.com/kernels/welcome?src=https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W2D3_ModernConvnets/instructor/W2D3_Tutorial1.ipynb" target="_blank"><img alt="Open in Kaggle" src="https://kaggle.com/static/images/open-in-kaggle.svg"/></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="tutorial-1-learn-how-to-use-modern-convnets">
<h1>Tutorial 1: Learn how to use modern convnets<a class="headerlink" href="#tutorial-1-learn-how-to-use-modern-convnets" title="Permalink to this heading">#</a></h1>
<p><strong>Week 2, Day 3: Modern Convnets</strong></p>
<p><strong>By Neuromatch Academy</strong></p>
<p><strong>Content creators:</strong> Laura Pede, Richard Vogg, Marissa Weis, Timo Lüddecke, Alexander Ecker</p>
<p><strong>Content reviewers:</strong> Arush Tagade, Polina Turishcheva, Yu-Fang Yang, Bettina Hein, Melvin Selim Atay, Kelson Shilling-Scrivo</p>
<p><strong>Content editors:</strong> Gagana B, Roberto Guidotti, Spiros Chavlis</p>
<p><strong>Production editors:</strong> Anoop Kulkarni, Roberto Guidotti, Cary Murray, Gagana B, Spiros Chavlis</p>
<br/>
<p><em>Tutorial notebook is based on an initial version by Ben Heil</em></p>
</section>
<hr class="docutils"/>
<section class="tex2jax_ignore mathjax_ignore" id="tutorial-objectives">
<h1>Tutorial Objectives<a class="headerlink" href="#tutorial-objectives" title="Permalink to this heading">#</a></h1>
<p>In this tutorial we are going to learn more about Convnets. More specifically, we will:</p>
<ol class="arabic simple">
<li><p>Learn about modern CNNs and Transfer Learning.</p></li>
<li><p>Understand how architectures incorporate ideas we have about the world.</p></li>
<li><p>Understand the operating principles underlying the basic building blocks of modern CNNs.</p></li>
<li><p>Understand the concept of transfer learning and learn to recognize opportunities for applying it.</p></li>
<li><p>(Bonus) Understand the speed vs. accuracy trade-off.</p></li>
</ol>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "4921910c074b4ac3972855c707fc9bb1"}</script></div>
</div>
</section>
<hr class="docutils"/>
<section class="tex2jax_ignore mathjax_ignore" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this heading">#</a></h1>
<section id="install-dependencies">
<h2>Install dependencies<a class="headerlink" href="#install-dependencies" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Install dependencies</span>
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>Pillow<span class="w"> </span>--quiet
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="install-and-import-feedback-gadget">
<h2>Install and import feedback gadget<a class="headerlink" href="#install-and-import-feedback-gadget" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Install and import feedback gadget</span>

<span class="o">!</span>pip3<span class="w"> </span>install<span class="w"> </span>vibecheck<span class="w"> </span>datatops<span class="w"> </span>--quiet

<span class="kn">from</span> <span class="nn">vibecheck</span> <span class="kn">import</span> <span class="n">DatatopsContentReviewContainer</span>
<span class="k">def</span> <span class="nf">content_review</span><span class="p">(</span><span class="n">notebook_section</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">DatatopsContentReviewContainer</span><span class="p">(</span>
        <span class="s2">""</span><span class="p">,</span>  <span class="c1"># No text prompt</span>
        <span class="n">notebook_section</span><span class="p">,</span>
        <span class="p">{</span>
            <span class="s2">"url"</span><span class="p">:</span> <span class="s2">"https://pmyvdlilci.execute-api.us-east-1.amazonaws.com/klab"</span><span class="p">,</span>
            <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"neuromatch_dl"</span><span class="p">,</span>
            <span class="s2">"user_key"</span><span class="p">:</span> <span class="s2">"f379rz8y"</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">)</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>


<span class="n">feedback_prefix</span> <span class="o">=</span> <span class="s2">"W2D3_T1"</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import libraries</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">tqdm</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">IPython</span>
<span class="kn">import</span> <span class="nn">torchvision</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>

<span class="kn">from</span> <span class="nn">torchvision</span> <span class="kn">import</span> <span class="n">transforms</span>
<span class="kn">from</span> <span class="nn">torchvision.models</span> <span class="kn">import</span> <span class="n">AlexNet</span>
<span class="kn">from</span> <span class="nn">torchvision.utils</span> <span class="kn">import</span> <span class="n">make_grid</span>
<span class="kn">from</span> <span class="nn">torchvision.datasets</span> <span class="kn">import</span> <span class="n">ImageFolder</span>

<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="figure-settings">
<h2>Figure settings<a class="headerlink" href="#figure-settings" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Figure settings</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">'matplotlib.font_manager'</span><span class="p">)</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>

<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>  <span class="c1"># Interactive display</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = 'retina'
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">"https://raw.githubusercontent.com/NeuromatchAcademy/content-creation/main/nma.mplstyle"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="set-random-seed">
<h2>Set random seed<a class="headerlink" href="#set-random-seed" title="Permalink to this heading">#</a></h2>
<p>Executing <code class="docutils literal notranslate"><span class="pre">set_seed(seed=seed)</span></code> you are setting the seed</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Set random seed</span>

<span class="c1"># @markdown Executing `set_seed(seed=seed)` you are setting the seed</span>

<span class="c1"># For DL its critical to set the random seed so that students can have a</span>
<span class="c1"># baseline to compare their results to expected results.</span>
<span class="c1"># Read more here: https://pytorch.org/docs/stable/notes/randomness.html</span>

<span class="c1"># Call `set_seed` function in the exercises to ensure reproducibility.</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">torch</span>

<span class="k">def</span> <span class="nf">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed_torch</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Function that controls randomness. NumPy and random modules must be imported.</span>

<span class="sd">  Args:</span>
<span class="sd">    seed : Integer</span>
<span class="sd">      A non-negative integer that defines the random state. Default is `None`.</span>
<span class="sd">    seed_torch : Boolean</span>
<span class="sd">      If `True` sets the random seed for pytorch tensors, so pytorch module</span>
<span class="sd">      must be imported. Default is `True`.</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  """</span>
  <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="mi">32</span><span class="p">)</span>
  <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">seed_torch</span><span class="p">:</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">manual_seed_all</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">cudnn</span><span class="o">.</span><span class="n">benchmark</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">cudnn</span><span class="o">.</span><span class="n">deterministic</span> <span class="o">=</span> <span class="kc">True</span>

  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Random seed </span><span class="si">{</span><span class="n">seed</span><span class="si">}</span><span class="s1"> has been set.'</span><span class="p">)</span>


<span class="c1"># In case that `DataLoader` is used</span>
<span class="k">def</span> <span class="nf">seed_worker</span><span class="p">(</span><span class="n">worker_id</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  DataLoader will reseed workers following randomness in</span>
<span class="sd">  multi-process data loading algorithm.</span>

<span class="sd">  Args:</span>
<span class="sd">    worker_id: integer</span>
<span class="sd">      ID of subprocess to seed. 0 means that</span>
<span class="sd">      the data will be loaded in the main process</span>
<span class="sd">      Refer: https://pytorch.org/docs/stable/data.html#data-loading-randomness for more details</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  """</span>
  <span class="n">worker_seed</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">initial_seed</span><span class="p">()</span> <span class="o">%</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span>
  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">worker_seed</span><span class="p">)</span>
  <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">worker_seed</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="set-device-gpu-or-cpu-execute-set-device">
<h2>Set device (GPU or CPU). Execute <code class="docutils literal notranslate"><span class="pre">set_device()</span></code><a class="headerlink" href="#set-device-gpu-or-cpu-execute-set-device" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Set device (GPU or CPU). Execute `set_device()`</span>
<span class="c1"># especially if torch modules used.</span>

<span class="c1"># Inform the user if the notebook uses GPU or CPU.</span>

<span class="k">def</span> <span class="nf">set_device</span><span class="p">():</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Set the device. CUDA if available, CPU otherwise</span>

<span class="sd">  Args:</span>
<span class="sd">    None</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  """</span>
  <span class="n">device</span> <span class="o">=</span> <span class="s2">"cuda"</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">"cpu"</span>
  <span class="k">if</span> <span class="n">device</span> <span class="o">!=</span> <span class="s2">"cuda"</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"WARNING: For this notebook to perform best, "</span>
        <span class="s2">"if possible, in the menu under `Runtime` -&gt; "</span>
        <span class="s2">"`Change runtime type.`  select `GPU` "</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"GPU is enabled in this notebook."</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">device</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SEED</span> <span class="o">=</span> <span class="mi">2021</span>
<span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
<span class="n">DEVICE</span> <span class="o">=</span> <span class="n">set_device</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Random seed 2021 has been set.
WARNING: For this notebook to perform best, if possible, in the menu under `Runtime` -&gt; `Change runtime type.`  select `GPU` 
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils"/>
<section class="tex2jax_ignore mathjax_ignore" id="section-1-modern-cnns-and-transfer-learning">
<h1>Section 1: Modern CNNs and Transfer Learning<a class="headerlink" href="#section-1-modern-cnns-and-transfer-learning" title="Permalink to this heading">#</a></h1>
<p><em>Time estimate: ~25mins</em></p>
<section id="video-1-modern-cnns-and-transfer-learning">
<h2>Video 1: Modern CNNs and Transfer Learning<a class="headerlink" href="#video-1-modern-cnns-and-transfer-learning" title="Permalink to this heading">#</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "0ca6f90dc27544b382465d58f0f34740"}</script></div>
</div>
</section>
<section id="submit-your-feedback">
<h2>Submit your feedback<a class="headerlink" href="#submit-your-feedback" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Modern_CNNs_and_Transfer_Learning_Video"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "e11e80b9fd9a4ce7a2089e1b5c6017ff"}</script></div>
</div>
<p>Images are high dimensional. That is to say that <code class="docutils literal notranslate"><span class="pre">image_length</span></code> * <code class="docutils literal notranslate"><span class="pre">image_width</span></code> * <code class="docutils literal notranslate"><span class="pre">image_channels</span></code> is a big number, and multiplying that big number by a normal sized fully-connected layer leads to a ton of parameters to learn. Yesterday, we learned about convolutional neural networks, one way of working around high dimensionality in images and other domains.</p>
<p>The widget below (i.e., <em>Interactive Demo 1</em>) calculates the parameters required for a single convolutional or fully connected layer that operates on an image of a certain height and width.</p>
<p>Recall that, the number of parameters of a convolutional layer <span class="math notranslate nohighlight">\(l\)</span> are calculated as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-5a1319fa-c092-4e27-b6e1-d3706efc0434">
<span class="eqno">(83)<a class="headerlink" href="#equation-5a1319fa-c092-4e27-b6e1-d3706efc0434" title="Permalink to this equation">#</a></span>\[\begin{equation}
\text{num_of_params}_l = \left[ \left( H \times W \times K_{l-1} \right) + 1 \right] \times K_l
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(H\)</span> denotes the shape of the height of the filter, <span class="math notranslate nohighlight">\(W\)</span> the shape of the width of the filter, and <span class="math notranslate nohighlight">\(K_l\)</span> denotes the number of the filters in the <span class="math notranslate nohighlight">\(l\)</span>-th layer. The added <span class="math notranslate nohighlight">\(1\)</span> is because of the bias term for each filter.</p>
<p>While a fully connected layer contains:</p>
<div class="amsmath math notranslate nohighlight" id="equation-6aebcf02-eae3-4979-b533-1f348cbaab63">
<span class="eqno">(84)<a class="headerlink" href="#equation-6aebcf02-eae3-4979-b533-1f348cbaab63" title="Permalink to this equation">#</a></span>\[\begin{equation}
\text{num_of_params}_l = \left[ \left( N_{l-1} \times N_l \right) + 1 \times N_l \right]
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(N_l\)</span> denotes the number of nodes in the <span class="math notranslate nohighlight">\(l\)</span>-th layer.</p>
<p>Adjust the sliders to gain an intuition for how different model and data characteristics affect the number of parameters your model need to fit.</p>
<p>Note: these classes are designed to show parameter scaling in the first layer of a network, to be actually useful they would need more layers, an activation function, etc.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">FullyConnectedNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Fully connected network with the following structure:</span>
<span class="sd">  nn.Linear(self.input_size, 256)</span>
<span class="sd">  """</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Initialize parameters of FullyConnectedNet</span>

<span class="sd">    Args:</span>
<span class="sd">      None</span>

<span class="sd">    Returns:</span>
<span class="sd">      Nothing</span>
<span class="sd">    """</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">FullyConnectedNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="n">image_width</span> <span class="o">=</span> <span class="mi">128</span>
    <span class="n">image_channels</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_size</span> <span class="o">=</span> <span class="n">image_channels</span> <span class="o">*</span> <span class="n">image_width</span> <span class="o">**</span> <span class="mi">2</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_size</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Forward pass of FullyConnectedNet</span>

<span class="sd">    Args:</span>
<span class="sd">      x: torch.tensor</span>
<span class="sd">        Input data</span>

<span class="sd">    Returns:</span>
<span class="sd">      x: torch.tensor</span>
<span class="sd">        Output from FullyConnectedNet</span>
<span class="sd">    """</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_size</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ConvNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Convolutional Neural Network</span>
<span class="sd">  """</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Initialize parameters of ConvNet</span>

<span class="sd">    Args:</span>
<span class="sd">      None</span>

<span class="sd">    Returns:</span>
<span class="sd">      Nothing</span>
<span class="sd">    """</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">ConvNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                            <span class="n">out_channels</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
                            <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                            <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Forward pass of ConvNet</span>

<span class="sd">    Args:</span>
<span class="sd">      x: torch.tensor</span>
<span class="sd">        Input data</span>

<span class="sd">    Returns:</span>
<span class="sd">      x: torch.tensor</span>
<span class="sd">        Output after passing x through Conv2d layer</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="coding-exercise-1-calculate-number-of-parameters-in-fcnn-vs-convnet">
<h2>Coding Exercise 1: Calculate number of parameters in FCNN vs ConvNet<a class="headerlink" href="#coding-exercise-1-calculate-number-of-parameters-in-fcnn-vs-convnet" title="Permalink to this heading">#</a></h2>
<p>Write a function that calculates the number of parameters of a given network. Apply the function to the above defined fully-connected network and convolutional network and compare the parameter counts.</p>
<p><strong>Hint:</strong> <code class="docutils literal notranslate"><span class="pre">torch.numel</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_parameter_count</span><span class="p">(</span><span class="n">network</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Calculate the number of parameters used by the fully connected/convolutional network.</span>
<span class="sd">  Hint: Casting the result of network.parameters() to a list may make it</span>
<span class="sd">        easier to work with</span>

<span class="sd">  Args:</span>
<span class="sd">    network: nn.module</span>
<span class="sd">      Network to calculate the parameters of fully connected/convolutional network</span>

<span class="sd">  Returns:</span>
<span class="sd">    param_count: int</span>
<span class="sd">      The number of parameters in the network</span>
<span class="sd">  """</span>

  <span class="c1">####################################################################</span>
  <span class="c1"># Fill in all missing code below (...),</span>
  <span class="c1"># then remove or comment the line below to test your function</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Convolution math"</span><span class="p">)</span>
  <span class="c1">####################################################################</span>
  <span class="c1"># Get the network's parameters</span>
  <span class="n">parameters</span> <span class="o">=</span> <span class="o">...</span>

  <span class="n">param_count</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="c1"># Loop over all layers</span>
  <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
    <span class="n">param_count</span> <span class="o">+=</span> <span class="o">...</span>

  <span class="k">return</span> <span class="n">param_count</span>



<span class="c1"># Initialize networks</span>
<span class="n">fccnet</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">()</span>
<span class="n">convnet</span> <span class="o">=</span> <span class="n">ConvNet</span><span class="p">()</span>
<span class="c1">## Apply the above defined function to both networks by uncommenting the following lines</span>
<span class="c1"># print(f"FCCN parameter count: {get_parameter_count(fccnet)}")</span>
<span class="c1"># print(f"ConvNet parameter count: {get_parameter_count(convnet)}")</span>

</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FCCN</span> <span class="n">parameter</span> <span class="n">count</span><span class="p">:</span> <span class="mi">12583168</span>
<span class="n">ConvNet</span> <span class="n">parameter</span> <span class="n">count</span><span class="p">:</span> <span class="mi">7168</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>
<span class="k">def</span> <span class="nf">get_parameter_count</span><span class="p">(</span><span class="n">network</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Calculate the number of parameters used by the fully connected/convolutional network.</span>
<span class="sd">  Hint: Casting the result of network.parameters() to a list may make it</span>
<span class="sd">        easier to work with</span>

<span class="sd">  Args:</span>
<span class="sd">    network: nn.module</span>
<span class="sd">      Network to calculate the parameters of fully connected/convolutional network</span>

<span class="sd">  Returns:</span>
<span class="sd">    param_count: int</span>
<span class="sd">      The number of parameters in the network</span>
<span class="sd">  """</span>

  <span class="c1"># Get the network's parameters</span>
  <span class="n">parameters</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="n">parameters</span><span class="p">()</span>

  <span class="n">param_count</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="c1"># Loop over all layers</span>
  <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
    <span class="n">param_count</span> <span class="o">+=</span> <span class="n">torch</span><span class="o">.</span><span class="n">numel</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">param_count</span>



<span class="c1"># Initialize networks</span>
<span class="n">fccnet</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">()</span>
<span class="n">convnet</span> <span class="o">=</span> <span class="n">ConvNet</span><span class="p">()</span>
<span class="c1">## Apply the above defined function to both networks by uncommenting the following lines</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"FCCN parameter count: </span><span class="si">{</span><span class="n">get_parameter_count</span><span class="p">(</span><span class="n">fccnet</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"ConvNet parameter count: </span><span class="si">{</span><span class="n">get_parameter_count</span><span class="p">(</span><span class="n">convnet</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FCCN parameter count: 12583168
ConvNet parameter count: 7168
</pre></div>
</div>
</div>
</div>
<section id="id1">
<h3>Submit your feedback<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Calculate_number_of_params_Exercise"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "aa481fbd8a5c46028f23cac9cac62a97"}</script></div>
</div>
</section>
</section>
<section id="interactive-demo-1-check-your-results">
<h2>Interactive Demo 1: Check your results<a class="headerlink" href="#interactive-demo-1-check-your-results" title="Permalink to this heading">#</a></h2>
<p>The widget below calculates the number of parameters in a FCNN and CNN with the same architecture as our models above. Our models had an input image that was 128x128, and used 256 filters (or 256 nodes in the FCNN case). Check that the calculations you made above are correct.</p>
<p>Note how few parameters the convolutional networks take, especially as you increase the input image size.</p>
<section id="parameter-calculator">
<h3>Parameter Calculator<a class="headerlink" href="#parameter-calculator" title="Permalink to this heading">#</a></h3>
<p>Run this cell to enable the widget!</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Parameter Calculator</span>
<span class="c1"># @markdown Run this cell to enable the widget!</span>

<span class="k">def</span> <span class="nf">calculate_parameters</span><span class="p">(</span><span class="n">filter_count</span><span class="p">,</span> <span class="n">image_width</span><span class="p">,</span>
                         <span class="n">fcnn_nodes</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Implement how parameters</span>
<span class="sd">  scale as a function of image size</span>
<span class="sd">  between convnets and FCNN</span>

<span class="sd">  Args:</span>
<span class="sd">    filter_count: int</span>
<span class="sd">      Number of filters</span>
<span class="sd">    image_width: int</span>
<span class="sd">      Width of image</span>
<span class="sd">    fcnn_nodes: int</span>
<span class="sd">      Number of fCNN nodes</span>

<span class="sd">  Returns:</span>
<span class="sd">    None</span>
<span class="sd">  """</span>

  <span class="n">filter_width</span> <span class="o">=</span> <span class="mi">3</span>
  <span class="n">image_channels</span> <span class="o">=</span> <span class="mi">3</span>

  <span class="c1"># Assuming a square, RGB image</span>
  <span class="n">image_area</span> <span class="o">=</span> <span class="n">image_width</span> <span class="o">**</span> <span class="mi">2</span>
  <span class="n">image_volume</span> <span class="o">=</span> <span class="n">image_area</span> <span class="o">*</span> <span class="n">image_channels</span>

  <span class="c1"># If we're using padding=same, the output of a</span>
  <span class="c1"># convnet will be the same shape</span>
  <span class="c1"># as the original image, but with more features</span>
  <span class="n">fcnn_parameters</span> <span class="o">=</span> <span class="n">image_volume</span> <span class="o">*</span> <span class="n">fcnn_nodes</span>
  <span class="n">cnn_parameters</span> <span class="o">=</span> <span class="n">image_channels</span> <span class="o">*</span> <span class="n">filter_count</span> <span class="o">*</span> <span class="n">filter_width</span> <span class="o">**</span> <span class="mi">2</span>

  <span class="c1"># Add bias</span>
  <span class="n">fcnn_parameters</span> <span class="o">+=</span> <span class="n">fcnn_nodes</span>
  <span class="n">cnn_parameters</span> <span class="o">+=</span> <span class="n">filter_count</span>

  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"CNN parameters: </span><span class="si">{</span><span class="n">cnn_parameters</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Fully Connected parameters: </span><span class="si">{</span><span class="n">fcnn_parameters</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

  <span class="k">return</span> <span class="kc">None</span>


<span class="n">_</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">calculate_parameters</span><span class="p">,</span>
                     <span class="n">filter_count</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
                     <span class="n">image_width</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
                     <span class="n">fcnn_nodes</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "5aa7b4e55dea4b49a98564be0b7a0a3f"}</script></div>
</div>
</section>
<section id="id2">
<h3>Submit your feedback<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Check_your_results_Interactive_Demo"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "a8d21b66636c419496d09ace08659ff7"}</script></div>
</div>
</section>
</section>
</section>
<hr class="docutils"/>
<section class="tex2jax_ignore mathjax_ignore" id="section-2-the-history-of-convnets">
<h1>Section 2: The History of Convnets<a class="headerlink" href="#section-2-the-history-of-convnets" title="Permalink to this heading">#</a></h1>
<p><em>Time estimate: ~15mins</em></p>
<p>Convolutional neural networks have been around for a long time. <a class="reference external" href="https://www.rctn.org/bruno/public/papers/Fukushima1980.pdf">The first CNN model</a> was published in 1980, and was based on ideas in neuroscience that <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1359523/">predated it by decades</a>. Why is it then that <a class="reference external" href="https://proceedings.neurips.cc/paper/2012/hash/c399862d3b9d6b76c8436e924a68c45b-Abstract.html">AlexNet</a>, a CNN model published in 2012, is generally considered to mark the start of the deep learning revolution?</p>
<p>Watch the video below to get a better idea of the role that hardware and the internet have played in progressing deep learning.</p>
<section id="video-2-history-of-convnets">
<h2>Video 2: History of convnets<a class="headerlink" href="#video-2-history-of-convnets" title="Permalink to this heading">#</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "62f7ddfd09da41aea9751e0a694c3f4a"}</script></div>
</div>
</section>
<section id="id3">
<h2>Submit your feedback<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_History_of_convnets_Video"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "7500ba74b1b1483ba29b907cacf385b6"}</script></div>
</div>
</section>
<section id="think-2-challenges-of-improving-cnns">
<h2>Think! 2: Challenges of improving CNNs<a class="headerlink" href="#think-2-challenges-of-improving-cnns" title="Permalink to this heading">#</a></h2>
<p>As we shall see today, the story of deep learning and CNNs has been one of scaling networks: making them bigger and deeper.</p>
<p>Based on what you know so far from previous days, what challenges might researchers have faced when trying to scale up CNNs and applying them to different visual recognition tasks? Do you already have some ideas how these challenges might have been addressed?</p>
<p>Discuss this with your group for ~10 minutes.</p>
<p>(Hint: labeled data, compute and memory are all finite)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove explanation</span>

<span class="sd">"""</span>
<span class="sd">Challenge 1: limited data / overfitting. Limited amount of labeled data for many tasks beyond ImageNet.</span>
<span class="sd">Labels are expensive, for many tasks we don't have enough of them. --&gt; Large networks will overfit.</span>
<span class="sd">[Solution: transfer learning: adapt networks trained on ImageNet to other tasks]</span>

<span class="sd">Challenge 2: hardware limitations. Making networks bigger/deeper will increase</span>
<span class="sd">compute and memory requirements. --&gt; There are physical limits what can be done, and completed in reasonable time.</span>
<span class="sd">[Solution: more efficient architectures than standard convolutions]</span>

<span class="sd">Challenge 3: training deep networks "out-of-the-box" is unstable / training diverges</span>
<span class="sd">[Solution:.1 mechanisms like batch normalization and architectures like ResNets]</span>

<span class="sd">NOTE: Students cannot know any of the solutions to the problems from the material.</span>
<span class="sd">The intention of the question is to have them discuss and think about the</span>
<span class="sd">challenges (primarily the first two). The solutions are just provided for completeness for the tutors.</span>
<span class="sd">"""</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<section id="id4">
<h3>Submit your feedback<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Challenges_of_improving_CNNs_Discussion"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "c3758fb6e2d44b80b8b35956b3c590ea"}</script></div>
</div>
</section>
</section>
</section>
<hr class="docutils"/>
<section class="tex2jax_ignore mathjax_ignore" id="section-3-big-and-deep-convnets">
<h1>Section 3: Big and Deep Convnets<a class="headerlink" href="#section-3-big-and-deep-convnets" title="Permalink to this heading">#</a></h1>
<p><em>Time estimate: 18mins</em></p>
<section id="video-3-alexnet-vgg">
<h2>Video 3: AlexNet &amp; VGG<a class="headerlink" href="#video-3-alexnet-vgg" title="Permalink to this heading">#</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "a6334cf28d3345b98bbaf356af0d12f8"}</script></div>
</div>
</section>
<section id="id5">
<h2>Submit your feedback<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_AlexNet_and_VGG_Video"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "dcb264b19ef94be994a080163ad25e79"}</script></div>
</div>
</section>
<section id="section-3-1-introduction-to-alexnet">
<h2>Section 3.1: Introduction to AlexNet<a class="headerlink" href="#section-3-1-introduction-to-alexnet" title="Permalink to this heading">#</a></h2>
<p>AlexNet arguably marked the start of the current age of deep learning.
It incorporates a number of the defining characteristics of successful DL today: deep networks, GPU-powered paralellization, and building blocks encoding task-specific priors.
In this section you’ll have the opportunity to play with AlexNet and see the world through its eyes.</p>
<section id="import-alexnet">
<h3>Import Alexnet<a class="headerlink" href="#import-alexnet" title="Permalink to this heading">#</a></h3>
<p>This cell gives you the <code class="docutils literal notranslate"><span class="pre">alexnet</span></code> model as well as the <code class="docutils literal notranslate"><span class="pre">input_image</span></code> and <code class="docutils literal notranslate"><span class="pre">input_batch</span></code> variables used below</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Import Alexnet</span>
<span class="c1"># @markdown This cell gives you the `alexnet` model as well as the `input_image` and `input_batch` variables used below</span>
<span class="kn">import</span> <span class="nn">requests</span><span class="o">,</span> <span class="nn">urllib</span>

<span class="c1"># Original link: https://s3.amazonaws.com/pytorch/models/alexnet-owt-4df8aa71.pth</span>
<span class="n">state_dict</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">hub</span><span class="o">.</span><span class="n">load_state_dict_from_url</span><span class="p">(</span><span class="s2">"https://osf.io/9dzeu/download"</span><span class="p">)</span>

<span class="n">alexnet</span> <span class="o">=</span> <span class="n">AlexNet</span><span class="p">()</span>
<span class="n">alexnet</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">state_dict</span><span class="o">=</span><span class="n">state_dict</span><span class="p">)</span>

<span class="n">url</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W2D3_ModernConvnets/static/dog.jpg"</span><span class="p">,</span> <span class="s2">"dog.jpg"</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span> <span class="n">urllib</span><span class="o">.</span><span class="n">URLopener</span><span class="p">()</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

<span class="n">input_image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="n">preprocess</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span>
                                 <span class="n">transforms</span><span class="o">.</span><span class="n">Resize</span><span class="p">(</span><span class="mi">256</span><span class="p">),</span>
                                 <span class="n">transforms</span><span class="o">.</span><span class="n">CenterCrop</span><span class="p">(</span><span class="mi">224</span><span class="p">),</span>
                                 <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
                                 <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="p">[</span><span class="mf">0.485</span><span class="p">,</span> <span class="mf">0.456</span><span class="p">,</span> <span class="mf">0.406</span><span class="p">],</span>
                                                      <span class="n">std</span><span class="o">=</span><span class="p">[</span><span class="mf">0.229</span><span class="p">,</span> <span class="mf">0.224</span><span class="p">,</span> <span class="mf">0.225</span><span class="p">]),</span>
                                 <span class="p">])</span>
<span class="n">input_tensor</span> <span class="o">=</span> <span class="n">preprocess</span><span class="p">(</span><span class="n">input_image</span><span class="p">)</span>
<span class="n">input_batch</span> <span class="o">=</span> <span class="n">input_tensor</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Create a mini-batch as expected by the model</span>

<span class="c1"># Move the input and model to GPU for speed if available</span>
<span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
  <span class="n">input_batch</span> <span class="o">=</span> <span class="n">input_batch</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
  <span class="n">alexnet</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
</div>
</div>
</section>
</section>
<section id="section-3-2-what-does-alexnet-learn">
<h2>Section 3.2: What does AlexNet learn?<a class="headerlink" href="#section-3-2-what-does-alexnet-learn" title="Permalink to this heading">#</a></h2>
<p>This code visualizes the top-layer filters learned by AlexNet.
What do these filters remind you of?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
  <span class="n">params</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">alexnet</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
  <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
  <span class="n">filters</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">filter_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">row_index</span> <span class="o">=</span> <span class="n">filter_index</span> <span class="o">//</span> <span class="mi">8</span>
    <span class="n">col_index</span> <span class="o">=</span> <span class="n">filter_index</span> <span class="o">%</span> <span class="mi">8</span>

    <span class="nb">filter</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">filter_index</span><span class="p">,:,:,:]</span>
    <span class="n">filter_image</span> <span class="o">=</span> <span class="nb">filter</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">filter_image</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="n">scaled_image</span> <span class="o">=</span> <span class="n">filter_image</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">scale</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span>
    <span class="n">filters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scaled_image</span><span class="o">.</span><span class="n">cpu</span><span class="p">())</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">row_index</span><span class="p">,</span> <span class="n">col_index</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">scaled_image</span><span class="o">.</span><span class="n">cpu</span><span class="p">())</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">row_index</span><span class="p">,</span> <span class="n">col_index</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">'off'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/0a07902f46436405e52c9d8c36a95376bdbc22b67aea740da4a627196ae89b50.png" src="../../../_images/0a07902f46436405e52c9d8c36a95376bdbc22b67aea740da4a627196ae89b50.png">
</img></div>
</div>
<section id="think-3-2-1-filter-similarity">
<h3>Think! 3.2.1: Filter Similarity<a class="headerlink" href="#think-3-2-1-filter-similarity" title="Permalink to this heading">#</a></h3>
<p>What do these filters remind you of?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove explanation</span>
<span class="sd">"""</span>
<span class="sd">Some of the filters look like edge detectors,</span>
<span class="sd">as they are color insensitive and consist of vertical or horizontal patterns.</span>
<span class="sd">"""</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<section id="id6">
<h4>Submit your feedback<a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Filter_Similarity_Discussion"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "615f6ae11c3947088ed5053203a76183"}</script></div>
</div>
</section>
</section>
<section id="interactive-demo-3-2-what-does-alexnet-see">
<h3>Interactive Demo 3.2: What does AlexNet see?<a class="headerlink" href="#interactive-demo-3-2-what-does-alexnet-see" title="Permalink to this heading">#</a></h3>
<p>One way of visualizing CNNs is to look at the output of individual filters for a given image. Below is a widget that lets you examine the outputs of various filters used in AlexNet.</p>
<p>Run this cell to enable the widget</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Run this cell to enable the widget</span>

<span class="k">def</span> <span class="nf">alexnet_intermediate_output</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">image</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Function to extract AlexNet's intermediate output</span>

<span class="sd">    Args:</span>
<span class="sd">      net: nn.module</span>
<span class="sd">        AlexNet instance</span>
<span class="sd">      image: torch.tensor</span>
<span class="sd">        Input features</span>

<span class="sd">    Returns:</span>
<span class="sd">      ReLU output on processing features</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="n">image</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">browse_images</span><span class="p">(</span><span class="n">input_batch</span><span class="p">,</span> <span class="n">input_image</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Helper function to browse images</span>

<span class="sd">  Args:</span>
<span class="sd">    input_batch: torch.tensor</span>
<span class="sd">      Input batch</span>
<span class="sd">    input_image: torch.tensor</span>
<span class="sd">      Input features</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  """</span>
  <span class="n">intermediate_output</span> <span class="o">=</span> <span class="n">alexnet_intermediate_output</span><span class="p">(</span><span class="n">alexnet</span><span class="p">,</span> <span class="n">input_batch</span><span class="p">)</span>
  <span class="n">n</span> <span class="o">=</span> <span class="n">intermediate_output</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

  <span class="k">def</span> <span class="nf">view_image</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Function to view incoming image frame</span>

<span class="sd">    Args:</span>
<span class="sd">      i: int</span>
<span class="sd">        Iteration</span>

<span class="sd">    Returns:</span>
<span class="sd">      Nothing</span>
<span class="sd">    """</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
      <span class="n">channel</span> <span class="o">=</span> <span class="n">intermediate_output</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
      <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
      <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">input_image</span><span class="p">)</span>
      <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">filters</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
      <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">22</span><span class="p">,</span> <span class="mi">33</span><span class="p">])</span>
      <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">channel</span><span class="o">.</span><span class="n">cpu</span><span class="p">())</span>
      <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Input image'</span><span class="p">)</span>
      <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Filter </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
      <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Filter </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> on input image"</span><span class="p">)</span>
      <span class="p">[</span><span class="n">axi</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span> <span class="k">for</span> <span class="n">axi</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">ravel</span><span class="p">()]</span>

  <span class="n">widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">view_image</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>


<span class="n">browse_images</span><span class="p">(</span><span class="n">input_batch</span><span class="p">,</span> <span class="n">input_image</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "3da59089a1d24f7b831be0ec43bc74bc"}</script></div>
</div>
<section id="id7">
<h4>Submit your feedback<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_What_does_AlexNet_see_Interactive_Demo"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "de286786b8604a6a9a5173524cf7b4d8"}</script></div>
</div>
</section>
</section>
<section id="think-3-2-2-filter-purpose">
<h3>Think! 3.2.2 Filter Purpose<a class="headerlink" href="#think-3-2-2-filter-purpose" title="Permalink to this heading">#</a></h3>
<p>What do these filters appear to be doing? Note that different filters play different roles so there are several good answers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove explanation</span>

<span class="sd">"""</span>
<span class="sd">Based on the areas that are highlighted in the outupt, some filters seem to be</span>
<span class="sd">detecting edges, while others seem to react to the white color of the dog or</span>
<span class="sd">the green of the background.</span>
<span class="sd">"""</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<section id="id8">
<h4>Submit your feedback<a class="headerlink" href="#id8" title="Permalink to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Filter_Purpose_Discussion"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "bdd5aac2e79b4978b66467ee05f1f3f2"}</script></div>
</div>
</section>
</section>
</section>
<section id="further-reading">
<h2>Further Reading<a class="headerlink" href="#further-reading" title="Permalink to this heading">#</a></h2>
<p>If the question “what are neural network filters looking for” is at all interesting to you, or if you like geometric art, you’ll enjoy <a class="reference external" href="https://distill.pub/2017/feature-visualization/">this post</a> creating images that maximize output of various CNN neurons. There is also a good article showing what the space of images looks like as models train <a class="reference external" href="https://distill.pub/2020/grand-tour/">here</a>.</p>
</section>
</section>
<hr class="docutils"/>
<section class="tex2jax_ignore mathjax_ignore" id="section-4-convnets-after-alexnet">
<h1>Section 4: Convnets After AlexNet<a class="headerlink" href="#section-4-convnets-after-alexnet" title="Permalink to this heading">#</a></h1>
<p><em>Time estimate: ~25mins</em></p>
<section id="video-4-residual-networks-resnets">
<h2>Video 4: Residual Networks (ResNets)<a class="headerlink" href="#video-4-residual-networks-resnets" title="Permalink to this heading">#</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "24e725667dae42dab49b53437ce6481d"}</script></div>
</div>
</section>
<section id="id9">
<h2>Submit your feedback<a class="headerlink" href="#id9" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Residual_Networks_ResNets_Video"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "0335678050f249aa90881dc1d0ca8109"}</script></div>
</div>
<p>In this section we’ll be working with a state of the art CNN model called <a class="reference external" href="https://arxiv.org/abs/1512.03385">ResNet</a>. ResNet has two particularly interesting features. First, it uses skip connections to avoid the vanishing gradient problem. Second, each block (collection of layers) in a ResNet can be treated as learning a residual function.</p>
<p>Mathematically, a neural network can be thought of as a series of operations that maps an input (like an image of a dog) to an output (like the label “dog”). In math-speak a mapping from an input to an output is called a function. Neural networks are a flexible way of expressing that function.</p>
<p>If you were to subtract out the true function mapping images to class labels from the function learned by a network, you’d be left with the residual error or “residual function”. ResNets try to learn the original function, then the residual function, then the residual of the residual, and so on, using their residual blocks and adding them to the output of the preceeding layers.</p>
<p>In this section we’ll run several images through a pre-trained ResNet and see what happens.</p>
</section>
<section id="download-imagenette">
<h2>Download imagenette<a class="headerlink" href="#download-imagenette" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Download imagenette</span>
<span class="kn">import</span> <span class="nn">requests</span><span class="o">,</span> <span class="nn">tarfile</span><span class="o">,</span> <span class="nn">os</span>

<span class="n">fname</span> <span class="o">=</span> <span class="s1">'imagenette2-320'</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">'https://osf.io/mnve4/download'</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"Data is being downloaded..."</span><span class="p">)</span>
  <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="o">+</span><span class="s1">'tgz'</span><span class="p">,</span> <span class="s1">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
    <span class="n">fd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

  <span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fname</span><span class="o">+</span><span class="s1">'tgz'</span><span class="p">,</span> <span class="s2">"r"</span><span class="p">)</span> <span class="k">as</span> <span class="n">ft</span><span class="p">:</span>
    <span class="n">ft</span><span class="o">.</span><span class="n">extractall</span><span class="p">()</span>

  <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">fname</span><span class="o">+</span><span class="s1">'tgz'</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"The download has been completed."</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"Data has already been downloaded."</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data is being downloaded...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The download has been completed.
</pre></div>
</div>
</div>
</div>
</section>
<section id="set-up-textual-imagenet-labels">
<h2>Set Up Textual ImageNet labels<a class="headerlink" href="#set-up-textual-imagenet-labels" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Set Up Textual ImageNet labels</span>
<span class="n">dict_map</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">'tench, Tinca tinca'</span><span class="p">,</span>
 <span class="mi">1</span><span class="p">:</span> <span class="s1">'goldfish, Carassius auratus'</span><span class="p">,</span>
 <span class="mi">2</span><span class="p">:</span> <span class="s1">'great white shark, white shark, man-eater, man-eating shark, Carcharodon carcharias'</span><span class="p">,</span>
 <span class="mi">3</span><span class="p">:</span> <span class="s1">'tiger shark, Galeocerdo cuvieri'</span><span class="p">,</span>
 <span class="mi">4</span><span class="p">:</span> <span class="s1">'hammerhead, hammerhead shark'</span><span class="p">,</span>
 <span class="mi">5</span><span class="p">:</span> <span class="s1">'electric ray, crampfish, numbfish, torpedo'</span><span class="p">,</span>
 <span class="mi">6</span><span class="p">:</span> <span class="s1">'stingray'</span><span class="p">,</span>
 <span class="mi">7</span><span class="p">:</span> <span class="s1">'cock'</span><span class="p">,</span>
 <span class="mi">8</span><span class="p">:</span> <span class="s1">'hen'</span><span class="p">,</span>
 <span class="mi">9</span><span class="p">:</span> <span class="s1">'ostrich, Struthio camelus'</span><span class="p">,</span>
 <span class="mi">10</span><span class="p">:</span> <span class="s1">'brambling, Fringilla montifringilla'</span><span class="p">,</span>
 <span class="mi">11</span><span class="p">:</span> <span class="s1">'goldfinch, Carduelis carduelis'</span><span class="p">,</span>
 <span class="mi">12</span><span class="p">:</span> <span class="s1">'house finch, linnet, Carpodacus mexicanus'</span><span class="p">,</span>
 <span class="mi">13</span><span class="p">:</span> <span class="s1">'junco, snowbird'</span><span class="p">,</span>
 <span class="mi">14</span><span class="p">:</span> <span class="s1">'indigo bunting, indigo finch, indigo bird, Passerina cyanea'</span><span class="p">,</span>
 <span class="mi">15</span><span class="p">:</span> <span class="s1">'robin, American robin, Turdus migratorius'</span><span class="p">,</span>
 <span class="mi">16</span><span class="p">:</span> <span class="s1">'bulbul'</span><span class="p">,</span>
 <span class="mi">17</span><span class="p">:</span> <span class="s1">'jay'</span><span class="p">,</span>
 <span class="mi">18</span><span class="p">:</span> <span class="s1">'magpie'</span><span class="p">,</span>
 <span class="mi">19</span><span class="p">:</span> <span class="s1">'chickadee'</span><span class="p">,</span>
 <span class="mi">20</span><span class="p">:</span> <span class="s1">'water ouzel, dipper'</span><span class="p">,</span>
 <span class="mi">21</span><span class="p">:</span> <span class="s1">'kite'</span><span class="p">,</span>
 <span class="mi">22</span><span class="p">:</span> <span class="s1">'bald eagle, American eagle, Haliaeetus leucocephalus'</span><span class="p">,</span>
 <span class="mi">23</span><span class="p">:</span> <span class="s1">'vulture'</span><span class="p">,</span>
 <span class="mi">24</span><span class="p">:</span> <span class="s1">'great grey owl, great gray owl, Strix nebulosa'</span><span class="p">,</span>
 <span class="mi">25</span><span class="p">:</span> <span class="s1">'European fire salamander, Salamandra salamandra'</span><span class="p">,</span>
 <span class="mi">26</span><span class="p">:</span> <span class="s1">'common newt, Triturus vulgaris'</span><span class="p">,</span>
 <span class="mi">27</span><span class="p">:</span> <span class="s1">'eft'</span><span class="p">,</span>
 <span class="mi">28</span><span class="p">:</span> <span class="s1">'spotted salamander, Ambystoma maculatum'</span><span class="p">,</span>
 <span class="mi">29</span><span class="p">:</span> <span class="s1">'axolotl, mud puppy, Ambystoma mexicanum'</span><span class="p">,</span>
 <span class="mi">30</span><span class="p">:</span> <span class="s1">'bullfrog, Rana catesbeiana'</span><span class="p">,</span>
 <span class="mi">31</span><span class="p">:</span> <span class="s1">'tree frog, tree-frog'</span><span class="p">,</span>
 <span class="mi">32</span><span class="p">:</span> <span class="s1">'tailed frog, bell toad, ribbed toad, tailed toad, Ascaphus trui'</span><span class="p">,</span>
 <span class="mi">33</span><span class="p">:</span> <span class="s1">'loggerhead, loggerhead turtle, Caretta caretta'</span><span class="p">,</span>
 <span class="mi">34</span><span class="p">:</span> <span class="s1">'leatherback turtle, leatherback, leathery turtle, Dermochelys coriacea'</span><span class="p">,</span>
 <span class="mi">35</span><span class="p">:</span> <span class="s1">'mud turtle'</span><span class="p">,</span>
 <span class="mi">36</span><span class="p">:</span> <span class="s1">'terrapin'</span><span class="p">,</span>
 <span class="mi">37</span><span class="p">:</span> <span class="s1">'box turtle, box tortoise'</span><span class="p">,</span>
 <span class="mi">38</span><span class="p">:</span> <span class="s1">'banded gecko'</span><span class="p">,</span>
 <span class="mi">39</span><span class="p">:</span> <span class="s1">'common iguana, iguana, Iguana iguana'</span><span class="p">,</span>
 <span class="mi">40</span><span class="p">:</span> <span class="s1">'American chameleon, anole, Anolis carolinensis'</span><span class="p">,</span>
 <span class="mi">41</span><span class="p">:</span> <span class="s1">'whiptail, whiptail lizard'</span><span class="p">,</span>
 <span class="mi">42</span><span class="p">:</span> <span class="s1">'agama'</span><span class="p">,</span>
 <span class="mi">43</span><span class="p">:</span> <span class="s1">'frilled lizard, Chlamydosaurus kingi'</span><span class="p">,</span>
 <span class="mi">44</span><span class="p">:</span> <span class="s1">'alligator lizard'</span><span class="p">,</span>
 <span class="mi">45</span><span class="p">:</span> <span class="s1">'Gila monster, Heloderma suspectum'</span><span class="p">,</span>
 <span class="mi">46</span><span class="p">:</span> <span class="s1">'green lizard, Lacerta viridis'</span><span class="p">,</span>
 <span class="mi">47</span><span class="p">:</span> <span class="s1">'African chameleon, Chamaeleo chamaeleon'</span><span class="p">,</span>
 <span class="mi">48</span><span class="p">:</span> <span class="s1">'Komodo dragon, Komodo lizard, dragon lizard, giant lizard, Varanus komodoensis'</span><span class="p">,</span>
 <span class="mi">49</span><span class="p">:</span> <span class="s1">'African crocodile, Nile crocodile, Crocodylus niloticus'</span><span class="p">,</span>
 <span class="mi">50</span><span class="p">:</span> <span class="s1">'American alligator, Alligator mississipiensis'</span><span class="p">,</span>
 <span class="mi">51</span><span class="p">:</span> <span class="s1">'triceratops'</span><span class="p">,</span>
 <span class="mi">52</span><span class="p">:</span> <span class="s1">'thunder snake, worm snake, Carphophis amoenus'</span><span class="p">,</span>
 <span class="mi">53</span><span class="p">:</span> <span class="s1">'ringneck snake, ring-necked snake, ring snake'</span><span class="p">,</span>
 <span class="mi">54</span><span class="p">:</span> <span class="s1">'hognose snake, puff adder, sand viper'</span><span class="p">,</span>
 <span class="mi">55</span><span class="p">:</span> <span class="s1">'green snake, grass snake'</span><span class="p">,</span>
 <span class="mi">56</span><span class="p">:</span> <span class="s1">'king snake, kingsnake'</span><span class="p">,</span>
 <span class="mi">57</span><span class="p">:</span> <span class="s1">'garter snake, grass snake'</span><span class="p">,</span>
 <span class="mi">58</span><span class="p">:</span> <span class="s1">'water snake'</span><span class="p">,</span>
 <span class="mi">59</span><span class="p">:</span> <span class="s1">'vine snake'</span><span class="p">,</span>
 <span class="mi">60</span><span class="p">:</span> <span class="s1">'night snake, Hypsiglena torquata'</span><span class="p">,</span>
 <span class="mi">61</span><span class="p">:</span> <span class="s1">'boa constrictor, Constrictor constrictor'</span><span class="p">,</span>
 <span class="mi">62</span><span class="p">:</span> <span class="s1">'rock python, rock snake, Python sebae'</span><span class="p">,</span>
 <span class="mi">63</span><span class="p">:</span> <span class="s1">'Indian cobra, Naja naja'</span><span class="p">,</span>
 <span class="mi">64</span><span class="p">:</span> <span class="s1">'green mamba'</span><span class="p">,</span>
 <span class="mi">65</span><span class="p">:</span> <span class="s1">'sea snake'</span><span class="p">,</span>
 <span class="mi">66</span><span class="p">:</span> <span class="s1">'horned viper, cerastes, sand viper, horned asp, Cerastes cornutus'</span><span class="p">,</span>
 <span class="mi">67</span><span class="p">:</span> <span class="s1">'diamondback, diamondback rattlesnake, Crotalus adamanteus'</span><span class="p">,</span>
 <span class="mi">68</span><span class="p">:</span> <span class="s1">'sidewinder, horned rattlesnake, Crotalus cerastes'</span><span class="p">,</span>
 <span class="mi">69</span><span class="p">:</span> <span class="s1">'trilobite'</span><span class="p">,</span>
 <span class="mi">70</span><span class="p">:</span> <span class="s1">'harvestman, daddy longlegs, Phalangium opilio'</span><span class="p">,</span>
 <span class="mi">71</span><span class="p">:</span> <span class="s1">'scorpion'</span><span class="p">,</span>
 <span class="mi">72</span><span class="p">:</span> <span class="s1">'black and gold garden spider, Argiope aurantia'</span><span class="p">,</span>
 <span class="mi">73</span><span class="p">:</span> <span class="s1">'barn spider, Araneus cavaticus'</span><span class="p">,</span>
 <span class="mi">74</span><span class="p">:</span> <span class="s1">'garden spider, Aranea diademata'</span><span class="p">,</span>
 <span class="mi">75</span><span class="p">:</span> <span class="s1">'black widow, Latrodectus mactans'</span><span class="p">,</span>
 <span class="mi">76</span><span class="p">:</span> <span class="s1">'tarantula'</span><span class="p">,</span>
 <span class="mi">77</span><span class="p">:</span> <span class="s1">'wolf spider, hunting spider'</span><span class="p">,</span>
 <span class="mi">78</span><span class="p">:</span> <span class="s1">'tick'</span><span class="p">,</span>
 <span class="mi">79</span><span class="p">:</span> <span class="s1">'centipede'</span><span class="p">,</span>
 <span class="mi">80</span><span class="p">:</span> <span class="s1">'black grouse'</span><span class="p">,</span>
 <span class="mi">81</span><span class="p">:</span> <span class="s1">'ptarmigan'</span><span class="p">,</span>
 <span class="mi">82</span><span class="p">:</span> <span class="s1">'ruffed grouse, partridge, Bonasa umbellus'</span><span class="p">,</span>
 <span class="mi">83</span><span class="p">:</span> <span class="s1">'prairie chicken, prairie grouse, prairie fowl'</span><span class="p">,</span>
 <span class="mi">84</span><span class="p">:</span> <span class="s1">'peacock'</span><span class="p">,</span>
 <span class="mi">85</span><span class="p">:</span> <span class="s1">'quail'</span><span class="p">,</span>
 <span class="mi">86</span><span class="p">:</span> <span class="s1">'partridge'</span><span class="p">,</span>
 <span class="mi">87</span><span class="p">:</span> <span class="s1">'African grey, African gray, Psittacus erithacus'</span><span class="p">,</span>
 <span class="mi">88</span><span class="p">:</span> <span class="s1">'macaw'</span><span class="p">,</span>
 <span class="mi">89</span><span class="p">:</span> <span class="s1">'sulphur-crested cockatoo, Kakatoe galerita, Cacatua galerita'</span><span class="p">,</span>
 <span class="mi">90</span><span class="p">:</span> <span class="s1">'lorikeet'</span><span class="p">,</span>
 <span class="mi">91</span><span class="p">:</span> <span class="s1">'coucal'</span><span class="p">,</span>
 <span class="mi">92</span><span class="p">:</span> <span class="s1">'bee eater'</span><span class="p">,</span>
 <span class="mi">93</span><span class="p">:</span> <span class="s1">'hornbill'</span><span class="p">,</span>
 <span class="mi">94</span><span class="p">:</span> <span class="s1">'hummingbird'</span><span class="p">,</span>
 <span class="mi">95</span><span class="p">:</span> <span class="s1">'jacamar'</span><span class="p">,</span>
 <span class="mi">96</span><span class="p">:</span> <span class="s1">'toucan'</span><span class="p">,</span>
 <span class="mi">97</span><span class="p">:</span> <span class="s1">'drake'</span><span class="p">,</span>
 <span class="mi">98</span><span class="p">:</span> <span class="s1">'red-breasted merganser, Mergus serrator'</span><span class="p">,</span>
 <span class="mi">99</span><span class="p">:</span> <span class="s1">'goose'</span><span class="p">,</span>
 <span class="mi">100</span><span class="p">:</span> <span class="s1">'black swan, Cygnus atratus'</span><span class="p">,</span>
 <span class="mi">101</span><span class="p">:</span> <span class="s1">'tusker'</span><span class="p">,</span>
 <span class="mi">102</span><span class="p">:</span> <span class="s1">'echidna, spiny anteater, anteater'</span><span class="p">,</span>
 <span class="mi">103</span><span class="p">:</span> <span class="s1">'platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus'</span><span class="p">,</span>
 <span class="mi">104</span><span class="p">:</span> <span class="s1">'wallaby, brush kangaroo'</span><span class="p">,</span>
 <span class="mi">105</span><span class="p">:</span> <span class="s1">'koala, koala bear, kangaroo bear, native bear, Phascolarctos cinereus'</span><span class="p">,</span>
 <span class="mi">106</span><span class="p">:</span> <span class="s1">'wombat'</span><span class="p">,</span>
 <span class="mi">107</span><span class="p">:</span> <span class="s1">'jellyfish'</span><span class="p">,</span>
 <span class="mi">108</span><span class="p">:</span> <span class="s1">'sea anemone, anemone'</span><span class="p">,</span>
 <span class="mi">109</span><span class="p">:</span> <span class="s1">'brain coral'</span><span class="p">,</span>
 <span class="mi">110</span><span class="p">:</span> <span class="s1">'flatworm, platyhelminth'</span><span class="p">,</span>
 <span class="mi">111</span><span class="p">:</span> <span class="s1">'nematode, nematode worm, roundworm'</span><span class="p">,</span>
 <span class="mi">112</span><span class="p">:</span> <span class="s1">'conch'</span><span class="p">,</span>
 <span class="mi">113</span><span class="p">:</span> <span class="s1">'snail'</span><span class="p">,</span>
 <span class="mi">114</span><span class="p">:</span> <span class="s1">'slug'</span><span class="p">,</span>
 <span class="mi">115</span><span class="p">:</span> <span class="s1">'sea slug, nudibranch'</span><span class="p">,</span>
 <span class="mi">116</span><span class="p">:</span> <span class="s1">'chiton, coat-of-mail shell, sea cradle, polyplacophore'</span><span class="p">,</span>
 <span class="mi">117</span><span class="p">:</span> <span class="s1">'chambered nautilus, pearly nautilus, nautilus'</span><span class="p">,</span>
 <span class="mi">118</span><span class="p">:</span> <span class="s1">'Dungeness crab, Cancer magister'</span><span class="p">,</span>
 <span class="mi">119</span><span class="p">:</span> <span class="s1">'rock crab, Cancer irroratus'</span><span class="p">,</span>
 <span class="mi">120</span><span class="p">:</span> <span class="s1">'fiddler crab'</span><span class="p">,</span>
 <span class="mi">121</span><span class="p">:</span> <span class="s1">'king crab, Alaska crab, Alaskan king crab, Alaska king crab, Paralithodes camtschatica'</span><span class="p">,</span>
 <span class="mi">122</span><span class="p">:</span> <span class="s1">'American lobster, Northern lobster, Maine lobster, Homarus americanus'</span><span class="p">,</span>
 <span class="mi">123</span><span class="p">:</span> <span class="s1">'spiny lobster, langouste, rock lobster, crawfish, crayfish, sea crawfish'</span><span class="p">,</span>
 <span class="mi">124</span><span class="p">:</span> <span class="s1">'crayfish, crawfish, crawdad, crawdaddy'</span><span class="p">,</span>
 <span class="mi">125</span><span class="p">:</span> <span class="s1">'hermit crab'</span><span class="p">,</span>
 <span class="mi">126</span><span class="p">:</span> <span class="s1">'isopod'</span><span class="p">,</span>
 <span class="mi">127</span><span class="p">:</span> <span class="s1">'white stork, Ciconia ciconia'</span><span class="p">,</span>
 <span class="mi">128</span><span class="p">:</span> <span class="s1">'black stork, Ciconia nigra'</span><span class="p">,</span>
 <span class="mi">129</span><span class="p">:</span> <span class="s1">'spoonbill'</span><span class="p">,</span>
 <span class="mi">130</span><span class="p">:</span> <span class="s1">'flamingo'</span><span class="p">,</span>
 <span class="mi">131</span><span class="p">:</span> <span class="s1">'little blue heron, Egretta caerulea'</span><span class="p">,</span>
 <span class="mi">132</span><span class="p">:</span> <span class="s1">'American egret, great white heron, Egretta albus'</span><span class="p">,</span>
 <span class="mi">133</span><span class="p">:</span> <span class="s1">'bittern'</span><span class="p">,</span>
 <span class="mi">134</span><span class="p">:</span> <span class="s1">'crane'</span><span class="p">,</span>
 <span class="mi">135</span><span class="p">:</span> <span class="s1">'limpkin, Aramus pictus'</span><span class="p">,</span>
 <span class="mi">136</span><span class="p">:</span> <span class="s1">'European gallinule, Porphyrio porphyrio'</span><span class="p">,</span>
 <span class="mi">137</span><span class="p">:</span> <span class="s1">'American coot, marsh hen, mud hen, water hen, Fulica americana'</span><span class="p">,</span>
 <span class="mi">138</span><span class="p">:</span> <span class="s1">'bustard'</span><span class="p">,</span>
 <span class="mi">139</span><span class="p">:</span> <span class="s1">'ruddy turnstone, Arenaria interpres'</span><span class="p">,</span>
 <span class="mi">140</span><span class="p">:</span> <span class="s1">'red-backed sandpiper, dunlin, Erolia alpina'</span><span class="p">,</span>
 <span class="mi">141</span><span class="p">:</span> <span class="s1">'redshank, Tringa totanus'</span><span class="p">,</span>
 <span class="mi">142</span><span class="p">:</span> <span class="s1">'dowitcher'</span><span class="p">,</span>
 <span class="mi">143</span><span class="p">:</span> <span class="s1">'oystercatcher, oyster catcher'</span><span class="p">,</span>
 <span class="mi">144</span><span class="p">:</span> <span class="s1">'pelican'</span><span class="p">,</span>
 <span class="mi">145</span><span class="p">:</span> <span class="s1">'king penguin, Aptenodytes patagonica'</span><span class="p">,</span>
 <span class="mi">146</span><span class="p">:</span> <span class="s1">'albatross, mollymawk'</span><span class="p">,</span>
 <span class="mi">147</span><span class="p">:</span> <span class="s1">'grey whale, gray whale, devilfish, Eschrichtius gibbosus, Eschrichtius robustus'</span><span class="p">,</span>
 <span class="mi">148</span><span class="p">:</span> <span class="s1">'killer whale, killer, orca, grampus, sea wolf, Orcinus orca'</span><span class="p">,</span>
 <span class="mi">149</span><span class="p">:</span> <span class="s1">'dugong, Dugong dugon'</span><span class="p">,</span>
 <span class="mi">150</span><span class="p">:</span> <span class="s1">'sea lion'</span><span class="p">,</span>
 <span class="mi">151</span><span class="p">:</span> <span class="s1">'Chihuahua'</span><span class="p">,</span>
 <span class="mi">152</span><span class="p">:</span> <span class="s1">'Japanese spaniel'</span><span class="p">,</span>
 <span class="mi">153</span><span class="p">:</span> <span class="s1">'Maltese dog, Maltese terrier, Maltese'</span><span class="p">,</span>
 <span class="mi">154</span><span class="p">:</span> <span class="s1">'Pekinese, Pekingese, Peke'</span><span class="p">,</span>
 <span class="mi">155</span><span class="p">:</span> <span class="s1">'Shih-Tzu'</span><span class="p">,</span>
 <span class="mi">156</span><span class="p">:</span> <span class="s1">'Blenheim spaniel'</span><span class="p">,</span>
 <span class="mi">157</span><span class="p">:</span> <span class="s1">'papillon'</span><span class="p">,</span>
 <span class="mi">158</span><span class="p">:</span> <span class="s1">'toy terrier'</span><span class="p">,</span>
 <span class="mi">159</span><span class="p">:</span> <span class="s1">'Rhodesian ridgeback'</span><span class="p">,</span>
 <span class="mi">160</span><span class="p">:</span> <span class="s1">'Afghan hound, Afghan'</span><span class="p">,</span>
 <span class="mi">161</span><span class="p">:</span> <span class="s1">'basset, basset hound'</span><span class="p">,</span>
 <span class="mi">162</span><span class="p">:</span> <span class="s1">'beagle'</span><span class="p">,</span>
 <span class="mi">163</span><span class="p">:</span> <span class="s1">'bloodhound, sleuthhound'</span><span class="p">,</span>
 <span class="mi">164</span><span class="p">:</span> <span class="s1">'bluetick'</span><span class="p">,</span>
 <span class="mi">165</span><span class="p">:</span> <span class="s1">'black-and-tan coonhound'</span><span class="p">,</span>
 <span class="mi">166</span><span class="p">:</span> <span class="s1">'Walker hound, Walker foxhound'</span><span class="p">,</span>
 <span class="mi">167</span><span class="p">:</span> <span class="s1">'English foxhound'</span><span class="p">,</span>
 <span class="mi">168</span><span class="p">:</span> <span class="s1">'redbone'</span><span class="p">,</span>
 <span class="mi">169</span><span class="p">:</span> <span class="s1">'borzoi, Russian wolfhound'</span><span class="p">,</span>
 <span class="mi">170</span><span class="p">:</span> <span class="s1">'Irish wolfhound'</span><span class="p">,</span>
 <span class="mi">171</span><span class="p">:</span> <span class="s1">'Italian greyhound'</span><span class="p">,</span>
 <span class="mi">172</span><span class="p">:</span> <span class="s1">'whippet'</span><span class="p">,</span>
 <span class="mi">173</span><span class="p">:</span> <span class="s1">'Ibizan hound, Ibizan Podenco'</span><span class="p">,</span>
 <span class="mi">174</span><span class="p">:</span> <span class="s1">'Norwegian elkhound, elkhound'</span><span class="p">,</span>
 <span class="mi">175</span><span class="p">:</span> <span class="s1">'otterhound, otter hound'</span><span class="p">,</span>
 <span class="mi">176</span><span class="p">:</span> <span class="s1">'Saluki, gazelle hound'</span><span class="p">,</span>
 <span class="mi">177</span><span class="p">:</span> <span class="s1">'Scottish deerhound, deerhound'</span><span class="p">,</span>
 <span class="mi">178</span><span class="p">:</span> <span class="s1">'Weimaraner'</span><span class="p">,</span>
 <span class="mi">179</span><span class="p">:</span> <span class="s1">'Staffordshire bullterrier, Staffordshire bull terrier'</span><span class="p">,</span>
 <span class="mi">180</span><span class="p">:</span> <span class="s1">'American Staffordshire terrier, Staffordshire terrier, American pit bull terrier, pit bull terrier'</span><span class="p">,</span>
 <span class="mi">181</span><span class="p">:</span> <span class="s1">'Bedlington terrier'</span><span class="p">,</span>
 <span class="mi">182</span><span class="p">:</span> <span class="s1">'Border terrier'</span><span class="p">,</span>
 <span class="mi">183</span><span class="p">:</span> <span class="s1">'Kerry blue terrier'</span><span class="p">,</span>
 <span class="mi">184</span><span class="p">:</span> <span class="s1">'Irish terrier'</span><span class="p">,</span>
 <span class="mi">185</span><span class="p">:</span> <span class="s1">'Norfolk terrier'</span><span class="p">,</span>
 <span class="mi">186</span><span class="p">:</span> <span class="s1">'Norwich terrier'</span><span class="p">,</span>
 <span class="mi">187</span><span class="p">:</span> <span class="s1">'Yorkshire terrier'</span><span class="p">,</span>
 <span class="mi">188</span><span class="p">:</span> <span class="s1">'wire-haired fox terrier'</span><span class="p">,</span>
 <span class="mi">189</span><span class="p">:</span> <span class="s1">'Lakeland terrier'</span><span class="p">,</span>
 <span class="mi">190</span><span class="p">:</span> <span class="s1">'Sealyham terrier, Sealyham'</span><span class="p">,</span>
 <span class="mi">191</span><span class="p">:</span> <span class="s1">'Airedale, Airedale terrier'</span><span class="p">,</span>
 <span class="mi">192</span><span class="p">:</span> <span class="s1">'cairn, cairn terrier'</span><span class="p">,</span>
 <span class="mi">193</span><span class="p">:</span> <span class="s1">'Australian terrier'</span><span class="p">,</span>
 <span class="mi">194</span><span class="p">:</span> <span class="s1">'Dandie Dinmont, Dandie Dinmont terrier'</span><span class="p">,</span>
 <span class="mi">195</span><span class="p">:</span> <span class="s1">'Boston bull, Boston terrier'</span><span class="p">,</span>
 <span class="mi">196</span><span class="p">:</span> <span class="s1">'miniature schnauzer'</span><span class="p">,</span>
 <span class="mi">197</span><span class="p">:</span> <span class="s1">'giant schnauzer'</span><span class="p">,</span>
 <span class="mi">198</span><span class="p">:</span> <span class="s1">'standard schnauzer'</span><span class="p">,</span>
 <span class="mi">199</span><span class="p">:</span> <span class="s1">'Scotch terrier, Scottish terrier, Scottie'</span><span class="p">,</span>
 <span class="mi">200</span><span class="p">:</span> <span class="s1">'Tibetan terrier, chrysanthemum dog'</span><span class="p">,</span>
 <span class="mi">201</span><span class="p">:</span> <span class="s1">'silky terrier, Sydney silky'</span><span class="p">,</span>
 <span class="mi">202</span><span class="p">:</span> <span class="s1">'soft-coated wheaten terrier'</span><span class="p">,</span>
 <span class="mi">203</span><span class="p">:</span> <span class="s1">'West Highland white terrier'</span><span class="p">,</span>
 <span class="mi">204</span><span class="p">:</span> <span class="s1">'Lhasa, Lhasa apso'</span><span class="p">,</span>
 <span class="mi">205</span><span class="p">:</span> <span class="s1">'flat-coated retriever'</span><span class="p">,</span>
 <span class="mi">206</span><span class="p">:</span> <span class="s1">'curly-coated retriever'</span><span class="p">,</span>
 <span class="mi">207</span><span class="p">:</span> <span class="s1">'golden retriever'</span><span class="p">,</span>
 <span class="mi">208</span><span class="p">:</span> <span class="s1">'Labrador retriever'</span><span class="p">,</span>
 <span class="mi">209</span><span class="p">:</span> <span class="s1">'Chesapeake Bay retriever'</span><span class="p">,</span>
 <span class="mi">210</span><span class="p">:</span> <span class="s1">'German short-haired pointer'</span><span class="p">,</span>
 <span class="mi">211</span><span class="p">:</span> <span class="s1">'vizsla, Hungarian pointer'</span><span class="p">,</span>
 <span class="mi">212</span><span class="p">:</span> <span class="s1">'English setter'</span><span class="p">,</span>
 <span class="mi">213</span><span class="p">:</span> <span class="s1">'Irish setter, red setter'</span><span class="p">,</span>
 <span class="mi">214</span><span class="p">:</span> <span class="s1">'Gordon setter'</span><span class="p">,</span>
 <span class="mi">215</span><span class="p">:</span> <span class="s1">'Brittany spaniel'</span><span class="p">,</span>
 <span class="mi">216</span><span class="p">:</span> <span class="s1">'clumber, clumber spaniel'</span><span class="p">,</span>
 <span class="mi">217</span><span class="p">:</span> <span class="s1">'English springer, English springer spaniel'</span><span class="p">,</span>
 <span class="mi">218</span><span class="p">:</span> <span class="s1">'Welsh springer spaniel'</span><span class="p">,</span>
 <span class="mi">219</span><span class="p">:</span> <span class="s1">'cocker spaniel, English cocker spaniel, cocker'</span><span class="p">,</span>
 <span class="mi">220</span><span class="p">:</span> <span class="s1">'Sussex spaniel'</span><span class="p">,</span>
 <span class="mi">221</span><span class="p">:</span> <span class="s1">'Irish water spaniel'</span><span class="p">,</span>
 <span class="mi">222</span><span class="p">:</span> <span class="s1">'kuvasz'</span><span class="p">,</span>
 <span class="mi">223</span><span class="p">:</span> <span class="s1">'schipperke'</span><span class="p">,</span>
 <span class="mi">224</span><span class="p">:</span> <span class="s1">'groenendael'</span><span class="p">,</span>
 <span class="mi">225</span><span class="p">:</span> <span class="s1">'malinois'</span><span class="p">,</span>
 <span class="mi">226</span><span class="p">:</span> <span class="s1">'briard'</span><span class="p">,</span>
 <span class="mi">227</span><span class="p">:</span> <span class="s1">'kelpie'</span><span class="p">,</span>
 <span class="mi">228</span><span class="p">:</span> <span class="s1">'komondor'</span><span class="p">,</span>
 <span class="mi">229</span><span class="p">:</span> <span class="s1">'Old English sheepdog, bobtail'</span><span class="p">,</span>
 <span class="mi">230</span><span class="p">:</span> <span class="s1">'Shetland sheepdog, Shetland sheep dog, Shetland'</span><span class="p">,</span>
 <span class="mi">231</span><span class="p">:</span> <span class="s1">'collie'</span><span class="p">,</span>
 <span class="mi">232</span><span class="p">:</span> <span class="s1">'Border collie'</span><span class="p">,</span>
 <span class="mi">233</span><span class="p">:</span> <span class="s1">'Bouvier des Flandres, Bouviers des Flandres'</span><span class="p">,</span>
 <span class="mi">234</span><span class="p">:</span> <span class="s1">'Rottweiler'</span><span class="p">,</span>
 <span class="mi">235</span><span class="p">:</span> <span class="s1">'German shepherd, German shepherd dog, German police dog, alsatian'</span><span class="p">,</span>
 <span class="mi">236</span><span class="p">:</span> <span class="s1">'Doberman, Doberman pinscher'</span><span class="p">,</span>
 <span class="mi">237</span><span class="p">:</span> <span class="s1">'miniature pinscher'</span><span class="p">,</span>
 <span class="mi">238</span><span class="p">:</span> <span class="s1">'Greater Swiss Mountain dog'</span><span class="p">,</span>
 <span class="mi">239</span><span class="p">:</span> <span class="s1">'Bernese mountain dog'</span><span class="p">,</span>
 <span class="mi">240</span><span class="p">:</span> <span class="s1">'Appenzeller'</span><span class="p">,</span>
 <span class="mi">241</span><span class="p">:</span> <span class="s1">'EntleBucher'</span><span class="p">,</span>
 <span class="mi">242</span><span class="p">:</span> <span class="s1">'boxer'</span><span class="p">,</span>
 <span class="mi">243</span><span class="p">:</span> <span class="s1">'bull mastiff'</span><span class="p">,</span>
 <span class="mi">244</span><span class="p">:</span> <span class="s1">'Tibetan mastiff'</span><span class="p">,</span>
 <span class="mi">245</span><span class="p">:</span> <span class="s1">'French bulldog'</span><span class="p">,</span>
 <span class="mi">246</span><span class="p">:</span> <span class="s1">'Great Dane'</span><span class="p">,</span>
 <span class="mi">247</span><span class="p">:</span> <span class="s1">'Saint Bernard, St Bernard'</span><span class="p">,</span>
 <span class="mi">248</span><span class="p">:</span> <span class="s1">'Eskimo dog, husky'</span><span class="p">,</span>
 <span class="mi">249</span><span class="p">:</span> <span class="s1">'malamute, malemute, Alaskan malamute'</span><span class="p">,</span>
 <span class="mi">250</span><span class="p">:</span> <span class="s1">'Siberian husky'</span><span class="p">,</span>
 <span class="mi">251</span><span class="p">:</span> <span class="s1">'dalmatian, coach dog, carriage dog'</span><span class="p">,</span>
 <span class="mi">252</span><span class="p">:</span> <span class="s1">'affenpinscher, monkey pinscher, monkey dog'</span><span class="p">,</span>
 <span class="mi">253</span><span class="p">:</span> <span class="s1">'basenji'</span><span class="p">,</span>
 <span class="mi">254</span><span class="p">:</span> <span class="s1">'pug, pug-dog'</span><span class="p">,</span>
 <span class="mi">255</span><span class="p">:</span> <span class="s1">'Leonberg'</span><span class="p">,</span>
 <span class="mi">256</span><span class="p">:</span> <span class="s1">'Newfoundland, Newfoundland dog'</span><span class="p">,</span>
 <span class="mi">257</span><span class="p">:</span> <span class="s1">'Great Pyrenees'</span><span class="p">,</span>
 <span class="mi">258</span><span class="p">:</span> <span class="s1">'Samoyed, Samoyede'</span><span class="p">,</span>
 <span class="mi">259</span><span class="p">:</span> <span class="s1">'Pomeranian'</span><span class="p">,</span>
 <span class="mi">260</span><span class="p">:</span> <span class="s1">'chow, chow chow'</span><span class="p">,</span>
 <span class="mi">261</span><span class="p">:</span> <span class="s1">'keeshond'</span><span class="p">,</span>
 <span class="mi">262</span><span class="p">:</span> <span class="s1">'Brabancon griffon'</span><span class="p">,</span>
 <span class="mi">263</span><span class="p">:</span> <span class="s1">'Pembroke, Pembroke Welsh corgi'</span><span class="p">,</span>
 <span class="mi">264</span><span class="p">:</span> <span class="s1">'Cardigan, Cardigan Welsh corgi'</span><span class="p">,</span>
 <span class="mi">265</span><span class="p">:</span> <span class="s1">'toy poodle'</span><span class="p">,</span>
 <span class="mi">266</span><span class="p">:</span> <span class="s1">'miniature poodle'</span><span class="p">,</span>
 <span class="mi">267</span><span class="p">:</span> <span class="s1">'standard poodle'</span><span class="p">,</span>
 <span class="mi">268</span><span class="p">:</span> <span class="s1">'Mexican hairless'</span><span class="p">,</span>
 <span class="mi">269</span><span class="p">:</span> <span class="s1">'timber wolf, grey wolf, gray wolf, Canis lupus'</span><span class="p">,</span>
 <span class="mi">270</span><span class="p">:</span> <span class="s1">'white wolf, Arctic wolf, Canis lupus tundrarum'</span><span class="p">,</span>
 <span class="mi">271</span><span class="p">:</span> <span class="s1">'red wolf, maned wolf, Canis rufus, Canis niger'</span><span class="p">,</span>
 <span class="mi">272</span><span class="p">:</span> <span class="s1">'coyote, prairie wolf, brush wolf, Canis latrans'</span><span class="p">,</span>
 <span class="mi">273</span><span class="p">:</span> <span class="s1">'dingo, warrigal, warragal, Canis dingo'</span><span class="p">,</span>
 <span class="mi">274</span><span class="p">:</span> <span class="s1">'dhole, Cuon alpinus'</span><span class="p">,</span>
 <span class="mi">275</span><span class="p">:</span> <span class="s1">'African hunting dog, hyena dog, Cape hunting dog, Lycaon pictus'</span><span class="p">,</span>
 <span class="mi">276</span><span class="p">:</span> <span class="s1">'hyena, hyaena'</span><span class="p">,</span>
 <span class="mi">277</span><span class="p">:</span> <span class="s1">'red fox, Vulpes vulpes'</span><span class="p">,</span>
 <span class="mi">278</span><span class="p">:</span> <span class="s1">'kit fox, Vulpes macrotis'</span><span class="p">,</span>
 <span class="mi">279</span><span class="p">:</span> <span class="s1">'Arctic fox, white fox, Alopex lagopus'</span><span class="p">,</span>
 <span class="mi">280</span><span class="p">:</span> <span class="s1">'grey fox, gray fox, Urocyon cinereoargenteus'</span><span class="p">,</span>
 <span class="mi">281</span><span class="p">:</span> <span class="s1">'tabby, tabby cat'</span><span class="p">,</span>
 <span class="mi">282</span><span class="p">:</span> <span class="s1">'tiger cat'</span><span class="p">,</span>
 <span class="mi">283</span><span class="p">:</span> <span class="s1">'Persian cat'</span><span class="p">,</span>
 <span class="mi">284</span><span class="p">:</span> <span class="s1">'Siamese cat, Siamese'</span><span class="p">,</span>
 <span class="mi">285</span><span class="p">:</span> <span class="s1">'Egyptian cat'</span><span class="p">,</span>
 <span class="mi">286</span><span class="p">:</span> <span class="s1">'cougar, puma, catamount, mountain lion, painter, panther, Felis concolor'</span><span class="p">,</span>
 <span class="mi">287</span><span class="p">:</span> <span class="s1">'lynx, catamount'</span><span class="p">,</span>
 <span class="mi">288</span><span class="p">:</span> <span class="s1">'leopard, Panthera pardus'</span><span class="p">,</span>
 <span class="mi">289</span><span class="p">:</span> <span class="s1">'snow leopard, ounce, Panthera uncia'</span><span class="p">,</span>
 <span class="mi">290</span><span class="p">:</span> <span class="s1">'jaguar, panther, Panthera onca, Felis onca'</span><span class="p">,</span>
 <span class="mi">291</span><span class="p">:</span> <span class="s1">'lion, king of beasts, Panthera leo'</span><span class="p">,</span>
 <span class="mi">292</span><span class="p">:</span> <span class="s1">'tiger, Panthera tigris'</span><span class="p">,</span>
 <span class="mi">293</span><span class="p">:</span> <span class="s1">'cheetah, chetah, Acinonyx jubatus'</span><span class="p">,</span>
 <span class="mi">294</span><span class="p">:</span> <span class="s1">'brown bear, bruin, Ursus arctos'</span><span class="p">,</span>
 <span class="mi">295</span><span class="p">:</span> <span class="s1">'American black bear, black bear, Ursus americanus, Euarctos americanus'</span><span class="p">,</span>
 <span class="mi">296</span><span class="p">:</span> <span class="s1">'ice bear, polar bear, Ursus Maritimus, Thalarctos maritimus'</span><span class="p">,</span>
 <span class="mi">297</span><span class="p">:</span> <span class="s1">'sloth bear, Melursus ursinus, Ursus ursinus'</span><span class="p">,</span>
 <span class="mi">298</span><span class="p">:</span> <span class="s1">'mongoose'</span><span class="p">,</span>
 <span class="mi">299</span><span class="p">:</span> <span class="s1">'meerkat, mierkat'</span><span class="p">,</span>
 <span class="mi">300</span><span class="p">:</span> <span class="s1">'tiger beetle'</span><span class="p">,</span>
 <span class="mi">301</span><span class="p">:</span> <span class="s1">'ladybug, ladybeetle, lady beetle, ladybird, ladybird beetle'</span><span class="p">,</span>
 <span class="mi">302</span><span class="p">:</span> <span class="s1">'ground beetle, carabid beetle'</span><span class="p">,</span>
 <span class="mi">303</span><span class="p">:</span> <span class="s1">'long-horned beetle, longicorn, longicorn beetle'</span><span class="p">,</span>
 <span class="mi">304</span><span class="p">:</span> <span class="s1">'leaf beetle, chrysomelid'</span><span class="p">,</span>
 <span class="mi">305</span><span class="p">:</span> <span class="s1">'dung beetle'</span><span class="p">,</span>
 <span class="mi">306</span><span class="p">:</span> <span class="s1">'rhinoceros beetle'</span><span class="p">,</span>
 <span class="mi">307</span><span class="p">:</span> <span class="s1">'weevil'</span><span class="p">,</span>
 <span class="mi">308</span><span class="p">:</span> <span class="s1">'fly'</span><span class="p">,</span>
 <span class="mi">309</span><span class="p">:</span> <span class="s1">'bee'</span><span class="p">,</span>
 <span class="mi">310</span><span class="p">:</span> <span class="s1">'ant, emmet, pismire'</span><span class="p">,</span>
 <span class="mi">311</span><span class="p">:</span> <span class="s1">'grasshopper, hopper'</span><span class="p">,</span>
 <span class="mi">312</span><span class="p">:</span> <span class="s1">'cricket'</span><span class="p">,</span>
 <span class="mi">313</span><span class="p">:</span> <span class="s1">'walking stick, walkingstick, stick insect'</span><span class="p">,</span>
 <span class="mi">314</span><span class="p">:</span> <span class="s1">'cockroach, roach'</span><span class="p">,</span>
 <span class="mi">315</span><span class="p">:</span> <span class="s1">'mantis, mantid'</span><span class="p">,</span>
 <span class="mi">316</span><span class="p">:</span> <span class="s1">'cicada, cicala'</span><span class="p">,</span>
 <span class="mi">317</span><span class="p">:</span> <span class="s1">'leafhopper'</span><span class="p">,</span>
 <span class="mi">318</span><span class="p">:</span> <span class="s1">'lacewing, lacewing fly'</span><span class="p">,</span>
 <span class="mi">319</span><span class="p">:</span> <span class="s2">"dragonfly, darning needle, devil's darning needle, sewing needle, snake feeder, snake doctor, mosquito hawk, skeeter hawk"</span><span class="p">,</span>
 <span class="mi">320</span><span class="p">:</span> <span class="s1">'damselfly'</span><span class="p">,</span>
 <span class="mi">321</span><span class="p">:</span> <span class="s1">'admiral'</span><span class="p">,</span>
 <span class="mi">322</span><span class="p">:</span> <span class="s1">'ringlet, ringlet butterfly'</span><span class="p">,</span>
 <span class="mi">323</span><span class="p">:</span> <span class="s1">'monarch, monarch butterfly, milkweed butterfly, Danaus plexippus'</span><span class="p">,</span>
 <span class="mi">324</span><span class="p">:</span> <span class="s1">'cabbage butterfly'</span><span class="p">,</span>
 <span class="mi">325</span><span class="p">:</span> <span class="s1">'sulphur butterfly, sulfur butterfly'</span><span class="p">,</span>
 <span class="mi">326</span><span class="p">:</span> <span class="s1">'lycaenid, lycaenid butterfly'</span><span class="p">,</span>
 <span class="mi">327</span><span class="p">:</span> <span class="s1">'starfish, sea star'</span><span class="p">,</span>
 <span class="mi">328</span><span class="p">:</span> <span class="s1">'sea urchin'</span><span class="p">,</span>
 <span class="mi">329</span><span class="p">:</span> <span class="s1">'sea cucumber, holothurian'</span><span class="p">,</span>
 <span class="mi">330</span><span class="p">:</span> <span class="s1">'wood rabbit, cottontail, cottontail rabbit'</span><span class="p">,</span>
 <span class="mi">331</span><span class="p">:</span> <span class="s1">'hare'</span><span class="p">,</span>
 <span class="mi">332</span><span class="p">:</span> <span class="s1">'Angora, Angora rabbit'</span><span class="p">,</span>
 <span class="mi">333</span><span class="p">:</span> <span class="s1">'hamster'</span><span class="p">,</span>
 <span class="mi">334</span><span class="p">:</span> <span class="s1">'porcupine, hedgehog'</span><span class="p">,</span>
 <span class="mi">335</span><span class="p">:</span> <span class="s1">'fox squirrel, eastern fox squirrel, Sciurus niger'</span><span class="p">,</span>
 <span class="mi">336</span><span class="p">:</span> <span class="s1">'marmot'</span><span class="p">,</span>
 <span class="mi">337</span><span class="p">:</span> <span class="s1">'beaver'</span><span class="p">,</span>
 <span class="mi">338</span><span class="p">:</span> <span class="s1">'guinea pig, Cavia cobaya'</span><span class="p">,</span>
 <span class="mi">339</span><span class="p">:</span> <span class="s1">'sorrel'</span><span class="p">,</span>
 <span class="mi">340</span><span class="p">:</span> <span class="s1">'zebra'</span><span class="p">,</span>
 <span class="mi">341</span><span class="p">:</span> <span class="s1">'hog, pig, grunter, squealer, Sus scrofa'</span><span class="p">,</span>
 <span class="mi">342</span><span class="p">:</span> <span class="s1">'wild boar, boar, Sus scrofa'</span><span class="p">,</span>
 <span class="mi">343</span><span class="p">:</span> <span class="s1">'warthog'</span><span class="p">,</span>
 <span class="mi">344</span><span class="p">:</span> <span class="s1">'hippopotamus, hippo, river horse, Hippopotamus amphibius'</span><span class="p">,</span>
 <span class="mi">345</span><span class="p">:</span> <span class="s1">'ox'</span><span class="p">,</span>
 <span class="mi">346</span><span class="p">:</span> <span class="s1">'water buffalo, water ox, Asiatic buffalo, Bubalus bubalis'</span><span class="p">,</span>
 <span class="mi">347</span><span class="p">:</span> <span class="s1">'bison'</span><span class="p">,</span>
 <span class="mi">348</span><span class="p">:</span> <span class="s1">'ram, tup'</span><span class="p">,</span>
 <span class="mi">349</span><span class="p">:</span> <span class="s1">'bighorn, bighorn sheep, cimarron, Rocky Mountain bighorn, Rocky Mountain sheep, Ovis canadensis'</span><span class="p">,</span>
 <span class="mi">350</span><span class="p">:</span> <span class="s1">'ibex, Capra ibex'</span><span class="p">,</span>
 <span class="mi">351</span><span class="p">:</span> <span class="s1">'hartebeest'</span><span class="p">,</span>
 <span class="mi">352</span><span class="p">:</span> <span class="s1">'impala, Aepyceros melampus'</span><span class="p">,</span>
 <span class="mi">353</span><span class="p">:</span> <span class="s1">'gazelle'</span><span class="p">,</span>
 <span class="mi">354</span><span class="p">:</span> <span class="s1">'Arabian camel, dromedary, Camelus dromedarius'</span><span class="p">,</span>
 <span class="mi">355</span><span class="p">:</span> <span class="s1">'llama'</span><span class="p">,</span>
 <span class="mi">356</span><span class="p">:</span> <span class="s1">'weasel'</span><span class="p">,</span>
 <span class="mi">357</span><span class="p">:</span> <span class="s1">'mink'</span><span class="p">,</span>
 <span class="mi">358</span><span class="p">:</span> <span class="s1">'polecat, fitch, foulmart, foumart, Mustela putorius'</span><span class="p">,</span>
 <span class="mi">359</span><span class="p">:</span> <span class="s1">'black-footed ferret, ferret, Mustela nigripes'</span><span class="p">,</span>
 <span class="mi">360</span><span class="p">:</span> <span class="s1">'otter'</span><span class="p">,</span>
 <span class="mi">361</span><span class="p">:</span> <span class="s1">'skunk, polecat, wood pussy'</span><span class="p">,</span>
 <span class="mi">362</span><span class="p">:</span> <span class="s1">'badger'</span><span class="p">,</span>
 <span class="mi">363</span><span class="p">:</span> <span class="s1">'armadillo'</span><span class="p">,</span>
 <span class="mi">364</span><span class="p">:</span> <span class="s1">'three-toed sloth, ai, Bradypus tridactylus'</span><span class="p">,</span>
 <span class="mi">365</span><span class="p">:</span> <span class="s1">'orangutan, orang, orangutang, Pongo pygmaeus'</span><span class="p">,</span>
 <span class="mi">366</span><span class="p">:</span> <span class="s1">'gorilla, Gorilla gorilla'</span><span class="p">,</span>
 <span class="mi">367</span><span class="p">:</span> <span class="s1">'chimpanzee, chimp, Pan troglodytes'</span><span class="p">,</span>
 <span class="mi">368</span><span class="p">:</span> <span class="s1">'gibbon, Hylobates lar'</span><span class="p">,</span>
 <span class="mi">369</span><span class="p">:</span> <span class="s1">'siamang, Hylobates syndactylus, Symphalangus syndactylus'</span><span class="p">,</span>
 <span class="mi">370</span><span class="p">:</span> <span class="s1">'guenon, guenon monkey'</span><span class="p">,</span>
 <span class="mi">371</span><span class="p">:</span> <span class="s1">'patas, hussar monkey, Erythrocebus patas'</span><span class="p">,</span>
 <span class="mi">372</span><span class="p">:</span> <span class="s1">'baboon'</span><span class="p">,</span>
 <span class="mi">373</span><span class="p">:</span> <span class="s1">'macaque'</span><span class="p">,</span>
 <span class="mi">374</span><span class="p">:</span> <span class="s1">'langur'</span><span class="p">,</span>
 <span class="mi">375</span><span class="p">:</span> <span class="s1">'colobus, colobus monkey'</span><span class="p">,</span>
 <span class="mi">376</span><span class="p">:</span> <span class="s1">'proboscis monkey, Nasalis larvatus'</span><span class="p">,</span>
 <span class="mi">377</span><span class="p">:</span> <span class="s1">'marmoset'</span><span class="p">,</span>
 <span class="mi">378</span><span class="p">:</span> <span class="s1">'capuchin, ringtail, Cebus capucinus'</span><span class="p">,</span>
 <span class="mi">379</span><span class="p">:</span> <span class="s1">'howler monkey, howler'</span><span class="p">,</span>
 <span class="mi">380</span><span class="p">:</span> <span class="s1">'titi, titi monkey'</span><span class="p">,</span>
 <span class="mi">381</span><span class="p">:</span> <span class="s1">'spider monkey, Ateles geoffroyi'</span><span class="p">,</span>
 <span class="mi">382</span><span class="p">:</span> <span class="s1">'squirrel monkey, Saimiri sciureus'</span><span class="p">,</span>
 <span class="mi">383</span><span class="p">:</span> <span class="s1">'Madagascar cat, ring-tailed lemur, Lemur catta'</span><span class="p">,</span>
 <span class="mi">384</span><span class="p">:</span> <span class="s1">'indri, indris, Indri indri, Indri brevicaudatus'</span><span class="p">,</span>
 <span class="mi">385</span><span class="p">:</span> <span class="s1">'Indian elephant, Elephas maximus'</span><span class="p">,</span>
 <span class="mi">386</span><span class="p">:</span> <span class="s1">'African elephant, Loxodonta africana'</span><span class="p">,</span>
 <span class="mi">387</span><span class="p">:</span> <span class="s1">'lesser panda, red panda, panda, bear cat, cat bear, Ailurus fulgens'</span><span class="p">,</span>
 <span class="mi">388</span><span class="p">:</span> <span class="s1">'giant panda, panda, panda bear, coon bear, Ailuropoda melanoleuca'</span><span class="p">,</span>
 <span class="mi">389</span><span class="p">:</span> <span class="s1">'barracouta, snoek'</span><span class="p">,</span>
 <span class="mi">390</span><span class="p">:</span> <span class="s1">'eel'</span><span class="p">,</span>
 <span class="mi">391</span><span class="p">:</span> <span class="s1">'coho, cohoe, coho salmon, blue jack, silver salmon, Oncorhynchus kisutch'</span><span class="p">,</span>
 <span class="mi">392</span><span class="p">:</span> <span class="s1">'rock beauty, Holocanthus tricolor'</span><span class="p">,</span>
 <span class="mi">393</span><span class="p">:</span> <span class="s1">'anemone fish'</span><span class="p">,</span>
 <span class="mi">394</span><span class="p">:</span> <span class="s1">'sturgeon'</span><span class="p">,</span>
 <span class="mi">395</span><span class="p">:</span> <span class="s1">'gar, garfish, garpike, billfish, Lepisosteus osseus'</span><span class="p">,</span>
 <span class="mi">396</span><span class="p">:</span> <span class="s1">'lionfish'</span><span class="p">,</span>
 <span class="mi">397</span><span class="p">:</span> <span class="s1">'puffer, pufferfish, blowfish, globefish'</span><span class="p">,</span>
 <span class="mi">398</span><span class="p">:</span> <span class="s1">'abacus'</span><span class="p">,</span>
 <span class="mi">399</span><span class="p">:</span> <span class="s1">'abaya'</span><span class="p">,</span>
 <span class="mi">400</span><span class="p">:</span> <span class="s2">"academic gown, academic robe, judge's robe"</span><span class="p">,</span>
 <span class="mi">401</span><span class="p">:</span> <span class="s1">'accordion, piano accordion, squeeze box'</span><span class="p">,</span>
 <span class="mi">402</span><span class="p">:</span> <span class="s1">'acoustic guitar'</span><span class="p">,</span>
 <span class="mi">403</span><span class="p">:</span> <span class="s1">'aircraft carrier, carrier, flattop, attack aircraft carrier'</span><span class="p">,</span>
 <span class="mi">404</span><span class="p">:</span> <span class="s1">'airliner'</span><span class="p">,</span>
 <span class="mi">405</span><span class="p">:</span> <span class="s1">'airship, dirigible'</span><span class="p">,</span>
 <span class="mi">406</span><span class="p">:</span> <span class="s1">'altar'</span><span class="p">,</span>
 <span class="mi">407</span><span class="p">:</span> <span class="s1">'ambulance'</span><span class="p">,</span>
 <span class="mi">408</span><span class="p">:</span> <span class="s1">'amphibian, amphibious vehicle'</span><span class="p">,</span>
 <span class="mi">409</span><span class="p">:</span> <span class="s1">'analog clock'</span><span class="p">,</span>
 <span class="mi">410</span><span class="p">:</span> <span class="s1">'apiary, bee house'</span><span class="p">,</span>
 <span class="mi">411</span><span class="p">:</span> <span class="s1">'apron'</span><span class="p">,</span>
 <span class="mi">412</span><span class="p">:</span> <span class="s1">'ashcan, trash can, garbage can, wastebin, ash bin, ash-bin, ashbin, dustbin, trash barrel, trash bin'</span><span class="p">,</span>
 <span class="mi">413</span><span class="p">:</span> <span class="s1">'assault rifle, assault gun'</span><span class="p">,</span>
 <span class="mi">414</span><span class="p">:</span> <span class="s1">'backpack, back pack, knapsack, packsack, rucksack, haversack'</span><span class="p">,</span>
 <span class="mi">415</span><span class="p">:</span> <span class="s1">'bakery, bakeshop, bakehouse'</span><span class="p">,</span>
 <span class="mi">416</span><span class="p">:</span> <span class="s1">'balance beam, beam'</span><span class="p">,</span>
 <span class="mi">417</span><span class="p">:</span> <span class="s1">'balloon'</span><span class="p">,</span>
 <span class="mi">418</span><span class="p">:</span> <span class="s1">'ballpoint, ballpoint pen, ballpen, Biro'</span><span class="p">,</span>
 <span class="mi">419</span><span class="p">:</span> <span class="s1">'Band Aid'</span><span class="p">,</span>
 <span class="mi">420</span><span class="p">:</span> <span class="s1">'banjo'</span><span class="p">,</span>
 <span class="mi">421</span><span class="p">:</span> <span class="s1">'bannister, banister, balustrade, balusters, handrail'</span><span class="p">,</span>
 <span class="mi">422</span><span class="p">:</span> <span class="s1">'barbell'</span><span class="p">,</span>
 <span class="mi">423</span><span class="p">:</span> <span class="s1">'barber chair'</span><span class="p">,</span>
 <span class="mi">424</span><span class="p">:</span> <span class="s1">'barbershop'</span><span class="p">,</span>
 <span class="mi">425</span><span class="p">:</span> <span class="s1">'barn'</span><span class="p">,</span>
 <span class="mi">426</span><span class="p">:</span> <span class="s1">'barometer'</span><span class="p">,</span>
 <span class="mi">427</span><span class="p">:</span> <span class="s1">'barrel, cask'</span><span class="p">,</span>
 <span class="mi">428</span><span class="p">:</span> <span class="s1">'barrow, garden cart, lawn cart, wheelbarrow'</span><span class="p">,</span>
 <span class="mi">429</span><span class="p">:</span> <span class="s1">'baseball'</span><span class="p">,</span>
 <span class="mi">430</span><span class="p">:</span> <span class="s1">'basketball'</span><span class="p">,</span>
 <span class="mi">431</span><span class="p">:</span> <span class="s1">'bassinet'</span><span class="p">,</span>
 <span class="mi">432</span><span class="p">:</span> <span class="s1">'bassoon'</span><span class="p">,</span>
 <span class="mi">433</span><span class="p">:</span> <span class="s1">'bathing cap, swimming cap'</span><span class="p">,</span>
 <span class="mi">434</span><span class="p">:</span> <span class="s1">'bath towel'</span><span class="p">,</span>
 <span class="mi">435</span><span class="p">:</span> <span class="s1">'bathtub, bathing tub, bath, tub'</span><span class="p">,</span>
 <span class="mi">436</span><span class="p">:</span> <span class="s1">'beach wagon, station wagon, wagon, estate car, beach waggon, station waggon, waggon'</span><span class="p">,</span>
 <span class="mi">437</span><span class="p">:</span> <span class="s1">'beacon, lighthouse, beacon light, pharos'</span><span class="p">,</span>
 <span class="mi">438</span><span class="p">:</span> <span class="s1">'beaker'</span><span class="p">,</span>
 <span class="mi">439</span><span class="p">:</span> <span class="s1">'bearskin, busby, shako'</span><span class="p">,</span>
 <span class="mi">440</span><span class="p">:</span> <span class="s1">'beer bottle'</span><span class="p">,</span>
 <span class="mi">441</span><span class="p">:</span> <span class="s1">'beer glass'</span><span class="p">,</span>
 <span class="mi">442</span><span class="p">:</span> <span class="s1">'bell cote, bell cot'</span><span class="p">,</span>
 <span class="mi">443</span><span class="p">:</span> <span class="s1">'bib'</span><span class="p">,</span>
 <span class="mi">444</span><span class="p">:</span> <span class="s1">'bicycle-built-for-two, tandem bicycle, tandem'</span><span class="p">,</span>
 <span class="mi">445</span><span class="p">:</span> <span class="s1">'bikini, two-piece'</span><span class="p">,</span>
 <span class="mi">446</span><span class="p">:</span> <span class="s1">'binder, ring-binder'</span><span class="p">,</span>
 <span class="mi">447</span><span class="p">:</span> <span class="s1">'binoculars, field glasses, opera glasses'</span><span class="p">,</span>
 <span class="mi">448</span><span class="p">:</span> <span class="s1">'birdhouse'</span><span class="p">,</span>
 <span class="mi">449</span><span class="p">:</span> <span class="s1">'boathouse'</span><span class="p">,</span>
 <span class="mi">450</span><span class="p">:</span> <span class="s1">'bobsled, bobsleigh, bob'</span><span class="p">,</span>
 <span class="mi">451</span><span class="p">:</span> <span class="s1">'bolo tie, bolo, bola tie, bola'</span><span class="p">,</span>
 <span class="mi">452</span><span class="p">:</span> <span class="s1">'bonnet, poke bonnet'</span><span class="p">,</span>
 <span class="mi">453</span><span class="p">:</span> <span class="s1">'bookcase'</span><span class="p">,</span>
 <span class="mi">454</span><span class="p">:</span> <span class="s1">'bookshop, bookstore, bookstall'</span><span class="p">,</span>
 <span class="mi">455</span><span class="p">:</span> <span class="s1">'bottlecap'</span><span class="p">,</span>
 <span class="mi">456</span><span class="p">:</span> <span class="s1">'bow'</span><span class="p">,</span>
 <span class="mi">457</span><span class="p">:</span> <span class="s1">'bow tie, bow-tie, bowtie'</span><span class="p">,</span>
 <span class="mi">458</span><span class="p">:</span> <span class="s1">'brass, memorial tablet, plaque'</span><span class="p">,</span>
 <span class="mi">459</span><span class="p">:</span> <span class="s1">'brassiere, bra, bandeau'</span><span class="p">,</span>
 <span class="mi">460</span><span class="p">:</span> <span class="s1">'breakwater, groin, groyne, mole, bulwark, seawall, jetty'</span><span class="p">,</span>
 <span class="mi">461</span><span class="p">:</span> <span class="s1">'breastplate, aegis, egis'</span><span class="p">,</span>
 <span class="mi">462</span><span class="p">:</span> <span class="s1">'broom'</span><span class="p">,</span>
 <span class="mi">463</span><span class="p">:</span> <span class="s1">'bucket, pail'</span><span class="p">,</span>
 <span class="mi">464</span><span class="p">:</span> <span class="s1">'buckle'</span><span class="p">,</span>
 <span class="mi">465</span><span class="p">:</span> <span class="s1">'bulletproof vest'</span><span class="p">,</span>
 <span class="mi">466</span><span class="p">:</span> <span class="s1">'bullet train, bullet'</span><span class="p">,</span>
 <span class="mi">467</span><span class="p">:</span> <span class="s1">'butcher shop, meat market'</span><span class="p">,</span>
 <span class="mi">468</span><span class="p">:</span> <span class="s1">'cab, hack, taxi, taxicab'</span><span class="p">,</span>
 <span class="mi">469</span><span class="p">:</span> <span class="s1">'caldron, cauldron'</span><span class="p">,</span>
 <span class="mi">470</span><span class="p">:</span> <span class="s1">'candle, taper, wax light'</span><span class="p">,</span>
 <span class="mi">471</span><span class="p">:</span> <span class="s1">'cannon'</span><span class="p">,</span>
 <span class="mi">472</span><span class="p">:</span> <span class="s1">'canoe'</span><span class="p">,</span>
 <span class="mi">473</span><span class="p">:</span> <span class="s1">'can opener, tin opener'</span><span class="p">,</span>
 <span class="mi">474</span><span class="p">:</span> <span class="s1">'cardigan'</span><span class="p">,</span>
 <span class="mi">475</span><span class="p">:</span> <span class="s1">'car mirror'</span><span class="p">,</span>
 <span class="mi">476</span><span class="p">:</span> <span class="s1">'carousel, carrousel, merry-go-round, roundabout, whirligig'</span><span class="p">,</span>
 <span class="mi">477</span><span class="p">:</span> <span class="s2">"carpenter's kit, tool kit"</span><span class="p">,</span>
 <span class="mi">478</span><span class="p">:</span> <span class="s1">'carton'</span><span class="p">,</span>
 <span class="mi">479</span><span class="p">:</span> <span class="s1">'car wheel'</span><span class="p">,</span>
 <span class="mi">480</span><span class="p">:</span> <span class="s1">'cash machine, cash dispenser, automated teller machine, automatic teller machine, automated teller, automatic teller, ATM'</span><span class="p">,</span>
 <span class="mi">481</span><span class="p">:</span> <span class="s1">'cassette'</span><span class="p">,</span>
 <span class="mi">482</span><span class="p">:</span> <span class="s1">'cassette player'</span><span class="p">,</span>
 <span class="mi">483</span><span class="p">:</span> <span class="s1">'castle'</span><span class="p">,</span>
 <span class="mi">484</span><span class="p">:</span> <span class="s1">'catamaran'</span><span class="p">,</span>
 <span class="mi">485</span><span class="p">:</span> <span class="s1">'CD player'</span><span class="p">,</span>
 <span class="mi">486</span><span class="p">:</span> <span class="s1">'cello, violoncello'</span><span class="p">,</span>
 <span class="mi">487</span><span class="p">:</span> <span class="s1">'cellular telephone, cellular phone, cellphone, cell, mobile phone'</span><span class="p">,</span>
 <span class="mi">488</span><span class="p">:</span> <span class="s1">'chain'</span><span class="p">,</span>
 <span class="mi">489</span><span class="p">:</span> <span class="s1">'chainlink fence'</span><span class="p">,</span>
 <span class="mi">490</span><span class="p">:</span> <span class="s1">'chain mail, ring mail, mail, chain armor, chain armour, ring armor, ring armour'</span><span class="p">,</span>
 <span class="mi">491</span><span class="p">:</span> <span class="s1">'chain saw, chainsaw'</span><span class="p">,</span>
 <span class="mi">492</span><span class="p">:</span> <span class="s1">'chest'</span><span class="p">,</span>
 <span class="mi">493</span><span class="p">:</span> <span class="s1">'chiffonier, commode'</span><span class="p">,</span>
 <span class="mi">494</span><span class="p">:</span> <span class="s1">'chime, bell, gong'</span><span class="p">,</span>
 <span class="mi">495</span><span class="p">:</span> <span class="s1">'china cabinet, china closet'</span><span class="p">,</span>
 <span class="mi">496</span><span class="p">:</span> <span class="s1">'Christmas stocking'</span><span class="p">,</span>
 <span class="mi">497</span><span class="p">:</span> <span class="s1">'church, church building'</span><span class="p">,</span>
 <span class="mi">498</span><span class="p">:</span> <span class="s1">'cinema, movie theater, movie theatre, movie house, picture palace'</span><span class="p">,</span>
 <span class="mi">499</span><span class="p">:</span> <span class="s1">'cleaver, meat cleaver, chopper'</span><span class="p">,</span>
 <span class="mi">500</span><span class="p">:</span> <span class="s1">'cliff dwelling'</span><span class="p">,</span>
 <span class="mi">501</span><span class="p">:</span> <span class="s1">'cloak'</span><span class="p">,</span>
 <span class="mi">502</span><span class="p">:</span> <span class="s1">'clog, geta, patten, sabot'</span><span class="p">,</span>
 <span class="mi">503</span><span class="p">:</span> <span class="s1">'cocktail shaker'</span><span class="p">,</span>
 <span class="mi">504</span><span class="p">:</span> <span class="s1">'coffee mug'</span><span class="p">,</span>
 <span class="mi">505</span><span class="p">:</span> <span class="s1">'coffeepot'</span><span class="p">,</span>
 <span class="mi">506</span><span class="p">:</span> <span class="s1">'coil, spiral, volute, whorl, helix'</span><span class="p">,</span>
 <span class="mi">507</span><span class="p">:</span> <span class="s1">'combination lock'</span><span class="p">,</span>
 <span class="mi">508</span><span class="p">:</span> <span class="s1">'computer keyboard, keypad'</span><span class="p">,</span>
 <span class="mi">509</span><span class="p">:</span> <span class="s1">'confectionery, confectionary, candy store'</span><span class="p">,</span>
 <span class="mi">510</span><span class="p">:</span> <span class="s1">'container ship, containership, container vessel'</span><span class="p">,</span>
 <span class="mi">511</span><span class="p">:</span> <span class="s1">'convertible'</span><span class="p">,</span>
 <span class="mi">512</span><span class="p">:</span> <span class="s1">'corkscrew, bottle screw'</span><span class="p">,</span>
 <span class="mi">513</span><span class="p">:</span> <span class="s1">'cornet, horn, trumpet, trump'</span><span class="p">,</span>
 <span class="mi">514</span><span class="p">:</span> <span class="s1">'cowboy boot'</span><span class="p">,</span>
 <span class="mi">515</span><span class="p">:</span> <span class="s1">'cowboy hat, ten-gallon hat'</span><span class="p">,</span>
 <span class="mi">516</span><span class="p">:</span> <span class="s1">'cradle'</span><span class="p">,</span>
 <span class="mi">517</span><span class="p">:</span> <span class="s1">'crane'</span><span class="p">,</span>
 <span class="mi">518</span><span class="p">:</span> <span class="s1">'crash helmet'</span><span class="p">,</span>
 <span class="mi">519</span><span class="p">:</span> <span class="s1">'crate'</span><span class="p">,</span>
 <span class="mi">520</span><span class="p">:</span> <span class="s1">'crib, cot'</span><span class="p">,</span>
 <span class="mi">521</span><span class="p">:</span> <span class="s1">'Crock Pot'</span><span class="p">,</span>
 <span class="mi">522</span><span class="p">:</span> <span class="s1">'croquet ball'</span><span class="p">,</span>
 <span class="mi">523</span><span class="p">:</span> <span class="s1">'crutch'</span><span class="p">,</span>
 <span class="mi">524</span><span class="p">:</span> <span class="s1">'cuirass'</span><span class="p">,</span>
 <span class="mi">525</span><span class="p">:</span> <span class="s1">'dam, dike, dyke'</span><span class="p">,</span>
 <span class="mi">526</span><span class="p">:</span> <span class="s1">'desk'</span><span class="p">,</span>
 <span class="mi">527</span><span class="p">:</span> <span class="s1">'desktop computer'</span><span class="p">,</span>
 <span class="mi">528</span><span class="p">:</span> <span class="s1">'dial telephone, dial phone'</span><span class="p">,</span>
 <span class="mi">529</span><span class="p">:</span> <span class="s1">'diaper, nappy, napkin'</span><span class="p">,</span>
 <span class="mi">530</span><span class="p">:</span> <span class="s1">'digital clock'</span><span class="p">,</span>
 <span class="mi">531</span><span class="p">:</span> <span class="s1">'digital watch'</span><span class="p">,</span>
 <span class="mi">532</span><span class="p">:</span> <span class="s1">'dining table, board'</span><span class="p">,</span>
 <span class="mi">533</span><span class="p">:</span> <span class="s1">'dishrag, dishcloth'</span><span class="p">,</span>
 <span class="mi">534</span><span class="p">:</span> <span class="s1">'dishwasher, dish washer, dishwashing machine'</span><span class="p">,</span>
 <span class="mi">535</span><span class="p">:</span> <span class="s1">'disk brake, disc brake'</span><span class="p">,</span>
 <span class="mi">536</span><span class="p">:</span> <span class="s1">'dock, dockage, docking facility'</span><span class="p">,</span>
 <span class="mi">537</span><span class="p">:</span> <span class="s1">'dogsled, dog sled, dog sleigh'</span><span class="p">,</span>
 <span class="mi">538</span><span class="p">:</span> <span class="s1">'dome'</span><span class="p">,</span>
 <span class="mi">539</span><span class="p">:</span> <span class="s1">'doormat, welcome mat'</span><span class="p">,</span>
 <span class="mi">540</span><span class="p">:</span> <span class="s1">'drilling platform, offshore rig'</span><span class="p">,</span>
 <span class="mi">541</span><span class="p">:</span> <span class="s1">'drum, membranophone, tympan'</span><span class="p">,</span>
 <span class="mi">542</span><span class="p">:</span> <span class="s1">'drumstick'</span><span class="p">,</span>
 <span class="mi">543</span><span class="p">:</span> <span class="s1">'dumbbell'</span><span class="p">,</span>
 <span class="mi">544</span><span class="p">:</span> <span class="s1">'Dutch oven'</span><span class="p">,</span>
 <span class="mi">545</span><span class="p">:</span> <span class="s1">'electric fan, blower'</span><span class="p">,</span>
 <span class="mi">546</span><span class="p">:</span> <span class="s1">'electric guitar'</span><span class="p">,</span>
 <span class="mi">547</span><span class="p">:</span> <span class="s1">'electric locomotive'</span><span class="p">,</span>
 <span class="mi">548</span><span class="p">:</span> <span class="s1">'entertainment center'</span><span class="p">,</span>
 <span class="mi">549</span><span class="p">:</span> <span class="s1">'envelope'</span><span class="p">,</span>
 <span class="mi">550</span><span class="p">:</span> <span class="s1">'espresso maker'</span><span class="p">,</span>
 <span class="mi">551</span><span class="p">:</span> <span class="s1">'face powder'</span><span class="p">,</span>
 <span class="mi">552</span><span class="p">:</span> <span class="s1">'feather boa, boa'</span><span class="p">,</span>
 <span class="mi">553</span><span class="p">:</span> <span class="s1">'file, file cabinet, filing cabinet'</span><span class="p">,</span>
 <span class="mi">554</span><span class="p">:</span> <span class="s1">'fireboat'</span><span class="p">,</span>
 <span class="mi">555</span><span class="p">:</span> <span class="s1">'fire engine, fire truck'</span><span class="p">,</span>
 <span class="mi">556</span><span class="p">:</span> <span class="s1">'fire screen, fireguard'</span><span class="p">,</span>
 <span class="mi">557</span><span class="p">:</span> <span class="s1">'flagpole, flagstaff'</span><span class="p">,</span>
 <span class="mi">558</span><span class="p">:</span> <span class="s1">'flute, transverse flute'</span><span class="p">,</span>
 <span class="mi">559</span><span class="p">:</span> <span class="s1">'folding chair'</span><span class="p">,</span>
 <span class="mi">560</span><span class="p">:</span> <span class="s1">'football helmet'</span><span class="p">,</span>
 <span class="mi">561</span><span class="p">:</span> <span class="s1">'forklift'</span><span class="p">,</span>
 <span class="mi">562</span><span class="p">:</span> <span class="s1">'fountain'</span><span class="p">,</span>
 <span class="mi">563</span><span class="p">:</span> <span class="s1">'fountain pen'</span><span class="p">,</span>
 <span class="mi">564</span><span class="p">:</span> <span class="s1">'four-poster'</span><span class="p">,</span>
 <span class="mi">565</span><span class="p">:</span> <span class="s1">'freight car'</span><span class="p">,</span>
 <span class="mi">566</span><span class="p">:</span> <span class="s1">'French horn, horn'</span><span class="p">,</span>
 <span class="mi">567</span><span class="p">:</span> <span class="s1">'frying pan, frypan, skillet'</span><span class="p">,</span>
 <span class="mi">568</span><span class="p">:</span> <span class="s1">'fur coat'</span><span class="p">,</span>
 <span class="mi">569</span><span class="p">:</span> <span class="s1">'garbage truck, dustcart'</span><span class="p">,</span>
 <span class="mi">570</span><span class="p">:</span> <span class="s1">'gasmask, respirator, gas helmet'</span><span class="p">,</span>
 <span class="mi">571</span><span class="p">:</span> <span class="s1">'gas pump, gasoline pump, petrol pump, island dispenser'</span><span class="p">,</span>
 <span class="mi">572</span><span class="p">:</span> <span class="s1">'goblet'</span><span class="p">,</span>
 <span class="mi">573</span><span class="p">:</span> <span class="s1">'go-kart'</span><span class="p">,</span>
 <span class="mi">574</span><span class="p">:</span> <span class="s1">'golf ball'</span><span class="p">,</span>
 <span class="mi">575</span><span class="p">:</span> <span class="s1">'golfcart, golf cart'</span><span class="p">,</span>
 <span class="mi">576</span><span class="p">:</span> <span class="s1">'gondola'</span><span class="p">,</span>
 <span class="mi">577</span><span class="p">:</span> <span class="s1">'gong, tam-tam'</span><span class="p">,</span>
 <span class="mi">578</span><span class="p">:</span> <span class="s1">'gown'</span><span class="p">,</span>
 <span class="mi">579</span><span class="p">:</span> <span class="s1">'grand piano, grand'</span><span class="p">,</span>
 <span class="mi">580</span><span class="p">:</span> <span class="s1">'greenhouse, nursery, glasshouse'</span><span class="p">,</span>
 <span class="mi">581</span><span class="p">:</span> <span class="s1">'grille, radiator grille'</span><span class="p">,</span>
 <span class="mi">582</span><span class="p">:</span> <span class="s1">'grocery store, grocery, food market, market'</span><span class="p">,</span>
 <span class="mi">583</span><span class="p">:</span> <span class="s1">'guillotine'</span><span class="p">,</span>
 <span class="mi">584</span><span class="p">:</span> <span class="s1">'hair slide'</span><span class="p">,</span>
 <span class="mi">585</span><span class="p">:</span> <span class="s1">'hair spray'</span><span class="p">,</span>
 <span class="mi">586</span><span class="p">:</span> <span class="s1">'half track'</span><span class="p">,</span>
 <span class="mi">587</span><span class="p">:</span> <span class="s1">'hammer'</span><span class="p">,</span>
 <span class="mi">588</span><span class="p">:</span> <span class="s1">'hamper'</span><span class="p">,</span>
 <span class="mi">589</span><span class="p">:</span> <span class="s1">'hand blower, blow dryer, blow drier, hair dryer, hair drier'</span><span class="p">,</span>
 <span class="mi">590</span><span class="p">:</span> <span class="s1">'hand-held computer, hand-held microcomputer'</span><span class="p">,</span>
 <span class="mi">591</span><span class="p">:</span> <span class="s1">'handkerchief, hankie, hanky, hankey'</span><span class="p">,</span>
 <span class="mi">592</span><span class="p">:</span> <span class="s1">'hard disc, hard disk, fixed disk'</span><span class="p">,</span>
 <span class="mi">593</span><span class="p">:</span> <span class="s1">'harmonica, mouth organ, harp, mouth harp'</span><span class="p">,</span>
 <span class="mi">594</span><span class="p">:</span> <span class="s1">'harp'</span><span class="p">,</span>
 <span class="mi">595</span><span class="p">:</span> <span class="s1">'harvester, reaper'</span><span class="p">,</span>
 <span class="mi">596</span><span class="p">:</span> <span class="s1">'hatchet'</span><span class="p">,</span>
 <span class="mi">597</span><span class="p">:</span> <span class="s1">'holster'</span><span class="p">,</span>
 <span class="mi">598</span><span class="p">:</span> <span class="s1">'home theater, home theatre'</span><span class="p">,</span>
 <span class="mi">599</span><span class="p">:</span> <span class="s1">'honeycomb'</span><span class="p">,</span>
 <span class="mi">600</span><span class="p">:</span> <span class="s1">'hook, claw'</span><span class="p">,</span>
 <span class="mi">601</span><span class="p">:</span> <span class="s1">'hoopskirt, crinoline'</span><span class="p">,</span>
 <span class="mi">602</span><span class="p">:</span> <span class="s1">'horizontal bar, high bar'</span><span class="p">,</span>
 <span class="mi">603</span><span class="p">:</span> <span class="s1">'horse cart, horse-cart'</span><span class="p">,</span>
 <span class="mi">604</span><span class="p">:</span> <span class="s1">'hourglass'</span><span class="p">,</span>
 <span class="mi">605</span><span class="p">:</span> <span class="s1">'iPod'</span><span class="p">,</span>
 <span class="mi">606</span><span class="p">:</span> <span class="s1">'iron, smoothing iron'</span><span class="p">,</span>
 <span class="mi">607</span><span class="p">:</span> <span class="s2">"jack-o'-lantern"</span><span class="p">,</span>
 <span class="mi">608</span><span class="p">:</span> <span class="s1">'jean, blue jean, denim'</span><span class="p">,</span>
 <span class="mi">609</span><span class="p">:</span> <span class="s1">'jeep, landrover'</span><span class="p">,</span>
 <span class="mi">610</span><span class="p">:</span> <span class="s1">'jersey, T-shirt, tee shirt'</span><span class="p">,</span>
 <span class="mi">611</span><span class="p">:</span> <span class="s1">'jigsaw puzzle'</span><span class="p">,</span>
 <span class="mi">612</span><span class="p">:</span> <span class="s1">'jinrikisha, ricksha, rickshaw'</span><span class="p">,</span>
 <span class="mi">613</span><span class="p">:</span> <span class="s1">'joystick'</span><span class="p">,</span>
 <span class="mi">614</span><span class="p">:</span> <span class="s1">'kimono'</span><span class="p">,</span>
 <span class="mi">615</span><span class="p">:</span> <span class="s1">'knee pad'</span><span class="p">,</span>
 <span class="mi">616</span><span class="p">:</span> <span class="s1">'knot'</span><span class="p">,</span>
 <span class="mi">617</span><span class="p">:</span> <span class="s1">'lab coat, laboratory coat'</span><span class="p">,</span>
 <span class="mi">618</span><span class="p">:</span> <span class="s1">'ladle'</span><span class="p">,</span>
 <span class="mi">619</span><span class="p">:</span> <span class="s1">'lampshade, lamp shade'</span><span class="p">,</span>
 <span class="mi">620</span><span class="p">:</span> <span class="s1">'laptop, laptop computer'</span><span class="p">,</span>
 <span class="mi">621</span><span class="p">:</span> <span class="s1">'lawn mower, mower'</span><span class="p">,</span>
 <span class="mi">622</span><span class="p">:</span> <span class="s1">'lens cap, lens cover'</span><span class="p">,</span>
 <span class="mi">623</span><span class="p">:</span> <span class="s1">'letter opener, paper knife, paperknife'</span><span class="p">,</span>
 <span class="mi">624</span><span class="p">:</span> <span class="s1">'library'</span><span class="p">,</span>
 <span class="mi">625</span><span class="p">:</span> <span class="s1">'lifeboat'</span><span class="p">,</span>
 <span class="mi">626</span><span class="p">:</span> <span class="s1">'lighter, light, igniter, ignitor'</span><span class="p">,</span>
 <span class="mi">627</span><span class="p">:</span> <span class="s1">'limousine, limo'</span><span class="p">,</span>
 <span class="mi">628</span><span class="p">:</span> <span class="s1">'liner, ocean liner'</span><span class="p">,</span>
 <span class="mi">629</span><span class="p">:</span> <span class="s1">'lipstick, lip rouge'</span><span class="p">,</span>
 <span class="mi">630</span><span class="p">:</span> <span class="s1">'Loafer'</span><span class="p">,</span>
 <span class="mi">631</span><span class="p">:</span> <span class="s1">'lotion'</span><span class="p">,</span>
 <span class="mi">632</span><span class="p">:</span> <span class="s1">'loudspeaker, speaker, speaker unit, loudspeaker system, speaker system'</span><span class="p">,</span>
 <span class="mi">633</span><span class="p">:</span> <span class="s2">"loupe, jeweler's loupe"</span><span class="p">,</span>
 <span class="mi">634</span><span class="p">:</span> <span class="s1">'lumbermill, sawmill'</span><span class="p">,</span>
 <span class="mi">635</span><span class="p">:</span> <span class="s1">'magnetic compass'</span><span class="p">,</span>
 <span class="mi">636</span><span class="p">:</span> <span class="s1">'mailbag, postbag'</span><span class="p">,</span>
 <span class="mi">637</span><span class="p">:</span> <span class="s1">'mailbox, letter box'</span><span class="p">,</span>
 <span class="mi">638</span><span class="p">:</span> <span class="s1">'maillot'</span><span class="p">,</span>
 <span class="mi">639</span><span class="p">:</span> <span class="s1">'maillot, tank suit'</span><span class="p">,</span>
 <span class="mi">640</span><span class="p">:</span> <span class="s1">'manhole cover'</span><span class="p">,</span>
 <span class="mi">641</span><span class="p">:</span> <span class="s1">'maraca'</span><span class="p">,</span>
 <span class="mi">642</span><span class="p">:</span> <span class="s1">'marimba, xylophone'</span><span class="p">,</span>
 <span class="mi">643</span><span class="p">:</span> <span class="s1">'mask'</span><span class="p">,</span>
 <span class="mi">644</span><span class="p">:</span> <span class="s1">'matchstick'</span><span class="p">,</span>
 <span class="mi">645</span><span class="p">:</span> <span class="s1">'maypole'</span><span class="p">,</span>
 <span class="mi">646</span><span class="p">:</span> <span class="s1">'maze, labyrinth'</span><span class="p">,</span>
 <span class="mi">647</span><span class="p">:</span> <span class="s1">'measuring cup'</span><span class="p">,</span>
 <span class="mi">648</span><span class="p">:</span> <span class="s1">'medicine chest, medicine cabinet'</span><span class="p">,</span>
 <span class="mi">649</span><span class="p">:</span> <span class="s1">'megalith, megalithic structure'</span><span class="p">,</span>
 <span class="mi">650</span><span class="p">:</span> <span class="s1">'microphone, mike'</span><span class="p">,</span>
 <span class="mi">651</span><span class="p">:</span> <span class="s1">'microwave, microwave oven'</span><span class="p">,</span>
 <span class="mi">652</span><span class="p">:</span> <span class="s1">'military uniform'</span><span class="p">,</span>
 <span class="mi">653</span><span class="p">:</span> <span class="s1">'milk can'</span><span class="p">,</span>
 <span class="mi">654</span><span class="p">:</span> <span class="s1">'minibus'</span><span class="p">,</span>
 <span class="mi">655</span><span class="p">:</span> <span class="s1">'miniskirt, mini'</span><span class="p">,</span>
 <span class="mi">656</span><span class="p">:</span> <span class="s1">'minivan'</span><span class="p">,</span>
 <span class="mi">657</span><span class="p">:</span> <span class="s1">'missile'</span><span class="p">,</span>
 <span class="mi">658</span><span class="p">:</span> <span class="s1">'mitten'</span><span class="p">,</span>
 <span class="mi">659</span><span class="p">:</span> <span class="s1">'mixing bowl'</span><span class="p">,</span>
 <span class="mi">660</span><span class="p">:</span> <span class="s1">'mobile home, manufactured home'</span><span class="p">,</span>
 <span class="mi">661</span><span class="p">:</span> <span class="s1">'Model T'</span><span class="p">,</span>
 <span class="mi">662</span><span class="p">:</span> <span class="s1">'modem'</span><span class="p">,</span>
 <span class="mi">663</span><span class="p">:</span> <span class="s1">'monastery'</span><span class="p">,</span>
 <span class="mi">664</span><span class="p">:</span> <span class="s1">'monitor'</span><span class="p">,</span>
 <span class="mi">665</span><span class="p">:</span> <span class="s1">'moped'</span><span class="p">,</span>
 <span class="mi">666</span><span class="p">:</span> <span class="s1">'mortar'</span><span class="p">,</span>
 <span class="mi">667</span><span class="p">:</span> <span class="s1">'mortarboard'</span><span class="p">,</span>
 <span class="mi">668</span><span class="p">:</span> <span class="s1">'mosque'</span><span class="p">,</span>
 <span class="mi">669</span><span class="p">:</span> <span class="s1">'mosquito net'</span><span class="p">,</span>
 <span class="mi">670</span><span class="p">:</span> <span class="s1">'motor scooter, scooter'</span><span class="p">,</span>
 <span class="mi">671</span><span class="p">:</span> <span class="s1">'mountain bike, all-terrain bike, off-roader'</span><span class="p">,</span>
 <span class="mi">672</span><span class="p">:</span> <span class="s1">'mountain tent'</span><span class="p">,</span>
 <span class="mi">673</span><span class="p">:</span> <span class="s1">'mouse, computer mouse'</span><span class="p">,</span>
 <span class="mi">674</span><span class="p">:</span> <span class="s1">'mousetrap'</span><span class="p">,</span>
 <span class="mi">675</span><span class="p">:</span> <span class="s1">'moving van'</span><span class="p">,</span>
 <span class="mi">676</span><span class="p">:</span> <span class="s1">'muzzle'</span><span class="p">,</span>
 <span class="mi">677</span><span class="p">:</span> <span class="s1">'nail'</span><span class="p">,</span>
 <span class="mi">678</span><span class="p">:</span> <span class="s1">'neck brace'</span><span class="p">,</span>
 <span class="mi">679</span><span class="p">:</span> <span class="s1">'necklace'</span><span class="p">,</span>
 <span class="mi">680</span><span class="p">:</span> <span class="s1">'nipple'</span><span class="p">,</span>
 <span class="mi">681</span><span class="p">:</span> <span class="s1">'notebook, notebook computer'</span><span class="p">,</span>
 <span class="mi">682</span><span class="p">:</span> <span class="s1">'obelisk'</span><span class="p">,</span>
 <span class="mi">683</span><span class="p">:</span> <span class="s1">'oboe, hautboy, hautbois'</span><span class="p">,</span>
 <span class="mi">684</span><span class="p">:</span> <span class="s1">'ocarina, sweet potato'</span><span class="p">,</span>
 <span class="mi">685</span><span class="p">:</span> <span class="s1">'odometer, hodometer, mileometer, milometer'</span><span class="p">,</span>
 <span class="mi">686</span><span class="p">:</span> <span class="s1">'oil filter'</span><span class="p">,</span>
 <span class="mi">687</span><span class="p">:</span> <span class="s1">'organ, pipe organ'</span><span class="p">,</span>
 <span class="mi">688</span><span class="p">:</span> <span class="s1">'oscilloscope, scope, cathode-ray oscilloscope, CRO'</span><span class="p">,</span>
 <span class="mi">689</span><span class="p">:</span> <span class="s1">'overskirt'</span><span class="p">,</span>
 <span class="mi">690</span><span class="p">:</span> <span class="s1">'oxcart'</span><span class="p">,</span>
 <span class="mi">691</span><span class="p">:</span> <span class="s1">'oxygen mask'</span><span class="p">,</span>
 <span class="mi">692</span><span class="p">:</span> <span class="s1">'packet'</span><span class="p">,</span>
 <span class="mi">693</span><span class="p">:</span> <span class="s1">'paddle, boat paddle'</span><span class="p">,</span>
 <span class="mi">694</span><span class="p">:</span> <span class="s1">'paddlewheel, paddle wheel'</span><span class="p">,</span>
 <span class="mi">695</span><span class="p">:</span> <span class="s1">'padlock'</span><span class="p">,</span>
 <span class="mi">696</span><span class="p">:</span> <span class="s1">'paintbrush'</span><span class="p">,</span>
 <span class="mi">697</span><span class="p">:</span> <span class="s2">"pajama, pyjama, pj's, jammies"</span><span class="p">,</span>
 <span class="mi">698</span><span class="p">:</span> <span class="s1">'palace'</span><span class="p">,</span>
 <span class="mi">699</span><span class="p">:</span> <span class="s1">'panpipe, pandean pipe, syrinx'</span><span class="p">,</span>
 <span class="mi">700</span><span class="p">:</span> <span class="s1">'paper towel'</span><span class="p">,</span>
 <span class="mi">701</span><span class="p">:</span> <span class="s1">'parachute, chute'</span><span class="p">,</span>
 <span class="mi">702</span><span class="p">:</span> <span class="s1">'parallel bars, bars'</span><span class="p">,</span>
 <span class="mi">703</span><span class="p">:</span> <span class="s1">'park bench'</span><span class="p">,</span>
 <span class="mi">704</span><span class="p">:</span> <span class="s1">'parking meter'</span><span class="p">,</span>
 <span class="mi">705</span><span class="p">:</span> <span class="s1">'passenger car, coach, carriage'</span><span class="p">,</span>
 <span class="mi">706</span><span class="p">:</span> <span class="s1">'patio, terrace'</span><span class="p">,</span>
 <span class="mi">707</span><span class="p">:</span> <span class="s1">'pay-phone, pay-station'</span><span class="p">,</span>
 <span class="mi">708</span><span class="p">:</span> <span class="s1">'pedestal, plinth, footstall'</span><span class="p">,</span>
 <span class="mi">709</span><span class="p">:</span> <span class="s1">'pencil box, pencil case'</span><span class="p">,</span>
 <span class="mi">710</span><span class="p">:</span> <span class="s1">'pencil sharpener'</span><span class="p">,</span>
 <span class="mi">711</span><span class="p">:</span> <span class="s1">'perfume, essence'</span><span class="p">,</span>
 <span class="mi">712</span><span class="p">:</span> <span class="s1">'Petri dish'</span><span class="p">,</span>
 <span class="mi">713</span><span class="p">:</span> <span class="s1">'photocopier'</span><span class="p">,</span>
 <span class="mi">714</span><span class="p">:</span> <span class="s1">'pick, plectrum, plectron'</span><span class="p">,</span>
 <span class="mi">715</span><span class="p">:</span> <span class="s1">'pickelhaube'</span><span class="p">,</span>
 <span class="mi">716</span><span class="p">:</span> <span class="s1">'picket fence, paling'</span><span class="p">,</span>
 <span class="mi">717</span><span class="p">:</span> <span class="s1">'pickup, pickup truck'</span><span class="p">,</span>
 <span class="mi">718</span><span class="p">:</span> <span class="s1">'pier'</span><span class="p">,</span>
 <span class="mi">719</span><span class="p">:</span> <span class="s1">'piggy bank, penny bank'</span><span class="p">,</span>
 <span class="mi">720</span><span class="p">:</span> <span class="s1">'pill bottle'</span><span class="p">,</span>
 <span class="mi">721</span><span class="p">:</span> <span class="s1">'pillow'</span><span class="p">,</span>
 <span class="mi">722</span><span class="p">:</span> <span class="s1">'ping-pong ball'</span><span class="p">,</span>
 <span class="mi">723</span><span class="p">:</span> <span class="s1">'pinwheel'</span><span class="p">,</span>
 <span class="mi">724</span><span class="p">:</span> <span class="s1">'pirate, pirate ship'</span><span class="p">,</span>
 <span class="mi">725</span><span class="p">:</span> <span class="s1">'pitcher, ewer'</span><span class="p">,</span>
 <span class="mi">726</span><span class="p">:</span> <span class="s2">"plane, carpenter's plane, woodworking plane"</span><span class="p">,</span>
 <span class="mi">727</span><span class="p">:</span> <span class="s1">'planetarium'</span><span class="p">,</span>
 <span class="mi">728</span><span class="p">:</span> <span class="s1">'plastic bag'</span><span class="p">,</span>
 <span class="mi">729</span><span class="p">:</span> <span class="s1">'plate rack'</span><span class="p">,</span>
 <span class="mi">730</span><span class="p">:</span> <span class="s1">'plow, plough'</span><span class="p">,</span>
 <span class="mi">731</span><span class="p">:</span> <span class="s2">"plunger, plumber's helper"</span><span class="p">,</span>
 <span class="mi">732</span><span class="p">:</span> <span class="s1">'Polaroid camera, Polaroid Land camera'</span><span class="p">,</span>
 <span class="mi">733</span><span class="p">:</span> <span class="s1">'pole'</span><span class="p">,</span>
 <span class="mi">734</span><span class="p">:</span> <span class="s1">'police van, police wagon, paddy wagon, patrol wagon, wagon, black Maria'</span><span class="p">,</span>
 <span class="mi">735</span><span class="p">:</span> <span class="s1">'poncho'</span><span class="p">,</span>
 <span class="mi">736</span><span class="p">:</span> <span class="s1">'pool table, billiard table, snooker table'</span><span class="p">,</span>
 <span class="mi">737</span><span class="p">:</span> <span class="s1">'pop bottle, soda bottle'</span><span class="p">,</span>
 <span class="mi">738</span><span class="p">:</span> <span class="s1">'pot, flowerpot'</span><span class="p">,</span>
 <span class="mi">739</span><span class="p">:</span> <span class="s2">"potter's wheel"</span><span class="p">,</span>
 <span class="mi">740</span><span class="p">:</span> <span class="s1">'power drill'</span><span class="p">,</span>
 <span class="mi">741</span><span class="p">:</span> <span class="s1">'prayer rug, prayer mat'</span><span class="p">,</span>
 <span class="mi">742</span><span class="p">:</span> <span class="s1">'printer'</span><span class="p">,</span>
 <span class="mi">743</span><span class="p">:</span> <span class="s1">'prison, prison house'</span><span class="p">,</span>
 <span class="mi">744</span><span class="p">:</span> <span class="s1">'projectile, missile'</span><span class="p">,</span>
 <span class="mi">745</span><span class="p">:</span> <span class="s1">'projector'</span><span class="p">,</span>
 <span class="mi">746</span><span class="p">:</span> <span class="s1">'puck, hockey puck'</span><span class="p">,</span>
 <span class="mi">747</span><span class="p">:</span> <span class="s1">'punching bag, punch bag, punching ball, punchball'</span><span class="p">,</span>
 <span class="mi">748</span><span class="p">:</span> <span class="s1">'purse'</span><span class="p">,</span>
 <span class="mi">749</span><span class="p">:</span> <span class="s1">'quill, quill pen'</span><span class="p">,</span>
 <span class="mi">750</span><span class="p">:</span> <span class="s1">'quilt, comforter, comfort, puff'</span><span class="p">,</span>
 <span class="mi">751</span><span class="p">:</span> <span class="s1">'racer, race car, racing car'</span><span class="p">,</span>
 <span class="mi">752</span><span class="p">:</span> <span class="s1">'racket, racquet'</span><span class="p">,</span>
 <span class="mi">753</span><span class="p">:</span> <span class="s1">'radiator'</span><span class="p">,</span>
 <span class="mi">754</span><span class="p">:</span> <span class="s1">'radio, wireless'</span><span class="p">,</span>
 <span class="mi">755</span><span class="p">:</span> <span class="s1">'radio telescope, radio reflector'</span><span class="p">,</span>
 <span class="mi">756</span><span class="p">:</span> <span class="s1">'rain barrel'</span><span class="p">,</span>
 <span class="mi">757</span><span class="p">:</span> <span class="s1">'recreational vehicle, RV, R.V.'</span><span class="p">,</span>
 <span class="mi">758</span><span class="p">:</span> <span class="s1">'reel'</span><span class="p">,</span>
 <span class="mi">759</span><span class="p">:</span> <span class="s1">'reflex camera'</span><span class="p">,</span>
 <span class="mi">760</span><span class="p">:</span> <span class="s1">'refrigerator, icebox'</span><span class="p">,</span>
 <span class="mi">761</span><span class="p">:</span> <span class="s1">'remote control, remote'</span><span class="p">,</span>
 <span class="mi">762</span><span class="p">:</span> <span class="s1">'restaurant, eating house, eating place, eatery'</span><span class="p">,</span>
 <span class="mi">763</span><span class="p">:</span> <span class="s1">'revolver, six-gun, six-shooter'</span><span class="p">,</span>
 <span class="mi">764</span><span class="p">:</span> <span class="s1">'rifle'</span><span class="p">,</span>
 <span class="mi">765</span><span class="p">:</span> <span class="s1">'rocking chair, rocker'</span><span class="p">,</span>
 <span class="mi">766</span><span class="p">:</span> <span class="s1">'rotisserie'</span><span class="p">,</span>
 <span class="mi">767</span><span class="p">:</span> <span class="s1">'rubber eraser, rubber, pencil eraser'</span><span class="p">,</span>
 <span class="mi">768</span><span class="p">:</span> <span class="s1">'rugby ball'</span><span class="p">,</span>
 <span class="mi">769</span><span class="p">:</span> <span class="s1">'rule, ruler'</span><span class="p">,</span>
 <span class="mi">770</span><span class="p">:</span> <span class="s1">'running shoe'</span><span class="p">,</span>
 <span class="mi">771</span><span class="p">:</span> <span class="s1">'safe'</span><span class="p">,</span>
 <span class="mi">772</span><span class="p">:</span> <span class="s1">'safety pin'</span><span class="p">,</span>
 <span class="mi">773</span><span class="p">:</span> <span class="s1">'saltshaker, salt shaker'</span><span class="p">,</span>
 <span class="mi">774</span><span class="p">:</span> <span class="s1">'sandal'</span><span class="p">,</span>
 <span class="mi">775</span><span class="p">:</span> <span class="s1">'sarong'</span><span class="p">,</span>
 <span class="mi">776</span><span class="p">:</span> <span class="s1">'sax, saxophone'</span><span class="p">,</span>
 <span class="mi">777</span><span class="p">:</span> <span class="s1">'scabbard'</span><span class="p">,</span>
 <span class="mi">778</span><span class="p">:</span> <span class="s1">'scale, weighing machine'</span><span class="p">,</span>
 <span class="mi">779</span><span class="p">:</span> <span class="s1">'school bus'</span><span class="p">,</span>
 <span class="mi">780</span><span class="p">:</span> <span class="s1">'schooner'</span><span class="p">,</span>
 <span class="mi">781</span><span class="p">:</span> <span class="s1">'scoreboard'</span><span class="p">,</span>
 <span class="mi">782</span><span class="p">:</span> <span class="s1">'screen, CRT screen'</span><span class="p">,</span>
 <span class="mi">783</span><span class="p">:</span> <span class="s1">'screw'</span><span class="p">,</span>
 <span class="mi">784</span><span class="p">:</span> <span class="s1">'screwdriver'</span><span class="p">,</span>
 <span class="mi">785</span><span class="p">:</span> <span class="s1">'seat belt, seatbelt'</span><span class="p">,</span>
 <span class="mi">786</span><span class="p">:</span> <span class="s1">'sewing machine'</span><span class="p">,</span>
 <span class="mi">787</span><span class="p">:</span> <span class="s1">'shield, buckler'</span><span class="p">,</span>
 <span class="mi">788</span><span class="p">:</span> <span class="s1">'shoe shop, shoe-shop, shoe store'</span><span class="p">,</span>
 <span class="mi">789</span><span class="p">:</span> <span class="s1">'shoji'</span><span class="p">,</span>
 <span class="mi">790</span><span class="p">:</span> <span class="s1">'shopping basket'</span><span class="p">,</span>
 <span class="mi">791</span><span class="p">:</span> <span class="s1">'shopping cart'</span><span class="p">,</span>
 <span class="mi">792</span><span class="p">:</span> <span class="s1">'shovel'</span><span class="p">,</span>
 <span class="mi">793</span><span class="p">:</span> <span class="s1">'shower cap'</span><span class="p">,</span>
 <span class="mi">794</span><span class="p">:</span> <span class="s1">'shower curtain'</span><span class="p">,</span>
 <span class="mi">795</span><span class="p">:</span> <span class="s1">'ski'</span><span class="p">,</span>
 <span class="mi">796</span><span class="p">:</span> <span class="s1">'ski mask'</span><span class="p">,</span>
 <span class="mi">797</span><span class="p">:</span> <span class="s1">'sleeping bag'</span><span class="p">,</span>
 <span class="mi">798</span><span class="p">:</span> <span class="s1">'slide rule, slipstick'</span><span class="p">,</span>
 <span class="mi">799</span><span class="p">:</span> <span class="s1">'sliding door'</span><span class="p">,</span>
 <span class="mi">800</span><span class="p">:</span> <span class="s1">'slot, one-armed bandit'</span><span class="p">,</span>
 <span class="mi">801</span><span class="p">:</span> <span class="s1">'snorkel'</span><span class="p">,</span>
 <span class="mi">802</span><span class="p">:</span> <span class="s1">'snowmobile'</span><span class="p">,</span>
 <span class="mi">803</span><span class="p">:</span> <span class="s1">'snowplow, snowplough'</span><span class="p">,</span>
 <span class="mi">804</span><span class="p">:</span> <span class="s1">'soap dispenser'</span><span class="p">,</span>
 <span class="mi">805</span><span class="p">:</span> <span class="s1">'soccer ball'</span><span class="p">,</span>
 <span class="mi">806</span><span class="p">:</span> <span class="s1">'sock'</span><span class="p">,</span>
 <span class="mi">807</span><span class="p">:</span> <span class="s1">'solar dish, solar collector, solar furnace'</span><span class="p">,</span>
 <span class="mi">808</span><span class="p">:</span> <span class="s1">'sombrero'</span><span class="p">,</span>
 <span class="mi">809</span><span class="p">:</span> <span class="s1">'soup bowl'</span><span class="p">,</span>
 <span class="mi">810</span><span class="p">:</span> <span class="s1">'space bar'</span><span class="p">,</span>
 <span class="mi">811</span><span class="p">:</span> <span class="s1">'space heater'</span><span class="p">,</span>
 <span class="mi">812</span><span class="p">:</span> <span class="s1">'space shuttle'</span><span class="p">,</span>
 <span class="mi">813</span><span class="p">:</span> <span class="s1">'spatula'</span><span class="p">,</span>
 <span class="mi">814</span><span class="p">:</span> <span class="s1">'speedboat'</span><span class="p">,</span>
 <span class="mi">815</span><span class="p">:</span> <span class="s2">"spider web, spider's web"</span><span class="p">,</span>
 <span class="mi">816</span><span class="p">:</span> <span class="s1">'spindle'</span><span class="p">,</span>
 <span class="mi">817</span><span class="p">:</span> <span class="s1">'sports car, sport car'</span><span class="p">,</span>
 <span class="mi">818</span><span class="p">:</span> <span class="s1">'spotlight, spot'</span><span class="p">,</span>
 <span class="mi">819</span><span class="p">:</span> <span class="s1">'stage'</span><span class="p">,</span>
 <span class="mi">820</span><span class="p">:</span> <span class="s1">'steam locomotive'</span><span class="p">,</span>
 <span class="mi">821</span><span class="p">:</span> <span class="s1">'steel arch bridge'</span><span class="p">,</span>
 <span class="mi">822</span><span class="p">:</span> <span class="s1">'steel drum'</span><span class="p">,</span>
 <span class="mi">823</span><span class="p">:</span> <span class="s1">'stethoscope'</span><span class="p">,</span>
 <span class="mi">824</span><span class="p">:</span> <span class="s1">'stole'</span><span class="p">,</span>
 <span class="mi">825</span><span class="p">:</span> <span class="s1">'stone wall'</span><span class="p">,</span>
 <span class="mi">826</span><span class="p">:</span> <span class="s1">'stopwatch, stop watch'</span><span class="p">,</span>
 <span class="mi">827</span><span class="p">:</span> <span class="s1">'stove'</span><span class="p">,</span>
 <span class="mi">828</span><span class="p">:</span> <span class="s1">'strainer'</span><span class="p">,</span>
 <span class="mi">829</span><span class="p">:</span> <span class="s1">'streetcar, tram, tramcar, trolley, trolley car'</span><span class="p">,</span>
 <span class="mi">830</span><span class="p">:</span> <span class="s1">'stretcher'</span><span class="p">,</span>
 <span class="mi">831</span><span class="p">:</span> <span class="s1">'studio couch, day bed'</span><span class="p">,</span>
 <span class="mi">832</span><span class="p">:</span> <span class="s1">'stupa, tope'</span><span class="p">,</span>
 <span class="mi">833</span><span class="p">:</span> <span class="s1">'submarine, pigboat, sub, U-boat'</span><span class="p">,</span>
 <span class="mi">834</span><span class="p">:</span> <span class="s1">'suit, suit of clothes'</span><span class="p">,</span>
 <span class="mi">835</span><span class="p">:</span> <span class="s1">'sundial'</span><span class="p">,</span>
 <span class="mi">836</span><span class="p">:</span> <span class="s1">'sunglass'</span><span class="p">,</span>
 <span class="mi">837</span><span class="p">:</span> <span class="s1">'sunglasses, dark glasses, shades'</span><span class="p">,</span>
 <span class="mi">838</span><span class="p">:</span> <span class="s1">'sunscreen, sunblock, sun blocker'</span><span class="p">,</span>
 <span class="mi">839</span><span class="p">:</span> <span class="s1">'suspension bridge'</span><span class="p">,</span>
 <span class="mi">840</span><span class="p">:</span> <span class="s1">'swab, swob, mop'</span><span class="p">,</span>
 <span class="mi">841</span><span class="p">:</span> <span class="s1">'sweatshirt'</span><span class="p">,</span>
 <span class="mi">842</span><span class="p">:</span> <span class="s1">'swimming trunks, bathing trunks'</span><span class="p">,</span>
 <span class="mi">843</span><span class="p">:</span> <span class="s1">'swing'</span><span class="p">,</span>
 <span class="mi">844</span><span class="p">:</span> <span class="s1">'switch, electric switch, electrical switch'</span><span class="p">,</span>
 <span class="mi">845</span><span class="p">:</span> <span class="s1">'syringe'</span><span class="p">,</span>
 <span class="mi">846</span><span class="p">:</span> <span class="s1">'table lamp'</span><span class="p">,</span>
 <span class="mi">847</span><span class="p">:</span> <span class="s1">'tank, army tank, armored combat vehicle, armoured combat vehicle'</span><span class="p">,</span>
 <span class="mi">848</span><span class="p">:</span> <span class="s1">'tape player'</span><span class="p">,</span>
 <span class="mi">849</span><span class="p">:</span> <span class="s1">'teapot'</span><span class="p">,</span>
 <span class="mi">850</span><span class="p">:</span> <span class="s1">'teddy, teddy bear'</span><span class="p">,</span>
 <span class="mi">851</span><span class="p">:</span> <span class="s1">'television, television system'</span><span class="p">,</span>
 <span class="mi">852</span><span class="p">:</span> <span class="s1">'tennis ball'</span><span class="p">,</span>
 <span class="mi">853</span><span class="p">:</span> <span class="s1">'thatch, thatched roof'</span><span class="p">,</span>
 <span class="mi">854</span><span class="p">:</span> <span class="s1">'theater curtain, theatre curtain'</span><span class="p">,</span>
 <span class="mi">855</span><span class="p">:</span> <span class="s1">'thimble'</span><span class="p">,</span>
 <span class="mi">856</span><span class="p">:</span> <span class="s1">'thresher, thrasher, threshing machine'</span><span class="p">,</span>
 <span class="mi">857</span><span class="p">:</span> <span class="s1">'throne'</span><span class="p">,</span>
 <span class="mi">858</span><span class="p">:</span> <span class="s1">'tile roof'</span><span class="p">,</span>
 <span class="mi">859</span><span class="p">:</span> <span class="s1">'toaster'</span><span class="p">,</span>
 <span class="mi">860</span><span class="p">:</span> <span class="s1">'tobacco shop, tobacconist shop, tobacconist'</span><span class="p">,</span>
 <span class="mi">861</span><span class="p">:</span> <span class="s1">'toilet seat'</span><span class="p">,</span>
 <span class="mi">862</span><span class="p">:</span> <span class="s1">'torch'</span><span class="p">,</span>
 <span class="mi">863</span><span class="p">:</span> <span class="s1">'totem pole'</span><span class="p">,</span>
 <span class="mi">864</span><span class="p">:</span> <span class="s1">'tow truck, tow car, wrecker'</span><span class="p">,</span>
 <span class="mi">865</span><span class="p">:</span> <span class="s1">'toyshop'</span><span class="p">,</span>
 <span class="mi">866</span><span class="p">:</span> <span class="s1">'tractor'</span><span class="p">,</span>
 <span class="mi">867</span><span class="p">:</span> <span class="s1">'trailer truck, tractor trailer, trucking rig, rig, articulated lorry, semi'</span><span class="p">,</span>
 <span class="mi">868</span><span class="p">:</span> <span class="s1">'tray'</span><span class="p">,</span>
 <span class="mi">869</span><span class="p">:</span> <span class="s1">'trench coat'</span><span class="p">,</span>
 <span class="mi">870</span><span class="p">:</span> <span class="s1">'tricycle, trike, velocipede'</span><span class="p">,</span>
 <span class="mi">871</span><span class="p">:</span> <span class="s1">'trimaran'</span><span class="p">,</span>
 <span class="mi">872</span><span class="p">:</span> <span class="s1">'tripod'</span><span class="p">,</span>
 <span class="mi">873</span><span class="p">:</span> <span class="s1">'triumphal arch'</span><span class="p">,</span>
 <span class="mi">874</span><span class="p">:</span> <span class="s1">'trolleybus, trolley coach, trackless trolley'</span><span class="p">,</span>
 <span class="mi">875</span><span class="p">:</span> <span class="s1">'trombone'</span><span class="p">,</span>
 <span class="mi">876</span><span class="p">:</span> <span class="s1">'tub, vat'</span><span class="p">,</span>
 <span class="mi">877</span><span class="p">:</span> <span class="s1">'turnstile'</span><span class="p">,</span>
 <span class="mi">878</span><span class="p">:</span> <span class="s1">'typewriter keyboard'</span><span class="p">,</span>
 <span class="mi">879</span><span class="p">:</span> <span class="s1">'umbrella'</span><span class="p">,</span>
 <span class="mi">880</span><span class="p">:</span> <span class="s1">'unicycle, monocycle'</span><span class="p">,</span>
 <span class="mi">881</span><span class="p">:</span> <span class="s1">'upright, upright piano'</span><span class="p">,</span>
 <span class="mi">882</span><span class="p">:</span> <span class="s1">'vacuum, vacuum cleaner'</span><span class="p">,</span>
 <span class="mi">883</span><span class="p">:</span> <span class="s1">'vase'</span><span class="p">,</span>
 <span class="mi">884</span><span class="p">:</span> <span class="s1">'vault'</span><span class="p">,</span>
 <span class="mi">885</span><span class="p">:</span> <span class="s1">'velvet'</span><span class="p">,</span>
 <span class="mi">886</span><span class="p">:</span> <span class="s1">'vending machine'</span><span class="p">,</span>
 <span class="mi">887</span><span class="p">:</span> <span class="s1">'vestment'</span><span class="p">,</span>
 <span class="mi">888</span><span class="p">:</span> <span class="s1">'viaduct'</span><span class="p">,</span>
 <span class="mi">889</span><span class="p">:</span> <span class="s1">'violin, fiddle'</span><span class="p">,</span>
 <span class="mi">890</span><span class="p">:</span> <span class="s1">'volleyball'</span><span class="p">,</span>
 <span class="mi">891</span><span class="p">:</span> <span class="s1">'waffle iron'</span><span class="p">,</span>
 <span class="mi">892</span><span class="p">:</span> <span class="s1">'wall clock'</span><span class="p">,</span>
 <span class="mi">893</span><span class="p">:</span> <span class="s1">'wallet, billfold, notecase, pocketbook'</span><span class="p">,</span>
 <span class="mi">894</span><span class="p">:</span> <span class="s1">'wardrobe, closet, press'</span><span class="p">,</span>
 <span class="mi">895</span><span class="p">:</span> <span class="s1">'warplane, military plane'</span><span class="p">,</span>
 <span class="mi">896</span><span class="p">:</span> <span class="s1">'washbasin, handbasin, washbowl, lavabo, wash-hand basin'</span><span class="p">,</span>
 <span class="mi">897</span><span class="p">:</span> <span class="s1">'washer, automatic washer, washing machine'</span><span class="p">,</span>
 <span class="mi">898</span><span class="p">:</span> <span class="s1">'water bottle'</span><span class="p">,</span>
 <span class="mi">899</span><span class="p">:</span> <span class="s1">'water jug'</span><span class="p">,</span>
 <span class="mi">900</span><span class="p">:</span> <span class="s1">'water tower'</span><span class="p">,</span>
 <span class="mi">901</span><span class="p">:</span> <span class="s1">'whiskey jug'</span><span class="p">,</span>
 <span class="mi">902</span><span class="p">:</span> <span class="s1">'whistle'</span><span class="p">,</span>
 <span class="mi">903</span><span class="p">:</span> <span class="s1">'wig'</span><span class="p">,</span>
 <span class="mi">904</span><span class="p">:</span> <span class="s1">'window screen'</span><span class="p">,</span>
 <span class="mi">905</span><span class="p">:</span> <span class="s1">'window shade'</span><span class="p">,</span>
 <span class="mi">906</span><span class="p">:</span> <span class="s1">'Windsor tie'</span><span class="p">,</span>
 <span class="mi">907</span><span class="p">:</span> <span class="s1">'wine bottle'</span><span class="p">,</span>
 <span class="mi">908</span><span class="p">:</span> <span class="s1">'wing'</span><span class="p">,</span>
 <span class="mi">909</span><span class="p">:</span> <span class="s1">'wok'</span><span class="p">,</span>
 <span class="mi">910</span><span class="p">:</span> <span class="s1">'wooden spoon'</span><span class="p">,</span>
 <span class="mi">911</span><span class="p">:</span> <span class="s1">'wool, woolen, woollen'</span><span class="p">,</span>
 <span class="mi">912</span><span class="p">:</span> <span class="s1">'worm fence, snake fence, snake-rail fence, Virginia fence'</span><span class="p">,</span>
 <span class="mi">913</span><span class="p">:</span> <span class="s1">'wreck'</span><span class="p">,</span>
 <span class="mi">914</span><span class="p">:</span> <span class="s1">'yawl'</span><span class="p">,</span>
 <span class="mi">915</span><span class="p">:</span> <span class="s1">'yurt'</span><span class="p">,</span>
 <span class="mi">916</span><span class="p">:</span> <span class="s1">'web site, website, internet site, site'</span><span class="p">,</span>
 <span class="mi">917</span><span class="p">:</span> <span class="s1">'comic book'</span><span class="p">,</span>
 <span class="mi">918</span><span class="p">:</span> <span class="s1">'crossword puzzle, crossword'</span><span class="p">,</span>
 <span class="mi">919</span><span class="p">:</span> <span class="s1">'street sign'</span><span class="p">,</span>
 <span class="mi">920</span><span class="p">:</span> <span class="s1">'traffic light, traffic signal, stoplight'</span><span class="p">,</span>
 <span class="mi">921</span><span class="p">:</span> <span class="s1">'book jacket, dust cover, dust jacket, dust wrapper'</span><span class="p">,</span>
 <span class="mi">922</span><span class="p">:</span> <span class="s1">'menu'</span><span class="p">,</span>
 <span class="mi">923</span><span class="p">:</span> <span class="s1">'plate'</span><span class="p">,</span>
 <span class="mi">924</span><span class="p">:</span> <span class="s1">'guacamole'</span><span class="p">,</span>
 <span class="mi">925</span><span class="p">:</span> <span class="s1">'consomme'</span><span class="p">,</span>
 <span class="mi">926</span><span class="p">:</span> <span class="s1">'hot pot, hotpot'</span><span class="p">,</span>
 <span class="mi">927</span><span class="p">:</span> <span class="s1">'trifle'</span><span class="p">,</span>
 <span class="mi">928</span><span class="p">:</span> <span class="s1">'ice cream, icecream'</span><span class="p">,</span>
 <span class="mi">929</span><span class="p">:</span> <span class="s1">'ice lolly, lolly, lollipop, popsicle'</span><span class="p">,</span>
 <span class="mi">930</span><span class="p">:</span> <span class="s1">'French loaf'</span><span class="p">,</span>
 <span class="mi">931</span><span class="p">:</span> <span class="s1">'bagel, beigel'</span><span class="p">,</span>
 <span class="mi">932</span><span class="p">:</span> <span class="s1">'pretzel'</span><span class="p">,</span>
 <span class="mi">933</span><span class="p">:</span> <span class="s1">'cheeseburger'</span><span class="p">,</span>
 <span class="mi">934</span><span class="p">:</span> <span class="s1">'hotdog, hot dog, red hot'</span><span class="p">,</span>
 <span class="mi">935</span><span class="p">:</span> <span class="s1">'mashed potato'</span><span class="p">,</span>
 <span class="mi">936</span><span class="p">:</span> <span class="s1">'head cabbage'</span><span class="p">,</span>
 <span class="mi">937</span><span class="p">:</span> <span class="s1">'broccoli'</span><span class="p">,</span>
 <span class="mi">938</span><span class="p">:</span> <span class="s1">'cauliflower'</span><span class="p">,</span>
 <span class="mi">939</span><span class="p">:</span> <span class="s1">'zucchini, courgette'</span><span class="p">,</span>
 <span class="mi">940</span><span class="p">:</span> <span class="s1">'spaghetti squash'</span><span class="p">,</span>
 <span class="mi">941</span><span class="p">:</span> <span class="s1">'acorn squash'</span><span class="p">,</span>
 <span class="mi">942</span><span class="p">:</span> <span class="s1">'butternut squash'</span><span class="p">,</span>
 <span class="mi">943</span><span class="p">:</span> <span class="s1">'cucumber, cuke'</span><span class="p">,</span>
 <span class="mi">944</span><span class="p">:</span> <span class="s1">'artichoke, globe artichoke'</span><span class="p">,</span>
 <span class="mi">945</span><span class="p">:</span> <span class="s1">'bell pepper'</span><span class="p">,</span>
 <span class="mi">946</span><span class="p">:</span> <span class="s1">'cardoon'</span><span class="p">,</span>
 <span class="mi">947</span><span class="p">:</span> <span class="s1">'mushroom'</span><span class="p">,</span>
 <span class="mi">948</span><span class="p">:</span> <span class="s1">'Granny Smith'</span><span class="p">,</span>
 <span class="mi">949</span><span class="p">:</span> <span class="s1">'strawberry'</span><span class="p">,</span>
 <span class="mi">950</span><span class="p">:</span> <span class="s1">'orange'</span><span class="p">,</span>
 <span class="mi">951</span><span class="p">:</span> <span class="s1">'lemon'</span><span class="p">,</span>
 <span class="mi">952</span><span class="p">:</span> <span class="s1">'fig'</span><span class="p">,</span>
 <span class="mi">953</span><span class="p">:</span> <span class="s1">'pineapple, ananas'</span><span class="p">,</span>
 <span class="mi">954</span><span class="p">:</span> <span class="s1">'banana'</span><span class="p">,</span>
 <span class="mi">955</span><span class="p">:</span> <span class="s1">'jackfruit, jak, jack'</span><span class="p">,</span>
 <span class="mi">956</span><span class="p">:</span> <span class="s1">'custard apple'</span><span class="p">,</span>
 <span class="mi">957</span><span class="p">:</span> <span class="s1">'pomegranate'</span><span class="p">,</span>
 <span class="mi">958</span><span class="p">:</span> <span class="s1">'hay'</span><span class="p">,</span>
 <span class="mi">959</span><span class="p">:</span> <span class="s1">'carbonara'</span><span class="p">,</span>
 <span class="mi">960</span><span class="p">:</span> <span class="s1">'chocolate sauce, chocolate syrup'</span><span class="p">,</span>
 <span class="mi">961</span><span class="p">:</span> <span class="s1">'dough'</span><span class="p">,</span>
 <span class="mi">962</span><span class="p">:</span> <span class="s1">'meat loaf, meatloaf'</span><span class="p">,</span>
 <span class="mi">963</span><span class="p">:</span> <span class="s1">'pizza, pizza pie'</span><span class="p">,</span>
 <span class="mi">964</span><span class="p">:</span> <span class="s1">'potpie'</span><span class="p">,</span>
 <span class="mi">965</span><span class="p">:</span> <span class="s1">'burrito'</span><span class="p">,</span>
 <span class="mi">966</span><span class="p">:</span> <span class="s1">'red wine'</span><span class="p">,</span>
 <span class="mi">967</span><span class="p">:</span> <span class="s1">'espresso'</span><span class="p">,</span>
 <span class="mi">968</span><span class="p">:</span> <span class="s1">'cup'</span><span class="p">,</span>
 <span class="mi">969</span><span class="p">:</span> <span class="s1">'eggnog'</span><span class="p">,</span>
 <span class="mi">970</span><span class="p">:</span> <span class="s1">'alp'</span><span class="p">,</span>
 <span class="mi">971</span><span class="p">:</span> <span class="s1">'bubble'</span><span class="p">,</span>
 <span class="mi">972</span><span class="p">:</span> <span class="s1">'cliff, drop, drop-off'</span><span class="p">,</span>
 <span class="mi">973</span><span class="p">:</span> <span class="s1">'coral reef'</span><span class="p">,</span>
 <span class="mi">974</span><span class="p">:</span> <span class="s1">'geyser'</span><span class="p">,</span>
 <span class="mi">975</span><span class="p">:</span> <span class="s1">'lakeside, lakeshore'</span><span class="p">,</span>
 <span class="mi">976</span><span class="p">:</span> <span class="s1">'promontory, headland, head, foreland'</span><span class="p">,</span>
 <span class="mi">977</span><span class="p">:</span> <span class="s1">'sandbar, sand bar'</span><span class="p">,</span>
 <span class="mi">978</span><span class="p">:</span> <span class="s1">'seashore, coast, seacoast, sea-coast'</span><span class="p">,</span>
 <span class="mi">979</span><span class="p">:</span> <span class="s1">'valley, vale'</span><span class="p">,</span>
 <span class="mi">980</span><span class="p">:</span> <span class="s1">'volcano'</span><span class="p">,</span>
 <span class="mi">981</span><span class="p">:</span> <span class="s1">'ballplayer, baseball player'</span><span class="p">,</span>
 <span class="mi">982</span><span class="p">:</span> <span class="s1">'groom, bridegroom'</span><span class="p">,</span>
 <span class="mi">983</span><span class="p">:</span> <span class="s1">'scuba diver'</span><span class="p">,</span>
 <span class="mi">984</span><span class="p">:</span> <span class="s1">'rapeseed'</span><span class="p">,</span>
 <span class="mi">985</span><span class="p">:</span> <span class="s1">'daisy'</span><span class="p">,</span>
 <span class="mi">986</span><span class="p">:</span> <span class="s2">"yellow lady's slipper, yellow lady-slipper, Cypripedium calceolus, Cypripedium parviflorum"</span><span class="p">,</span>
 <span class="mi">987</span><span class="p">:</span> <span class="s1">'corn'</span><span class="p">,</span>
 <span class="mi">988</span><span class="p">:</span> <span class="s1">'acorn'</span><span class="p">,</span>
 <span class="mi">989</span><span class="p">:</span> <span class="s1">'hip, rose hip, rosehip'</span><span class="p">,</span>
 <span class="mi">990</span><span class="p">:</span> <span class="s1">'buckeye, horse chestnut, conker'</span><span class="p">,</span>
 <span class="mi">991</span><span class="p">:</span> <span class="s1">'coral fungus'</span><span class="p">,</span>
 <span class="mi">992</span><span class="p">:</span> <span class="s1">'agaric'</span><span class="p">,</span>
 <span class="mi">993</span><span class="p">:</span> <span class="s1">'gyromitra'</span><span class="p">,</span>
 <span class="mi">994</span><span class="p">:</span> <span class="s1">'stinkhorn, carrion fungus'</span><span class="p">,</span>
 <span class="mi">995</span><span class="p">:</span> <span class="s1">'earthstar'</span><span class="p">,</span>
 <span class="mi">996</span><span class="p">:</span> <span class="s1">'hen-of-the-woods, hen of the woods, Polyporus frondosus, Grifola frondosa'</span><span class="p">,</span>
 <span class="mi">997</span><span class="p">:</span> <span class="s1">'bolete'</span><span class="p">,</span>
 <span class="mi">998</span><span class="p">:</span> <span class="s1">'ear, spike, capitulum'</span><span class="p">,</span>
 <span class="mi">999</span><span class="p">:</span> <span class="s1">'toilet tissue, toilet paper, bathroom tissue'</span><span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="map-imagenette-labels-to-imagenet-labels">
<h2>Map Imagenette Labels to Imagenet Labels<a class="headerlink" href="#map-imagenette-labels-to-imagenet-labels" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Map Imagenette Labels to Imagenet Labels</span>
<span class="n">dir_to_imagenet_index</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'n03888257'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">'n03425413'</span><span class="p">:</span> <span class="mi">571</span><span class="p">,</span>
    <span class="s1">'n03394916'</span><span class="p">:</span> <span class="mi">566</span><span class="p">,</span>
    <span class="s1">'n03000684'</span><span class="p">:</span> <span class="mi">491</span><span class="p">,</span>
    <span class="s1">'n02102040'</span><span class="p">:</span> <span class="mi">217</span><span class="p">,</span>
    <span class="s1">'n03445777'</span><span class="p">:</span> <span class="mi">574</span><span class="p">,</span>
    <span class="s1">'n03417042'</span><span class="p">:</span> <span class="mi">569</span><span class="p">,</span>
    <span class="s1">'n03028079'</span><span class="p">:</span> <span class="mi">497</span><span class="p">,</span>
    <span class="s1">'n02979186'</span><span class="p">:</span> <span class="mi">482</span><span class="p">,</span>
    <span class="s1">'n01440764'</span><span class="p">:</span> <span class="mi">701</span>
    <span class="p">}</span>

<span class="n">dir_index_to_imagenet_label</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">ordered_dirs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dir_to_imagenet_index</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>

<span class="k">for</span> <span class="n">dir_index</span><span class="p">,</span> <span class="n">dir_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ordered_dirs</span><span class="p">):</span>
  <span class="n">dir_index_to_imagenet_label</span><span class="p">[</span><span class="n">dir_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">dir_to_imagenet_index</span><span class="p">[</span><span class="n">dir_name</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="prepare-imagenette-data">
<h2>Prepare Imagenette Data<a class="headerlink" href="#prepare-imagenette-data" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Prepare Imagenette Data</span>
<span class="n">val_transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">((</span><span class="n">transforms</span><span class="o">.</span><span class="n">Resize</span><span class="p">((</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">)),</span>
                                    <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">()))</span>

<span class="n">imagenette_val</span> <span class="o">=</span> <span class="n">ImageFolder</span><span class="p">(</span><span class="s1">'imagenette2-320/val'</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">val_transform</span><span class="p">)</span>

<span class="n">train_transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">((</span><span class="n">transforms</span><span class="o">.</span><span class="n">Resize</span><span class="p">((</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">)),</span>
                                      <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">()))</span>

<span class="n">imagenette_train</span> <span class="o">=</span> <span class="n">ImageFolder</span><span class="p">(</span><span class="s1">'imagenette2-320/train'</span><span class="p">,</span>
                               <span class="n">transform</span><span class="o">=</span><span class="n">train_transform</span><span class="p">)</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">SEED</span><span class="p">)</span>
<span class="n">random_indices</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">imagenette_train</span><span class="p">)),</span> <span class="mi">400</span><span class="p">)</span>
<span class="n">imagenette_train_subset</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Subset</span><span class="p">(</span><span class="n">imagenette_train</span><span class="p">,</span>
                                                  <span class="n">random_indices</span><span class="p">)</span>




<span class="c1"># Subset to only one tenth of the data for faster runtime</span>
<span class="n">random_indices</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">imagenette_val</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">imagenette_val</span><span class="p">)</span> <span class="o">*</span> <span class="mf">.1</span><span class="p">))</span>
<span class="n">imagenette_val</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Subset</span><span class="p">(</span><span class="n">imagenette_val</span><span class="p">,</span> <span class="n">random_indices</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># To preserve reproducibility</span>
<span class="n">g_seed</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Generator</span><span class="p">()</span>
<span class="n">g_seed</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">SEED</span><span class="p">)</span>

<span class="n">imagenette_train_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">imagenette_train_subset</span><span class="p">,</span>
                                                      <span class="n">batch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
                                                      <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                      <span class="n">num_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                                      <span class="n">worker_init_fn</span><span class="o">=</span><span class="n">seed_worker</span><span class="p">,</span>
                                                      <span class="n">generator</span><span class="o">=</span><span class="n">g_seed</span>
                                                      <span class="p">)</span>

<span class="n">imagenette_val_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">imagenette_val</span><span class="p">,</span>
                                                    <span class="n">batch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
                                                    <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                    <span class="n">num_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                                    <span class="n">worker_init_fn</span><span class="o">=</span><span class="n">seed_worker</span><span class="p">,</span>
                                                    <span class="n">generator</span><span class="o">=</span><span class="n">g_seed</span><span class="p">)</span>

<span class="n">dataiter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">imagenette_val_loader</span><span class="p">)</span>
<span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">dataiter</span><span class="p">)</span>

<span class="c1"># Show images</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">make_grid</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">nrow</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">'off'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/4e759aba82faecd7b68e0ea26f21f92c11c610a7b3e0439901302f805fac2633.png" src="../../../_images/4e759aba82faecd7b68e0ea26f21f92c11c610a7b3e0439901302f805fac2633.png">
</img></div>
</div>
</section>
<section id="eval-imagenette-function">
<h2>eval_imagenette function<a class="headerlink" href="#eval-imagenette-function" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title eval_imagenette function</span>
<span class="k">def</span> <span class="nf">eval_imagenette</span><span class="p">(</span><span class="n">resnet</span><span class="p">,</span> <span class="n">data_loader</span><span class="p">,</span> <span class="n">dataset_length</span><span class="p">,</span> <span class="n">device</span><span class="p">):</span>
  <span class="n">resnet</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
  <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">loss_sum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">total_1_correct</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">total_5_correct</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">total</span> <span class="o">=</span> <span class="n">dataset_length</span>
    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="n">data_loader</span><span class="p">):</span>
      <span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">batch</span>

      <span class="c1"># Map the imagenette labels onto the network's output</span>
      <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
          <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dir_index_to_imagenet_label</span><span class="p">[</span><span class="n">label</span><span class="o">.</span><span class="n">item</span><span class="p">()]</span>

      <span class="n">images</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
      <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
      <span class="n">output</span> <span class="o">=</span> <span class="n">resnet</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>

      <span class="c1"># Calculate top-5 accuracy</span>
      <span class="c1"># Implementation from https://github.com/bearpaw/pytorch-classification/blob/cc9106d598ff1fe375cc030873ceacfea0499d77/utils/eval.py</span>
      <span class="n">batch_size</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

      <span class="n">_</span><span class="p">,</span> <span class="n">predictions</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">topk</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
      <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictions</span><span class="o">.</span><span class="n">t</span><span class="p">()</span>

      <span class="n">top_k_correct</span> <span class="o">=</span> <span class="n">predictions</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">labels</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">expand_as</span><span class="p">(</span><span class="n">predictions</span><span class="p">))</span>
      <span class="n">top_k_correct</span> <span class="o">=</span> <span class="n">top_k_correct</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

      <span class="n">predictions</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">top_1_correct</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">predictions</span> <span class="o">==</span> <span class="n">labels</span><span class="p">)</span>
      <span class="n">total_1_correct</span> <span class="o">+=</span> <span class="n">top_1_correct</span>
      <span class="n">total_5_correct</span> <span class="o">+=</span> <span class="n">top_k_correct</span>

    <span class="n">top_1_acc</span> <span class="o">=</span> <span class="n">total_1_correct</span> <span class="o">/</span> <span class="n">total</span>
    <span class="n">top_5_acc</span> <span class="o">=</span> <span class="n">total_5_correct</span> <span class="o">/</span> <span class="n">total</span>

    <span class="k">return</span> <span class="n">top_1_acc</span><span class="p">,</span> <span class="n">top_5_acc</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="imagenette-train-loop">
<h2>Imagenette Train Loop<a class="headerlink" href="#imagenette-train-loop" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Imagenette Train Loop</span>

<span class="k">def</span> <span class="nf">imagenette_train_loop</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">train_loader</span><span class="p">,</span>
                          <span class="n">loss_fn</span><span class="p">,</span> <span class="n">device</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Training loop for Imagenette</span>

<span class="sd">  Args:</span>
<span class="sd">    model: nn.module</span>
<span class="sd">      Untrained model</span>
<span class="sd">    optimizer: function</span>
<span class="sd">      Optimizer</span>
<span class="sd">    train_loader: torch.loader</span>
<span class="sd">      Training loader</span>
<span class="sd">    loss_fn: function</span>
<span class="sd">      Criterion</span>
<span class="sd">    device: string</span>
<span class="sd">      If available, GPU/CUDA. CPU otherwise</span>

<span class="sd">  Returns:</span>
<span class="sd">    model: nn.module</span>
<span class="sd">      Trained model</span>
<span class="sd">  """</span>
  <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)):</span>
    <span class="c1"># Set model to use the imagenette classifier head</span>
    <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
    <span class="c1"># Train on a batch of images</span>
    <span class="k">for</span> <span class="n">imagenette_batch</span> <span class="ow">in</span> <span class="n">train_loader</span><span class="p">:</span>
      <span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">imagenette_batch</span>

      <span class="c1"># Convert labels from imagenette indices to imagenet labels</span>
      <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
        <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dir_index_to_imagenet_label</span><span class="p">[</span><span class="n">label</span><span class="o">.</span><span class="n">item</span><span class="p">()]</span>

      <span class="n">images</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
      <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
      <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
      <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
      <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
      <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
      <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

  <span class="k">return</span> <span class="n">model</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>This cell creates a ResNet model pretrained on <a class="reference external" href="http://www.image-net.org/">ImageNet</a>, a 1000 class image prediction dataset. The model is then trained to make predictions on <a class="reference external" href="https://github.com/fastai/imagenette">Imagenette</a>, a small subset of ImageNet classes that is useful for demonstrations and prototyping.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Original network</span>
<span class="n">top_1_accuracies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">top_5_accuracies</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Instantiate a pretrained resnet model</span>
<span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
<span class="n">resnet</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">resnet18</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="s1">'ResNet18_Weights.DEFAULT'</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
<span class="n">resnet_opt</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">resnet</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">)</span>
<span class="n">loss_fn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>

<span class="n">imagenette_train_loop</span><span class="p">(</span><span class="n">resnet</span><span class="p">,</span>
                      <span class="n">resnet_opt</span><span class="p">,</span>
                      <span class="n">imagenette_train_loader</span><span class="p">,</span>
                      <span class="n">loss_fn</span><span class="p">,</span>
                      <span class="n">device</span><span class="o">=</span><span class="n">DEVICE</span><span class="p">)</span>

<span class="n">top_1_acc</span><span class="p">,</span> <span class="n">top_5_acc</span> <span class="o">=</span> <span class="n">eval_imagenette</span><span class="p">(</span><span class="n">resnet</span><span class="p">,</span>
                                       <span class="n">imagenette_val_loader</span><span class="p">,</span>
                                       <span class="nb">len</span><span class="p">(</span><span class="n">imagenette_val</span><span class="p">),</span>
                                       <span class="n">device</span><span class="o">=</span><span class="n">DEVICE</span><span class="p">)</span>
<span class="n">top_1_accuracies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">top_1_acc</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
<span class="n">top_5_accuracies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">top_5_acc</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Random seed 2021 has been set.
</pre></div>
</div>
</div>
</div>
</section>
<section id="coding-exercise-4-1-use-the-resnet-model">
<h2>Coding Exercise 4.1: Use the ResNet model<a class="headerlink" href="#coding-exercise-4-1-use-the-resnet-model" title="Permalink to this heading">#</a></h2>
<p>Complete the function below that runs a batch of images through the trained ResNet and returns the Top 5 class predictions and their probabilities. Note that the ResNet model returns unnormalized logits<span class="math notranslate nohighlight">\(^\dagger\)</span>. To obtain probabilities, you need to normalize the logits using softmax.</p>
<br/>
<p><span class="math notranslate nohighlight">\(^\dagger\)</span> <span class="math notranslate nohighlight">\( \text{logit}(p) = \sigma^{-1}(p) = \text{log} \left( \frac{p}{1-p} \right), \, \text{for} \, p \in (0,1)\)</span>, where <span class="math notranslate nohighlight">\(\sigma(\cdot)\)</span> is the sigmoid function, i.e., <span class="math notranslate nohighlight">\(\sigma(z) = 1/(1+e^{-z})\)</span>. For more information see <a class="reference external" href="http://machinelearningmechanic.com/deep_learning/2019/09/04/cross-entropy-loss-derivative.html">here</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">predict_top5</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">seed</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Function to predict top 5 classes</span>

<span class="sd">  Args:</span>
<span class="sd">    images: torch.tensor</span>
<span class="sd">      Image data with dimensionality B x C x H x W batch size x number of channels x height x width)</span>
<span class="sd">    device: STRING</span>
<span class="sd">      `cuda` if GPU is available, else `cpu`.</span>

<span class="sd">  Output:</span>
<span class="sd">    top5_probs: torch.tensor</span>
<span class="sd">      Tensor(B, 5) with top 5 class probabilities</span>
<span class="sd">    top5_names: list</span>
<span class="sd">      List of top 5 class names (B, 5)</span>
<span class="sd">  """</span>
  <span class="c1">####################################################################</span>
  <span class="c1"># Fill in all missing code below (...),</span>
  <span class="c1"># then remove or comment the line below to test your function</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Predict top 5"</span><span class="p">)</span>
  <span class="c1">####################################################################</span>
  <span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>

  <span class="n">B</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="c1"># Run images through model</span>
    <span class="n">images</span> <span class="o">=</span> <span class="o">...</span>
    <span class="n">output</span> <span class="o">=</span> <span class="o">...</span>
    <span class="c1"># The model output is unnormalized. To get probabilities, run a softmax on it.</span>
    <span class="n">probs</span> <span class="o">=</span> <span class="o">...</span>
    <span class="c1"># Fetch output from GPU and convert to numpy array</span>
    <span class="n">probs</span> <span class="o">=</span> <span class="o">...</span>

  <span class="c1"># Get top 5 predictions</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">top5_idcs</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">topk</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
  <span class="n">top5_idcs</span> <span class="o">=</span> <span class="n">top5_idcs</span><span class="o">.</span><span class="n">t</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
  <span class="n">top5_probs</span> <span class="o">=</span> <span class="n">probs</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">B</span><span class="p">),</span> <span class="n">top5_idcs</span><span class="p">]</span>

  <span class="c1"># Convert indices to class names</span>
  <span class="n">top5_names</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">B</span><span class="p">):</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="p">[</span><span class="n">dict_map</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">','</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">top5_idcs</span><span class="p">[:,</span> <span class="n">b</span><span class="p">]]</span>
    <span class="n">top5_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">top5_names</span><span class="p">,</span> <span class="n">top5_probs</span>


<span class="c1"># Get batch of images</span>
<span class="n">dataiter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">imagenette_val_loader</span><span class="p">)</span>
<span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">dataiter</span><span class="p">)</span>

<span class="c1">## Uncomment to test your function and retrieve top 5 predictions</span>
<span class="c1"># top5_names, top5_probs = predict_top5(images, DEVICE, SEED)</span>
<span class="c1"># print(top5_names[1])</span>

</pre></div>
</div>
<p>You will see something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Random</span> <span class="n">seed</span> <span class="mi">2021</span> <span class="n">has</span> <span class="n">been</span> <span class="nb">set</span><span class="o">.</span>
<span class="p">[</span><span class="s1">'gas pump'</span><span class="p">,</span> <span class="s1">'chain saw'</span><span class="p">,</span> <span class="s1">'jinrikisha'</span><span class="p">,</span> <span class="s1">'rifle'</span><span class="p">,</span> <span class="s1">'turnstile'</span><span class="p">]</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>
<span class="k">def</span> <span class="nf">predict_top5</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">seed</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Function to predict top 5 classes</span>

<span class="sd">  Args:</span>
<span class="sd">    images: torch.tensor</span>
<span class="sd">      Image data with dimensionality B x C x H x W batch size x number of channels x height x width)</span>
<span class="sd">    device: STRING</span>
<span class="sd">      `cuda` if GPU is available, else `cpu`.</span>

<span class="sd">  Output:</span>
<span class="sd">    top5_probs: torch.tensor</span>
<span class="sd">      Tensor(B, 5) with top 5 class probabilities</span>
<span class="sd">    top5_names: list</span>
<span class="sd">      List of top 5 class names (B, 5)</span>
<span class="sd">  """</span>
  <span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>

  <span class="n">B</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="c1"># Run images through model</span>
    <span class="n">images</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">resnet</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
    <span class="c1"># The model output is unnormalized. To get probabilities, run a softmax on it.</span>
    <span class="n">probs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Fetch output from GPU and convert to numpy array</span>
    <span class="n">probs</span> <span class="o">=</span> <span class="n">probs</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>

  <span class="c1"># Get top 5 predictions</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">top5_idcs</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">topk</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
  <span class="n">top5_idcs</span> <span class="o">=</span> <span class="n">top5_idcs</span><span class="o">.</span><span class="n">t</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
  <span class="n">top5_probs</span> <span class="o">=</span> <span class="n">probs</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">B</span><span class="p">),</span> <span class="n">top5_idcs</span><span class="p">]</span>

  <span class="c1"># Convert indices to class names</span>
  <span class="n">top5_names</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">B</span><span class="p">):</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="p">[</span><span class="n">dict_map</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">','</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">top5_idcs</span><span class="p">[:,</span> <span class="n">b</span><span class="p">]]</span>
    <span class="n">top5_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">top5_names</span><span class="p">,</span> <span class="n">top5_probs</span>


<span class="c1"># Get batch of images</span>
<span class="n">dataiter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">imagenette_val_loader</span><span class="p">)</span>
<span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">dataiter</span><span class="p">)</span>

<span class="c1">## Uncomment to test your function and retrieve top 5 predictions</span>
<span class="n">top5_names</span><span class="p">,</span> <span class="n">top5_probs</span> <span class="o">=</span> <span class="n">predict_top5</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">DEVICE</span><span class="p">,</span> <span class="n">SEED</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">top5_names</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Random seed 2021 has been set.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>['gas pump', 'chain saw', 'jinrikisha', 'rifle', 'shovel']
</pre></div>
</div>
</div>
</div>
<section id="id10">
<h3>Submit your feedback<a class="headerlink" href="#id10" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Use_the_ResNet_model_Exercise"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "dadae292739d4165b725a066b65ede31"}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize probabilities of top 5 predictions</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
  <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">images</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
  <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">'off'</span><span class="p">)</span>

  <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">top5_probs</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
  <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
  <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">top5_names</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/773d651260890a32edf03d452f3f882a0d1fde7e52549409684a864905c5b7d5.png" src="../../../_images/773d651260890a32edf03d452f3f882a0d1fde7e52549409684a864905c5b7d5.png"/>
</div>
</div>
</section>
</section>
<section id="out-of-distribution-examples">
<h2>Out-of-distribution examples<a class="headerlink" href="#out-of-distribution-examples" title="Permalink to this heading">#</a></h2>
<p>The code below runs two out-of-distribution examples through the trained ResNet. Look at the predictions and discuss, why the model might fail to make accurate predictions on these images.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loc</span> <span class="o">=</span> <span class="s1">'https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W2D3_ModernConvnets/static/'</span>

<span class="n">fname1</span> <span class="o">=</span> <span class="s1">'bonsai-svg-5.png'</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">loc</span> <span class="o">+</span> <span class="n">fname1</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">))</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">))</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">image</span><span class="p">)[:,</span> <span class="p">:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span> <span class="o">/</span> <span class="mf">255.</span>

<span class="n">fname2</span> <span class="o">=</span> <span class="s1">'Pokémon_Pikachu_art.png'</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">loc</span> <span class="o">+</span> <span class="n">fname2</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">))</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">))</span>
<span class="n">data2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">image</span><span class="p">)[:,</span> <span class="p">:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span> <span class="o">/</span> <span class="mf">255.</span>

<span class="n">images</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">data</span><span class="p">,</span> <span class="n">data2</span><span class="p">])</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Retrieve top 5 predictions</span>
<span class="n">top5_names</span><span class="p">,</span> <span class="n">top5_probs</span> <span class="o">=</span> <span class="n">predict_top5</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">DEVICE</span><span class="p">,</span> <span class="n">SEED</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Random seed 2021 has been set.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize probabilities of top 5 predictions</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
  <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">images</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
  <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">'off'</span><span class="p">)</span>

  <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">top5_probs</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
  <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
  <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">top5_names</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/c4a69b35b103faa2cfb395b4cabbd1e4138edfb61fb47b73d989f2e34fb75ec7.png" src="../../../_images/c4a69b35b103faa2cfb395b4cabbd1e4138edfb61fb47b73d989f2e34fb75ec7.png"/>
</div>
</div>
</section>
</section>
<hr class="docutils"/>
<section class="tex2jax_ignore mathjax_ignore" id="section-5-inception-resnext">
<h1>Section 5: Inception + ResNeXt<a class="headerlink" href="#section-5-inception-resnext" title="Permalink to this heading">#</a></h1>
<p><em>Time estimate: ~27mins</em></p>
<section id="video-5-improving-efficiency-inception-and-resnext">
<h2>Video 5: Improving efficiency: Inception and ResNeXt<a class="headerlink" href="#video-5-improving-efficiency-inception-and-resnext" title="Permalink to this heading">#</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "85fec8c0f06f4d779307d728e32d6dfa"}</script></div>
</div>
</section>
<section id="id11">
<h2>Submit your feedback<a class="headerlink" href="#id11" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Improving_efficiency_Inception_and_ResNeXt_Video"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "5820979de6fd42ac9b59aef2ef6dcd59"}</script></div>
</div>
</section>
<section id="resnet-vs-resnext">
<h2>ResNet vs ResNeXt<a class="headerlink" href="#resnet-vs-resnext" title="Permalink to this heading">#</a></h2>
<a class="reference internal image-reference" href="https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W2D3_ModernConvnets/static/ResNets.png"><img alt="https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W2D3_ModernConvnets/static/ResNets.png" src="https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W2D3_ModernConvnets/static/ResNets.png" style="height: 300px;"/></a>
<p><a class="reference external" href="https://arxiv.org/abs/1611.05431">Xie et al., 2016</a></p>
</section>
<section id="interactive-demo-5-resnet-vs-resnext">
<h2>Interactive Demo 5: ResNet vs. ResNeXt<a class="headerlink" href="#interactive-demo-5-resnet-vs-resnext" title="Permalink to this heading">#</a></h2>
<p>The widgets below calculate the number of parameters in a ResNet (top) and the parameters in a ResNeXt (bottom). We assume that the number of input and output channels (or feature maps) is the same (labeled “Channels in+out” in the widget). We refer to the number of channels after the first and the second layer of one block of either ResNet or ResNeXt as “bottleneck channels”.</p>
<p>The sliders are currently in the position that is displayed in the figure above. The goal of the following tasks is to investigate the difference in expressiveness and numbers of parameters in ResNet and ResNeXt.</p>
<section id="id12">
<h3>Parameter Calculator<a class="headerlink" href="#id12" title="Permalink to this heading">#</a></h3>
<p>Run this cell to enable the widget</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Parameter Calculator</span>
<span class="c1"># @markdown Run this cell to enable the widget</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span> <span class="k">as</span> <span class="n">dis</span>

<span class="k">def</span> <span class="nf">calculate_parameters_resnet</span><span class="p">(</span><span class="n">d_in</span><span class="p">,</span> <span class="n">resnet_channels</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    ResNet math: Implement how parameters scale</span>

<span class="sd">    Args:</span>
<span class="sd">      d_in: int</span>
<span class="sd">        Input dimensionality</span>
<span class="sd">      resnet_channels: int</span>
<span class="sd">        Number of channels in ResNet</span>

<span class="sd">    Returns:</span>
<span class="sd">      None</span>
<span class="sd">    """</span>
    <span class="n">d_out</span> <span class="o">=</span> <span class="n">d_in</span>
    <span class="n">resnet_parameters</span> <span class="o">=</span> <span class="n">d_in</span><span class="o">*</span><span class="n">resnet_channels</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="n">resnet_channels</span><span class="o">*</span><span class="n">resnet_channels</span> <span class="o">+</span> <span class="n">resnet_channels</span><span class="o">*</span><span class="n">d_out</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">'ResNet parameters: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">resnet_parameters</span><span class="p">))</span>
    <span class="k">return</span> <span class="kc">None</span>


<span class="k">def</span> <span class="nf">calculate_parameters_resnext</span><span class="p">(</span><span class="n">d_in</span><span class="p">,</span> <span class="n">resnext_channels</span><span class="p">,</span>
                                 <span class="n">num_paths</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    ResNext math: Implement how parameters scale</span>

<span class="sd">    Args:</span>
<span class="sd">      d_in: int</span>
<span class="sd">        Input dimensionality</span>
<span class="sd">      resnet_channels: int</span>
<span class="sd">        Number of channels in ResNext</span>
<span class="sd">      num_paths: int</span>
<span class="sd">        Number of pathways in ResNext</span>

<span class="sd">    Returns:</span>
<span class="sd">      None</span>
<span class="sd">    """</span>
    <span class="n">d_out</span> <span class="o">=</span> <span class="n">d_in</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">resnext_channels</span>

    <span class="n">resnext_parameters</span> <span class="o">=</span> <span class="p">(</span><span class="n">d_in</span><span class="o">*</span><span class="n">d</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="n">d</span><span class="o">*</span><span class="n">d</span> <span class="o">+</span> <span class="n">d</span><span class="o">*</span><span class="n">d_out</span><span class="p">)</span><span class="o">*</span><span class="n">num_paths</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">'ResNeXt parameters: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">resnext_parameters</span><span class="p">))</span>
    <span class="k">return</span> <span class="kc">None</span>


<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'ResNet'</span><span class="p">,</span> <span class="s1">'ResNeXt'</span><span class="p">]</span>
<span class="n">descriptions_resnet</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Channels in+out'</span><span class="p">,</span> <span class="s1">'Bottleneck channels'</span><span class="p">]</span>
<span class="n">descriptions_resnext</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Channels in+out'</span><span class="p">,</span> <span class="s1">'Bottleneck channels'</span><span class="p">,</span>
                        <span class="s1">'Number of paths (cardinality)'</span><span class="p">]</span>
<span class="n">lbox_resnet</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">widgets</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">description</span><span class="p">)</span> <span class="k">for</span> <span class="n">description</span> <span class="ow">in</span> <span class="n">descriptions_resnet</span><span class="p">])</span>
<span class="n">lbox_resnext</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">widgets</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">description</span><span class="p">)</span> <span class="k">for</span> <span class="n">description</span> <span class="ow">in</span> <span class="n">descriptions_resnext</span><span class="p">])</span>

<span class="n">d_in</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatLogSlider</span><span class="p">(</span>
    <span class="n">value</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
    <span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="c1"># Max exponent of base</span>
    <span class="nb">max</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="c1"># Min exponent of base</span>
    <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="c1"># Exponent step</span>
<span class="p">)</span>
<span class="n">resnet_channels</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatLogSlider</span><span class="p">(</span>
    <span class="n">value</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
    <span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="nb">min</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="c1"># Max exponent of base</span>
    <span class="nb">max</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="c1"># Min exponent of base</span>
    <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="c1"># Exponent step</span>
<span class="p">)</span>
<span class="n">resnext_channels</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatLogSlider</span><span class="p">(</span>
    <span class="n">value</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="c1"># Max exponent of base</span>
    <span class="nb">max</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="c1"># Min exponent of base</span>
    <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="c1"># Exponent step</span>
<span class="p">)</span>
<span class="n">num_paths</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatLogSlider</span><span class="p">(</span>
    <span class="n">value</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="c1"># Max exponent of base</span>
    <span class="nb">max</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="c1"># Min exponent of base</span>
    <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="c1"># Exponent step</span>
<span class="p">)</span>

<span class="n">rbox_resnet</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">d_in</span><span class="p">,</span> <span class="n">resnet_channels</span><span class="p">])</span>
<span class="n">rbox_resnext</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">d_in</span><span class="p">,</span> <span class="n">resnext_channels</span><span class="p">,</span> <span class="n">num_paths</span><span class="p">])</span>
<span class="n">ui_resnet</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="n">lbox_resnet</span><span class="p">,</span> <span class="n">rbox_resnet</span><span class="p">])</span>
<span class="n">ui_resnet_labeled</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">(</span>
    <span class="p">[</span><span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">"&lt;b&gt;"</span> <span class="o">+</span> <span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">"&lt;/b&gt;"</span><span class="p">),</span> <span class="n">ui_resnet</span><span class="p">],</span>
    <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">border</span><span class="o">=</span><span class="s1">'1px solid black'</span><span class="p">))</span>
<span class="n">ui_resnext</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="n">lbox_resnext</span><span class="p">,</span> <span class="n">rbox_resnext</span><span class="p">])</span>
<span class="n">ui_resnext_labeled</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">(</span>
    <span class="p">[</span><span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">"&lt;b&gt;"</span> <span class="o">+</span> <span class="n">labels</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">"&lt;/b&gt;"</span><span class="p">),</span> <span class="n">ui_resnext</span><span class="p">],</span>
    <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">border</span><span class="o">=</span><span class="s1">'1px solid black'</span><span class="p">))</span>
<span class="n">ui</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">ui_resnet_labeled</span><span class="p">,</span> <span class="n">ui_resnext_labeled</span><span class="p">])</span>

<span class="n">out_resnet</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">interactive_output</span><span class="p">(</span><span class="n">calculate_parameters_resnet</span><span class="p">,</span>
                     <span class="p">{</span><span class="s1">'d_in'</span><span class="p">:</span><span class="n">d_in</span><span class="p">,</span>
                     <span class="s1">'resnet_channels'</span><span class="p">:</span><span class="n">resnet_channels</span><span class="p">})</span>

<span class="n">out_resnext</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">interactive_output</span><span class="p">(</span><span class="n">calculate_parameters_resnext</span><span class="p">,</span>
                     <span class="p">{</span><span class="s1">'d_in'</span><span class="p">:</span><span class="n">d_in</span><span class="p">,</span>
                     <span class="s1">'resnext_channels'</span><span class="p">:</span><span class="n">resnext_channels</span><span class="p">,</span>
                     <span class="s1">'num_paths'</span><span class="p">:</span><span class="n">num_paths</span><span class="p">})</span>

<span class="n">d1</span> <span class="o">=</span> <span class="n">dis</span><span class="p">(</span><span class="n">ui</span><span class="p">,</span> <span class="n">out_resnet</span><span class="p">,</span> <span class="n">out_resnext</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "6d9aa5c25bbc47aba5c0f961ad4eedf8"}</script><script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "c03e22613cbc4a619c4f942ecfd95903"}</script><script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "11db7b279fd64a659dab3384e20ad9b7"}</script></div>
</div>
</section>
<section id="id13">
<h3>Submit your feedback<a class="headerlink" href="#id13" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_ResNet_vs_ResNeXt_Interactive_Demo"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "babfe00c60ab4027a54eea45d50f1dde"}</script></div>
</div>
</section>
</section>
<section id="think-5-resnet-vs-resnext">
<h2>Think! 5: ResNet vs. ResNeXt<a class="headerlink" href="#think-5-resnet-vs-resnext" title="Permalink to this heading">#</a></h2>
<p>In the figure above, both networks, i.e., ResNet and ResNeXt, have a similar number of parameters.</p>
<ol class="arabic simple">
<li><p>How many channels are there in the bottleneck of the two networks, respectively?</p></li>
<li><p>How are these channels connected to each other from the first to the second layer in the blocks of the two networks, respectively?</p></li>
<li><p>What does it mean for the expressiveness of the two models relative to each other?</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove explanation</span>

<span class="sd">"""</span>
<span class="sd">1. The ResNeXt has 32 * 4 = 128 channels in the bottleneck, whereas the ResNet has only 64.</span>

<span class="sd">2. In ResNet all 64 output channels of the first layer are connected to all 64 output channels of the second layer.</span>
<span class="sd">In ResNeXt, channels are connected only within paths, i.e. in groups of 4.</span>

<span class="sd">3. ResNeXt contains more channels in the bottleneck (potentially more expressive),</span>
<span class="sd">   but each of them "sees" only a subset of the previous layer's output (potentially less expressive).</span>
<span class="sd">   The former tends to outweigh the latter, which is why the ResNeXt architecture tends to outperform the</span>
<span class="sd">   vanilla ResNet architecture.</span>
<span class="sd">"""</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<section id="id14">
<h3>Submit your feedback<a class="headerlink" href="#id14" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_ResNet_vs_ResNeXt_Discussion"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "fa0f96b9ccd143a9bde74d5b84738395"}</script></div>
</div>
<p>Now we want to look at the number of parameters.</p>
<ul class="simple">
<li><p>How does the difference in number of parameters change if we fix the number of channels in the bottleneck of both ResNet and ResNeXt to be 64, but vary the number of paths in ResNeXt? (8 paths with 8 channels each would be one such example)</p></li>
<li><p>Which number of paths results in the biggest parameter savings?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove explanation</span>

<span class="sd">"""</span>
<span class="sd">1. if number of paths=1 and channels per path=64 -&gt; same architecture as ResNet, no parameter saving</span>
<span class="sd">2. if number of paths=8 and channels per path=8 -&gt; around half the number of parameters</span>
<span class="sd">3. if number of paths=32 and channels per path=2 -&gt; biggest parameter saving the more paths, the more saving</span>
<span class="sd">"""</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<hr class="docutils"/>
<section class="tex2jax_ignore mathjax_ignore" id="section-6-depthwise-separable-convolutions">
<h1>Section 6: Depthwise separable convolutions<a class="headerlink" href="#section-6-depthwise-separable-convolutions" title="Permalink to this heading">#</a></h1>
<p><em>Time estimate: ~23mins</em></p>
<section id="video-6-improving-efficiency-mobilenet">
<h2>Video 6: Improving efficiency: MobileNet<a class="headerlink" href="#video-6-improving-efficiency-mobilenet" title="Permalink to this heading">#</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "ffca113731e04c6c848b8ba932d04934"}</script></div>
</div>
</section>
<section id="id15">
<h2>Submit your feedback<a class="headerlink" href="#id15" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Improving_efficiency_MobileNet_Video"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "0dee249acb7c47aa9eb1f588b7bf98f8"}</script></div>
</div>
</section>
<section id="section-6-1-depthwise-separable-convolutions">
<h2>Section 6.1: Depthwise separable convolutions<a class="headerlink" href="#section-6-1-depthwise-separable-convolutions" title="Permalink to this heading">#</a></h2>
<p>Another way to reduce the computational cost of large models is the use of depthwise separable convolutions (<a class="reference external" href="https://www.di.ens.fr/data/publications/papers/phd_sifre.pdf">introduced here</a>). Depthwise separable convolutions are the key component making <a class="reference external" href="https://arxiv.org/abs/1704.04861">MobileNets</a> efficient.</p>
<img alt="https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W2D3_ModernConvnets/static/SchematicCNN.png" src="https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W2D3_ModernConvnets/static/SchematicCNN.png"/>
<section id="coding-exercise-6-1-calculation-of-parameters">
<h3>Coding Exercise 6.1: Calculation of parameters<a class="headerlink" href="#coding-exercise-6-1-calculation-of-parameters" title="Permalink to this heading">#</a></h3>
<p>Fill in the calculation of the parameters of regular convolution and depthwise separable convolution in the function below.
Above you can see the example given in the video for you to check if your calculation is correct.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">convolution_math</span><span class="p">(</span><span class="n">in_channels</span><span class="p">,</span> <span class="n">filter_size</span><span class="p">,</span> <span class="n">out_channels</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Convolution math: Implement how parameters scale as a function of feature maps</span>
<span class="sd">  and filter size in convolution vs depthwise separable convolution.</span>

<span class="sd">  Args:</span>
<span class="sd">    in_channels : int</span>
<span class="sd">      Number of input channels</span>
<span class="sd">    filter_size : int</span>
<span class="sd">      Size of the filter</span>
<span class="sd">    out_channels : int</span>
<span class="sd">      Number of output channels</span>

<span class="sd">  Returns:</span>
<span class="sd">    None</span>
<span class="sd">  """</span>
  <span class="c1">####################################################################</span>
  <span class="c1"># Fill in all missing code below (...),</span>
  <span class="c1"># then remove or comment the line below to test your function</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Convolution math"</span><span class="p">)</span>
  <span class="c1">####################################################################</span>
  <span class="c1"># Calculate the number of parameters for regular convolution</span>
  <span class="n">conv_parameters</span> <span class="o">=</span> <span class="o">...</span>
  <span class="c1"># Calculate the number of parameters for depthwise separable convolution</span>
  <span class="n">depthwise_conv_parameters</span> <span class="o">=</span> <span class="o">...</span>

  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Depthwise separable: </span><span class="si">{</span><span class="n">depthwise_conv_parameters</span><span class="si">}</span><span class="s2"> parameters"</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Regular convolution: </span><span class="si">{</span><span class="n">conv_parameters</span><span class="si">}</span><span class="s2"> parameters"</span><span class="p">)</span>

  <span class="k">return</span> <span class="kc">None</span>



<span class="c1">## Uncomment to test your function</span>
<span class="c1"># convolution_math(in_channels=4, filter_size=3, out_channels=2)</span>

</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Depthwise</span> <span class="n">separable</span><span class="p">:</span> <span class="mi">44</span> <span class="n">parameters</span>
<span class="n">Regular</span> <span class="n">convolution</span><span class="p">:</span> <span class="mi">72</span> <span class="n">parameters</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>
<span class="k">def</span> <span class="nf">convolution_math</span><span class="p">(</span><span class="n">in_channels</span><span class="p">,</span> <span class="n">filter_size</span><span class="p">,</span> <span class="n">out_channels</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Convolution math: Implement how parameters scale as a function of feature maps</span>
<span class="sd">  and filter size in convolution vs depthwise separable convolution.</span>

<span class="sd">  Args:</span>
<span class="sd">    in_channels : int</span>
<span class="sd">      Number of input channels</span>
<span class="sd">    filter_size : int</span>
<span class="sd">      Size of the filter</span>
<span class="sd">    out_channels : int</span>
<span class="sd">      Number of output channels</span>

<span class="sd">  Returns:</span>
<span class="sd">    None</span>
<span class="sd">  """</span>
  <span class="c1"># Calculate the number of parameters for regular convolution</span>
  <span class="n">conv_parameters</span> <span class="o">=</span> <span class="n">in_channels</span> <span class="o">*</span> <span class="n">filter_size</span> <span class="o">*</span> <span class="n">filter_size</span> <span class="o">*</span> <span class="n">out_channels</span>
  <span class="c1"># Calculate the number of parameters for depthwise separable convolution</span>
  <span class="n">depthwise_conv_parameters</span> <span class="o">=</span> <span class="n">in_channels</span> <span class="o">*</span> <span class="n">filter_size</span> <span class="o">*</span> <span class="n">filter_size</span> <span class="o">+</span> <span class="n">in_channels</span> <span class="o">*</span> <span class="n">out_channels</span>

  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Depthwise separable: </span><span class="si">{</span><span class="n">depthwise_conv_parameters</span><span class="si">}</span><span class="s2"> parameters"</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Regular convolution: </span><span class="si">{</span><span class="n">conv_parameters</span><span class="si">}</span><span class="s2"> parameters"</span><span class="p">)</span>

  <span class="k">return</span> <span class="kc">None</span>



<span class="c1">## Uncomment to test your function</span>
<span class="n">convolution_math</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">filter_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Depthwise separable: 44 parameters
Regular convolution: 72 parameters
</pre></div>
</div>
</div>
</div>
<section id="id16">
<h4>Submit your feedback<a class="headerlink" href="#id16" title="Permalink to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Calculation_of_parameters_Exercise"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "eaf20a77c0c842a087dd392bfafd0ea7"}</script></div>
</div>
</section>
</section>
<section id="think-6-1-how-do-parameter-savings-depend-the-on-number-of-input-feature-maps-4-vs-64">
<h3>Think! 6.1: How do parameter savings depend the on number of input feature maps, 4 vs. 64?<a class="headerlink" href="#think-6-1-how-do-parameter-savings-depend-the-on-number-of-input-feature-maps-4-vs-64" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove explanation</span>

<span class="sd">"""</span>
<span class="sd">The more input features the more parameter saving</span>
<span class="sd">  4:  28 less params</span>
<span class="sd">  64: 448 less params</span>
<span class="sd">"""</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<section id="id17">
<h4>Submit your feedback<a class="headerlink" href="#id17" title="Permalink to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Parameter_savings_Discussion"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "1c895e6c946e41c189aee12c6a62b72d"}</script></div>
</div>
</section>
</section>
</section>
</section>
<hr class="docutils"/>
<section class="tex2jax_ignore mathjax_ignore" id="section-7-transfer-learning">
<h1>Section 7: Transfer Learning<a class="headerlink" href="#section-7-transfer-learning" title="Permalink to this heading">#</a></h1>
<p><em>Time estimate: ~24mins</em></p>
<section id="video-7-transfer-learning">
<h2>Video 7: Transfer Learning<a class="headerlink" href="#video-7-transfer-learning" title="Permalink to this heading">#</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "59459694fe9043dea138e1f72f85e057"}</script></div>
</div>
</section>
<section id="id18">
<h2>Submit your feedback<a class="headerlink" href="#id18" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Transfer_Learning_Video"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "17059e00ee804da4b5ab97e9524fb916"}</script></div>
</div>
<p>The most common way large image models are trained in practice is via transfer learning. One first pretrains a network on a large classification dataset like ImageNet, then uses the weights of this network as initialization for training (“fine-tuning”) that network on your task of choice.</p>
<p>While training a network twice sounds like a strange thing to do, the model ends up training faster on the target dataset and often outperforms training “from scratch”. There are also other benefits such as <a class="reference external" href="https://arxiv.org/pdf/1901.09960.pdf">robustness to noise</a> that are the subject of <a class="reference external" href="https://arxiv.org/abs/2008.11687">active research</a>.</p>
<p>In this section we will demonstrate transfer learning by taking a model trained on ImageNet and teaching it to classify Pokemon.</p>
</section>
<section id="section-7-1-download-and-prepare-the-data">
<h2>Section 7.1: Download and prepare the data<a class="headerlink" href="#section-7-1-download-and-prepare-the-data" title="Permalink to this heading">#</a></h2>
<section id="download-data">
<h3>Download Data<a class="headerlink" href="#download-data" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Download Data</span>
<span class="kn">import</span> <span class="nn">zipfile</span><span class="o">,</span> <span class="nn">io</span>

<span class="c1"># Original link: https://github.com/ben-heil/cis_522_data.git</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">'https://osf.io/u4njm/download'</span>

<span class="n">fname</span> <span class="o">=</span> <span class="s1">'small_pokemon_dataset'</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">fname</span><span class="o">+</span><span class="s1">'zip'</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"Data is being downloaded..."</span><span class="p">)</span>
  <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="n">z</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>
  <span class="n">z</span><span class="o">.</span><span class="n">extractall</span><span class="p">()</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"The download has been completed."</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"Data has already been downloaded."</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data is being downloaded...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The download has been completed.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># List the different Pokemon</span>
<span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s2">"small_pokemon_dataset/"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>['Blastoise',
 'Charmander',
 'Squirtle',
 'Ivysaur',
 'Wartortle',
 'Charizard',
 'Charmeleon',
 'Bulbasaur',
 'Venusaur']
</pre></div>
</div>
</div>
</div>
</section>
<section id="determine-number-of-classes">
<h3>Determine number of classes<a class="headerlink" href="#determine-number-of-classes" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Determine number of classes</span>
<span class="n">num_classes</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">folders</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">'small_pokemon_dataset/'</span><span class="p">):</span>
  <span class="n">num_classes</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">num_classes</span><span class="si">}</span><span class="s2"> types of Pokemon"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9 types of Pokemon
</pre></div>
</div>
</div>
</div>
</section>
<section id="display-example-images">
<h3>Display Example Images<a class="headerlink" href="#display-example-images" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Display Example Images</span>
<span class="n">train_transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">((</span><span class="n">transforms</span><span class="o">.</span><span class="n">Resize</span><span class="p">((</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">)),</span>
                                      <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">()))</span>

<span class="n">pokemon_dataset</span> <span class="o">=</span> <span class="n">ImageFolder</span><span class="p">(</span><span class="s1">'small_pokemon_dataset'</span><span class="p">,</span>
                              <span class="n">transform</span><span class="o">=</span><span class="n">train_transform</span><span class="p">)</span>

<span class="n">image_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pokemon_dataset</span><span class="p">)</span>
<span class="n">train_indices</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">test_indices</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">image_count</span><span class="p">):</span>
  <span class="c1"># Put ten percent of the images in the test set</span>
  <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">.1</span><span class="p">:</span>
    <span class="n">test_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">train_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="n">pokemon_test_set</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Subset</span><span class="p">(</span><span class="n">pokemon_dataset</span><span class="p">,</span> <span class="n">test_indices</span><span class="p">)</span>
<span class="n">pokemon_train_set</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Subset</span><span class="p">(</span><span class="n">pokemon_dataset</span><span class="p">,</span> <span class="n">train_indices</span><span class="p">)</span>

<span class="n">pokemon_train_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">pokemon_train_set</span><span class="p">,</span>
                                                   <span class="n">batch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
                                                   <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>
<span class="n">pokemon_test_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">pokemon_test_set</span><span class="p">,</span>
                                                  <span class="n">batch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">dataiter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">pokemon_train_loader</span><span class="p">)</span>
<span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">dataiter</span><span class="p">)</span>

<span class="c1"># Show images</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">make_grid</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">nrow</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">'off'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../../_images/cc72aa81921dbb52f8f4974846c4bdf54a96fd2cf17ac3f328056a70de8249e3.png" src="../../../_images/cc72aa81921dbb52f8f4974846c4bdf54a96fd2cf17ac3f328056a70de8249e3.png"/>
</div>
</div>
</section>
</section>
<section id="section-7-2-fine-tuning-a-resnet">
<h2>Section 7.2: Fine-tuning a ResNet<a class="headerlink" href="#section-7-2-fine-tuning-a-resnet" title="Permalink to this heading">#</a></h2>
<p>It is common in computer vision to take a large model trained on a large dataset (often ImageNet), replace the classification layer and fine-tune the entire network to perform a different task.</p>
<p>Here we’ll be using a pre-trained ResNet model to classify types of Pokemon.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resnet</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">resnet18</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="s1">'ResNet18_Weights.DEFAULT'</span><span class="p">)</span>
<span class="n">num_ftrs</span> <span class="o">=</span> <span class="n">resnet</span><span class="o">.</span><span class="n">fc</span><span class="o">.</span><span class="n">in_features</span>
<span class="c1"># Reset final fully connected layer, number of classes = types of Pokemon = 9</span>
<span class="n">resnet</span><span class="o">.</span><span class="n">fc</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">num_ftrs</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">)</span>
<span class="n">resnet</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">resnet</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">)</span>
<span class="n">loss_fn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="finetune-resnet">
<h3>Finetune ResNet<a class="headerlink" href="#finetune-resnet" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Finetune ResNet</span>
<span class="n">pretrained_accs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)):</span>
  <span class="c1"># Train loop</span>
  <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">pokemon_train_loader</span><span class="p">:</span>
    <span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">batch</span>
    <span class="n">images</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>

    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">resnet</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

  <span class="c1"># Eval loop</span>
  <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">loss_sum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">total_correct</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pokemon_test_set</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">pokemon_test_loader</span><span class="p">:</span>
      <span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">batch</span>
      <span class="n">images</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
      <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
      <span class="n">output</span> <span class="o">=</span> <span class="n">resnet</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
      <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
      <span class="n">loss_sum</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

      <span class="n">predictions</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

      <span class="n">num_correct</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">predictions</span> <span class="o">==</span> <span class="n">labels</span><span class="p">)</span>
      <span class="n">total_correct</span> <span class="o">+=</span> <span class="n">num_correct</span>

    <span class="c1"># Plot accuracy</span>
    <span class="n">pretrained_accs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">total_correct</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span> <span class="o">/</span> <span class="n">total</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pretrained_accs</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'epoch'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'accuracy'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Pokemon prediction accuracy'</span><span class="p">)</span>
    <span class="n">IPython</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">IPython</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">())</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../../_images/7f9556f5628b888e278d138ba00597c50157f721898433695d197d4986a386c8.png" src="../../../_images/7f9556f5628b888e278d138ba00597c50157f721898433695d197d4986a386c8.png"/>
</div>
</div>
</section>
</section>
<section id="section-7-3-train-only-classification-layer">
<h2>Section 7.3: Train only classification layer<a class="headerlink" href="#section-7-3-train-only-classification-layer" title="Permalink to this heading">#</a></h2>
<p>Another possible way to make use of transfer learning is to take a pre-trained model and replace the last layer, the classification layer (sometimes also called the “linear readout”). Instead of fine-tuning the whole model as before, we train only the classification layer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resnet</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">resnet18</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="s1">'ResNet18_Weights.DEFAULT'</span><span class="p">)</span>
<span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">resnet</span><span class="o">.</span><span class="n">parameters</span><span class="p">():</span>
  <span class="n">param</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">num_ftrs</span> <span class="o">=</span> <span class="n">resnet</span><span class="o">.</span><span class="n">fc</span><span class="o">.</span><span class="n">in_features</span>
<span class="c1"># ResNet final fully connected layer</span>
<span class="n">resnet</span><span class="o">.</span><span class="n">fc</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">num_ftrs</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">)</span>
<span class="n">resnet</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">resnet</span><span class="o">.</span><span class="n">fc</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span>
<span class="n">loss_fn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="finetune-readout-of-resnet">
<h3>Finetune readout of ResNet<a class="headerlink" href="#finetune-readout-of-resnet" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Finetune readout of ResNet</span>
<span class="n">linreadout_accs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)):</span>
  <span class="c1"># Train loop</span>
  <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">pokemon_train_loader</span><span class="p">:</span>
    <span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">batch</span>
    <span class="n">images</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>

    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">resnet</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

  <span class="c1"># Eval loop</span>
  <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">loss_sum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">total_correct</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pokemon_test_set</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">pokemon_test_loader</span><span class="p">:</span>
      <span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">batch</span>
      <span class="n">images</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
      <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
      <span class="n">output</span> <span class="o">=</span> <span class="n">resnet</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
      <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
      <span class="n">loss_sum</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

      <span class="n">predictions</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

      <span class="n">num_correct</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">predictions</span> <span class="o">==</span> <span class="n">labels</span><span class="p">)</span>
      <span class="n">total_correct</span> <span class="o">+=</span> <span class="n">num_correct</span>

    <span class="c1"># Plot accuracy</span>
    <span class="n">linreadout_accs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">total_correct</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span> <span class="o">/</span> <span class="n">total</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linreadout_accs</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'epoch'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'accuracy'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Pokemon prediction accuracy'</span><span class="p">)</span>
    <span class="n">IPython</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">IPython</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">())</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../../_images/f994909ae9e5f9158acc1182a5131f6b5087ead3b92db1f33230b02859edbae1.png" src="../../../_images/f994909ae9e5f9158acc1182a5131f6b5087ead3b92db1f33230b02859edbae1.png"/>
</div>
</div>
</section>
</section>
<section id="section-7-4-training-resnet-from-scratch">
<h2>Section 7.4: Training ResNet from scratch<a class="headerlink" href="#section-7-4-training-resnet-from-scratch" title="Permalink to this heading">#</a></h2>
<p>As a baseline and for comparison reasons we will also train the ResNet “from scratch” – that is: initialize the weights randomly and train the entire network exclusively on the Pokemon dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resnet</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">resnet18</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">num_ftrs</span> <span class="o">=</span> <span class="n">resnet</span><span class="o">.</span><span class="n">fc</span><span class="o">.</span><span class="n">in_features</span>
<span class="c1"># ResNet final fully connected layer</span>
<span class="n">resnet</span><span class="o">.</span><span class="n">fc</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">num_ftrs</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">)</span>
<span class="n">resnet</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">resnet</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">)</span>

<span class="n">loss_fn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="train-resnet-from-scratch">
<h3>Train ResNet from scratch<a class="headerlink" href="#train-resnet-from-scratch" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Train ResNet from scratch</span>
<span class="n">scratch_accs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)):</span>
  <span class="c1"># Train loop</span>
  <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">pokemon_train_loader</span><span class="p">:</span>
    <span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">batch</span>
    <span class="n">images</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>

    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">resnet</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

  <span class="c1"># Eval loop</span>
  <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">loss_sum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">total_correct</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pokemon_test_set</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">pokemon_test_loader</span><span class="p">:</span>
      <span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">batch</span>
      <span class="n">images</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
      <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
      <span class="n">output</span> <span class="o">=</span> <span class="n">resnet</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
      <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
      <span class="n">loss_sum</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

      <span class="n">predictions</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

      <span class="n">num_correct</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">predictions</span> <span class="o">==</span> <span class="n">labels</span><span class="p">)</span>
      <span class="n">total_correct</span> <span class="o">+=</span> <span class="n">num_correct</span>

    <span class="n">scratch_accs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">total_correct</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span> <span class="o">/</span> <span class="n">total</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scratch_accs</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'epoch'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'accuracy'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Pokemon prediction accuracy'</span><span class="p">)</span>

    <span class="n">IPython</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">IPython</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">())</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../../_images/5f025bb6d6026cb07a5ecdb47d4af492ce35f1d60820dcccfde5cfdb00b13726.png" src="../../../_images/5f025bb6d6026cb07a5ecdb47d4af492ce35f1d60820dcccfde5cfdb00b13726.png"/>
</div>
</div>
</section>
</section>
<section id="section-7-5-head-to-head-comparison">
<h2>Section 7.5: Head to Head Comparison<a class="headerlink" href="#section-7-5-head-to-head-comparison" title="Permalink to this heading">#</a></h2>
<p>Starting from a randomly initialized network works less well, especially in the case of small datsets. Note that the model converges more slowly and less evenly.</p>
<section id="plot-accuracies">
<h3>Plot Accuracies<a class="headerlink" href="#plot-accuracies" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Plot Accuracies</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pretrained_accs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Pretrained: fine-tuning'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linreadout_accs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Pretrained: linear Readout'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scratch_accs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Trained from Scratch'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Pokemon prediction accuracy'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../../_images/d64a5b5eae0f81dd1d66d76e262bb478ab2001e3a1ab8f3524a2d192e6c5eb11.png" src="../../../_images/d64a5b5eae0f81dd1d66d76e262bb478ab2001e3a1ab8f3524a2d192e6c5eb11.png"/>
</div>
</div>
</section>
<section id="exercise-7-5-1-pretrained-resnet-vs-resnet-trained-from-scratch">
<h3>Exercise 7.5.1: Pretrained ResNet vs. ResNet trained from scratch<a class="headerlink" href="#exercise-7-5-1-pretrained-resnet-vs-resnet-trained-from-scratch" title="Permalink to this heading">#</a></h3>
<p>First, we compare the Pretrained ResNet with the ResNet trained from scratch. Why might pretrained models outperform models trained from scratch? In what cases would you expect them to be worse?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove explanation</span>

<span class="sd">"""</span>
<span class="sd">1. The closer your pretraining and target data domains are, the better pretraining will work</span>
<span class="sd">2. The more pretraining data you have, the better pretraining will work</span>
<span class="sd">3. The better your model is able to take advantage of your pretraining data (that is to say</span>
<span class="sd">   the larger your model is as you have enough data), the better pretraining will work</span>

<span class="sd">Pretraining isn't necessarily always a benefit though. If your source domain is very different from</span>
<span class="sd">the domain you're trying to predict, your models might learn unhelpful features.</span>

<span class="sd">Additionally, if you have a lot of training data in your target domain, pretraining data might</span>
<span class="sd">cause your model to converge to a local minimum (this process is referred to as ossification in</span>
<span class="sd">the Scaling Laws for Transfer paper cited in the Further Reading section)</span>
<span class="sd">"""</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<section id="id19">
<h4>Submit your feedback<a class="headerlink" href="#id19" title="Permalink to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Pretrained_ResNet_vs_ResNet_Exercise"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "34c2badf44aa4634ae4cc465436efce3"}</script></div>
</div>
</section>
</section>
<section id="exercise-7-5-2-training-only-the-classification-layer">
<h3>Exercise 7.5.2: Training only the classification layer<a class="headerlink" href="#exercise-7-5-2-training-only-the-classification-layer" title="Permalink to this heading">#</a></h3>
<p>Second, take a look at the different transfer learning methods - fine-tuning the whole network and training only the classification layer. Why might fine-tuning the whole network outperform training only the classification layer? What are the benefits of training only the classification layer? In what cases would you expect a similar performance of both methods?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove explanation</span>

<span class="sd">"""</span>
<span class="sd">1. More weights are adjusted to the pretraining domain.</span>
<span class="sd">2. Since only one layer is trained, the training procedure is faster/less computationally expensive.</span>
<span class="sd">3. If your pretraining and target data domains are close.</span>
<span class="sd">"""</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<section id="id20">
<h4>Submit your feedback<a class="headerlink" href="#id20" title="Permalink to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Training_only_the_classification_Exercise"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "145e5e5e9dc84e4a8b477d86fb2949f3"}</script></div>
</div>
</section>
</section>
</section>
<section id="id21">
<h2>Further Reading<a class="headerlink" href="#id21" title="Permalink to this heading">#</a></h2>
<p>Supervised pretraining as you’ve seen here is useful, but there are several other ways of using outside data to improve your models. The ones that are particularly popular right now are self-supervised techniques like <a class="reference external" href="https://arxiv.org/pdf/2002.05709.pdf">contrastive learning</a>.</p>
<p>There is also a <a class="reference external" href="https://arxiv.org/abs/2102.01293">recent paper</a> that seeks to quantify the relationship between model size, pretraining dataset size, training dataset size, and performance.</p>
</section>
</section>
<hr class="docutils"/>
<section class="tex2jax_ignore mathjax_ignore" id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Permalink to this heading">#</a></h1>
<p>In this tutorial, you have learned about the modern Convnets (CNNs), their architecture, and operating principles. Also, you are now familiar with the notion of <em>Transfer Learning</em>, and you have learned when to apply it. If you have time left, you will learn more about the speed vs. accuracy trade-off. In the next tutorial, we will see the modern convnets in a facial recognition task.</p>
<section id="video-8-summary-and-outlook">
<h2>Video 8: Summary and Outlook<a class="headerlink" href="#video-8-summary-and-outlook" title="Permalink to this heading">#</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "5f2238ba6fc9460eb157077dc6a7cd88"}</script></div>
</div>
</section>
<section id="id22">
<h2>Submit your feedback<a class="headerlink" href="#id22" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Summary_and_Outlook_Video"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "a038cc5ab8c24d21b7854d07fc277da0"}</script></div>
</div>
</section>
</section>
<hr class="docutils"/>
<section class="tex2jax_ignore mathjax_ignore" id="daily-survey">
<h1>Daily survey<a class="headerlink" href="#daily-survey" title="Permalink to this heading">#</a></h1>
<p>Don’t forget to complete your reflections and content check in the daily survey! Please be patient after logging in as there is a small delay before you will be redirected to the survey.</p>
<p><a href="https://portal.neuromatchacademy.org/api/redirect/to/d37b07c5-da62-4745-bff1-f5f1a64f47aa"><img alt="button link to survey" src="https://github.com/NeuromatchAcademy/course-content-dl/blob/main/tutorials/static/SurveyButton.png?raw=1"/></a></p>
</section>
<hr class="docutils"/>
<section class="tex2jax_ignore mathjax_ignore" id="bonus-speed-accuracy-trade-off-different-backbones">
<h1>Bonus: Speed-Accuracy Trade-Off / Different Backbones<a class="headerlink" href="#bonus-speed-accuracy-trade-off-different-backbones" title="Permalink to this heading">#</a></h1>
<p><em>Time estimate: ~ 21mins</em></p>
<section id="video-9-speed-accuracy-trade-off">
<h2>Video 9: Speed-accuracy trade-off<a class="headerlink" href="#video-9-speed-accuracy-trade-off" title="Permalink to this heading">#</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "91fa0a93f83c4cb99df394551222d0e4"}</script></div>
</div>
</section>
<section id="id23">
<h2>Submit your feedback<a class="headerlink" href="#id23" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_SpeedAccuracy_TradeOff_Different_Backbones_Bonus_Video"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "059c085901e14c14976d5ee4f3b4f152"}</script></div>
</div>
<p>As the models got larger and the number of connections increased so did the computational costs involved. In the modern era of image processing, there is a tradeoff between model performance and computational cost. Models can reach extremely high performance on many problems, but achieving state of the art results requires <a class="reference external" href="https://arxiv.org/pdf/1810.00736.pdf">huge amounts of compute power</a>.</p>
<img alt="https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W2D3_ModernConvnets/static/compute_vs_performance.png" src="https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W2D3_ModernConvnets/static/compute_vs_performance.png"/>
</section>
<section id="bonus-coding-exercise-compare-accuracy-and-training-speed-of-different-models">
<h2>Bonus Coding Exercise: Compare accuracy and training speed of different models<a class="headerlink" href="#bonus-coding-exercise-compare-accuracy-and-training-speed-of-different-models" title="Permalink to this heading">#</a></h2>
<p>The goal is to load three pretrained models and fine-tune them.
<code class="docutils literal notranslate"><span class="pre">models</span></code> is a dictionary where the keys are the names of the models and the values are the corresponding model objects.
Currently the names are <em>ResNet18, AlexNet</em> and <em>VGG-19</em>.
For a start, load these models from torchvision.models and make sure they are pretrained.</p>
<p>If you want to try other models, just change the dictionary, or if you want to even try out more than three models, just add them to the dictionary and add their learning rates in the array below.</p>
<section id="imagenette-train-loop-train-loop-model-optimizer-train-loader-loss-fn-device">
<h3>Imagenette Train Loop: <code class="docutils literal notranslate"><span class="pre">train_loop(model,</span> <span class="pre">optimizer,</span> <span class="pre">train_loader,</span> <span class="pre">loss_fn,</span> <span class="pre">device)</span></code><a class="headerlink" href="#imagenette-train-loop-train-loop-model-optimizer-train-loader-loss-fn-device" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Imagenette Train Loop: `train_loop(model, optimizer, train_loader, loss_fn, device)`</span>
<span class="k">def</span> <span class="nf">train_loop</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">train_loader</span><span class="p">,</span>
               <span class="n">loss_fn</span><span class="p">,</span> <span class="n">device</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Imagenette Train Loop</span>

<span class="sd">  Args:</span>
<span class="sd">    model: nn.module</span>
<span class="sd">      Model</span>
<span class="sd">    optimizer: function</span>
<span class="sd">      Optimizer</span>
<span class="sd">    train_loader: torch.loader</span>
<span class="sd">      Training dataset</span>
<span class="sd">    loss_fn: function</span>
<span class="sd">      Criterion</span>
<span class="sd">    device: string</span>
<span class="sd">      GPU/CUDA if available. CPU otherwise.</span>

<span class="sd">  Returns:</span>
<span class="sd">    Average Training time</span>
<span class="sd">  """</span>
  <span class="n">times</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)):</span>
    <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
    <span class="n">t_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="c1"># Train on a batch of images</span>
    <span class="k">for</span> <span class="n">imagenette_batch</span> <span class="ow">in</span> <span class="n">train_loader</span><span class="p">:</span>
      <span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">imagenette_batch</span>

      <span class="c1"># Convert labels from imagenette indices to imagenet labels</span>
      <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
        <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dir_index_to_imagenet_label</span><span class="p">[</span><span class="n">label</span><span class="o">.</span><span class="n">item</span><span class="p">()]</span>

      <span class="n">images</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
      <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
      <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
      <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
      <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
      <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
      <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
      <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

      <span class="n">times</span> <span class="o">+=</span> <span class="p">[</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t_start</span><span class="p">]</span>

  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">times</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="run-the-models-run-models-models-lr-rates">
<h3>Run the models: <code class="docutils literal notranslate"><span class="pre">run_models(models,</span> <span class="pre">lr_rates)</span></code><a class="headerlink" href="#run-the-models-run-models-models-lr-rates" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Run the models: `run_models(models, lr_rates)`</span>
<span class="k">def</span> <span class="nf">run_models</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">lr_rates</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Run the models</span>

<span class="sd">  Args:</span>
<span class="sd">    models: dict</span>
<span class="sd">      Models</span>
<span class="sd">    lr_rates: list</span>
<span class="sd">      Learning rates</span>

<span class="sd">  Returns:</span>
<span class="sd">    times: list</span>
<span class="sd">      Running time for models</span>
<span class="sd">    top_1_acciracies: list</span>
<span class="sd">      Top 1 accuracy per model</span>
<span class="sd">  """</span>
  <span class="n">times</span><span class="p">,</span> <span class="n">top_1_accuracies</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

  <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">model</span><span class="p">),</span> <span class="n">lr</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">lr_rates</span><span class="p">):</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">lr</span><span class="p">)</span>

    <span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">aux_logits</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Important only for googlenet</span>

    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">lr</span><span class="p">)</span>
    <span class="n">loss_fn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>

    <span class="n">model_time</span> <span class="o">=</span> <span class="n">train_loop</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">imagenette_train_loader</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">,</span>
                            <span class="n">DEVICE</span><span class="p">)</span>
    <span class="n">times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model_time</span><span class="p">)</span>

    <span class="n">top_1_acc</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">eval_imagenette</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">imagenette_val_loader</span><span class="p">,</span>
                                  <span class="nb">len</span><span class="p">(</span><span class="n">imagenette_val</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="n">DEVICE</span><span class="p">)</span>
    <span class="n">top_1_accuracies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">top_1_acc</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>

  <span class="k">return</span> <span class="n">times</span><span class="p">,</span> <span class="n">top_1_accuracies</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="plot-accuracies-vs-training-speed">
<h3>Plot accuracies vs. training speed<a class="headerlink" href="#plot-accuracies-vs-training-speed" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Plot accuracies vs. training speed</span>
<span class="k">def</span> <span class="nf">get_parameter_count</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Get parameter count per model</span>

<span class="sd">  Args:</span>
<span class="sd">    model: nn.module</span>
<span class="sd">      Model</span>

<span class="sd">  Returns:</span>
<span class="sd">    Parameter count for model</span>
<span class="sd">  """</span>
  <span class="k">return</span> <span class="nb">sum</span><span class="p">([</span><span class="n">torch</span><span class="o">.</span><span class="n">numel</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">()])</span>


<span class="k">def</span> <span class="nf">plot_acc_speed</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">accs</span><span class="p">,</span> <span class="n">models</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Plots Accuracy vs Speed</span>

<span class="sd">  Args:</span>
<span class="sd">    times: list</span>
<span class="sd">      Log of running times</span>
<span class="sd">    accs: list</span>
<span class="sd">      Log of accuracies</span>
<span class="sd">    models: dict</span>
<span class="sd">      Log of models</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  """</span>
  <span class="n">ti</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="o">*</span><span class="mi">1000</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times</span><span class="p">]</span>
  <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">get_parameter_count</span><span class="p">(</span><span class="n">models</span><span class="p">[</span><span class="n">model</span><span class="p">])</span><span class="o">*</span><span class="mf">1e-6</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ti</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">accs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Speed [ms]'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Accuracy'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Accuracy vs. Speed'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_models</span><span class="p">(</span><span class="n">weights</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Creates models</span>

<span class="sd">  Args:</span>
<span class="sd">    weights: list of strings</span>
<span class="sd">      If True, load pretrained models.</span>

<span class="sd">  Returns:</span>
<span class="sd">    models: dict</span>
<span class="sd">      Log of models</span>
<span class="sd">    lr_rates: list</span>
<span class="sd">      Log of learning rates</span>
<span class="sd">  """</span>
  <span class="c1">####################################################################</span>
  <span class="c1"># Fill in all missing code below (...),</span>
  <span class="c1"># then remove or comment the line below to test your function</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"create pretrained models"</span><span class="p">)</span>
  <span class="c1">####################################################################</span>
  <span class="c1"># Load three pretrained models from torchvision.models</span>
  <span class="c1"># [these are just examples, other models are possible as well]</span>
  <span class="n">model1</span> <span class="o">=</span> <span class="o">...</span>
  <span class="n">model2</span> <span class="o">=</span> <span class="o">...</span>
  <span class="n">model3</span> <span class="o">=</span> <span class="o">...</span>

  <span class="n">models</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'...'</span><span class="p">:</span> <span class="n">model1</span><span class="p">,</span> <span class="s1">'...'</span><span class="p">:</span> <span class="n">model2</span><span class="p">,</span> <span class="s1">'...'</span><span class="p">:</span> <span class="n">model3</span><span class="p">}</span>
  <span class="n">lr_rates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e-4</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">]</span>

  <span class="k">return</span> <span class="n">models</span><span class="p">,</span> <span class="n">lr_rates</span>


<span class="n">weight_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'ResNet18_Weights.DEFAULT'</span><span class="p">,</span> <span class="s1">'AlexNet_Weights.DEFAULT'</span><span class="p">,</span> <span class="s1">'VGG19_Weights.DEFAULT'</span><span class="p">]</span>
<span class="c1">## Uncomment below to test your function</span>
<span class="c1"># models, lr_rates = create_models(weights=weight_list)</span>
<span class="c1"># times, top_1_accuracies = run_models(models, lr_rates)</span>
<span class="c1"># plot_acc_speed(times, top_1_accuracies, models)</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>
<span class="k">def</span> <span class="nf">create_models</span><span class="p">(</span><span class="n">weights</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Creates models</span>

<span class="sd">  Args:</span>
<span class="sd">    weights: list of strings</span>
<span class="sd">      If True, load pretrained models.</span>

<span class="sd">  Returns:</span>
<span class="sd">    models: dict</span>
<span class="sd">      Log of models</span>
<span class="sd">    lr_rates: list</span>
<span class="sd">      Log of learning rates</span>
<span class="sd">  """</span>
  <span class="c1"># Load three pretrained models from torchvision.models</span>
  <span class="c1"># [these are just examples, other models are possible as well]</span>
  <span class="n">model1</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">resnet18</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
  <span class="n">model2</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">alexnet</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
  <span class="n">model3</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">vgg19</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

  <span class="n">models</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'ResNet18'</span><span class="p">:</span> <span class="n">model1</span><span class="p">,</span> <span class="s1">'AlexNet'</span><span class="p">:</span> <span class="n">model2</span><span class="p">,</span> <span class="s1">'VGG19'</span><span class="p">:</span> <span class="n">model3</span><span class="p">}</span>
  <span class="n">lr_rates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e-4</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">]</span>

  <span class="k">return</span> <span class="n">models</span><span class="p">,</span> <span class="n">lr_rates</span>


<span class="n">weight_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'ResNet18_Weights.DEFAULT'</span><span class="p">,</span> <span class="s1">'AlexNet_Weights.DEFAULT'</span><span class="p">,</span> <span class="s1">'VGG19_Weights.DEFAULT'</span><span class="p">]</span>
<span class="c1">## Uncomment below to test your function</span>
<span class="n">models</span><span class="p">,</span> <span class="n">lr_rates</span> <span class="o">=</span> <span class="n">create_models</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="n">weight_list</span><span class="p">)</span>
<span class="n">times</span><span class="p">,</span> <span class="n">top_1_accuracies</span> <span class="o">=</span> <span class="n">run_models</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">lr_rates</span><span class="p">)</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
  <span class="n">plot_acc_speed</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">top_1_accuracies</span><span class="p">,</span> <span class="n">models</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ResNet18 0.0001
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AlexNet 0.0001
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>VGG19 0.0001
</pre></div>
</div>
</div>
</div>
</section>
<section id="id24">
<h3>Submit your feedback<a class="headerlink" href="#id24" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Accuracy_vs_Training_Speed_Exercise"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="bonus-exercise-1-finding-the-best-model">
<h2>Bonus Exercise 1: Finding the best model<a class="headerlink" href="#bonus-exercise-1-finding-the-best-model" title="Permalink to this heading">#</a></h2>
<p>Look at the plot above.
It shows the training speed vs. the accuracy of the models you chose.
The training speed is measured as the mean time the training takes per epoch.
The size of the marker visualizes the number of parameters of the model.</p>
<p>Which model seems to be the best for this task and why?
Explain your conclusion based on speed, accuracy and number of parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove explanation</span>

<span class="sd">"""</span>
<span class="sd">Given the 3 suggested models, the ResNet is the best model because it has the</span>
<span class="sd">highest accuracy by being almost as fast as AlexNet and having less parameters.</span>
<span class="sd">"""</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<section id="id25">
<h3>Submit your feedback<a class="headerlink" href="#id25" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Finding_best_model_Exercise"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="bonus-exercise-2-speed-and-accuracy-correlation">
<h3>Bonus Exercise 2: Speed and accuracy correlation<a class="headerlink" href="#bonus-exercise-2-speed-and-accuracy-correlation" title="Permalink to this heading">#</a></h3>
<p>How does the speed correlate with the accuracy? Are faster models also more accurate?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove explanation</span>

<span class="sd">"""</span>
<span class="sd">Also depends on the models they chose. For example, if we compare VGG with ResNet,</span>
<span class="sd">the ResNet is both faster and more accurate. AlexNet is a bit faster than ResNet,</span>
<span class="sd">but not as accurate.</span>
<span class="sd">"""</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<section id="id26">
<h4>Submit your feedback<a class="headerlink" href="#id26" title="Permalink to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Speed_and_accuracy_correlation_Exercise"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
</section>
</section>
<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./tutorials/W2D3_ModernConvnets/instructor"
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'python3'</script>
</article>
<footer class="bd-footer-article">
<!-- Previous / next buttons -->
<div class="prev-next-area">
<a class="left-prev" href="../chapter_title.html" id="prev-link" title="previous page">
<i class="fa-solid fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">Modern Convnets</p>
</div>
</a>
<a class="right-next" href="W2D3_Tutorial2.html" id="next-link" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">Bonus Tutorial: Facial recognition using modern convnets</p>
</div>
<i class="fa-solid fa-angle-right"></i>
</a>
</div>
</footer>
</div>
<div class="bd-sidebar-secondary bd-toc">
<div class="toc-item">
<div class="tocsection onthispage">
<i class="fa-solid fa-list"></i> On this page
</div>
<nav class="page-toc" id="bd-toc-nav">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Tutorial 1: Learn how to use modern convnets
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#install-dependencies">
     Install dependencies
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#install-and-import-feedback-gadget">
     Install and import feedback gadget
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure settings
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#set-random-seed">
     Set random seed
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#set-device-gpu-or-cpu-execute-set-device">
     Set device (GPU or CPU). Execute
     <code class="docutils literal notranslate">
<span class="pre">
       set_device()
      </span>
</code>
</a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-modern-cnns-and-transfer-learning">
   Section 1: Modern CNNs and Transfer Learning
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-modern-cnns-and-transfer-learning">
     Video 1: Modern CNNs and Transfer Learning
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#submit-your-feedback">
     Submit your feedback
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-1-calculate-number-of-parameters-in-fcnn-vs-convnet">
     Coding Exercise 1: Calculate number of parameters in FCNN vs ConvNet
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id1">
       Submit your feedback
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-1-check-your-results">
     Interactive Demo 1: Check your results
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#parameter-calculator">
       Parameter Calculator
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id2">
       Submit your feedback
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-the-history-of-convnets">
   Section 2: The History of Convnets
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-2-history-of-convnets">
     Video 2: History of convnets
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id3">
     Submit your feedback
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-2-challenges-of-improving-cnns">
     Think! 2: Challenges of improving CNNs
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id4">
       Submit your feedback
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-big-and-deep-convnets">
   Section 3: Big and Deep Convnets
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-3-alexnet-vgg">
     Video 3: AlexNet &amp; VGG
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id5">
     Submit your feedback
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-1-introduction-to-alexnet">
     Section 3.1: Introduction to AlexNet
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#import-alexnet">
       Import Alexnet
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-2-what-does-alexnet-learn">
     Section 3.2: What does AlexNet learn?
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-3-2-1-filter-similarity">
       Think! 3.2.1: Filter Similarity
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id6">
         Submit your feedback
        </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-3-2-what-does-alexnet-see">
       Interactive Demo 3.2: What does AlexNet see?
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id7">
         Submit your feedback
        </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-3-2-2-filter-purpose">
       Think! 3.2.2 Filter Purpose
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id8">
         Submit your feedback
        </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#further-reading">
     Further Reading
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-4-convnets-after-alexnet">
   Section 4: Convnets After AlexNet
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-4-residual-networks-resnets">
     Video 4: Residual Networks (ResNets)
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id9">
     Submit your feedback
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#download-imagenette">
     Download imagenette
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#set-up-textual-imagenet-labels">
     Set Up Textual ImageNet labels
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#map-imagenette-labels-to-imagenet-labels">
     Map Imagenette Labels to Imagenet Labels
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#prepare-imagenette-data">
     Prepare Imagenette Data
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#eval-imagenette-function">
     eval_imagenette function
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#imagenette-train-loop">
     Imagenette Train Loop
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-4-1-use-the-resnet-model">
     Coding Exercise 4.1: Use the ResNet model
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id10">
       Submit your feedback
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#out-of-distribution-examples">
     Out-of-distribution examples
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-5-inception-resnext">
   Section 5: Inception + ResNeXt
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-5-improving-efficiency-inception-and-resnext">
     Video 5: Improving efficiency: Inception and ResNeXt
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id11">
     Submit your feedback
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#resnet-vs-resnext">
     ResNet vs ResNeXt
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-5-resnet-vs-resnext">
     Interactive Demo 5: ResNet vs. ResNeXt
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id12">
       Parameter Calculator
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id13">
       Submit your feedback
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-5-resnet-vs-resnext">
     Think! 5: ResNet vs. ResNeXt
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id14">
       Submit your feedback
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-6-depthwise-separable-convolutions">
   Section 6: Depthwise separable convolutions
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-6-improving-efficiency-mobilenet">
     Video 6: Improving efficiency: MobileNet
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id15">
     Submit your feedback
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-6-1-depthwise-separable-convolutions">
     Section 6.1: Depthwise separable convolutions
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-6-1-calculation-of-parameters">
       Coding Exercise 6.1: Calculation of parameters
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id16">
         Submit your feedback
        </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-6-1-how-do-parameter-savings-depend-the-on-number-of-input-feature-maps-4-vs-64">
       Think! 6.1: How do parameter savings depend the on number of input feature maps, 4 vs. 64?
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id17">
         Submit your feedback
        </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-7-transfer-learning">
   Section 7: Transfer Learning
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-7-transfer-learning">
     Video 7: Transfer Learning
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id18">
     Submit your feedback
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-7-1-download-and-prepare-the-data">
     Section 7.1: Download and prepare the data
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#download-data">
       Download Data
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#determine-number-of-classes">
       Determine number of classes
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#display-example-images">
       Display Example Images
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-7-2-fine-tuning-a-resnet">
     Section 7.2: Fine-tuning a ResNet
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#finetune-resnet">
       Finetune ResNet
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-7-3-train-only-classification-layer">
     Section 7.3: Train only classification layer
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#finetune-readout-of-resnet">
       Finetune readout of ResNet
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-7-4-training-resnet-from-scratch">
     Section 7.4: Training ResNet from scratch
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#train-resnet-from-scratch">
       Train ResNet from scratch
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-7-5-head-to-head-comparison">
     Section 7.5: Head to Head Comparison
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#plot-accuracies">
       Plot Accuracies
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#exercise-7-5-1-pretrained-resnet-vs-resnet-trained-from-scratch">
       Exercise 7.5.1: Pretrained ResNet vs. ResNet trained from scratch
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id19">
         Submit your feedback
        </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#exercise-7-5-2-training-only-the-classification-layer">
       Exercise 7.5.2: Training only the classification layer
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id20">
         Submit your feedback
        </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id21">
     Further Reading
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#summary">
   Summary
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-8-summary-and-outlook">
     Video 8: Summary and Outlook
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id22">
     Submit your feedback
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#daily-survey">
   Daily survey
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-speed-accuracy-trade-off-different-backbones">
   Bonus: Speed-Accuracy Trade-Off / Different Backbones
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-9-speed-accuracy-trade-off">
     Video 9: Speed-accuracy trade-off
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id23">
     Submit your feedback
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-coding-exercise-compare-accuracy-and-training-speed-of-different-models">
     Bonus Coding Exercise: Compare accuracy and training speed of different models
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#imagenette-train-loop-train-loop-model-optimizer-train-loader-loss-fn-device">
       Imagenette Train Loop:
       <code class="docutils literal notranslate">
<span class="pre">
         train_loop(model,
        </span>
<span class="pre">
         optimizer,
        </span>
<span class="pre">
         train_loader,
        </span>
<span class="pre">
         loss_fn,
        </span>
<span class="pre">
         device)
        </span>
</code>
</a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#run-the-models-run-models-models-lr-rates">
       Run the models:
       <code class="docutils literal notranslate">
<span class="pre">
         run_models(models,
        </span>
<span class="pre">
         lr_rates)
        </span>
</code>
</a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#plot-accuracies-vs-training-speed">
       Plot accuracies vs. training speed
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id24">
       Submit your feedback
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-exercise-1-finding-the-best-model">
     Bonus Exercise 1: Finding the best model
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id25">
       Submit your feedback
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-exercise-2-speed-and-accuracy-correlation">
       Bonus Exercise 2: Speed and accuracy correlation
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id26">
         Submit your feedback
        </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</div>
<footer class="bd-footer-content">
<div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
<div class="footer-item">
<p class="component-author">
By Neuromatch
</p>
</div>
<div class="footer-item">
</div>
<div class="footer-item">
<p class="last-updated">
Last updated on None.<br/>
</p>
</div>
<div class="footer-item">
<div class="extra_footer">
<div>
<a href="http://creativecommons.org/licenses/by/4.0/"><img src="https://i.creativecommons.org/l/by/4.0/88x31.png"/></a>
<a href="https://opensource.org/licenses/BSD-3-Clause"><img src="https://camo.githubusercontent.com/9b9ea65d95c9ef878afa1987df65731d47681336/68747470733a2f2f696d672e736869656c64732e696f2f707970692f6c2f736561626f726e2e737667"/></a>
The contents of this repository are shared under the <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
Software elements are additionally licensed under the <a href="https://opensource.org/licenses/BSD-3-Clause">BSD (3-Clause) License</a>.
</div>
</div>
</div>
</div>
</div>
</footer>
</main>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../../../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script>
</body>
</html>