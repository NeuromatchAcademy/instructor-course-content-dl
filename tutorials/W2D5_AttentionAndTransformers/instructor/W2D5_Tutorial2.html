
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bonus Tutorial: Understanding Pre-training, Fine-tuning and Robustness of Transformers &#8212; Neuromatch Academy: Deep Learning (instructor&#39;s version)</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script >const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <link rel="shortcut icon" href="../../../_static/nma-dl-logo-square-4xp.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Time Series And Natural Language Processing" href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/chapter_title.html" />
    <link rel="prev" title="Tutorial 1: Learn how to work with Transformers" href="W2D5_Tutorial1.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/nma-dl-logo-square-4xp.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Neuromatch Academy: Deep Learning (instructor's version)</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../tatraining/TA_Training_DL.html">
   TA Training: Deep Learning (DL)
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Schedule/schedule_intro.html">
   Schedule
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Schedule/daily_schedules.html">
     General schedule
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Schedule/shared_calendars.html">
     Shared calendars
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Schedule/timezone_widget.html">
     Timezone widget
    </a>
   </li>
  </ul>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../TechnicalHelp/tech_intro.html">
   Technical Help
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../TechnicalHelp/Jupyterbook.html">
     Using jupyterbook
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../TechnicalHelp/Tutorial_colab.html">
       Using Google Colab
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../TechnicalHelp/Tutorial_kaggle.html">
       Using Kaggle
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../TechnicalHelp/Discord.html">
     Using Discord
    </a>
   </li>
  </ul>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../TechnicalHelp/Links_Policy.html">
   Quick links and policies
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../prereqs/DeepLearning.html">
   Prerequisites and preparatory materials for NMA Deep Learning
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Basics Module
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W1D1_BasicsAndPytorch/chapter_title.html">
   Basics And Pytorch (W1D1)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D1_BasicsAndPytorch/instructor/W1D1_Tutorial1.html">
     Tutorial 1: PyTorch
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W1D2_LinearDeepLearning/chapter_title.html">
   Linear Deep Learning (W1D2)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D2_LinearDeepLearning/instructor/W1D2_Tutorial1.html">
     Tutorial 1: Gradient Descent and AutoGrad
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D2_LinearDeepLearning/instructor/W1D2_Tutorial2.html">
     Tutorial 2: Learning Hyperparameters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D2_LinearDeepLearning/instructor/W1D2_Tutorial3.html">
     Tutorial 3: Deep linear neural networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D2_LinearDeepLearning/instructor/W1D2_BonusLecture.html">
     Bonus Lecture: Yoshua Bengio
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W1D3_MultiLayerPerceptrons/chapter_title.html">
   Multi Layer Perceptrons (W1D3)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D3_MultiLayerPerceptrons/instructor/W1D3_Tutorial1.html">
     Tutorial 1: Biological vs. Artificial Neural Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D3_MultiLayerPerceptrons/instructor/W1D3_Tutorial2.html">
     Tutorial 2: Deep MLPs
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Fine Tuning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W1D5_Optimization/chapter_title.html">
   Optimization (W1D5)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D5_Optimization/instructor/W1D5_Tutorial1.html">
     Tutorial 1: Optimization techniques
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W2D1_Regularization/chapter_title.html">
   Regularization (W2D1)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D1_Regularization/instructor/W2D1_Tutorial1.html">
     Tutorial 1: Regularization techniques part 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D1_Regularization/instructor/W2D1_Tutorial2.html">
     Tutorial 2: Regularization techniques part 2
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Module_WrapUps/FineTuning.html">
   Deep Learning: The Basics and Fine Tuning Wrap-up
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  ConvNets and Generative Models
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W2D2_ConvnetsAndDlThinking/chapter_title.html">
   Convnets And Dl Thinking (W2D2)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D2_ConvnetsAndDlThinking/instructor/W2D2_Tutorial1.html">
     Tutorial 1: Introduction to CNNs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D2_ConvnetsAndDlThinking/instructor/W2D2_Tutorial2.html">
     Tutorial 2: Deep Learning Thinking 1: Cost Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D2_ConvnetsAndDlThinking/instructor/W2D2_BonusLecture.html">
     Bonus Lecture: Kyunghyun Cho
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W2D3_ModernConvnets/chapter_title.html">
   Modern Convnets (W2D3)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D3_ModernConvnets/instructor/W2D3_Tutorial1.html">
     Tutorial 1: Learn how to use modern convnets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D3_ModernConvnets/instructor/W2D3_Tutorial2.html">
     Bonus Tutorial: Facial recognition using modern convnets
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W2D4_GenerativeModels/chapter_title.html">
   Generative Models (W2D4)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D4_GenerativeModels/instructor/W2D4_Tutorial1.html">
     Tutorial 1: Variational Autoencoders (VAEs)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D4_GenerativeModels/instructor/W2D4_Tutorial2.html">
     Tutorial 2: Diffusion models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D4_GenerativeModels/instructor/W2D4_Tutorial3.html">
     Tutorial 3: Image, Conditional Diffusion and Beyond
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D4_GenerativeModels/instructor/W2D4_BonusLecture.html">
     Bonus Lecture: Geoffrey Hinton
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Natural Language Processing
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../chapter_title.html">
   Attention And Transformers (W2D5)
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="W2D5_Tutorial1.html">
     Tutorial 1: Learn how to work with Transformers
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Bonus Tutorial: Understanding Pre-training, Fine-tuning and Robustness of Transformers
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/chapter_title.html">
   Time Series And Natural Language Processing (W3D1)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/instructor/W3D1_Tutorial1.html">
     Tutorial 1: Introduction to processing time series
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/instructor/W3D1_Tutorial2.html">
     Tutorial 2: Natural Language Processing and LLMs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/instructor/W3D1_Tutorial3.html">
     Bonus Tutorial: Multilingual Embeddings
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W3D2_DlThinking2/chapter_title.html">
   Dl Thinking2 (W3D2)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D2_DlThinking2/instructor/W3D2_Tutorial1.html">
     Tutorial 1: Deep Learning Thinking 2: Architectures and Multimodal DL thinking
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Module_WrapUps/NaturalLanguageProcessing.html">
   Deep Learning: Convnets and NLP
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Unsupervised and Reinforcement Learning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W3D3_UnsupervisedAndSelfSupervisedLearning/chapter_title.html">
   Unsupervised And Self Supervised Learning (W3D3)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D3_UnsupervisedAndSelfSupervisedLearning/instructor/W3D3_Tutorial1.html">
     Tutorial 1: Un/Self-supervised learning methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D3_UnsupervisedAndSelfSupervisedLearning/instructor/W3D3_BonusLecture.html">
     Bonus Lecture: Melanie Mitchell
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W3D4_BasicReinforcementLearning/chapter_title.html">
   Basic Reinforcement Learning (W3D4)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D4_BasicReinforcementLearning/instructor/W3D4_Tutorial1.html">
     Tutorial 1: Basic Reinforcement Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D4_BasicReinforcementLearning/instructor/W3D4_BonusLecture.html">
     Bonus Lecture: Chealsea Finn
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W3D5_ReinforcementLearningForGamesAndDlThinking3/chapter_title.html">
   Reinforcement Learning For Games And Dl Thinking3 (W3D5)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D5_ReinforcementLearningForGamesAndDlThinking3/instructor/W3D5_Tutorial1.html">
     Tutorial 1: Reinforcement Learning For Games
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D5_ReinforcementLearningForGamesAndDlThinking3/instructor/W3D5_Tutorial2.html">
     Tutorial 2: Deep Learning Thinking 3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D5_ReinforcementLearningForGamesAndDlThinking3/instructor/W3D5_Tutorial3.html">
     Bonus Tutorial: Planning with Monte Carlo Tree Search
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D5_ReinforcementLearningForGamesAndDlThinking3/instructor/W3D5_BonusLecture.html">
     Bonus Lecture: Amita Kapoor
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Deploy Models on the Web
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Bonus_DeployModels/chapter_title.html">
   Deploy Models (Bonus)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
  <label for="toctree-checkbox-18">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Bonus_DeployModels/instructor/Bonus_Tutorial1.html">
     Bonus Tutorial: Deploying Neural Networks on the Web
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Project Booklet
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../projects/README.html">
   Introduction to projects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../projects/docs/project_guidance.html">
   Daily guide for projects
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../projects/modelingsteps/intro.html">
   Modeling Step-by-Step Guide
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
  <label for="toctree-checkbox-19">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_1through2_DL.html">
     Modeling Steps 1 - 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_3through4_DL.html">
     Modeling Steps 3 - 4
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_5through6_DL.html">
     Modeling Steps 5 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_7through9_DL.html">
     Modeling Steps 7 - 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_10_DL.html">
     Modeling Steps 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionDataProjectDL.html">
     Example Data Project: the Train Illusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionModelingProjectDL.html">
     Example Model Project: the Train Illusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../projects/modelingsteps/Example_Deep_Learning_Project.html">
     Example Deep Learning Project
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../projects/docs/projects_overview.html">
   Project Templates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
  <label for="toctree-checkbox-20">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../projects/ComputerVision/README.html">
     Computer Vision
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
    <label for="toctree-checkbox-21">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ComputerVision/slides.html">
       Slides
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ComputerVision/ideas_and_datasets.html">
       Ideas
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ComputerVision/em_synapses.html">
       Knowledge Extraction from a Convolutional Neural Network
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ComputerVision/spectrogram_analysis.html">
       Music classification and generation with spectrograms
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ComputerVision/screws.html">
       Something Screwy - image recognition, detection, and classification of screws
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ComputerVision/data_augmentation.html">
       Data Augmentation in image classification models
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ComputerVision/transfer_learning.html">
       Transfer Learning
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../projects/ReinforcementLearning/README.html">
     Reinforcement Learning
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
    <label for="toctree-checkbox-22">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ReinforcementLearning/slides.html">
       Slides
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ReinforcementLearning/ideas_and_datasets.html">
       Ideas
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ReinforcementLearning/robolympics.html">
       NMA Robolympics: Controlling robots using reinforcement learning
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ReinforcementLearning/lunar_lander.html">
       Performance Analysis of DQN Algorithm on the Lunar Lander task
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ReinforcementLearning/human_rl.html">
       Using RL to Model Cognitive Tasks
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../projects/NaturalLanguageProcessing/README.html">
     Natural Language Processing
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
    <label for="toctree-checkbox-23">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/NaturalLanguageProcessing/slides.html">
       Slides
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/NaturalLanguageProcessing/ideas_and_datasets.html">
       Ideas
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/NaturalLanguageProcessing/sentiment_analysis.html">
       Twitter Sentiment Analysis
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/NaturalLanguageProcessing/machine_translation.html">
       Machine Translation
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../projects/Neuroscience/README.html">
     Neuroscience
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/>
    <label for="toctree-checkbox-24">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/Neuroscience/slides.html">
       Slides
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/Neuroscience/ideas_and_datasets.html">
       Ideas
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/Neuroscience/pose_estimation.html">
       Animal Pose Estimation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/Neuroscience/cellular_segmentation.html">
       Segmentation and Denoising
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/Neuroscience/algonauts_videos.html">
       Load algonauts videos
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/Neuroscience/blurry_vision.html">
       Vision with Lost Glasses: Modelling how the brain deals with noisy input
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/Neuroscience/finetuning_fmri.html">
       Moving beyond Labels: Finetuning CNNs on BOLD response
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/Neuroscience/neuro_seq_to_seq.html">
       Focus on what matters: inferring low-dimensional dynamics from neural recordings
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../projects/docs/datasets_and_models.html">
   Models and Data sets
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/NeuromatchAcademy/instructor-course-content-dl"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/NeuromatchAcademy/instructor-course-content-dl/issues/new?title=Issue%20on%20page%20%2Ftutorials/W2D5_AttentionAndTransformers/instructor/W2D5_Tutorial2.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../_sources/tutorials/W2D5_AttentionAndTransformers/instructor/W2D5_Tutorial2.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Bonus Tutorial: Understanding Pre-training, Fine-tuning and Robustness of Transformers
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install-dependencies">
     Install dependencies
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install-and-import-feedback-gadget">
     Install and import feedback gadget
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-environment-variables">
     Set environment variables
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-random-seed">
     Set random seed
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-device-gpu-or-cpu-execute-set-device">
     Set device (GPU or CPU). Execute
     <code class="docutils literal notranslate">
      <span class="pre">
       set_device()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bonus-1-language-modeling-as-pre-training">
   Bonus 1: Language modeling as pre-training
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#video-1-pre-training">
     Video 1: Pre-training
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#submit-your-feedback">
     Submit your feedback
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#bonus-interactive-demo-1-gpt-2-for-sentiment-classification">
       Bonus Interactive Demo 1: GPT-2 for sentiment classification
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#download-the-dataset-from-osf">
         Download the dataset from OSF
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#load-the-dataset">
         Load the dataset
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#bonus-1-1-load-yelp-reviews-dataset">
         Bonus 1.1: Load Yelp reviews dataset ⌛🤗
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#bonus-1-2-setting-up-a-text-context">
         Bonus 1.2: Setting up a text context ✍️
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#bonus-1-3-extending-the-review-with-pre-trained-models">
         Bonus 1.3: Extending the review with pre-trained models 🤖
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#bonus-1-4-sentiment-binary-classification-with-likelihood-of-positive-and-negative-extensions-of-the-review">
         Bonus 1.4: Sentiment binary-classification with likelihood of positive and negative extensions of the review 👍👎
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bonus-2-light-weight-fine-tuning">
   Bonus 2: Light-weight fine-tuning
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#video-2-fine-tuning">
     Video 2: Fine-tuning
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Submit your feedback
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bonus-2-1-data-processing">
     Bonus 2.1: Data Processing
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bonus-2-2-model-loading">
     Bonus 2.2: Model Loading
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bonus-2-3-fine-tuning">
     Bonus 2.3: Fine-tuning
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bonus-3-model-robustness">
   Bonus 3: Model robustness
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#video-3-robustness">
     Video 3: Robustness
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Submit your feedback
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bonus-interactive-demo-3-break-the-model">
     Bonus Interactive Demo 3: Break the model
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#bonus-3-1-load-an-original-review">
       Bonus 3.1: Load an original review
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Submit your feedback
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#helper-functions-to-avoid-textattack-issue">
       Helper functions to avoid
       <code class="docutils literal notranslate">
        <span class="pre">
         textattack
        </span>
       </code>
       issue
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#bonus-3-2-augment-the-original-review">
       Bonus 3.2: Augment the original review
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#bonus-3-3-check-model-predictions">
       Bonus 3.3: Check model predictions
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       Submit your feedback
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Bonus Tutorial: Understanding Pre-training, Fine-tuning and Robustness of Transformers</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Bonus Tutorial: Understanding Pre-training, Fine-tuning and Robustness of Transformers
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install-dependencies">
     Install dependencies
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install-and-import-feedback-gadget">
     Install and import feedback gadget
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-environment-variables">
     Set environment variables
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-random-seed">
     Set random seed
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-device-gpu-or-cpu-execute-set-device">
     Set device (GPU or CPU). Execute
     <code class="docutils literal notranslate">
      <span class="pre">
       set_device()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bonus-1-language-modeling-as-pre-training">
   Bonus 1: Language modeling as pre-training
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#video-1-pre-training">
     Video 1: Pre-training
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#submit-your-feedback">
     Submit your feedback
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#bonus-interactive-demo-1-gpt-2-for-sentiment-classification">
       Bonus Interactive Demo 1: GPT-2 for sentiment classification
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#download-the-dataset-from-osf">
         Download the dataset from OSF
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#load-the-dataset">
         Load the dataset
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#bonus-1-1-load-yelp-reviews-dataset">
         Bonus 1.1: Load Yelp reviews dataset ⌛🤗
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#bonus-1-2-setting-up-a-text-context">
         Bonus 1.2: Setting up a text context ✍️
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#bonus-1-3-extending-the-review-with-pre-trained-models">
         Bonus 1.3: Extending the review with pre-trained models 🤖
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#bonus-1-4-sentiment-binary-classification-with-likelihood-of-positive-and-negative-extensions-of-the-review">
         Bonus 1.4: Sentiment binary-classification with likelihood of positive and negative extensions of the review 👍👎
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bonus-2-light-weight-fine-tuning">
   Bonus 2: Light-weight fine-tuning
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#video-2-fine-tuning">
     Video 2: Fine-tuning
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Submit your feedback
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bonus-2-1-data-processing">
     Bonus 2.1: Data Processing
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bonus-2-2-model-loading">
     Bonus 2.2: Model Loading
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bonus-2-3-fine-tuning">
     Bonus 2.3: Fine-tuning
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bonus-3-model-robustness">
   Bonus 3: Model robustness
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#video-3-robustness">
     Video 3: Robustness
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Submit your feedback
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bonus-interactive-demo-3-break-the-model">
     Bonus Interactive Demo 3: Break the model
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#bonus-3-1-load-an-original-review">
       Bonus 3.1: Load an original review
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Submit your feedback
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#helper-functions-to-avoid-textattack-issue">
       Helper functions to avoid
       <code class="docutils literal notranslate">
        <span class="pre">
         textattack
        </span>
       </code>
       issue
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#bonus-3-2-augment-the-original-review">
       Bonus 3.2: Augment the original review
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#bonus-3-3-check-model-predictions">
       Bonus 3.3: Check model predictions
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       Submit your feedback
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <p><a href="https://colab.research.google.com/github/NeuromatchAcademy/course-content-dl/blob/main/tutorials/W2D5_AttentionAndTransformers/instructor/W2D5_Tutorial2.ipynb" target="_blank"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a>   <a href="https://kaggle.com/kernels/welcome?src=https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W2D5_AttentionAndTransformers/instructor/W2D5_Tutorial2.ipynb" target="_blank"><img alt="Open in Kaggle" src="https://kaggle.com/static/images/open-in-kaggle.svg" /></a></p>
<div class="section" id="bonus-tutorial-understanding-pre-training-fine-tuning-and-robustness-of-transformers">
<h1>Bonus Tutorial: Understanding Pre-training, Fine-tuning and Robustness of Transformers<a class="headerlink" href="#bonus-tutorial-understanding-pre-training-fine-tuning-and-robustness-of-transformers" title="Permalink to this headline">¶</a></h1>
<p><strong>Week 2, Day 5: Attention and Transformers</strong></p>
<p><strong>By Neuromatch Academy</strong></p>
<p><strong>Content creators:</strong> Bikram Khastgir, Rajaswa Patil, Egor Zverev, Kelson Shilling-Scrivo, Alish Dipani, He He</p>
<p><strong>Content reviewers:</strong> Ezekiel Williams, Melvin Selim Atay, Khalid Almubarak, Lily Cheng, Hadi Vafaei, Kelson Shilling-Scrivo</p>
<p><strong>Content editors:</strong> Gagana B, Anoop Kulkarni, Spiros Chavlis</p>
<p><strong>Production editors:</strong> Khalid Almubarak, Gagana B, Spiros Chavlis</p>
</div>
<hr class="docutils" />
<div class="section" id="tutorial-objectives">
<h1>Tutorial Objectives<a class="headerlink" href="#tutorial-objectives" title="Permalink to this headline">¶</a></h1>
<p>On finishing the tutorial, you will be able to:</p>
<ul class="simple">
<li><p>Write down the objective of language model pre-training</p></li>
<li><p>Understand the framework of pre-training then fine-tuning</p></li>
<li><p>Name three types of biases in pre-trained language models</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "c6a465f6c80e4f9995792e8c6d907cf0", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h1>
<p>In this section, we will install, and import libraries, as well as helper functions needed for this tutorial.</p>
<div class="section" id="install-dependencies">
<h2>Install dependencies<a class="headerlink" href="#install-dependencies" title="Permalink to this headline">¶</a></h2>
<p>There may be <em>errors</em> and/or <em>warnings</em> reported during the installation. However, they are to be ignored.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Install dependencies</span>
<span class="c1"># @markdown There may be *errors* and/or *warnings* reported during the installation. However, they are to be ignored.</span>
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>datasets<span class="w"> </span>--quiet
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>accelerate<span class="w"> </span>--quiet
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>transformers<span class="w"> </span>--quiet
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="install-and-import-feedback-gadget">
<h2>Install and import feedback gadget<a class="headerlink" href="#install-and-import-feedback-gadget" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Install and import feedback gadget</span>

<span class="o">!</span>pip3<span class="w"> </span>install<span class="w"> </span>vibecheck<span class="w"> </span>datatops<span class="w"> </span>--quiet

<span class="kn">from</span> <span class="nn">vibecheck</span> <span class="kn">import</span> <span class="n">DatatopsContentReviewContainer</span>
<span class="k">def</span> <span class="nf">content_review</span><span class="p">(</span><span class="n">notebook_section</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">DatatopsContentReviewContainer</span><span class="p">(</span>
        <span class="s2">&quot;&quot;</span><span class="p">,</span>  <span class="c1"># No text prompt</span>
        <span class="n">notebook_section</span><span class="p">,</span>
        <span class="p">{</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://pmyvdlilci.execute-api.us-east-1.amazonaws.com/klab&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;neuromatch_dl&quot;</span><span class="p">,</span>
            <span class="s2">&quot;user_key&quot;</span><span class="p">:</span> <span class="s2">&quot;f379rz8y&quot;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">)</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>


<span class="n">feedback_prefix</span> <span class="o">=</span> <span class="s2">&quot;W2D5_T2_Bonus&quot;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="set-environment-variables">
<h2>Set environment variables<a class="headerlink" href="#set-environment-variables" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Set environment variables</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;TA_CACHE_DIR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;data/&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;NLTK_DATA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;nltk_data/&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imports</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">nltk</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">datasets</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>

<span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">brown</span>
<span class="kn">from</span> <span class="nn">gensim.models</span> <span class="kn">import</span> <span class="n">Word2Vec</span>
<span class="kn">from</span> <span class="nn">sklearn.manifold</span> <span class="kn">import</span> <span class="n">TSNE</span>

<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">from</span> <span class="nn">torch.autograd</span> <span class="kn">import</span> <span class="n">Variable</span>
<span class="kn">from</span> <span class="nn">torchtext.vocab</span> <span class="kn">import</span> <span class="n">Vectors</span>

<span class="c1"># transformers library</span>
<span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">Trainer</span>
<span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">pipeline</span>
<span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">AutoTokenizer</span>
<span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">TrainingArguments</span>
<span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">AutoModelForCausalLM</span>
<span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">AutoModelForSequenceClassification</span>

<span class="o">%</span><span class="k">load_ext</span> tensorboard
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="set-random-seed">
<h2>Set random seed<a class="headerlink" href="#set-random-seed" title="Permalink to this headline">¶</a></h2>
<p>Executing <code class="docutils literal notranslate"><span class="pre">set_seed(seed=seed)</span></code> you are setting the seed</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Set random seed</span>

<span class="c1"># @markdown Executing `set_seed(seed=seed)` you are setting the seed</span>

<span class="c1"># for DL its critical to set the random seed so that students can have a</span>
<span class="c1"># baseline to compare their results to expected results.</span>
<span class="c1"># Read more here: https://pytorch.org/docs/stable/notes/randomness.html</span>

<span class="c1"># Call `set_seed` function in the exercises to ensure reproducibility.</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">torch</span>

<span class="k">def</span> <span class="nf">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed_torch</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Handles variability by controlling sources of randomness</span>
<span class="sd">  through set seed values</span>

<span class="sd">  Args:</span>
<span class="sd">    seed: Integer</span>
<span class="sd">      Set the seed value to given integer.</span>
<span class="sd">      If no seed, set seed value to random integer in the range 2^32</span>
<span class="sd">    seed_torch: Bool</span>
<span class="sd">      Seeds the random number generator for all devices to</span>
<span class="sd">      offer some guarantees on reproducibility</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="mi">32</span><span class="p">)</span>
  <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">seed_torch</span><span class="p">:</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">manual_seed_all</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">cudnn</span><span class="o">.</span><span class="n">benchmark</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">cudnn</span><span class="o">.</span><span class="n">deterministic</span> <span class="o">=</span> <span class="kc">True</span>

  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Random seed </span><span class="si">{</span><span class="n">seed</span><span class="si">}</span><span class="s1"> has been set.&#39;</span><span class="p">)</span>


<span class="c1"># In case that `DataLoader` is used</span>
<span class="k">def</span> <span class="nf">seed_worker</span><span class="p">(</span><span class="n">worker_id</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  DataLoader will reseed workers following randomness in</span>
<span class="sd">  multi-process data loading algorithm.</span>

<span class="sd">  Args:</span>
<span class="sd">    worker_id: integer</span>
<span class="sd">      ID of subprocess to seed. 0 means that</span>
<span class="sd">      the data will be loaded in the main process</span>
<span class="sd">      Refer: https://pytorch.org/docs/stable/data.html#data-loading-randomness for more details</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">worker_seed</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">initial_seed</span><span class="p">()</span> <span class="o">%</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span>
  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">worker_seed</span><span class="p">)</span>
  <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">worker_seed</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="set-device-gpu-or-cpu-execute-set-device">
<h2>Set device (GPU or CPU). Execute <code class="docutils literal notranslate"><span class="pre">set_device()</span></code><a class="headerlink" href="#set-device-gpu-or-cpu-execute-set-device" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Set device (GPU or CPU). Execute `set_device()`</span>
<span class="c1"># especially if torch modules used.</span>

<span class="c1"># inform the user if the notebook uses GPU or CPU.</span>

<span class="k">def</span> <span class="nf">set_device</span><span class="p">():</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Set the device. CUDA if available, CPU otherwise</span>

<span class="sd">  Args:</span>
<span class="sd">    None</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">device</span> <span class="o">=</span> <span class="s2">&quot;cuda&quot;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;cpu&quot;</span>
  <span class="k">if</span> <span class="n">device</span> <span class="o">!=</span> <span class="s2">&quot;cuda&quot;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: For this notebook to perform best, &quot;</span>
        <span class="s2">&quot;if possible, in the menu under `Runtime` -&gt; &quot;</span>
        <span class="s2">&quot;`Change runtime type.`  select `GPU` &quot;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;GPU is enabled in this notebook.&quot;</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">device</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SEED</span> <span class="o">=</span> <span class="mi">2021</span>
<span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
<span class="n">DEVICE</span> <span class="o">=</span> <span class="n">set_device</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Random seed 2021 has been set.
GPU is enabled in this notebook.
</pre></div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="bonus-1-language-modeling-as-pre-training">
<h1>Bonus 1: Language modeling as pre-training<a class="headerlink" href="#bonus-1-language-modeling-as-pre-training" title="Permalink to this headline">¶</a></h1>
<p><em>Time estimate: ~20mins</em></p>
<div class="section" id="video-1-pre-training">
<h2>Video 1: Pre-training<a class="headerlink" href="#video-1-pre-training" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "c723ba79622f47ba9e8f88809f5799b8", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</div>
<div class="section" id="submit-your-feedback">
<h2>Submit your feedback<a class="headerlink" href="#submit-your-feedback" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_PreTraining_Video&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "ef92d541b6bf4c509e72729d4bddbe55", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<div class="section" id="bonus-interactive-demo-1-gpt-2-for-sentiment-classification">
<h3>Bonus Interactive Demo 1: GPT-2 for sentiment classification<a class="headerlink" href="#bonus-interactive-demo-1-gpt-2-for-sentiment-classification" title="Permalink to this headline">¶</a></h3>
<p>In this section, we will use the pre-trained language model GPT-2 for sentiment classification.</p>
<p>Let’s first load the Yelp review dataset.</p>
<div class="section" id="download-the-dataset-from-osf">
<h4>Download the dataset from OSF<a class="headerlink" href="#download-the-dataset-from-osf" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Download the dataset from OSF</span>
<span class="kn">import</span> <span class="nn">requests</span><span class="o">,</span> <span class="nn">tarfile</span>

<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HF_DATASETS_CACHE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;data/&#39;</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://osf.io/kthjg/download&quot;</span>
<span class="n">fname</span> <span class="o">=</span> <span class="s2">&quot;huggingface.tar.gz&quot;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dataset is being downloaded...&#39;</span><span class="p">)</span>
  <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
    <span class="n">fd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Download is finished.&#39;</span><span class="p">)</span>

  <span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span> <span class="k">as</span> <span class="n">ft</span><span class="p">:</span>
    <span class="n">ft</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="s1">&#39;data/&#39;</span><span class="p">)</span>
  <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Files have been extracted.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataset is being downloaded...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Download is finished.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Files have been extracted.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="load-the-dataset">
<h4>Load the dataset<a class="headerlink" href="#load-the-dataset" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Load the dataset</span>

<span class="n">DATASET</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;yelp_review_full&quot;</span><span class="p">,</span>
                                <span class="n">download_mode</span><span class="o">=</span><span class="s2">&quot;reuse_dataset_if_exists&quot;</span><span class="p">,</span>
                                <span class="n">cache_dir</span><span class="o">=</span><span class="s1">&#39;data/&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">DATASET</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "4441189b7bb54e8287631ac7f2976471", "version_major": 2, "version_minor": 0}
</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;datasets.dataset_dict.DatasetDict&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># If the above cell produces an error uncomment below and run this cell.</span>
<span class="c1"># DATASET = load_dataset(&quot;yelp_review_full&quot;, ignore_verifications=True)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="bonus-1-1-load-yelp-reviews-dataset">
<h4>Bonus 1.1: Load Yelp reviews dataset ⌛🤗<a class="headerlink" href="#bonus-1-1-load-yelp-reviews-dataset" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Bonus 1.1: Load Yelp reviews dataset ⌛🤗</span>
<span class="n">train_dataset</span> <span class="o">=</span> <span class="n">DATASET</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span>
<span class="n">test_dataset</span> <span class="o">=</span> <span class="n">DATASET</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span>

<span class="c1"># filter training data by sentiment value</span>
<span class="n">sentiment_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">sentiment_dict</span><span class="p">[</span><span class="s2">&quot;Sentiment = 0&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_dataset</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">example</span><span class="p">:</span> <span class="n">example</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sentiment_dict</span><span class="p">[</span><span class="s2">&quot;Sentiment = 1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_dataset</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">example</span><span class="p">:</span> <span class="n">example</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sentiment_dict</span><span class="p">[</span><span class="s2">&quot;Sentiment = 2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_dataset</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">example</span><span class="p">:</span> <span class="n">example</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sentiment_dict</span><span class="p">[</span><span class="s2">&quot;Sentiment = 3&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_dataset</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">example</span><span class="p">:</span> <span class="n">example</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span>
<span class="n">sentiment_dict</span><span class="p">[</span><span class="s2">&quot;Sentiment = 4&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_dataset</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">example</span><span class="p">:</span> <span class="n">example</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "dfe326a7b4204bfb904f7136ebfc406b", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "c4ad213b45c34bd3a3c09b962d7b0cf3", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "e10ac461af5a420aa809dacac5b4f75a", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "db05dc83cdf244d8850f143c30add745", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "05251ba55a834c4b819519ef6aee29a9", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<p><strong>Kaggle users:</strong> If the cell above fails, please re-execute it several times!</p>
<p>Next, we’ll set up a text context for the pre-trained language models. We can either sample a review from the Yelp reviews dataset or write our own custom review as the text context. We will perform text-generation and sentiment-classification with this text context.</p>
</div>
<div class="section" id="bonus-1-2-setting-up-a-text-context">
<h4>Bonus 1.2: Setting up a text context ✍️<a class="headerlink" href="#bonus-1-2-setting-up-a-text-context" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Bonus 1.2: Setting up a text context ✍️</span>

<span class="k">def</span> <span class="nf">clean_text</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to clean up text</span>

<span class="sd">    Args:</span>
<span class="sd">      text: String</span>
<span class="sd">        Input text sequence</span>

<span class="sd">    Returns:</span>
<span class="sd">      text: String</span>
<span class="sd">        Returned clean string does not contain new-line characters,</span>
<span class="sd">        backslashes etc.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">n&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">text</span>

<span class="c1"># @markdown ---</span>
<span class="n">sample_review_from_yelp</span> <span class="o">=</span> <span class="s2">&quot;Sentiment = 4&quot;</span>  <span class="c1"># @param [&quot;Sentiment = 0&quot;, &quot;Sentiment = 1&quot;, &quot;Sentiment = 2&quot;, &quot;Sentiment = 3&quot;, &quot;Sentiment = 4&quot;]</span>
<span class="c1"># @markdown **Randomly sample a response from the Yelp review dataset with the given sentiment value {0:😠, 1:😦, 2:😐, 3:🙂, 4:😀}**</span>

<span class="c1"># @markdown ---</span>
<span class="n">use_custom_review</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># @param {type:&quot;boolean&quot;}</span>
<span class="n">custom_review</span> <span class="o">=</span> <span class="s2">&quot;I liked this movie very much because ...&quot;</span>  <span class="c1"># @param {type:&quot;string&quot;}</span>
<span class="c1"># @markdown ***Alternatively, write your own review (don&#39;t forget to enable custom review using the checkbox given above)***</span>

<span class="c1"># @markdown ---</span>

<span class="c1"># @markdown **NOTE:** *Run the cell after setting all the You can adding different kinds of extension above fields appropriately!*</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ****** The selected text context ****** </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">use_custom_review</span><span class="p">:</span>
  <span class="n">context</span> <span class="o">=</span> <span class="n">clean_text</span><span class="p">(</span><span class="n">custom_review</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">context</span> <span class="o">=</span> <span class="n">clean_text</span><span class="p">(</span><span class="n">sentiment_dict</span><span class="p">[</span><span class="n">sample_review_from_yelp</span><span class="p">][</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">sentiment_dict</span><span class="p">[</span><span class="n">sample_review_from_yelp</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">)][</span><span class="s2">&quot;text&quot;</span><span class="p">])</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> ****** The selected text context ****** 

(&quot;They carry Eegee&#39;s!!!!!!!  I love Eegee&#39;s but am rarely in Tuscon. Finally I &quot;
 &#39;have a place to go satisfy my cravings without having to drive 90 min.   &#39;
 &#39;Their subs are pretty good too :)&#39;)
</pre></div>
</div>
</div>
</div>
<p>Here, we’ll ask the pre-trained language models to extend the selected text context further. You can try adding different kinds of extension prompts at the end of the text context, conditioning it for different kinds of text extensions.</p>
</div>
<div class="section" id="bonus-1-3-extending-the-review-with-pre-trained-models">
<h4>Bonus 1.3: Extending the review with pre-trained models 🤖<a class="headerlink" href="#bonus-1-3-extending-the-review-with-pre-trained-models" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Bonus 1.3: Extending the review with pre-trained models 🤖</span>

<span class="c1"># @markdown ---</span>
<span class="n">model</span> <span class="o">=</span> <span class="s2">&quot;gpt2&quot;</span>  <span class="c1"># @param [&quot;gpt2&quot;, &quot;gpt2-medium&quot;, &quot;xlnet-base-cased&quot;]</span>
<span class="n">generator</span> <span class="o">=</span> <span class="n">pipeline</span><span class="p">(</span><span class="s1">&#39;text-generation&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>
<span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
<span class="c1"># @markdown **Select a pre-trained language model to generate text 🤖**</span>

<span class="c1"># @markdown *(might take some time to download the pre-trained weights for the first time)*</span>

<span class="c1"># @markdown ---</span>
<span class="n">extension_prompt</span> <span class="o">=</span> <span class="s2">&quot;Hence, overall I feel that ...&quot;</span>  <span class="c1"># @param {type:&quot;string&quot;}</span>
<span class="n">num_output_responses</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># @param {type:&quot;slider&quot;, min:1, max:10, step:1}</span>
<span class="c1"># @markdown **Provide a prompt to extend the review ✍️**</span>

<span class="n">input_text</span> <span class="o">=</span> <span class="n">context</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">extension_prompt</span>
<span class="c1"># @markdown **NOTE:** *Run this cell after setting all the fields appropriately!*</span>

<span class="c1"># @markdown **NOTE:** *Some pre-trained models might not work well with longer texts!*</span>

<span class="n">generated_responses</span> <span class="o">=</span> <span class="n">generator</span><span class="p">(</span><span class="n">input_text</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">num_return_sequences</span><span class="o">=</span><span class="n">num_output_responses</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> *********** INPUT PROMPT TO THE MODEL ************ </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">input_text</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> *********** EXTENDED RESPONSES BY THE MODEL ************ </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">response</span> <span class="ow">in</span> <span class="n">generated_responses</span><span class="p">:</span>
  <span class="n">pprint</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;generated_text&quot;</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">input_text</span><span class="p">):]</span> <span class="o">+</span> <span class="s2">&quot; ...&quot;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Random seed 2021 has been set.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> *********** INPUT PROMPT TO THE MODEL ************ 

(&quot;They carry Eegee&#39;s!!!!!!!  I love Eegee&#39;s but am rarely in Tuscon. Finally I &quot;
 &#39;have a place to go satisfy my cravings without having to drive 90 min.   &#39;
 &#39;Their subs are pretty good too :) Hence, overall I feel that ...&#39;)

 *********** EXTENDED RESPONSES BY THE MODEL ************ 

(&#39; Read more\n&#39;
 &#39;\n&#39;
 &#39;\n&#39;
 &#39;Vladna Rangel 1k 2k\n&#39;
 &#39;\n&#39;
 &#39;The most important thing was the filling, I gave a couple of tablespoons of &#39;
 &#39;ground flour along with 1/2 teaspoon salt, pepper, and pepper powder, and &#39;
 &quot;went to work! I am sure my mom will have this so well, but I didn&#39;t give it &quot;
 &#39;a chance. All I had to do was add Insight of the Earth to the eggs... Read &#39;
 &#39;more ...&#39;)
</pre></div>
</div>
</div>
</div>
<p>Next, we’ll ask the pre-trained language models to calculate the likelihood of already existing text-extensions. We can define a positive text-extension as well as a negative text-extension. The sentiment of the given text context can then be determined by comparing the likelihoods of the given text extensions.</p>
<p>(For a positive review, a positive text-extension should ideally be given more likelihood by the pre-trained language model as compared to a negative text-extension. Similarly, for a negative review, the negative text-extension should have more likelihood than the positive text-extension.)</p>
</div>
<div class="section" id="bonus-1-4-sentiment-binary-classification-with-likelihood-of-positive-and-negative-extensions-of-the-review">
<h4>Bonus 1.4: Sentiment binary-classification with likelihood of positive and negative extensions of the review 👍👎<a class="headerlink" href="#bonus-1-4-sentiment-binary-classification-with-likelihood-of-positive-and-negative-extensions-of-the-review" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Bonus 1.4: Sentiment binary-classification with likelihood of positive and negative extensions of the review 👍👎</span>

<span class="c1"># @markdown ---</span>
<span class="n">model_name</span> <span class="o">=</span> <span class="s2">&quot;gpt2&quot;</span>  <span class="c1"># @param [&quot;gpt2&quot;, &quot;gpt2-medium&quot;, &quot;xlnet-base-cased&quot;]</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">AutoModelForCausalLM</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">AutoTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>
<span class="c1"># @markdown **Select a pre-trained language model to score the likelihood of extended review**</span>

<span class="c1"># @markdown *(might take some time to download the pre-trained weights for the first time)*</span>

<span class="c1"># @markdown ---</span>
<span class="n">custom_positive_extension</span> <span class="o">=</span> <span class="s2">&quot;I would definitely recommend this!&quot;</span>  <span class="c1"># @param {type:&quot;string&quot;}</span>
<span class="n">custom_negative_extension</span> <span class="o">=</span> <span class="s2">&quot;I would not recommend this!&quot;</span>  <span class="c1"># @param {type:&quot;string&quot;}</span>
<span class="c1"># @markdown **Provide custom positive and negative extensions to the review ✍️**</span>

<span class="n">texts</span> <span class="o">=</span> <span class="p">[</span><span class="n">context</span><span class="p">,</span> <span class="n">custom_positive_extension</span><span class="p">,</span> <span class="n">custom_negative_extension</span><span class="p">]</span>
<span class="n">encodings</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span>

<span class="n">positive_input_ids</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">encodings</span><span class="p">[</span><span class="s2">&quot;input_ids&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">encodings</span><span class="p">[</span><span class="s2">&quot;input_ids&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
<span class="n">positive_attention_mask</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">encodings</span><span class="p">[</span><span class="s2">&quot;attention_mask&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">encodings</span><span class="p">[</span><span class="s2">&quot;attention_mask&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
<span class="n">positive_label_ids</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">encodings</span><span class="p">[</span><span class="s2">&quot;input_ids&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">encodings</span><span class="p">[</span><span class="s2">&quot;input_ids&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_ids</span><span class="o">=</span><span class="n">positive_input_ids</span><span class="p">,</span>
                <span class="n">attention_mask</span><span class="o">=</span><span class="n">positive_attention_mask</span><span class="p">,</span>
                <span class="n">labels</span><span class="o">=</span><span class="n">positive_label_ids</span><span class="p">)</span>
<span class="n">positive_extension_likelihood</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">outputs</span><span class="o">.</span><span class="n">loss</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Log-likelihood of positive extension = &quot;</span><span class="p">,</span> <span class="n">positive_extension_likelihood</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>

<span class="n">negative_input_ids</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">encodings</span><span class="p">[</span><span class="s2">&quot;input_ids&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">encodings</span><span class="p">[</span><span class="s2">&quot;input_ids&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
<span class="n">negative_attention_mask</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">encodings</span><span class="p">[</span><span class="s2">&quot;attention_mask&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">encodings</span><span class="p">[</span><span class="s2">&quot;attention_mask&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
<span class="n">negative_label_ids</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">encodings</span><span class="p">[</span><span class="s2">&quot;input_ids&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">encodings</span><span class="p">[</span><span class="s2">&quot;input_ids&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_ids</span><span class="o">=</span><span class="n">negative_input_ids</span><span class="p">,</span>
                <span class="n">attention_mask</span><span class="o">=</span><span class="n">negative_attention_mask</span><span class="p">,</span>
                <span class="n">labels</span><span class="o">=</span><span class="n">negative_label_ids</span><span class="p">)</span>
<span class="n">negative_extension_likelihood</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">outputs</span><span class="o">.</span><span class="n">loss</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Log-likelihood of negative extension = &quot;</span><span class="p">,</span> <span class="n">negative_extension_likelihood</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>

<span class="k">if</span> <span class="p">(</span><span class="n">positive_extension_likelihood</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">negative_extension_likelihood</span><span class="o">.</span><span class="n">item</span><span class="p">()):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Positive text-extension has greater likelihood probabilities!&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The given review can be predicted to be POSITIVE 👍&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Negative text-extension has greater likelihood probabilities!&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The given review can be predicted to be NEGATIVE 👎&quot;</span><span class="p">)</span>
<span class="c1"># @markdown **NOTE:** *Run this cell after setting all the fields appropriately!*</span>

<span class="c1"># @markdown **NOTE:** *Some pre-trained models might not work well with longer texts!*</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Log-likelihood of positive extension =  -3.462390899658203

Log-likelihood of negative extension =  -3.91379451751709

Positive text-extension has greater likelihood probabilities!
The given review can be predicted to be POSITIVE 👍
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="bonus-2-light-weight-fine-tuning">
<h1>Bonus 2: Light-weight fine-tuning<a class="headerlink" href="#bonus-2-light-weight-fine-tuning" title="Permalink to this headline">¶</a></h1>
<p><em>Time estimate: ~10mins</em></p>
<div class="section" id="video-2-fine-tuning">
<h2>Video 2: Fine-tuning<a class="headerlink" href="#video-2-fine-tuning" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "8ed4af4a609e4521b227d760ca4e7e6f", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</div>
<div class="section" id="id1">
<h2>Submit your feedback<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_FineTuning_Video&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "a5b95e8c2ee64dc9b9165813de9b45d4", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<p>Fine-tuning these large pre-trained models with billions of parameters tends to be very slow. In this section, we will explore the effect of fine-tuning a few layers (while fixing the others) to save training time.</p>
<p>The HuggingFace python library provides a simplified API for training and fine-tuning transformer language models. In this exercise we will fine-tune a pre-trained language model for sentiment classification.</p>
</div>
<div class="section" id="bonus-2-1-data-processing">
<h2>Bonus 2.1: Data Processing<a class="headerlink" href="#bonus-2-1-data-processing" title="Permalink to this headline">¶</a></h2>
<p>Pre-trained transformer models have a fixed vocabulary of words and sub-words. The input text to a transformer model has to be tokenized into these words and sub-words during the pre-processing stage. We’ll use the HuggingFace <code class="docutils literal notranslate"><span class="pre">tokenizers</span></code> to perform the tokenization here.</p>
<p>(By default we’ll use the BERT base-cased pre-trained language model here. You can try using one of the other models available <a class="reference external" href="https://huggingface.co/transformers/pretrained_models.html">here</a> by changing the model ID values at appropriate places in the code.)</p>
<p>Most of the pre-trained language models have a fixed maximum sequence length. With the HuggingFace <code class="docutils literal notranslate"><span class="pre">tokenizer</span></code> library, we can either pad or truncate input text sequences to maximum length with a few lines of code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tokenize the input texts</span>
<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">AutoTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;bert-base-cased&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">tokenize_function</span><span class="p">(</span><span class="n">examples</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Tokenises incoming sequences;</span>

<span class="sd">  Args:</span>
<span class="sd">    examples: Sequence of strings</span>
<span class="sd">      Sequences to tokenise</span>

<span class="sd">  Returns:</span>
<span class="sd">    Returns transformer autotokenizer object with padded, truncated input sequences.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">tokenizer</span><span class="p">(</span><span class="n">examples</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">],</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;max_length&quot;</span><span class="p">,</span> <span class="n">truncation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Here we use the `DATASET` as defined above.</span>
<span class="c1"># Recall that DATASET = load_dataset(&quot;yelp_review_full&quot;, ignore_verifications=True)</span>
<span class="n">tokenized_datasets</span> <span class="o">=</span> <span class="n">DATASET</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">tokenize_function</span><span class="p">,</span> <span class="n">batched</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "82f11ddff2544c6692ecf8310d36513a", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "c5b83a42b26c45f597ec5f9d8d452fe2", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<p>We’ll randomly sample a subset of the <a class="reference external" href="https://huggingface.co/datasets/yelp_review_full">Yelp reviews dataset</a> (10k train samples, 5k samples for validation &amp; testing each). You can include more samples here for better performance (at the cost of longer training times!)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select the data splits</span>
<span class="n">train_dataset</span> <span class="o">=</span> <span class="n">tokenized_datasets</span><span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">))</span>
<span class="n">test_dataset</span> <span class="o">=</span> <span class="n">tokenized_datasets</span><span class="p">[</span><span class="s2">&quot;test&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2500</span><span class="p">))</span>
<span class="n">validation_dataset</span> <span class="o">=</span> <span class="n">tokenized_datasets</span><span class="p">[</span><span class="s2">&quot;test&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2500</span><span class="p">,</span> <span class="mi">5000</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="bonus-2-2-model-loading">
<h2>Bonus 2.2: Model Loading<a class="headerlink" href="#bonus-2-2-model-loading" title="Permalink to this headline">¶</a></h2>
<p>Next, we’ll load a pre-trained checkpoint of the model and decide which layers are to be fine-tuned.</p>
<p>Modify the <code class="docutils literal notranslate"><span class="pre">train_layers</span></code> variable below to pick which layers you would like to fine-tune (you can uncomment the print statements for this). Fine-tuning more layers might result in better performance (at the cost of longer training times). Due to computational limitations (limited GPU memory) we cannot fine-tune the entire model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load pre-trained BERT model and freeze layers</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">AutoModelForSequenceClassification</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;bert-base-cased&quot;</span><span class="p">,</span>
                                                           <span class="n">cache_dir</span><span class="o">=</span><span class="s2">&quot;data/&quot;</span><span class="p">,</span>
                                                           <span class="n">num_labels</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">train_layers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;classifier&quot;</span><span class="p">,</span> <span class="s2">&quot;bert.pooler&quot;</span><span class="p">,</span> <span class="s2">&quot;bert.encoder.layer.11&quot;</span><span class="p">]</span>  <span class="c1"># add/remove layers here (use layer-name sub-strings)</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">named_parameters</span><span class="p">():</span>
  <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">name</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">train_layers</span><span class="p">):</span>
    <span class="n">param</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="c1"># print(&quot;FINE-TUNING --&gt;&quot;, name)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">param</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># print(&quot;FROZEN --&gt;&quot;, name)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "ed630d808762480695dec2e239cd1eb1", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "adec8c4a71c946e78ee45cafa75cb0c9", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</div>
<div class="section" id="bonus-2-3-fine-tuning">
<h2>Bonus 2.3: Fine-tuning<a class="headerlink" href="#bonus-2-3-fine-tuning" title="Permalink to this headline">¶</a></h2>
<p>Fine-tune the model! The HuggingFace <code class="docutils literal notranslate"><span class="pre">Trainer</span></code> class supports easy fine-tuning and logging. You can play around with various hyperparameters here!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Setup huggingface trainer</span>
<span class="n">training_args</span> <span class="o">=</span> <span class="n">TrainingArguments</span><span class="p">(</span><span class="n">output_dir</span><span class="o">=</span><span class="s2">&quot;yelp_bert&quot;</span><span class="p">,</span>
                                  <span class="n">overwrite_output_dir</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                  <span class="n">evaluation_strategy</span><span class="o">=</span><span class="s2">&quot;epoch&quot;</span><span class="p">,</span>
                                  <span class="n">per_device_train_batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
                                  <span class="n">per_device_eval_batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
                                  <span class="n">learning_rate</span><span class="o">=</span><span class="mf">5e-5</span><span class="p">,</span>
                                  <span class="n">weight_decay</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                  <span class="n">num_train_epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># students may use 5 to see a full training!</span>
                                  <span class="n">fp16</span><span class="o">=</span><span class="kc">False</span> <span class="k">if</span> <span class="n">DEVICE</span><span class="o">==</span><span class="s1">&#39;cpu&#39;</span> <span class="k">else</span> <span class="kc">True</span><span class="p">,</span>
                                  <span class="n">save_steps</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                                  <span class="n">logging_steps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                  <span class="n">report_to</span><span class="o">=</span><span class="s2">&quot;tensorboard&quot;</span>
                                  <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We’ll use <code class="docutils literal notranslate"><span class="pre">Accuracy</span></code> as the evaluation metric for the sentiment classification task. The HuggingFace <code class="docutils literal notranslate"><span class="pre">datasets</span></code> library supports various metrics. You can try experimenting with other classification metrics here!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Setup evaluation metric</span>
<span class="k">def</span> <span class="nf">compute_metrics</span><span class="p">(</span><span class="n">eval_pred</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Computes accuracy of the prediction</span>

<span class="sd">  Args:</span>
<span class="sd">    eval_pred: Tuple</span>
<span class="sd">      Logits predicted by the model vs actual labels</span>

<span class="sd">  Returns:</span>
<span class="sd">    Dictionary containing accuracy of the prediction</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">metric</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_metric</span><span class="p">(</span><span class="s2">&quot;accuracy&quot;</span><span class="p">)</span>
  <span class="n">logits</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">eval_pred</span>
  <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">accuracy</span> <span class="o">=</span> <span class="n">metric</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">predictions</span><span class="o">=</span><span class="n">predictions</span><span class="p">,</span> <span class="n">references</span><span class="o">=</span><span class="n">labels</span><span class="p">)[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">]</span>
  <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Start the training!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiate a trainer with training and validation datasets</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">args</span><span class="o">=</span><span class="n">training_args</span><span class="p">,</span>
    <span class="n">train_dataset</span><span class="o">=</span><span class="n">train_dataset</span><span class="p">,</span>
    <span class="n">eval_dataset</span><span class="o">=</span><span class="n">validation_dataset</span><span class="p">,</span>
    <span class="n">compute_metrics</span><span class="o">=</span><span class="n">compute_metrics</span><span class="p">,</span>
    <span class="n">tokenizer</span><span class="o">=</span><span class="n">tokenizer</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train the model</span>
<span class="k">if</span> <span class="n">DEVICE</span> <span class="o">!=</span> <span class="s1">&#39;cpu&#39;</span><span class="p">:</span>
  <span class="n">trainer</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
    <div>

      <progress value='157' max='157' style='width:300px; height:20px; vertical-align: middle;'></progress>
      [157/157 02:04, Epoch 1/1]
    </div>
    <table border="1" class="dataframe">
  <thead>
 <tr style="text-align: left;">
      <th>Epoch</th>
      <th>Training Loss</th>
      <th>Validation Loss</th>
      <th>Accuracy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>1.100200</td>
      <td>1.098263</td>
      <td>0.518400</td>
    </tr>
  </tbody>
</table><p></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Evaluate the model on the test dataset</span>
<span class="k">if</span> <span class="n">DEVICE</span> <span class="o">!=</span> <span class="s1">&#39;cpu&#39;</span><span class="p">:</span>
  <span class="n">trainer</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div>

  <progress value='40' max='40' style='width:300px; height:20px; vertical-align: middle;'></progress>
  [40/40 00:16]
</div>
</div></div>
</div>
<p>We can now visualize the <code class="docutils literal notranslate"><span class="pre">Tensorboard</span></code> logs to analyze the training process! The HuggingFace <code class="docutils literal notranslate"><span class="pre">Trainer</span></code> class will log various loss values and evaluation metrics automatically!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize the tensorboard logs</span>
<span class="k">if</span> <span class="n">DEVICE</span> <span class="o">!=</span> <span class="s1">&#39;cpu&#39;</span><span class="p">:</span>
  <span class="o">%</span><span class="k">tensorboard</span> --logdir yelp_bert/runs
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<iframe id="tensorboard-frame-1c80317fa3b1799d" width="100%" height="800" frameborder="0">
</iframe>
<script>
  (function() {
    const frame = document.getElementById("tensorboard-frame-1c80317fa3b1799d");
    const url = new URL("/", window.location);
    const port = 6006;
    if (port) {
      url.port = port;
    }
    frame.src = url;
  })();
</script>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
</pre></div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="bonus-3-model-robustness">
<h1>Bonus 3: Model robustness<a class="headerlink" href="#bonus-3-model-robustness" title="Permalink to this headline">¶</a></h1>
<p><em>Time estimate: ~22mins</em></p>
<div class="section" id="video-3-robustness">
<h2>Video 3: Robustness<a class="headerlink" href="#video-3-robustness" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "924a4a6e50e2473d97053106f397bd26", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</div>
<div class="section" id="id2">
<h2>Submit your feedback<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Robustness_Video&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "4d45a86068e844a6a85cae564a29c461", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<p>Given the previously trained model for sentiment classification, it is possible to deceive it using various text perturbations. The text perturbations can act as previously unseen noise to the model, which might persuade it to impart wrong values of sentiment!</p>
</div>
<div class="section" id="bonus-interactive-demo-3-break-the-model">
<h2>Bonus Interactive Demo 3: Break the model<a class="headerlink" href="#bonus-interactive-demo-3-break-the-model" title="Permalink to this headline">¶</a></h2>
<div class="section" id="bonus-3-1-load-an-original-review">
<h3>Bonus 3.1: Load an original review<a class="headerlink" href="#bonus-3-1-load-an-original-review" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Bonus 3.1: Load an original review</span>

<span class="k">def</span> <span class="nf">clean_text</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to clean up text</span>

<span class="sd">    Args:</span>
<span class="sd">      text: String</span>
<span class="sd">        Input text sequence</span>

<span class="sd">    Returns:</span>
<span class="sd">      text: String</span>
<span class="sd">        Returned string does not contain characters new-line characters, backslashes etc.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">n&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">text</span>

<span class="c1"># @markdown ---</span>
<span class="n">sample_review_from_yelp</span> <span class="o">=</span> <span class="s2">&quot;Sentiment = 4&quot;</span> <span class="c1">#@param [&quot;Sentiment = 0&quot;, &quot;Sentiment = 1&quot;, &quot;Sentiment = 2&quot;, &quot;Sentiment = 3&quot;, &quot;Sentiment = 4&quot;]</span>
<span class="c1"># @markdown **Randomly sample a response from the Yelp review dataset with the given sentiment value {0:😠, 1:😦, 2:😐, 3:🙂, 4:😀}**</span>

<span class="c1"># @markdown ---</span>

<span class="n">context</span> <span class="o">=</span> <span class="n">clean_text</span><span class="p">(</span><span class="n">sentiment_dict</span><span class="p">[</span><span class="n">sample_review_from_yelp</span><span class="p">][</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">sentiment_dict</span><span class="p">[</span><span class="n">sample_review_from_yelp</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">)][</span><span class="s2">&quot;text&quot;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Review for &quot;</span><span class="p">,</span> <span class="n">sample_review_from_yelp</span><span class="p">,</span> <span class="s2">&quot;:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Review for  Sentiment = 4 :

(&#39;You only need to know three words walking into TEXAZ Grill: chicken fried &#39;
 &quot;steak. It&#39;s a huge monster, with a crispy double dipped batter layer &quot;
 &#39;encasing a beautiful tenderized steak, smothered with a beautiful white &#39;
 &#39;gravy. Without a doubt TEXAZ Grill has the best chicken fried steak in the &#39;
 &#39;Phoenix area, perhaps even Arizona!  Portions are huge too! The dinner &#39;
 &#39;portion actually gives you two steaks while the lunch portion gives you one. &#39;
 &#39;The coleslaw and mashed potatoes on the side were huge as well.  The &#39;
 &#39;restaurant is a bit small and the parking lot a bit smaller, but the &#39;
 &#39;interior is definitely cozy and the staff is very friendly. It really makes &#39;
 &#39;the meal worth it on top of the kick*** CFS. You NEED to try this out!&#39;)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id3">
<h3>Submit your feedback<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Load_an_original_review_Interactive_Demo&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "34e9c1a0d87a41b69842ee7007ae6531", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<p>We can apply various text perturbations to the selected review using the <code class="docutils literal notranslate"><span class="pre">textattack</span></code> python library. This will help us augment the original text to break the model!</p>
<p><strong>Important:</strong> Locally or on colab (with <code class="docutils literal notranslate"><span class="pre">!</span></code>) you can simple</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>textattack<span class="w"> </span>--quiet
</pre></div>
</div>
<p>Then, import the packages:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">textattack.augmentation</span> <span class="kn">import</span> <span class="n">Augmenter</span>
<span class="kn">from</span> <span class="nn">textattack.transformations</span> <span class="kn">import</span> <span class="n">WordSwapQWERTY</span>
<span class="kn">from</span> <span class="nn">textattack.transformations</span> <span class="kn">import</span> <span class="n">WordSwapExtend</span>
<span class="kn">from</span> <span class="nn">textattack.transformations</span> <span class="kn">import</span> <span class="n">WordSwapContract</span>
<span class="kn">from</span> <span class="nn">textattack.transformations</span> <span class="kn">import</span> <span class="n">WordSwapHomoglyphSwap</span>
<span class="kn">from</span> <span class="nn">textattack.transformations</span> <span class="kn">import</span> <span class="n">CompositeTransformation</span>
<span class="kn">from</span> <span class="nn">textattack.transformations</span> <span class="kn">import</span> <span class="n">WordSwapRandomCharacterDeletion</span>
<span class="kn">from</span> <span class="nn">textattack.transformations</span> <span class="kn">import</span> <span class="n">WordSwapNeighboringCharacterSwap</span>
<span class="kn">from</span> <span class="nn">textattack.transformations</span> <span class="kn">import</span> <span class="n">WordSwapRandomCharacterInsertion</span>
<span class="kn">from</span> <span class="nn">textattack.transformations</span> <span class="kn">import</span> <span class="n">WordSwapRandomCharacterSubstitution</span>
</pre></div>
</div>
<p>However, as we faced issues, you can run the cell below to load all necessary classes and functions.</p>
</div>
<div class="section" id="helper-functions-to-avoid-textattack-issue">
<h3>Helper functions to avoid <code class="docutils literal notranslate"><span class="pre">textattack</span></code> issue<a class="headerlink" href="#helper-functions-to-avoid-textattack-issue" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Helper functions to avoid `textattack` issue</span>
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>flair<span class="w"> </span>--quiet

<span class="kn">import</span> <span class="nn">flair</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">flair.data</span> <span class="kn">import</span> <span class="n">Sentence</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Word Swap</span>
<span class="sd">-------------------------------</span>
<span class="sd">Word swap transformations act by</span>
<span class="sd">replacing some words in the input.</span>
<span class="sd">Subclasses can implement the abstract WordSwap class by</span>
<span class="sd">overriding self._get_replacement_words</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="k">def</span> <span class="nf">default_class_repr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Formats given input</span>

<span class="sd">    Args:</span>
<span class="sd">      None</span>

<span class="sd">    Returns:</span>
<span class="sd">      Formatted string with additional parameters</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;extra_repr_keys&quot;</span><span class="p">):</span>
        <span class="n">extra_params</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">extra_repr_keys</span><span class="p">():</span>
            <span class="n">extra_params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;  (&quot;</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span> <span class="o">+</span> <span class="s2">&quot;:  {&quot;</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">extra_params</span><span class="p">):</span>
            <span class="n">extra_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">extra_params</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">extra_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">extra_str</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">extra_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">extra_str</span> <span class="o">=</span> <span class="n">extra_str</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">extra_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}{</span><span class="n">extra_str</span><span class="si">}</span><span class="s2">&quot;</span>


<span class="n">LABEL_COLORS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;red&quot;</span><span class="p">,</span>
    <span class="s2">&quot;green&quot;</span><span class="p">,</span>
    <span class="s2">&quot;blue&quot;</span><span class="p">,</span>
    <span class="s2">&quot;purple&quot;</span><span class="p">,</span>
    <span class="s2">&quot;yellow&quot;</span><span class="p">,</span>
    <span class="s2">&quot;orange&quot;</span><span class="p">,</span>
    <span class="s2">&quot;pink&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cyan&quot;</span><span class="p">,</span>
    <span class="s2">&quot;gray&quot;</span><span class="p">,</span>
    <span class="s2">&quot;brown&quot;</span><span class="p">,</span>
<span class="p">]</span>


<span class="k">class</span> <span class="nc">Transformation</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An abstract class for transforming a sequence of text to produce a</span>
<span class="sd">    potential adversarial example.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">current_text</span><span class="p">,</span>
        <span class="n">pre_transformation_constraints</span><span class="o">=</span><span class="p">[],</span>
        <span class="n">indices_to_modify</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">shifted_idxs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies the pre_transformation_constraints then calls</span>
<span class="sd">        _get_transformations.</span>

<span class="sd">        Args:</span>
<span class="sd">          current_text: String</span>
<span class="sd">            The AttackedText Object to transform.</span>
<span class="sd">          pre_transformation_constraints: List</span>
<span class="sd">            The PreTransformationConstraint to apply for cross-checking transformation compatibility.</span>
<span class="sd">          indices_to_modify: Integer</span>
<span class="sd">            Word indices to be modified as dictated by the SearchMethod.</span>
<span class="sd">          shifted_idxs: Boolean</span>
<span class="sd">            Indicates whether indices could be shifted from their original position in the text.</span>

<span class="sd">        Returns:</span>
<span class="sd">          transformed_texts: List</span>
<span class="sd">            Returns a list of all possible transformations for current_text.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">indices_to_modify</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">indices_to_modify</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">current_text</span><span class="o">.</span><span class="n">words</span><span class="p">)))</span>
            <span class="c1"># If we are modifying all indices, we don&#39;t care if some of the indices might have been shifted.</span>
            <span class="n">shifted_idxs</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">indices_to_modify</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">indices_to_modify</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">shifted_idxs</span><span class="p">:</span>
            <span class="n">indices_to_modify</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
                <span class="n">current_text</span><span class="o">.</span><span class="n">convert_from_original_idxs</span><span class="p">(</span><span class="n">indices_to_modify</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">constraint</span> <span class="ow">in</span> <span class="n">pre_transformation_constraints</span><span class="p">:</span>
            <span class="n">indices_to_modify</span> <span class="o">=</span> <span class="n">indices_to_modify</span> <span class="o">&amp;</span> <span class="n">constraint</span><span class="p">(</span><span class="n">current_text</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">transformed_texts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_transformations</span><span class="p">(</span><span class="n">current_text</span><span class="p">,</span> <span class="n">indices_to_modify</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">transformed_texts</span><span class="p">:</span>
            <span class="n">text</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="s2">&quot;last_transformation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">return</span> <span class="n">transformed_texts</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_get_transformations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_text</span><span class="p">,</span> <span class="n">indices_to_modify</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of all possible transformations for current_text,</span>
<span class="sd">        only modifying indices_to_modify.</span>
<span class="sd">        Must be overridden by specific transformations.</span>

<span class="sd">        Args:</span>
<span class="sd">          current_text: String</span>
<span class="sd">            The AttackedText Object to transform.</span>
<span class="sd">          indicies_to_modify: Integer</span>
<span class="sd">            Specifies word indices which can be modified.</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">deterministic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">extra_repr_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="fm">__repr__</span> <span class="o">=</span> <span class="fm">__str__</span> <span class="o">=</span> <span class="n">default_class_repr</span>


<span class="k">class</span> <span class="nc">WordSwap</span><span class="p">(</span><span class="n">Transformation</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An abstract class that takes a sentence and transforms it by replacing</span>
<span class="sd">    some of its words.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">letters_to_insert</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes following attributes</span>

<span class="sd">        Args:</span>
<span class="sd">          letters_to_insert: String</span>
<span class="sd">            Letters allowed for insertion into words (used by some char-based transformations)</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">letters_to_insert</span> <span class="o">=</span> <span class="n">letters_to_insert</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">letters_to_insert</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">letters_to_insert</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span>

    <span class="k">def</span> <span class="nf">_get_replacement_words</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a set of replacements given an input word.</span>
<span class="sd">        Must be overriden by specific word swap transformations.</span>

<span class="sd">        Args:</span>
<span class="sd">          word: String</span>
<span class="sd">            The input word for which replacements are to be found.</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_get_random_letter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper function that returns a random single letter from the English</span>
<span class="sd">        alphabet that could be lowercase or uppercase.</span>

<span class="sd">        Args:</span>
<span class="sd">          None</span>

<span class="sd">        Returns:</span>
<span class="sd">          Random Single Letter to simulate random-letter transformation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">letters_to_insert</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_transformations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_text</span><span class="p">,</span> <span class="n">indices_to_modify</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of all possible transformations for current_text,</span>
<span class="sd">        only modifying indices_to_modify.</span>
<span class="sd">        Must be overridden by specific transformations.</span>

<span class="sd">        Args:</span>
<span class="sd">          current_text: String</span>
<span class="sd">            The AttackedText Object to transform.</span>
<span class="sd">          indicies_to_modify: Integer</span>
<span class="sd">            Which word indices can be modified.</span>

<span class="sd">        Returns:</span>
<span class="sd">          transformed_texts: List</span>
<span class="sd">            List of all transformed texts i.e., index at which transformation was applied</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">words</span> <span class="o">=</span> <span class="n">current_text</span><span class="o">.</span><span class="n">words</span>
        <span class="n">transformed_texts</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices_to_modify</span><span class="p">:</span>
            <span class="n">word_to_replace</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">replacement_words</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_replacement_words</span><span class="p">(</span><span class="n">word_to_replace</span><span class="p">)</span>
            <span class="n">transformed_texts_idx</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">replacement_words</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="n">word_to_replace</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">transformed_texts_idx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_text</span><span class="o">.</span><span class="n">replace_word_at_index</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">r</span><span class="p">))</span>
            <span class="n">transformed_texts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">transformed_texts_idx</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">transformed_texts</span>


<span class="k">class</span> <span class="nc">WordSwapQWERTY</span><span class="p">(</span><span class="n">WordSwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A transformation that swaps characters with adjacent keys on a</span>
<span class="sd">    QWERTY keyboard, replicating the kind of errors that come from typing</span>
<span class="sd">    too quickly.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">random_one</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skip_first_char</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">skip_last_char</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initiates the following attributes</span>

<span class="sd">        Args:</span>
<span class="sd">          random_one: Boolean</span>
<span class="sd">            Specifies whether to return a single (random) swap, or all possible swaps.</span>
<span class="sd">          skip_first_char: Boolean</span>
<span class="sd">            When True, do not modify the first character of each word.</span>
<span class="sd">          skip_last_char: Boolean</span>
<span class="sd">            When True, do not modify the last character of each word.</span>

<span class="sd">        Usage/Example:</span>
<span class="sd">          &gt;&gt;&gt; from textattack.transformations import WordSwapQWERTY</span>
<span class="sd">          &gt;&gt;&gt; from textattack.augmentation import Augmenter</span>
<span class="sd">          &gt;&gt;&gt; transformation = WordSwapQWERT()</span>
<span class="sd">          &gt;&gt;&gt; augmenter = Augmenter(transformation=transformation)</span>
<span class="sd">          &gt;&gt;&gt; s = &#39;I am fabulous.&#39;</span>
<span class="sd">          &gt;&gt;&gt; augmenter.augment(s)</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span> <span class="o">=</span> <span class="n">random_one</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_first_char</span> <span class="o">=</span> <span class="n">skip_first_char</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_last_char</span> <span class="o">=</span> <span class="n">skip_last_char</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_keyboard_adjacency</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;q&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;w&quot;</span><span class="p">,</span>
                <span class="s2">&quot;a&quot;</span><span class="p">,</span>
                <span class="s2">&quot;s&quot;</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;q&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span>
            <span class="s2">&quot;e&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">],</span>
            <span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">],</span>
            <span class="s2">&quot;t&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">],</span>
            <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span><span class="p">,</span> <span class="s2">&quot;j&quot;</span><span class="p">,</span> <span class="s2">&quot;u&quot;</span><span class="p">],</span>
            <span class="s2">&quot;u&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span><span class="p">,</span> <span class="s2">&quot;j&quot;</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="s2">&quot;i&quot;</span><span class="p">],</span>
            <span class="s2">&quot;i&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;u&quot;</span><span class="p">,</span> <span class="s2">&quot;j&quot;</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">],</span>
            <span class="s2">&quot;o&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;i&quot;</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;p&quot;</span><span class="p">],</span>
            <span class="s2">&quot;p&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">],</span>
            <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;q&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">],</span>
            <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;q&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">],</span>
            <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">],</span>
            <span class="s2">&quot;f&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span>
            <span class="s2">&quot;g&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span>
            <span class="s2">&quot;h&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;u&quot;</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;j&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;n&quot;</span><span class="p">],</span>
            <span class="s2">&quot;j&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;u&quot;</span><span class="p">,</span> <span class="s2">&quot;i&quot;</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;n&quot;</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span><span class="p">],</span>
            <span class="s2">&quot;k&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;u&quot;</span><span class="p">,</span> <span class="s2">&quot;i&quot;</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;j&quot;</span><span class="p">],</span>
            <span class="s2">&quot;l&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;i&quot;</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">],</span>
            <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">],</span>
            <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],</span>
            <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">],</span>
            <span class="s2">&quot;v&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span>
            <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;v&quot;</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span><span class="p">,</span> <span class="s2">&quot;n&quot;</span><span class="p">],</span>
            <span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span><span class="p">,</span> <span class="s2">&quot;j&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">],</span>
            <span class="s2">&quot;m&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">,</span> <span class="s2">&quot;j&quot;</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">],</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">_get_adjacent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper function to extract keys adjacent to given input key</span>

<span class="sd">        Args:</span>
<span class="sd">          s: String</span>
<span class="sd">            Letter for which adjacent keys are to be queried</span>

<span class="sd">        Returns:</span>
<span class="sd">          adjacent_keys: List</span>
<span class="sd">            List of co-occuring keys with respect to input</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s_lower</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">s_lower</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_keyboard_adjacency</span><span class="p">:</span>
            <span class="n">adjacent_keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_keyboard_adjacency</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s_lower</span><span class="p">,</span> <span class="p">[])</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">isupper</span><span class="p">():</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">adjacent_keys</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">adjacent_keys</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">_get_replacement_words</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper function to find candidate words with respect to given input key.</span>
<span class="sd">        Candidate words are words selected based on nearest neighbors</span>
<span class="sd">        with scope for subsequent swapping.</span>

<span class="sd">        Args:</span>
<span class="sd">          word: String</span>
<span class="sd">            Word for which candidate words are to be generated.</span>

<span class="sd">        Returns:</span>
<span class="sd">          candidate_words: List</span>
<span class="sd">            List of candidate words with respect to input word.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="n">candidate_words</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">start_idx</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_first_char</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">end_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_last_char</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">start_idx</span> <span class="o">&gt;=</span> <span class="n">end_idx</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">start_idx</span><span class="p">,</span> <span class="n">end_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">candidate_word</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">word</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_adjacent</span><span class="p">(</span><span class="n">word</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
            <span class="p">)</span>
            <span class="n">candidate_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate_word</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start_idx</span><span class="p">,</span> <span class="n">end_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">swap_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_adjacent</span><span class="p">(</span><span class="n">word</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                    <span class="n">candidate_word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">swap_key</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
                    <span class="n">candidate_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate_word</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">candidate_words</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">deterministic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span>


<span class="n">EXTENSION_MAP</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ain&#39;t&quot;</span><span class="p">:</span> <span class="s2">&quot;isn&#39;t&quot;</span><span class="p">,</span> <span class="s2">&quot;aren&#39;t&quot;</span><span class="p">:</span> <span class="s1">&#39;are not&#39;</span><span class="p">,</span> <span class="s2">&quot;can&#39;t&quot;</span><span class="p">:</span> <span class="s1">&#39;cannot&#39;</span><span class="p">,</span> <span class="s2">&quot;can&#39;t&#39;ve&quot;</span><span class="p">:</span> <span class="s1">&#39;cannot have&#39;</span><span class="p">,</span> <span class="s2">&quot;could&#39;ve&quot;</span><span class="p">:</span> <span class="s1">&#39;could have&#39;</span><span class="p">,</span> <span class="s2">&quot;couldn&#39;t&quot;</span><span class="p">:</span> <span class="s1">&#39;could not&#39;</span><span class="p">,</span> <span class="s2">&quot;didn&#39;t&quot;</span><span class="p">:</span> <span class="s1">&#39;did not&#39;</span><span class="p">,</span> <span class="s2">&quot;doesn&#39;t&quot;</span><span class="p">:</span> <span class="s1">&#39;does not&#39;</span><span class="p">,</span> <span class="s2">&quot;don&#39;t&quot;</span><span class="p">:</span> <span class="s1">&#39;do not&#39;</span><span class="p">,</span> <span class="s2">&quot;hadn&#39;t&quot;</span><span class="p">:</span> <span class="s1">&#39;had not&#39;</span><span class="p">,</span> <span class="s2">&quot;hasn&#39;t&quot;</span><span class="p">:</span> <span class="s1">&#39;has not&#39;</span><span class="p">,</span> <span class="s2">&quot;haven&#39;t&quot;</span><span class="p">:</span> <span class="s1">&#39;have not&#39;</span><span class="p">,</span> <span class="s2">&quot;he&#39;d&quot;</span><span class="p">:</span> <span class="s1">&#39;he would&#39;</span><span class="p">,</span> <span class="s2">&quot;he&#39;d&#39;ve&quot;</span><span class="p">:</span> <span class="s1">&#39;he would have&#39;</span><span class="p">,</span> <span class="s2">&quot;he&#39;ll&quot;</span><span class="p">:</span> <span class="s1">&#39;he will&#39;</span><span class="p">,</span> <span class="s2">&quot;he&#39;s&quot;</span><span class="p">:</span> <span class="s1">&#39;he is&#39;</span><span class="p">,</span> <span class="s2">&quot;how&#39;d&quot;</span><span class="p">:</span> <span class="s1">&#39;how did&#39;</span><span class="p">,</span> <span class="s2">&quot;how&#39;d&#39;y&quot;</span><span class="p">:</span> <span class="s1">&#39;how do you&#39;</span><span class="p">,</span> <span class="s2">&quot;how&#39;ll&quot;</span><span class="p">:</span> <span class="s1">&#39;how will&#39;</span><span class="p">,</span> <span class="s2">&quot;how&#39;s&quot;</span><span class="p">:</span> <span class="s1">&#39;how is&#39;</span><span class="p">,</span> <span class="s2">&quot;I&#39;d&quot;</span><span class="p">:</span> <span class="s1">&#39;I would&#39;</span><span class="p">,</span> <span class="s2">&quot;I&#39;ll&quot;</span><span class="p">:</span> <span class="s1">&#39;I will&#39;</span><span class="p">,</span> <span class="s2">&quot;I&#39;m&quot;</span><span class="p">:</span> <span class="s1">&#39;I am&#39;</span><span class="p">,</span> <span class="s2">&quot;I&#39;ve&quot;</span><span class="p">:</span> <span class="s1">&#39;I have&#39;</span><span class="p">,</span> <span class="s2">&quot;i&#39;d&quot;</span><span class="p">:</span> <span class="s1">&#39;i would&#39;</span><span class="p">,</span> <span class="s2">&quot;i&#39;ll&quot;</span><span class="p">:</span> <span class="s1">&#39;i will&#39;</span><span class="p">,</span> <span class="s2">&quot;i&#39;m&quot;</span><span class="p">:</span> <span class="s1">&#39;i am&#39;</span><span class="p">,</span> <span class="s2">&quot;i&#39;ve&quot;</span><span class="p">:</span> <span class="s1">&#39;i have&#39;</span><span class="p">,</span> <span class="s2">&quot;isn&#39;t&quot;</span><span class="p">:</span> <span class="s1">&#39;is not&#39;</span><span class="p">,</span> <span class="s2">&quot;it&#39;d&quot;</span><span class="p">:</span> <span class="s1">&#39;it would&#39;</span><span class="p">,</span> <span class="s2">&quot;it&#39;ll&quot;</span><span class="p">:</span> <span class="s1">&#39;it will&#39;</span><span class="p">,</span> <span class="s2">&quot;it&#39;s&quot;</span><span class="p">:</span> <span class="s1">&#39;it is&#39;</span><span class="p">,</span> <span class="s2">&quot;ma&#39;am&quot;</span><span class="p">:</span> <span class="s1">&#39;madam&#39;</span><span class="p">,</span> <span class="s2">&quot;might&#39;ve&quot;</span><span class="p">:</span> <span class="s1">&#39;might have&#39;</span><span class="p">,</span> <span class="s2">&quot;mightn&#39;t&quot;</span><span class="p">:</span> <span class="s1">&#39;might not&#39;</span><span class="p">,</span> <span class="s2">&quot;must&#39;ve&quot;</span><span class="p">:</span> <span class="s1">&#39;must have&#39;</span><span class="p">,</span> <span class="s2">&quot;mustn&#39;t&quot;</span><span class="p">:</span> <span class="s1">&#39;must not&#39;</span><span class="p">,</span> <span class="s2">&quot;needn&#39;t&quot;</span><span class="p">:</span> <span class="s1">&#39;need not&#39;</span><span class="p">,</span> <span class="s2">&quot;oughtn&#39;t&quot;</span><span class="p">:</span> <span class="s1">&#39;ought not&#39;</span><span class="p">,</span> <span class="s2">&quot;shan&#39;t&quot;</span><span class="p">:</span> <span class="s1">&#39;shall not&#39;</span><span class="p">,</span> <span class="s2">&quot;she&#39;d&quot;</span><span class="p">:</span> <span class="s1">&#39;she would&#39;</span><span class="p">,</span> <span class="s2">&quot;she&#39;ll&quot;</span><span class="p">:</span> <span class="s1">&#39;she will&#39;</span><span class="p">,</span> <span class="s2">&quot;she&#39;s&quot;</span><span class="p">:</span> <span class="s1">&#39;she is&#39;</span><span class="p">,</span> <span class="s2">&quot;should&#39;ve&quot;</span><span class="p">:</span> <span class="s1">&#39;should have&#39;</span><span class="p">,</span> <span class="s2">&quot;shouldn&#39;t&quot;</span><span class="p">:</span> <span class="s1">&#39;should not&#39;</span><span class="p">,</span> <span class="s2">&quot;that&#39;d&quot;</span><span class="p">:</span> <span class="s1">&#39;that would&#39;</span><span class="p">,</span> <span class="s2">&quot;that&#39;s&quot;</span><span class="p">:</span> <span class="s1">&#39;that is&#39;</span><span class="p">,</span> <span class="s2">&quot;there&#39;d&quot;</span><span class="p">:</span> <span class="s1">&#39;there would&#39;</span><span class="p">,</span> <span class="s2">&quot;there&#39;s&quot;</span><span class="p">:</span> <span class="s1">&#39;there is&#39;</span><span class="p">,</span> <span class="s2">&quot;they&#39;d&quot;</span><span class="p">:</span> <span class="s1">&#39;they would&#39;</span><span class="p">,</span> <span class="s2">&quot;they&#39;ll&quot;</span><span class="p">:</span> <span class="s1">&#39;they will&#39;</span><span class="p">,</span> <span class="s2">&quot;they&#39;re&quot;</span><span class="p">:</span> <span class="s1">&#39;they are&#39;</span><span class="p">,</span> <span class="s2">&quot;they&#39;ve&quot;</span><span class="p">:</span> <span class="s1">&#39;they have&#39;</span><span class="p">,</span> <span class="s2">&quot;wasn&#39;t&quot;</span><span class="p">:</span> <span class="s1">&#39;was not&#39;</span><span class="p">,</span> <span class="s2">&quot;we&#39;d&quot;</span><span class="p">:</span> <span class="s1">&#39;we would&#39;</span><span class="p">,</span> <span class="s2">&quot;we&#39;ll&quot;</span><span class="p">:</span> <span class="s1">&#39;we will&#39;</span><span class="p">,</span> <span class="s2">&quot;we&#39;re&quot;</span><span class="p">:</span> <span class="s1">&#39;we are&#39;</span><span class="p">,</span> <span class="s2">&quot;we&#39;ve&quot;</span><span class="p">:</span> <span class="s1">&#39;we have&#39;</span><span class="p">,</span> <span class="s2">&quot;weren&#39;t&quot;</span><span class="p">:</span> <span class="s1">&#39;were not&#39;</span><span class="p">,</span> <span class="s2">&quot;what&#39;re&quot;</span><span class="p">:</span> <span class="s1">&#39;what are&#39;</span><span class="p">,</span> <span class="s2">&quot;what&#39;s&quot;</span><span class="p">:</span> <span class="s1">&#39;what is&#39;</span><span class="p">,</span> <span class="s2">&quot;when&#39;s&quot;</span><span class="p">:</span> <span class="s1">&#39;when is&#39;</span><span class="p">,</span> <span class="s2">&quot;where&#39;d&quot;</span><span class="p">:</span> <span class="s1">&#39;where did&#39;</span><span class="p">,</span> <span class="s2">&quot;where&#39;s&quot;</span><span class="p">:</span> <span class="s1">&#39;where is&#39;</span><span class="p">,</span> <span class="s2">&quot;where&#39;ve&quot;</span><span class="p">:</span> <span class="s1">&#39;where have&#39;</span><span class="p">,</span> <span class="s2">&quot;who&#39;ll&quot;</span><span class="p">:</span> <span class="s1">&#39;who will&#39;</span><span class="p">,</span> <span class="s2">&quot;who&#39;s&quot;</span><span class="p">:</span> <span class="s1">&#39;who is&#39;</span><span class="p">,</span> <span class="s2">&quot;who&#39;ve&quot;</span><span class="p">:</span> <span class="s1">&#39;who have&#39;</span><span class="p">,</span> <span class="s2">&quot;why&#39;s&quot;</span><span class="p">:</span> <span class="s1">&#39;why is&#39;</span><span class="p">,</span> <span class="s2">&quot;won&#39;t&quot;</span><span class="p">:</span> <span class="s1">&#39;will not&#39;</span><span class="p">,</span> <span class="s2">&quot;would&#39;ve&quot;</span><span class="p">:</span> <span class="s1">&#39;would have&#39;</span><span class="p">,</span> <span class="s2">&quot;wouldn&#39;t&quot;</span><span class="p">:</span> <span class="s1">&#39;would not&#39;</span><span class="p">,</span> <span class="s2">&quot;you&#39;d&quot;</span><span class="p">:</span> <span class="s1">&#39;you would&#39;</span><span class="p">,</span> <span class="s2">&quot;you&#39;d&#39;ve&quot;</span><span class="p">:</span> <span class="s1">&#39;you would have&#39;</span><span class="p">,</span> <span class="s2">&quot;you&#39;ll&quot;</span><span class="p">:</span> <span class="s1">&#39;you will&#39;</span><span class="p">,</span> <span class="s2">&quot;you&#39;re&quot;</span><span class="p">:</span> <span class="s1">&#39;you are&#39;</span><span class="p">,</span> <span class="s2">&quot;you&#39;ve&quot;</span><span class="p">:</span> <span class="s1">&#39;you have&#39;</span><span class="p">}</span>


<span class="k">class</span> <span class="nc">WordSwap</span><span class="p">(</span><span class="n">Transformation</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An abstract class that takes a sentence and transforms it by replacing</span>
<span class="sd">    some of its words.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">letters_to_insert</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initiates the following attributes</span>

<span class="sd">        Args:</span>
<span class="sd">          letters_to_insert: String</span>
<span class="sd">            Letters allowed for insertion into words</span>
<span class="sd">            (used by some char-based transformations)</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">letters_to_insert</span> <span class="o">=</span> <span class="n">letters_to_insert</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">letters_to_insert</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">letters_to_insert</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span>

    <span class="k">def</span> <span class="nf">_get_replacement_words</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a set of replacements given an input word.</span>
<span class="sd">        Must be overridden by specific word swap transformations.</span>

<span class="sd">        Args:</span>
<span class="sd">          word: String</span>
<span class="sd">            The input word to find replacements for.</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_get_random_letter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper function that returns a random single letter from the English</span>
<span class="sd">        alphabet that could be lowercase or uppercase.</span>

<span class="sd">        Args:</span>
<span class="sd">          None</span>

<span class="sd">        Returns:</span>
<span class="sd">          Random single letter for random-letter transformation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">letters_to_insert</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_transformations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_text</span><span class="p">,</span> <span class="n">indices_to_modify</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of all possible transformations for current_text,</span>
<span class="sd">        only modifying indices_to_modify.</span>
<span class="sd">        Must be overridden by specific transformations.</span>

<span class="sd">        Args:</span>
<span class="sd">          current_text: String</span>
<span class="sd">            The AttackedText Object to transform.</span>
<span class="sd">          indicies_to_modify: Integer</span>
<span class="sd">            Which word indices can be modified.</span>

<span class="sd">        Returns:</span>
<span class="sd">          transformed_texts: List</span>
<span class="sd">            List of all transformed texts with indexes at which transformation was applied</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">words</span> <span class="o">=</span> <span class="n">current_text</span><span class="o">.</span><span class="n">words</span>
        <span class="n">transformed_texts</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices_to_modify</span><span class="p">:</span>
            <span class="n">word_to_replace</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">replacement_words</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_replacement_words</span><span class="p">(</span><span class="n">word_to_replace</span><span class="p">)</span>
            <span class="n">transformed_texts_idx</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">replacement_words</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="n">word_to_replace</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">transformed_texts_idx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_text</span><span class="o">.</span><span class="n">replace_word_at_index</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">r</span><span class="p">))</span>
            <span class="n">transformed_texts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">transformed_texts_idx</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">transformed_texts</span>


<span class="k">class</span> <span class="nc">WordSwapExtend</span><span class="p">(</span><span class="n">WordSwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transforms an input by performing extension on recognized</span>
<span class="sd">    combinations.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_get_transformations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_text</span><span class="p">,</span> <span class="n">indices_to_modify</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return all possible transformed sentences, each with one extension.</span>

<span class="sd">        Args:</span>
<span class="sd">          current_text: String</span>
<span class="sd">            The AttackedText Object to transform.</span>
<span class="sd">          indicies_to_modify: Integer</span>
<span class="sd">            Which word indices can be modified.</span>

<span class="sd">        Returns:</span>
<span class="sd">          transformed_texts: List</span>
<span class="sd">            List of all transformed texts based on extension map</span>

<span class="sd">        Usage/Examples:</span>
<span class="sd">        &gt;&gt;&gt; from textattack.transformations import WordSwapExtend</span>
<span class="sd">        &gt;&gt;&gt; from textattack.augmentation import Augmenter</span>
<span class="sd">        &gt;&gt;&gt; transformation = WordSwapExtend()</span>
<span class="sd">        &gt;&gt;&gt; augmenter = Augmenter(transformation=transformation)</span>
<span class="sd">        &gt;&gt;&gt; s = &#39;&#39;&#39;I&#39;m fabulous&#39;&#39;&#39;</span>
<span class="sd">        &gt;&gt;&gt; augmenter.augment(s)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">transformed_texts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">words</span> <span class="o">=</span> <span class="n">current_text</span><span class="o">.</span><span class="n">words</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">indices_to_modify</span><span class="p">:</span>
            <span class="n">word</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            <span class="c1"># expend when word in map</span>
            <span class="k">if</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">EXTENSION_MAP</span><span class="p">:</span>
                <span class="n">expanded</span> <span class="o">=</span> <span class="n">EXTENSION_MAP</span><span class="p">[</span><span class="n">word</span><span class="p">]</span>
                <span class="n">transformed_text</span> <span class="o">=</span> <span class="n">current_text</span><span class="o">.</span><span class="n">replace_word_at_index</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">expanded</span><span class="p">)</span>
                <span class="n">transformed_texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transformed_text</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">transformed_texts</span>


<span class="k">class</span> <span class="nc">WordSwapContract</span><span class="p">(</span><span class="n">WordSwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transforms an input by performing contraction on recognized</span>
<span class="sd">    combinations.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">reverse_contraction_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">EXTENSION_MAP</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

    <span class="k">def</span> <span class="nf">_get_transformations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_text</span><span class="p">,</span> <span class="n">indices_to_modify</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return all possible transformed sentences, each with one</span>
<span class="sd">        contraction.</span>

<span class="sd">        Args:</span>
<span class="sd">          current_text: String</span>
<span class="sd">            The AttackedText Object to transform.</span>
<span class="sd">          indicies_to_modify: Integer</span>
<span class="sd">            Which word indices can be modified.</span>

<span class="sd">        Returns:</span>
<span class="sd">          transformed_texts: List</span>
<span class="sd">            List of all transformed texts based on reverse contraction map</span>

<span class="sd">        Usage/Example:</span>
<span class="sd">        &gt;&gt;&gt; from textattack.transformations import WordSwapContract</span>
<span class="sd">        &gt;&gt;&gt; from textattack.augmentation import Augmenter</span>
<span class="sd">        &gt;&gt;&gt; transformation = WordSwapContract()</span>
<span class="sd">        &gt;&gt;&gt; augmenter = Augmenter(transformation=transformation)</span>
<span class="sd">        &gt;&gt;&gt; s = &#39;I am 12 years old.&#39;</span>
<span class="sd">        &gt;&gt;&gt; augmenter.augment(s)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">transformed_texts</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">words</span> <span class="o">=</span> <span class="n">current_text</span><span class="o">.</span><span class="n">words</span>
        <span class="n">indices_to_modify</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">indices_to_modify</span><span class="p">)</span>

        <span class="c1"># search for every 2-words combination in reverse_contraction_map</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">word_idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">indices_to_modify</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">next_idx</span> <span class="o">=</span> <span class="n">indices_to_modify</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="n">next_idx</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">word</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="n">word_idx</span><span class="p">]</span>
            <span class="n">next_word</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="n">next_idx</span><span class="p">]</span>

            <span class="c1"># generating the words to search for</span>
            <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">word</span><span class="p">,</span> <span class="n">next_word</span><span class="p">])</span>

            <span class="c1"># when a possible contraction is found in map, contract the current text</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reverse_contraction_map</span><span class="p">:</span>
                <span class="n">transformed_text</span> <span class="o">=</span> <span class="n">current_text</span><span class="o">.</span><span class="n">replace_word_at_index</span><span class="p">(</span>
                    <span class="n">idx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reverse_contraction_map</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">transformed_text</span> <span class="o">=</span> <span class="n">transformed_text</span><span class="o">.</span><span class="n">delete_word_at_index</span><span class="p">(</span><span class="n">next_idx</span><span class="p">)</span>
                <span class="n">transformed_texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transformed_text</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">transformed_texts</span>


<span class="k">class</span> <span class="nc">WordSwapHomoglyphSwap</span><span class="p">(</span><span class="n">WordSwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transforms an input by replacing its words with visually similar words</span>
<span class="sd">    using homoglyph swaps.</span>
<span class="sd">    A homoglyph is one of two or more graphemes, characters, or glyphs</span>
<span class="sd">    with shapes that appear identical or very similar.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">random_one</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initiates the following attributes</span>

<span class="sd">        Args:</span>
<span class="sd">          random_one: Boolean</span>
<span class="sd">            Choosing random substring for transformation</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>

<span class="sd">        Usage/Examples:</span>
<span class="sd">          &gt;&gt;&gt; from textattack.transformations import WordSwapHomoglyphSwap</span>
<span class="sd">          &gt;&gt;&gt; from textattack.augmentation import Augmenter</span>
<span class="sd">          &gt;&gt;&gt; transformation = WordSwapHomoglyphSwap()</span>
<span class="sd">          &gt;&gt;&gt; augmenter = Augmenter(transformation=transformation)</span>
<span class="sd">          &gt;&gt;&gt; s = &#39;I am fabulous.&#39;</span>
<span class="sd">          &gt;&gt;&gt; augmenter.augment(s)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">homos</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;-&quot;</span><span class="p">:</span> <span class="s2">&quot;˗&quot;</span><span class="p">,</span>
            <span class="s2">&quot;9&quot;</span><span class="p">:</span> <span class="s2">&quot;৭&quot;</span><span class="p">,</span>
            <span class="s2">&quot;8&quot;</span><span class="p">:</span> <span class="s2">&quot;Ȣ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;7&quot;</span><span class="p">:</span> <span class="s2">&quot;𝟕&quot;</span><span class="p">,</span>
            <span class="s2">&quot;6&quot;</span><span class="p">:</span> <span class="s2">&quot;б&quot;</span><span class="p">,</span>
            <span class="s2">&quot;5&quot;</span><span class="p">:</span> <span class="s2">&quot;Ƽ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;4&quot;</span><span class="p">:</span> <span class="s2">&quot;Ꮞ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;3&quot;</span><span class="p">:</span> <span class="s2">&quot;Ʒ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="s2">&quot;ᒿ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;1&quot;</span><span class="p">:</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span>
            <span class="s2">&quot;0&quot;</span><span class="p">:</span> <span class="s2">&quot;O&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&#39;&quot;</span><span class="p">:</span> <span class="s2">&quot;`&quot;</span><span class="p">,</span>
            <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;ɑ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="s2">&quot;Ь&quot;</span><span class="p">,</span>
            <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="s2">&quot;ϲ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="s2">&quot;ԁ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;e&quot;</span><span class="p">:</span> <span class="s2">&quot;е&quot;</span><span class="p">,</span>
            <span class="s2">&quot;f&quot;</span><span class="p">:</span> <span class="s2">&quot;𝚏&quot;</span><span class="p">,</span>
            <span class="s2">&quot;g&quot;</span><span class="p">:</span> <span class="s2">&quot;ɡ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;h&quot;</span><span class="p">:</span> <span class="s2">&quot;հ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;i&quot;</span><span class="p">:</span> <span class="s2">&quot;і&quot;</span><span class="p">,</span>
            <span class="s2">&quot;j&quot;</span><span class="p">:</span> <span class="s2">&quot;ϳ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;k&quot;</span><span class="p">:</span> <span class="s2">&quot;𝒌&quot;</span><span class="p">,</span>
            <span class="s2">&quot;l&quot;</span><span class="p">:</span> <span class="s2">&quot;ⅼ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;m&quot;</span><span class="p">:</span> <span class="s2">&quot;ｍ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="s2">&quot;ո&quot;</span><span class="p">,</span>
            <span class="s2">&quot;o&quot;</span><span class="p">:</span> <span class="s2">&quot;о&quot;</span><span class="p">,</span>
            <span class="s2">&quot;p&quot;</span><span class="p">:</span> <span class="s2">&quot;р&quot;</span><span class="p">,</span>
            <span class="s2">&quot;q&quot;</span><span class="p">:</span> <span class="s2">&quot;ԛ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="s2">&quot;ⲅ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="s2">&quot;ѕ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;t&quot;</span><span class="p">:</span> <span class="s2">&quot;𝚝&quot;</span><span class="p">,</span>
            <span class="s2">&quot;u&quot;</span><span class="p">:</span> <span class="s2">&quot;ս&quot;</span><span class="p">,</span>
            <span class="s2">&quot;v&quot;</span><span class="p">:</span> <span class="s2">&quot;ѵ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="s2">&quot;ԝ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;×&quot;</span><span class="p">,</span>
            <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="s2">&quot;у&quot;</span><span class="p">,</span>
            <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="s2">&quot;ᴢ&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span> <span class="o">=</span> <span class="n">random_one</span>

    <span class="k">def</span> <span class="nf">_get_replacement_words</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list containing all possible words with 1 character</span>
<span class="sd">        replaced by a homoglyph.</span>

<span class="sd">        Args:</span>
<span class="sd">          word: String</span>
<span class="sd">            Word for which homoglyphs are to be generated.</span>

<span class="sd">        Returns:</span>
<span class="sd">          candidate_words: List</span>
<span class="sd">            List of homoglyphs with respect to input word.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">candidate_words</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">homos</span><span class="p">:</span>
                <span class="n">repl_letter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">homos</span><span class="p">[</span><span class="n">word</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                <span class="n">candidate_word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">repl_letter</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
                <span class="n">candidate_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate_word</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">homos</span><span class="p">:</span>
                    <span class="n">repl_letter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">homos</span><span class="p">[</span><span class="n">word</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                    <span class="n">candidate_word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">repl_letter</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
                    <span class="n">candidate_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate_word</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">candidate_words</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">deterministic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span>

    <span class="k">def</span> <span class="nf">extra_repr_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">extra_repr_keys</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">WordSwapRandomCharacterDeletion</span><span class="p">(</span><span class="n">WordSwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transforms an input by deleting its characters.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">random_one</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skip_first_char</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">skip_last_char</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initiates the following parameters:</span>

<span class="sd">        Args:</span>
<span class="sd">          random_one: Boolean</span>
<span class="sd">            Whether to return a single word with a random</span>
<span class="sd">            character deleted. If not, returns all possible options.</span>
<span class="sd">          skip_first_char: Boolean</span>
<span class="sd">            Whether to disregard deleting the first character.</span>
<span class="sd">          skip_last_char: Boolean</span>
<span class="sd">            Whether to disregard deleting the last character.</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>

<span class="sd">        Usage/Example:</span>
<span class="sd">          &gt;&gt;&gt; from textattack.transformations import WordSwapRandomCharacterDeletion</span>
<span class="sd">          &gt;&gt;&gt; from textattack.augmentation import Augmenter</span>
<span class="sd">          &gt;&gt;&gt; transformation = WordSwapRandomCharacterDeletion()</span>
<span class="sd">          &gt;&gt;&gt; augmenter = Augmenter(transformation=transformation)</span>
<span class="sd">          &gt;&gt;&gt; s = &#39;I am fabulous.&#39;</span>
<span class="sd">          &gt;&gt;&gt; augmenter.augment(s)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span> <span class="o">=</span> <span class="n">random_one</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_first_char</span> <span class="o">=</span> <span class="n">skip_first_char</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_last_char</span> <span class="o">=</span> <span class="n">skip_last_char</span>

    <span class="k">def</span> <span class="nf">_get_replacement_words</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list containing all possible words with 1 letter</span>
<span class="sd">        deleted.</span>

<span class="sd">        Args:</span>
<span class="sd">          word: String</span>
<span class="sd">            The input word to find replacements for.</span>

<span class="sd">        Returns:</span>
<span class="sd">          candidate_words: List</span>
<span class="sd">            List of candidate words with single letter deletion</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="n">candidate_words</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">start_idx</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_first_char</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">end_idx</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_last_char</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">start_idx</span> <span class="o">&gt;=</span> <span class="n">end_idx</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">start_idx</span><span class="p">,</span> <span class="n">end_idx</span><span class="p">)</span>
            <span class="n">candidate_word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
            <span class="n">candidate_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate_word</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start_idx</span><span class="p">,</span> <span class="n">end_idx</span><span class="p">):</span>
                <span class="n">candidate_word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
                <span class="n">candidate_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate_word</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">candidate_words</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">deterministic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span>

    <span class="k">def</span> <span class="nf">extra_repr_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">extra_repr_keys</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;random_one&quot;</span><span class="p">]</span>


<span class="k">class</span> <span class="nc">WordSwapNeighboringCharacterSwap</span><span class="p">(</span><span class="n">WordSwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transforms an input by replacing its words with a neighboring character</span>
<span class="sd">    swap.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">random_one</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skip_first_char</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">skip_last_char</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initiates the following attributes</span>

<span class="sd">        Args:</span>
<span class="sd">          random_one: Boolean</span>
<span class="sd">            Whether to return a single word with two characters</span>
<span class="sd">            swapped. If not, returns all possible options.</span>
<span class="sd">          skip_first_char: Boolean</span>
<span class="sd">            Whether to disregard perturbing the first</span>
<span class="sd">            character.</span>
<span class="sd">          skip_last_char: Boolean</span>
<span class="sd">            Whether to disregard perturbing the last</span>
<span class="sd">            character.</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>

<span class="sd">        Usage/Examples:</span>
<span class="sd">          &gt;&gt;&gt; from textattack.transformations import WordSwapNeighboringCharacterSwap</span>
<span class="sd">          &gt;&gt;&gt; from textattack.augmentation import Augmenter</span>
<span class="sd">          &gt;&gt;&gt; transformation = WordSwapNeighboringCharacterSwap()</span>
<span class="sd">          &gt;&gt;&gt; augmenter = Augmenter(transformation=transformation)</span>
<span class="sd">          &gt;&gt;&gt; s = &#39;I am fabulous.&#39;</span>
<span class="sd">          &gt;&gt;&gt; augmenter.augment(s)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span> <span class="o">=</span> <span class="n">random_one</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_first_char</span> <span class="o">=</span> <span class="n">skip_first_char</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_last_char</span> <span class="o">=</span> <span class="n">skip_last_char</span>

    <span class="k">def</span> <span class="nf">_get_replacement_words</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list containing all possible words with a single pair of</span>
<span class="sd">        neighboring characters swapped.</span>

<span class="sd">        Args:</span>
<span class="sd">          word: String</span>
<span class="sd">            The input word to find replacements for.</span>

<span class="sd">        Returns:</span>
<span class="sd">          candidate_words: List</span>
<span class="sd">            List of candidate words</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="n">candidate_words</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">start_idx</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_first_char</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">end_idx</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_last_char</span> <span class="k">else</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">start_idx</span> <span class="o">&gt;=</span> <span class="n">end_idx</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">start_idx</span><span class="p">,</span> <span class="n">end_idx</span><span class="p">)</span>
            <span class="n">candidate_word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="p">:]</span>
            <span class="n">candidate_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate_word</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start_idx</span><span class="p">,</span> <span class="n">end_idx</span><span class="p">):</span>
                <span class="n">candidate_word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="p">:]</span>
                <span class="n">candidate_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate_word</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">candidate_words</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">deterministic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span>

    <span class="k">def</span> <span class="nf">extra_repr_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">extra_repr_keys</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;random_one&quot;</span><span class="p">]</span>


<span class="k">class</span> <span class="nc">WordSwapRandomCharacterInsertion</span><span class="p">(</span><span class="n">WordSwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transforms an input by inserting a random character.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">random_one</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skip_first_char</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">skip_last_char</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initiates the following attributes</span>

<span class="sd">        Args:</span>
<span class="sd">          random_one: Boolean</span>
<span class="sd">            Whether to return a single word with a random</span>
<span class="sd">            character deleted. If not, returns all possible options.</span>
<span class="sd">          skip_first_char: Boolean</span>
<span class="sd">            Whether to disregard inserting as the first character.</span>
<span class="sd">          skip_last_char: Boolean</span>
<span class="sd">            Whether to disregard inserting as the last character.</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>

<span class="sd">        Usage/Example:</span>
<span class="sd">          &gt;&gt;&gt; from textattack.transformations import WordSwapRandomCharacterInsertion</span>
<span class="sd">          &gt;&gt;&gt; from textattack.augmentation import Augmenter</span>
<span class="sd">          &gt;&gt;&gt; transformation = WordSwapRandomCharacterInsertion()</span>
<span class="sd">          &gt;&gt;&gt; augmenter = Augmenter(transformation=transformation)</span>
<span class="sd">          &gt;&gt;&gt; s = &#39;I am fabulous.&#39;</span>
<span class="sd">          &gt;&gt;&gt; augmenter.augment(s)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span> <span class="o">=</span> <span class="n">random_one</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_first_char</span> <span class="o">=</span> <span class="n">skip_first_char</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_last_char</span> <span class="o">=</span> <span class="n">skip_last_char</span>

    <span class="k">def</span> <span class="nf">_get_replacement_words</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list containing all possible words with 1 random</span>
<span class="sd">        character inserted.</span>

<span class="sd">        Args:</span>
<span class="sd">          word: String</span>
<span class="sd">            The input word to find replacements for.</span>

<span class="sd">        Returns:</span>
<span class="sd">          candidate_words: List</span>
<span class="sd">            List of candidate words with all possible words with 1 random</span>
<span class="sd">            character inserted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="n">candidate_words</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">start_idx</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_first_char</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">end_idx</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_last_char</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">start_idx</span> <span class="o">&gt;=</span> <span class="n">end_idx</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">start_idx</span><span class="p">,</span> <span class="n">end_idx</span><span class="p">)</span>
            <span class="n">candidate_word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_random_letter</span><span class="p">()</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
            <span class="n">candidate_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate_word</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start_idx</span><span class="p">,</span> <span class="n">end_idx</span><span class="p">):</span>
                <span class="n">candidate_word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_random_letter</span><span class="p">()</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
                <span class="n">candidate_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate_word</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">candidate_words</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">deterministic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span>

    <span class="k">def</span> <span class="nf">extra_repr_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">extra_repr_keys</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;random_one&quot;</span><span class="p">]</span>


<span class="k">class</span> <span class="nc">WordSwapRandomCharacterSubstitution</span><span class="p">(</span><span class="n">WordSwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transforms an input by replacing one character in a word with a random</span>
<span class="sd">    new character.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">random_one</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initiates the following attributes</span>

<span class="sd">        Args:</span>
<span class="sd">          random_one: Boolean</span>
<span class="sd">            Whether to return a single word with a random</span>
<span class="sd">            character deleted. If not set, returns all possible options.</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>

<span class="sd">        Usage/Example:</span>
<span class="sd">          &gt;&gt;&gt; from textattack.transformations import WordSwapRandomCharacterSubstitution</span>
<span class="sd">          &gt;&gt;&gt; from textattack.augmentation import Augmenter</span>
<span class="sd">          &gt;&gt;&gt; transformation = WordSwapRandomCharacterSubstitution()</span>
<span class="sd">          &gt;&gt;&gt; augmenter = Augmenter(transformation=transformation)</span>
<span class="sd">          &gt;&gt;&gt; s = &#39;I am fabulous.&#39;</span>
<span class="sd">          &gt;&gt;&gt; augmenter.augment(s)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span> <span class="o">=</span> <span class="n">random_one</span>

    <span class="k">def</span> <span class="nf">_get_replacement_words</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list containing all possible words with 1 letter</span>
<span class="sd">        substituted for a random letter.</span>

<span class="sd">        Args:</span>
<span class="sd">          word: String</span>
<span class="sd">            The input word to find replacements for.</span>

<span class="sd">        Returns:</span>
<span class="sd">          candidate_words: List</span>
<span class="sd">            List of candidate words with combinations involving random substitution</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="n">candidate_words</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">))</span>
            <span class="n">candidate_word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_random_letter</span><span class="p">()</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
            <span class="n">candidate_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate_word</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)):</span>
                <span class="n">candidate_word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_random_letter</span><span class="p">()</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
                <span class="n">candidate_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate_word</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">candidate_words</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">deterministic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span>

    <span class="k">def</span> <span class="nf">extra_repr_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">extra_repr_keys</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;random_one&quot;</span><span class="p">]</span>


<span class="k">class</span> <span class="nc">CompositeTransformation</span><span class="p">(</span><span class="n">Transformation</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A transformation which applies each of a list of transformations,</span>
<span class="sd">    returning a set of all optoins.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transformations</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initiates the following attributes</span>

<span class="sd">        Args:</span>
<span class="sd">          transformations: List</span>
<span class="sd">            The list of Transformation to apply.</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">transformations</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transformations</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;transformations must be list or tuple&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">transformations</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;transformations cannot be empty&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transformations</span> <span class="o">=</span> <span class="n">transformations</span>

    <span class="k">def</span> <span class="nf">_get_transformations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Placeholder method that would throw an error if a user tried to</span>
<span class="sd">        treat the CompositeTransformation as a &#39;normal&#39; transformation.</span>

<span class="sd">        Args:</span>
<span class="sd">          None</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;CompositeTransformation does not support _get_transformations().&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates new attacked texts based on different possible transformations</span>

<span class="sd">        Args:</span>
<span class="sd">          None</span>

<span class="sd">        Returns:</span>
<span class="sd">          new_attacked_texts: List</span>
<span class="sd">            List of new attacked texts based on different possible transformations</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_attacked_texts</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">transformation</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformations</span><span class="p">:</span>
            <span class="n">new_attacked_texts</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">transformation</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">new_attacked_texts</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">main_str</span> <span class="o">=</span> <span class="s2">&quot;CompositeTransformation&quot;</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span>
        <span class="n">transformation_lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">transformation</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transformations</span><span class="p">):</span>
            <span class="n">transformation_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">add_indent</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">transformation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">transformation_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">)</span>
        <span class="n">main_str</span> <span class="o">+=</span> <span class="n">utils</span><span class="o">.</span><span class="n">add_indent</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">transformation_lines</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">main_str</span>

    <span class="fm">__str__</span> <span class="o">=</span> <span class="fm">__repr__</span>


<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">===================</span>
<span class="sd">Augmenter Class</span>
<span class="sd">===================</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cuda&quot;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;cpu&quot;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">PreTransformationConstraint</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An abstract class that represents constraints which are applied before</span>
<span class="sd">    the transformation.</span>
<span class="sd">    These restrict which words are allowed to be modified during the</span>
<span class="sd">    transformation. For example, we might not allow stopwords to be</span>
<span class="sd">    modified.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_text</span><span class="p">,</span> <span class="n">transformation</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the word indices in current_text which are able to be</span>
<span class="sd">        modified. First checks compatibility with transformation then calls</span>
<span class="sd">        _get_modifiable_indices</span>

<span class="sd">        Args:</span>
<span class="sd">          current_text: String</span>
<span class="sd">            The AttackedText Object input to consider.</span>
<span class="sd">          transformation: Transformation Object</span>
<span class="sd">            The Transformation which will be applied.</span>

<span class="sd">        Returns:</span>
<span class="sd">          Modifiable indices of input if transformation is compatible</span>
<span class="sd">          Words of current text otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_compatibility</span><span class="p">(</span><span class="n">transformation</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">current_text</span><span class="o">.</span><span class="n">words</span><span class="p">)))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_modifiable_indices</span><span class="p">(</span><span class="n">current_text</span><span class="p">)</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_get_modifiable_indices</span><span class="p">(</span><span class="n">current_text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the word indices in current_text which are able to be</span>
<span class="sd">        modified. Must be overridden by specific pre-transformation</span>
<span class="sd">        constraints.</span>

<span class="sd">        Args:</span>
<span class="sd">          current_text: String</span>
<span class="sd">            The AttackedText Object input to consider.</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">check_compatibility</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transformation</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if this constraint is compatible with the given</span>
<span class="sd">        transformation. For example, the WordEmbeddingDistance constraint</span>
<span class="sd">        compares the embedding of the word inserted with that of the word</span>
<span class="sd">        deleted. Therefore it can only be applied in the case of word swaps,</span>
<span class="sd">        and not for transformations which involve only one of insertion or</span>
<span class="sd">        deletion.</span>

<span class="sd">        Args:</span>
<span class="sd">          transformation: Transformation Object</span>
<span class="sd">            The Transformation to check compatibility for.</span>

<span class="sd">        Returns:</span>
<span class="sd">          True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">extra_repr_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the extra representation of the constraint using these keys.</span>
<span class="sd">        To print customized extra information, you should reimplement</span>
<span class="sd">        this method in your own constraint. Both single-line and multi-</span>
<span class="sd">        line strings are acceptable.</span>

<span class="sd">        Args:</span>
<span class="sd">          None</span>

<span class="sd">        Returns:</span>
<span class="sd">          []</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="fm">__str__</span> <span class="o">=</span> <span class="fm">__repr__</span> <span class="o">=</span> <span class="n">default_class_repr</span>


<span class="n">flair</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span>

<span class="k">def</span> <span class="nf">words_from_text</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">words_to_ignore</span><span class="o">=</span><span class="p">[]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Lowercases a string, removes all non-alphanumeric characters, and splits</span>
<span class="sd">    into words.</span>

<span class="sd">    Args:</span>
<span class="sd">      s: String</span>
<span class="sd">        Input String</span>
<span class="sd">      words_to_ignore: List</span>
<span class="sd">        List of words that explicitly need to be ignored</span>

<span class="sd">    Returns:</span>
<span class="sd">      words: List</span>
<span class="sd">        Legitimate list of alpha-numeric words that aren&#39;t ignored</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">homos</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="s2">&quot;˗&quot;</span><span class="p">,</span>
            <span class="s2">&quot;৭&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Ȣ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;𝟕&quot;</span><span class="p">,</span>
            <span class="s2">&quot;б&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Ƽ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Ꮞ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Ʒ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ᒿ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;l&quot;</span><span class="p">,</span>
            <span class="s2">&quot;O&quot;</span><span class="p">,</span>
            <span class="s2">&quot;`&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ɑ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Ь&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ϲ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ԁ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;е&quot;</span><span class="p">,</span>
            <span class="s2">&quot;𝚏&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ɡ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;հ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;і&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ϳ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;𝒌&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ⅼ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ｍ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ո&quot;</span><span class="p">,</span>
            <span class="s2">&quot;о&quot;</span><span class="p">,</span>
            <span class="s2">&quot;р&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ԛ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ⲅ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ѕ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;𝚝&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ս&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ѵ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ԝ&quot;</span><span class="p">,</span>
            <span class="s2">&quot;×&quot;</span><span class="p">,</span>
            <span class="s2">&quot;у&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ᴢ&quot;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="n">words</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">word</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">homos</span><span class="p">:</span>
            <span class="n">word</span> <span class="o">+=</span> <span class="n">c</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="ow">in</span> <span class="s2">&quot;&#39;-_*@&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Allow apostrophes, hyphens, underscores, asterisks and at signs as long as they don&#39;t begin the</span>
            <span class="c1"># word.</span>
            <span class="n">word</span> <span class="o">+=</span> <span class="n">c</span>
        <span class="k">elif</span> <span class="n">word</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">words_to_ignore</span><span class="p">:</span>
                <span class="n">words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
            <span class="n">word</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">words_to_ignore</span><span class="p">):</span>
        <span class="n">words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">words</span>


<span class="n">_flair_pos_tagger</span> <span class="o">=</span> <span class="kc">None</span>


<span class="k">def</span> <span class="nf">flair_tag</span><span class="p">(</span><span class="n">sentence</span><span class="p">,</span> <span class="n">tag_type</span><span class="o">=</span><span class="s2">&quot;upos-fast&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tags a Sentence object using flair part-of-speech tagger.</span>

<span class="sd">    Args:</span>
<span class="sd">      sentence: Object</span>
<span class="sd">        Input Sequence</span>
<span class="sd">      tag_type: String</span>
<span class="sd">        Type of flair tag that needs to be applied</span>

<span class="sd">    Returns:</span>
<span class="sd">      Nothing</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">_flair_pos_tagger</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_flair_pos_tagger</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">flair.models</span> <span class="kn">import</span> <span class="n">SequenceTagger</span>

        <span class="n">_flair_pos_tagger</span> <span class="o">=</span> <span class="n">SequenceTagger</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">tag_type</span><span class="p">)</span>
    <span class="n">_flair_pos_tagger</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">zip_flair_result</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">tag_type</span><span class="o">=</span><span class="s2">&quot;upos-fast&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes a sentence tagging from flair and returns two lists, of words</span>
<span class="sd">    and their corresponding parts-of-speech.</span>

<span class="sd">    Args:</span>
<span class="sd">      pred: Object</span>
<span class="sd">        Resulting Prediction on input sentence post tagging</span>
<span class="sd">      tag_type: String</span>
<span class="sd">        Type of flair tag that needs to be applied</span>

<span class="sd">    Returns:</span>
<span class="sd">      Nothing</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">flair.data</span> <span class="kn">import</span> <span class="n">Sentence</span>


<span class="k">class</span> <span class="nc">AttackedText</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A helper class that represents a string that can be attacked.</span>
<span class="sd">    Models that take multiple sentences as input separate them by SPLIT_TOKEN.</span>
<span class="sd">    Attacks &quot;see&quot; the entire input, joined into one string, without the split</span>
<span class="sd">    token.</span>
<span class="sd">    AttackedText instances that were perturbed from other AttackedText</span>
<span class="sd">    objects contain a pointer to the previous text</span>
<span class="sd">    (attack_attrs[&quot;previous_attacked_text&quot;]), so that the full chain of</span>
<span class="sd">    perturbations might be reconstructed by using this key to form a linked</span>
<span class="sd">    list.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SPLIT_TOKEN</span> <span class="o">=</span> <span class="s2">&quot;&lt;SPLIT&gt;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text_input</span><span class="p">,</span> <span class="n">attack_attrs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Read in ``text_input`` as a string or OrderedDict.</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initiates the following attributes:</span>

<span class="sd">        Args:</span>
<span class="sd">          text: String</span>
<span class="sd">            The string that this AttackedText Object represents</span>
<span class="sd">          attack_attrs: Dictionary</span>
<span class="sd">            Dictionary of various attributes stored during the</span>
<span class="sd">            course of an attack.</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text_input</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_text_input</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">text_input</span><span class="p">)])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text_input</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_text_input</span> <span class="o">=</span> <span class="n">text_input</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid text_input type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">text_input</span><span class="p">)</span><span class="si">}</span><span class="s2"> (required str or OrderedDict)&quot;</span>
            <span class="p">)</span>
        <span class="c1"># Process input lazily.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_words</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_words_per_input</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pos_tags</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ner_tags</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Format text inputs.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_text_input</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text_input</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
        <span class="k">if</span> <span class="n">attack_attrs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attack_attrs</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span> <span class="o">=</span> <span class="n">attack_attrs</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid type for attack_attrs: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">attack_attrs</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># Indices of words from the *original* text. Allows us to map</span>
        <span class="c1"># indices between original text and this text, and vice-versa.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;original_index_map&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_words</span><span class="p">))</span>
        <span class="c1"># A list of all indices in *this* text that have been modified.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;modified_indices&quot;</span><span class="p">,</span> <span class="nb">set</span><span class="p">())</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compares two text instances to make sure they have the same attack</span>
<span class="sd">        attributes.</span>
<span class="sd">        Since some elements stored in self.attack_attrs may be numpy</span>
<span class="sd">        arrays, we have to take special care when comparing them.</span>

<span class="sd">        Args:</span>
<span class="sd">          Other: String</span>
<span class="sd">            Specifies second text instance to be compared for attack attributes</span>

<span class="sd">        Returns:</span>
<span class="sd">          True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">text</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span>
                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
                    <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">free_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete items that take up memory.</span>
<span class="sd">        Can be called once the AttackedText is only needed to display.</span>

<span class="sd">        Args:</span>
<span class="sd">          None</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;previous_attacked_text&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="s2">&quot;previous_attacked_text&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">free_memory</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;previous_attacked_text&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;last_transformation&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">text_window_around_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">window_size</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The text window of window_size words centered around</span>
<span class="sd">        index.</span>

<span class="sd">        Args:</span>
<span class="sd">          index: Integer</span>
<span class="sd">            Index of transformation within input sequence</span>
<span class="sd">          window_size: Integer</span>
<span class="sd">            Specifies size of the window around index</span>

<span class="sd">        Returns:</span>
<span class="sd">          Substring of text with specified window_size</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_words</span>
        <span class="n">half_size</span> <span class="o">=</span> <span class="p">(</span><span class="n">window_size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">-</span> <span class="n">half_size</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">window_size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">index</span> <span class="o">+</span> <span class="n">half_size</span> <span class="o">&gt;=</span> <span class="n">length</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">length</span> <span class="o">-</span> <span class="n">window_size</span><span class="p">)</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">length</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">index</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">half_size</span><span class="p">)</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">index</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">half_size</span><span class="p">)</span>
        <span class="n">text_idx_start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text_index_of_word_index</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
        <span class="n">text_idx_end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text_index_of_word_index</span><span class="p">(</span><span class="n">end</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">words</span><span class="p">[</span><span class="n">end</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="n">text_idx_start</span><span class="p">:</span><span class="n">text_idx_end</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">pos_of_word_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">desired_word_idx</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the part-of-speech of the word at index word_idx.</span>
<span class="sd">        Uses FLAIR part-of-speech tagger.</span>

<span class="sd">        Args:</span>
<span class="sd">          desired_word_idx: Integer</span>
<span class="sd">            Index where POS transformation is to be applied within input sequence</span>

<span class="sd">        Returns:</span>
<span class="sd">          Part-of-speech of the word at index word_idx</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pos_tags</span><span class="p">:</span>
            <span class="n">sentence</span> <span class="o">=</span> <span class="n">Sentence</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">use_tokenizer</span><span class="o">=</span><span class="n">words_from_text</span>
            <span class="p">)</span>
            <span class="n">flair_tag</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pos_tags</span> <span class="o">=</span> <span class="n">sentence</span>
        <span class="n">flair_word_list</span><span class="p">,</span> <span class="n">flair_pos_list</span> <span class="o">=</span> <span class="n">zip_flair_result</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pos_tags</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">word_idx</span><span class="p">,</span> <span class="n">word</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">words</span><span class="p">):</span>
            <span class="k">assert</span> <span class="p">(</span>
                <span class="n">word</span> <span class="ow">in</span> <span class="n">flair_word_list</span>
            <span class="p">),</span> <span class="s2">&quot;word absent in flair returned part-of-speech tags&quot;</span>
            <span class="n">word_idx_in_flair_tags</span> <span class="o">=</span> <span class="n">flair_word_list</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">word_idx</span> <span class="o">==</span> <span class="n">desired_word_idx</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">flair_pos_list</span><span class="p">[</span><span class="n">word_idx_in_flair_tags</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flair_word_list</span> <span class="o">=</span> <span class="n">flair_word_list</span><span class="p">[</span><span class="n">word_idx_in_flair_tags</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
                <span class="n">flair_pos_list</span> <span class="o">=</span> <span class="n">flair_pos_list</span><span class="p">[</span><span class="n">word_idx_in_flair_tags</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Did not find word from index </span><span class="si">{</span><span class="n">desired_word_idx</span><span class="si">}</span><span class="s2"> in flair POS tag&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">ner_of_word_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">desired_word_idx</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;ner&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the ner tag of the word at index word_idx.</span>
<span class="sd">        Uses FLAIR ner tagger.</span>

<span class="sd">        Args:</span>
<span class="sd">          desired_word_idx: Integer</span>
<span class="sd">            Index where POS transformation is to be applied within input sequence</span>
<span class="sd">          model_name: String</span>
<span class="sd">            Name of the model tag that needs to be applied</span>

<span class="sd">        Returns:</span>
<span class="sd">          ner tag of the word at index word_idx.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ner_tags</span><span class="p">:</span>
            <span class="n">sentence</span> <span class="o">=</span> <span class="n">Sentence</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">use_tokenizer</span> <span class="o">=</span> <span class="n">words_from_text</span>
            <span class="p">)</span>
            <span class="n">flair_tag</span><span class="p">(</span><span class="n">sentence</span><span class="p">,</span> <span class="n">model_name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ner_tags</span> <span class="o">=</span> <span class="n">sentence</span>
        <span class="n">flair_word_list</span><span class="p">,</span> <span class="n">flair_ner_list</span> <span class="o">=</span> <span class="n">zip_flair_result</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ner_tags</span><span class="p">,</span> <span class="s2">&quot;ner&quot;</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">word_idx</span><span class="p">,</span> <span class="n">word</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">flair_word_list</span><span class="p">):</span>
            <span class="n">word_idx_in_flair_tags</span> <span class="o">=</span> <span class="n">flair_word_list</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">word_idx</span> <span class="o">==</span> <span class="n">desired_word_idx</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">flair_ner_list</span><span class="p">[</span><span class="n">word_idx_in_flair_tags</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flair_word_list</span> <span class="o">=</span> <span class="n">flair_word_list</span><span class="p">[</span><span class="n">word_idx_in_flair_tags</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
                <span class="n">flair_ner_list</span> <span class="o">=</span> <span class="n">flair_ner_list</span><span class="p">[</span><span class="n">word_idx_in_flair_tags</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Did not find word from index </span><span class="si">{</span><span class="n">desired_word_idx</span><span class="si">}</span><span class="s2"> in flair POS tag&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_text_index_of_word_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the index of word following i in self.text.</span>

<span class="sd">        Args:</span>
<span class="sd">          i: Integer</span>
<span class="sd">            Index of word upon which perturbation is intended.</span>

<span class="sd">        Returns:</span>
<span class="sd">          look_after_index: Index</span>
<span class="sd">            Index of the word following word[i]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pre_words</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">words</span><span class="p">[:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">lower_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="c1"># Find all words until `i` in string.</span>
        <span class="n">look_after_index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">pre_words</span><span class="p">:</span>
            <span class="n">look_after_index</span> <span class="o">=</span> <span class="n">lower_text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">look_after_index</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span>
                <span class="n">word</span>
            <span class="p">)</span>
        <span class="n">look_after_index</span> <span class="o">-=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">words</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">look_after_index</span>

    <span class="k">def</span> <span class="nf">text_until_word_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the text before the beginning of word at index i.</span>

<span class="sd">        Args:</span>
<span class="sd">          i: Integer</span>
<span class="sd">            Index of word upon which perturbation is intended.</span>

<span class="sd">        Returns:</span>
<span class="sd">          Text before the beginning of word at index i.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">look_after_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text_index_of_word_index</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">[:</span><span class="n">look_after_index</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">text_after_word_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the text after the end of word at index i.</span>

<span class="sd">        Args:</span>
<span class="sd">          i: Integer</span>
<span class="sd">            Index of word upon which perturbation is intended.</span>

<span class="sd">        Returns:</span>
<span class="sd">          Text after the end of word at index i.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get index of beginning of word then jump to end of word.</span>
        <span class="n">look_after_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text_index_of_word_index</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">words</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="n">look_after_index</span><span class="p">:]</span>

    <span class="k">def</span> <span class="nf">first_word_diff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_attacked_text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the first word in self.words that differs from</span>
<span class="sd">        other_attacked_text.</span>
<span class="sd">        Useful for word swap strategies.</span>

<span class="sd">        Args:</span>
<span class="sd">          other_attacked_text: String Object</span>
<span class="sd">            Sentence/sequence to be compared with given input</span>

<span class="sd">        Returns:</span>
<span class="sd">          w1: String</span>
<span class="sd">            First differing word in self.words if difference exists</span>
<span class="sd">            None otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">w1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">words</span>
        <span class="n">w2</span> <span class="o">=</span> <span class="n">other_attacked_text</span><span class="o">.</span><span class="n">words</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">w1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">w2</span><span class="p">))):</span>
            <span class="k">if</span> <span class="n">w1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">w2</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">return</span> <span class="n">w1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">first_word_diff_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_attacked_text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the index of the first word in self.words that differs from</span>
<span class="sd">        other_attacked_text.</span>
<span class="sd">        Useful for word swap strategies.</span>

<span class="sd">        Args:</span>
<span class="sd">          other_attacked_text: String object</span>
<span class="sd">            Sentence/sequence to be compared with given input</span>

<span class="sd">        Returns:</span>
<span class="sd">          w1: String</span>
<span class="sd">            First differing word in self.words if difference exists</span>
<span class="sd">            None otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">w1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">words</span>
        <span class="n">w2</span> <span class="o">=</span> <span class="n">other_attacked_text</span><span class="o">.</span><span class="n">words</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">w1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">w2</span><span class="p">))):</span>
            <span class="k">if</span> <span class="n">w1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">w2</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">return</span> <span class="n">i</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">all_words_diff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_attacked_text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the set of indices for which this and other_attacked_text</span>
<span class="sd">        have different words.</span>

<span class="sd">        Args:</span>
<span class="sd">          other_attacked_text: String object</span>
<span class="sd">            Sentence/sequence to be compared with given input</span>

<span class="sd">        Returns:</span>
<span class="sd">          indices: Set</span>
<span class="sd">            differing indices for corresponding words betwee self.words and other_attacked_text</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">w1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">words</span>
        <span class="n">w2</span> <span class="o">=</span> <span class="n">other_attacked_text</span><span class="o">.</span><span class="n">words</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">w1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">w2</span><span class="p">))):</span>
            <span class="k">if</span> <span class="n">w1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">w2</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">indices</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">indices</span>

    <span class="k">def</span> <span class="nf">ith_word_diff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_attacked_text</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns whether the word at index i differs from</span>
<span class="sd">        other_attacked_text.</span>

<span class="sd">        Args:</span>
<span class="sd">          other_attacked_text: String object</span>
<span class="sd">            Sentence/sequence to be compared with given input</span>
<span class="sd">          i: Integer</span>
<span class="sd">            Index of word of interest within input sequence</span>

<span class="sd">        Returns:</span>
<span class="sd">          w1: Boolean</span>
<span class="sd">            Checks for differing words in self.words at index i</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">w1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">words</span>
        <span class="n">w2</span> <span class="o">=</span> <span class="n">other_attacked_text</span><span class="o">.</span><span class="n">words</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">w1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">i</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">w2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">w1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">w2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">words_diff_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_attacked_text</span><span class="p">):</span>
        <span class="c1"># using edit distance to calculate words diff num</span>
        <span class="k">def</span> <span class="nf">generate_tokens</span><span class="p">(</span><span class="n">words</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Generates token for given sequence of words</span>

<span class="sd">            Args:</span>
<span class="sd">              words: List</span>
<span class="sd">                Sequence of words</span>

<span class="sd">            Returns:</span>
<span class="sd">              result: Dictionary</span>
<span class="sd">                Word mapped to corresponding index</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">w</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
                    <span class="n">result</span><span class="p">[</span><span class="n">w</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span>
                    <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">def</span> <span class="nf">words_to_tokens</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">tokens</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Helper function to extract corresponding words from tokens</span>

<span class="sd">            Args:</span>
<span class="sd">              words: List</span>
<span class="sd">                Sequence of words</span>
<span class="sd">              tokens: List</span>
<span class="sd">                Sequence of tokens</span>

<span class="sd">            Returns:</span>
<span class="sd">              result: List</span>
<span class="sd">                Corresponding token for each word</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tokens</span><span class="p">[</span><span class="n">w</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">def</span> <span class="nf">edit_distance</span><span class="p">(</span><span class="n">w1_t</span><span class="p">,</span> <span class="n">w2_t</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Function to find the edit distance between given pair of words</span>

<span class="sd">            Args:</span>
<span class="sd">              w1_t: String</span>
<span class="sd">                Input Sequence #1</span>
<span class="sd">              w2_t: String</span>
<span class="sd">                Input Sequence #2</span>

<span class="sd">            Returns:</span>
<span class="sd">              matrix: 2D Tensor</span>
<span class="sd">                Distance between each letter in input sequence #1 in</span>
<span class="sd">                relation to letter in input sequence #2</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">matrix</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">w2_t</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">w1_t</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="p">]</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">w1_t</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">w2_t</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">w1_t</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">w2_t</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]:</span>
                        <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">d</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
                        <span class="n">matrix</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="n">matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="n">matrix</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">d</span><span class="p">,</span>
                    <span class="p">)</span>

            <span class="k">return</span> <span class="n">matrix</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">w1_t</span><span class="p">)][</span><span class="nb">len</span><span class="p">(</span><span class="n">w2_t</span><span class="p">)]</span>

        <span class="k">def</span> <span class="nf">cal_dif</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Calculate the edit distance given any pair of characters</span>

<span class="sd">            Args:</span>
<span class="sd">              w1: String</span>
<span class="sd">                Input Character #1</span>
<span class="sd">              w2: String</span>
<span class="sd">                Input Character #2</span>

<span class="sd">            Returns:</span>
<span class="sd">              Distance between token of input sequence #1 in</span>
<span class="sd">              relation to token of input sequence #2</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">tokens</span> <span class="o">=</span> <span class="n">generate_tokens</span><span class="p">(</span><span class="n">w1</span> <span class="o">+</span> <span class="n">w2</span><span class="p">)</span>
            <span class="n">w1_t</span> <span class="o">=</span> <span class="n">words_to_tokens</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">tokens</span><span class="p">)</span>
            <span class="n">w2_t</span> <span class="o">=</span> <span class="n">words_to_tokens</span><span class="p">(</span><span class="n">w2</span><span class="p">,</span> <span class="n">tokens</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">edit_distance</span><span class="p">(</span><span class="n">w1_t</span><span class="p">,</span> <span class="n">w2_t</span><span class="p">)</span>

        <span class="n">w1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">words</span>
        <span class="n">w2</span> <span class="o">=</span> <span class="n">other_attacked_text</span><span class="o">.</span><span class="n">words</span>
        <span class="k">return</span> <span class="n">cal_dif</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">convert_from_original_idxs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idxs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Takes indices of words from original string and converts them to</span>
<span class="sd">        indices of the same words in the current string.</span>
<span class="sd">        Uses information from</span>
<span class="sd">        self.attack_attrs[&#39;original_index_map&#39;], which maps word</span>
<span class="sd">        indices from the original to perturbed text.</span>

<span class="sd">        Args:</span>
<span class="sd">          idxs: List</span>
<span class="sd">            List of indexes</span>

<span class="sd">        Returns:</span>
<span class="sd">          List of mapping of word indices from the original to perturbed text</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="s2">&quot;original_index_map&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">idxs</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idxs</span><span class="p">,</span> <span class="nb">set</span><span class="p">):</span>
            <span class="n">idxs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">idxs</span><span class="p">)</span>

        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idxs</span><span class="p">,</span> <span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;convert_from_original_idxs got invalid idxs type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">idxs</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="s2">&quot;original_index_map&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">replace_words_at_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">new_words</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This code returns a new AttackedText object where the word at</span>
<span class="sd">        index is replaced with a new word.</span>

<span class="sd">        Args:</span>
<span class="sd">          indices: List</span>
<span class="sd">            List of indexes of words in input sequence</span>
<span class="sd">          new_words: List</span>
<span class="sd">            List of words with new word as replacement for original word</span>

<span class="sd">        Returns:</span>
<span class="sd">          New AttackedText object where the word at</span>
<span class="sd">          index is replaced with a new word.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_words</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Cannot replace </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">new_words</span><span class="p">)</span><span class="si">}</span><span class="s2"> words at </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span><span class="si">}</span><span class="s2"> indices.&quot;</span>
            <span class="p">)</span>
        <span class="n">words</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">words</span><span class="p">[:]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">new_word</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">new_words</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_word</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;replace_words_at_indices requires ``str`` words, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">new_word</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot assign word at index </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">words</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_word</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_new_attacked_text</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">replace_word_at_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">new_word</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This code returns a new AttackedText object where the word at</span>
<span class="sd">        index is replaced with a new word.</span>

<span class="sd">        Args:</span>
<span class="sd">          indices: Integer</span>
<span class="sd">            Index of word</span>
<span class="sd">          new_word: String</span>
<span class="sd">            New word for replacement at index of word</span>

<span class="sd">        Returns:</span>
<span class="sd">          New AttackedText object where the word at</span>
<span class="sd">          index is replaced with a new word.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_word</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;replace_word_at_index requires ``str`` new_word, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">new_word</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">replace_words_at_indices</span><span class="p">([</span><span class="n">index</span><span class="p">],</span> <span class="p">[</span><span class="n">new_word</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">delete_word_at_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This code returns a new AttackedText object where the word at</span>
<span class="sd">        index is removed.</span>

<span class="sd">         Args:</span>
<span class="sd">          index: Integer</span>
<span class="sd">            Index of word</span>

<span class="sd">        Returns:</span>
<span class="sd">          New AttackedText object where the word at</span>
<span class="sd">          index is removed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">replace_word_at_index</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">insert_text_after_word_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Inserts a string before word at index &quot;index&quot; and attempts to add</span>
<span class="sd">        appropriate spacing.</span>

<span class="sd">        Args:</span>
<span class="sd">          index: Integer</span>
<span class="sd">            Index of word</span>
<span class="sd">          text: String</span>
<span class="sd">            Input Sequence</span>

<span class="sd">        Returns:</span>
<span class="sd">          New AttackedText object where new word is inserted</span>
<span class="sd">          before word at index &quot;index&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;text must be an str, got type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">word_at_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">words</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="n">new_text</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">word_at_index</span><span class="p">,</span> <span class="n">text</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">replace_word_at_index</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">new_text</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">insert_text_before_word_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Inserts a string before word at index &quot;index&quot; and attempts to add</span>
<span class="sd">        appropriate spacing.</span>

<span class="sd">        Args:</span>
<span class="sd">          index: Integer</span>
<span class="sd">            Index of word</span>
<span class="sd">          text: String</span>
<span class="sd">            Input Sequence</span>

<span class="sd">        Returns:</span>
<span class="sd">          New AttackedText object where the word before</span>
<span class="sd">          index &quot;index&quot; is replaced with a new word.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;text must be an str, got type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">word_at_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">words</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="c1"># TODO if ``word_at_index`` is at the beginning of a sentence, we should</span>
        <span class="c1"># optionally capitalize ``text``.</span>
        <span class="n">new_text</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">text</span><span class="p">,</span> <span class="n">word_at_index</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">replace_word_at_index</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">new_text</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_deletion_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns attack attributes based on corresponding</span>
<span class="sd">        attributes in original_index_map</span>

<span class="sd">        Args:</span>
<span class="sd">          None</span>

<span class="sd">        Returns:</span>
<span class="sd">          Attack attributes based on corresponding</span>
<span class="sd">          attributes in original_index_map</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="s2">&quot;original_index_map&quot;</span><span class="p">][</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="s2">&quot;original_index_map&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
        <span class="p">]</span>

    <span class="k">def</span> <span class="nf">generate_new_attacked_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_words</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a new AttackedText object and replaces old list of words</span>
<span class="sd">        with a new list of words, but preserves the punctuation and spacing of</span>
<span class="sd">        the original message.</span>
<span class="sd">        self.words is a list of the words in the current text with</span>
<span class="sd">        punctuation removed. However, each &quot;word&quot; in new_words could</span>
<span class="sd">        be an empty string, representing a word deletion, or a string</span>
<span class="sd">        with multiple space-separated words, representation an insertion</span>
<span class="sd">        of one or more words.</span>

<span class="sd">        Args:</span>
<span class="sd">          new_words: String</span>
<span class="sd">            New word for potential replacement</span>

<span class="sd">        Returns:</span>
<span class="sd">          TextAttack object with preturbed text and attack attributes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">perturbed_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">original_text</span> <span class="o">=</span> <span class="n">AttackedText</span><span class="o">.</span><span class="n">SPLIT_TOKEN</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text_input</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">new_attack_attrs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">&quot;label_names&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">:</span>
            <span class="n">new_attack_attrs</span><span class="p">[</span><span class="s2">&quot;label_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="s2">&quot;label_names&quot;</span><span class="p">]</span>
        <span class="n">new_attack_attrs</span><span class="p">[</span><span class="s2">&quot;newly_modified_indices&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="c1"># Point to previously monitored text.</span>
        <span class="n">new_attack_attrs</span><span class="p">[</span><span class="s2">&quot;previous_attacked_text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="c1"># Use `new_attack_attrs` to track indices with respect to the original</span>
        <span class="c1"># text.</span>
        <span class="n">new_attack_attrs</span><span class="p">[</span><span class="s2">&quot;modified_indices&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span>
            <span class="s2">&quot;modified_indices&quot;</span>
        <span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">new_attack_attrs</span><span class="p">[</span><span class="s2">&quot;original_index_map&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span>
            <span class="s2">&quot;original_index_map&quot;</span>
        <span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">new_i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># Create the new attacked text by swapping out words from the original</span>
        <span class="c1"># text with a sequence of 0+ words in the new text.</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">input_word</span><span class="p">,</span> <span class="n">adv_word_seq</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">words</span><span class="p">,</span> <span class="n">new_words</span><span class="p">)):</span>
            <span class="n">word_start</span> <span class="o">=</span> <span class="n">original_text</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">input_word</span><span class="p">)</span>
            <span class="n">word_end</span> <span class="o">=</span> <span class="n">word_start</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_word</span><span class="p">)</span>
            <span class="n">perturbed_text</span> <span class="o">+=</span> <span class="n">original_text</span><span class="p">[:</span><span class="n">word_start</span><span class="p">]</span>
            <span class="n">original_text</span> <span class="o">=</span> <span class="n">original_text</span><span class="p">[</span><span class="n">word_end</span><span class="p">:]</span>
            <span class="n">adv_words</span> <span class="o">=</span> <span class="n">words_from_text</span><span class="p">(</span><span class="n">adv_word_seq</span><span class="p">)</span>
            <span class="n">adv_num_words</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">adv_words</span><span class="p">)</span>
            <span class="n">num_words_diff</span> <span class="o">=</span> <span class="n">adv_num_words</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">words_from_text</span><span class="p">(</span><span class="n">input_word</span><span class="p">))</span>
            <span class="c1"># Track indices on insertions and deletions.</span>
            <span class="k">if</span> <span class="n">num_words_diff</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># Re-calculated modified indices. If words are inserted or deleted,</span>
                <span class="c1"># they could change.</span>
                <span class="n">shifted_modified_indices</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">modified_idx</span> <span class="ow">in</span> <span class="n">new_attack_attrs</span><span class="p">[</span><span class="s2">&quot;modified_indices&quot;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">modified_idx</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">:</span>
                        <span class="n">shifted_modified_indices</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">modified_idx</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">modified_idx</span> <span class="o">&gt;</span> <span class="n">i</span><span class="p">:</span>
                        <span class="n">shifted_modified_indices</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">modified_idx</span> <span class="o">+</span> <span class="n">num_words_diff</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">pass</span>
                <span class="n">new_attack_attrs</span><span class="p">[</span><span class="s2">&quot;modified_indices&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">shifted_modified_indices</span>
                <span class="c1"># Track insertions and deletions wrt original text.</span>
                <span class="c1"># original_modification_idx = i</span>
                <span class="n">new_idx_map</span> <span class="o">=</span> <span class="n">new_attack_attrs</span><span class="p">[</span><span class="s2">&quot;original_index_map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">num_words_diff</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="c1"># Word deletion</span>
                    <span class="n">new_idx_map</span><span class="p">[</span><span class="n">new_idx_map</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="n">new_idx_map</span><span class="p">[</span><span class="n">new_idx_map</span> <span class="o">&gt;</span> <span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">num_words_diff</span>

                <span class="k">if</span> <span class="n">num_words_diff</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">input_word</span> <span class="o">!=</span> <span class="n">adv_words</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="c1"># If insertion happens before the `input_word`</span>
                    <span class="n">new_idx_map</span><span class="p">[</span><span class="n">new_idx_map</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">num_words_diff</span>

                <span class="n">new_attack_attrs</span><span class="p">[</span><span class="s2">&quot;original_index_map&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_idx_map</span>
            <span class="c1"># Move pointer and save indices of new modified words.</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">adv_num_words</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">input_word</span> <span class="o">!=</span> <span class="n">adv_word_seq</span><span class="p">:</span>
                    <span class="n">new_attack_attrs</span><span class="p">[</span><span class="s2">&quot;modified_indices&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_i</span><span class="p">)</span>
                    <span class="n">new_attack_attrs</span><span class="p">[</span><span class="s2">&quot;newly_modified_indices&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_i</span><span class="p">)</span>
                <span class="n">new_i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="c1"># Check spaces for deleted text.</span>
            <span class="k">if</span> <span class="n">adv_num_words</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">original_text</span><span class="p">):</span>
                <span class="c1"># Remove extra space (or else there would be two spaces for each</span>
                <span class="c1"># deleted word).</span>
                <span class="c1"># @TODO What to do with punctuation in this case? This behavior is undefined.</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># If the first word was deleted, take a subsequent space.</span>
                    <span class="k">if</span> <span class="n">original_text</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot; &quot;</span><span class="p">:</span>
                        <span class="n">original_text</span> <span class="o">=</span> <span class="n">original_text</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># If a word other than the first was deleted, take a preceding space.</span>
                    <span class="k">if</span> <span class="n">perturbed_text</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot; &quot;</span><span class="p">:</span>
                        <span class="n">perturbed_text</span> <span class="o">=</span> <span class="n">perturbed_text</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="c1"># Add substitute word(s) to new sentence.</span>
            <span class="n">perturbed_text</span> <span class="o">+=</span> <span class="n">adv_word_seq</span>
        <span class="n">perturbed_text</span> <span class="o">+=</span> <span class="n">original_text</span>  <span class="c1"># Add all of the ending punctuation.</span>
        <span class="c1"># Reform perturbed_text into an OrderedDict.</span>
        <span class="n">perturbed_input_texts</span> <span class="o">=</span> <span class="n">perturbed_text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">AttackedText</span><span class="o">.</span><span class="n">SPLIT_TOKEN</span><span class="p">)</span>
        <span class="n">perturbed_input</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
            <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text_input</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">perturbed_input_texts</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">AttackedText</span><span class="p">(</span><span class="n">perturbed_input</span><span class="p">,</span> <span class="n">attack_attrs</span><span class="o">=</span><span class="n">new_attack_attrs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">words_diff_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the ratio of word differences between current text and x.</span>
<span class="sd">        Note that current text and x must have same number of words.</span>

<span class="sd">        Args:</span>
<span class="sd">          x: String</span>
<span class="sd">            Compares x with input text for ratio of word differences</span>

<span class="sd">        Returns:</span>
<span class="sd">          Ratio of word differences between current text and x.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_words</span> <span class="o">==</span> <span class="n">x</span><span class="o">.</span><span class="n">num_words</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">words</span> <span class="o">!=</span> <span class="n">x</span><span class="o">.</span><span class="n">words</span><span class="p">))</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_words</span>

    <span class="k">def</span> <span class="nf">align_with_model_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_wrapper</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Align AttackedText&#39;s words with target model&#39;s tokenization scheme</span>
<span class="sd">        (e.g. word, character, subword).</span>
<span class="sd">        Specifically, we map each word to list</span>
<span class="sd">        of indices of tokens that compose the</span>
<span class="sd">        word (e.g. embedding --&gt; [&quot;em&quot;,&quot;##bed&quot;, &quot;##ding&quot;])</span>

<span class="sd">        Args:</span>
<span class="sd">          model_wrapper: textattack.models.wrappers.ModelWrapper</span>
<span class="sd">            ModelWrapper of the target model</span>

<span class="sd">        Returns:</span>
<span class="sd">          word2token_mapping: (dict[int, list[int]])</span>
<span class="sd">            Dictionary that maps i-th word to list of indices.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tokens</span> <span class="o">=</span> <span class="n">model_wrapper</span><span class="o">.</span><span class="n">tokenize</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">tokenizer_input</span><span class="p">],</span> <span class="n">strip_prefix</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">word2token_mapping</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">last_matched</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">word</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">words</span><span class="p">):</span>
            <span class="n">matched_tokens</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">token</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="p">:]</span>
                    <span class="n">matched_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                    <span class="n">last_matched</span> <span class="o">=</span> <span class="n">j</span>
                <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">matched_tokens</span><span class="p">:</span>
                <span class="n">word2token_mapping</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">last_matched</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">word2token_mapping</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">matched_tokens</span>

        <span class="k">return</span> <span class="n">word2token_mapping</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">tokenizer_input</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The tuple of inputs to be passed to the tokenizer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">input_tuple</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text_input</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="c1"># Prefer to return a string instead of a tuple with a single value.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_tuple</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">input_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">input_tuple</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">column_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the labels for this text&#39;s columns.</span>
<span class="sd">        For single-sequence inputs, this simply returns [&#39;text&#39;].</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text_input</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">words_per_input</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of lists of words corresponding to each input.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_words_per_input</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_words_per_input</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">words_from_text</span><span class="p">(</span><span class="n">_input</span><span class="p">)</span> <span class="k">for</span> <span class="n">_input</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text_input</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_words_per_input</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">words</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_words</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_words</span> <span class="o">=</span> <span class="n">words_from_text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_words</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">text</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Represents full text input.</span>
<span class="sd">        Multiply inputs are joined with a line break.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text_input</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">num_words</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the number of words in the sequence.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">words</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">printable_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_color</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">key_color_method</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Represents full text input. Adds field descriptions.</span>

<span class="sd">        Args:</span>
<span class="sd">        key_color: String</span>
<span class="sd">          Field description of input text</span>
<span class="sd">        key_color_method: String</span>
<span class="sd">          Color method description of input text</span>

<span class="sd">        Usage/Example:</span>
<span class="sd">            entailment inputs look like:</span>
<span class="sd">            premise: ...</span>
<span class="sd">            hypothesis: ...</span>

<span class="sd">        Returns:</span>
<span class="sd">          Next iterable value for single sequence inputs</span>
<span class="sd">          Shared field attributes for multi-sequence inputs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># For single-sequence inputs, don&#39;t show a prefix.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text_input</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text_input</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
        <span class="c1"># For multiple-sequence inputs, show a prefix and a colon. Optionally,</span>
        <span class="c1"># color the key.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key_color_method</span><span class="p">:</span>

                <span class="k">def</span> <span class="nf">ck</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">textattack</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">color_text</span><span class="p">(</span>
                        <span class="n">k</span><span class="p">,</span> <span class="n">key_color</span><span class="p">,</span> <span class="n">key_color_method</span>
                    <span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="k">def</span> <span class="nf">ck</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">k</span>

            <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ck</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">capitalize</span><span class="p">())</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text_input</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;&lt;AttackedText &quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s1">&quot;&gt;&#39;</span>


<span class="k">class</span> <span class="nc">Augmenter</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class for performing data augmentation using TextAttack.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">transformation</span><span class="p">,</span>
        <span class="n">constraints</span><span class="o">=</span><span class="p">[],</span>
        <span class="n">pct_words_to_swap</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
        <span class="n">transformations_per_example</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initiates the following attributes:</span>

<span class="sd">        Args:</span>
<span class="sd">          transformation: Transformation Object</span>
<span class="sd">            The transformation that suggests new texts from an input.</span>
<span class="sd">          constraints: List</span>
<span class="sd">            Constraints that each transformation must meet</span>
<span class="sd">          pct_words_to_swap: Float [0., 1.],</span>
<span class="sd">            Percentage of words to swap per augmented example</span>
<span class="sd">          transformations_per_example: Integer</span>
<span class="sd">            Maximum number of augmentations per input</span>

<span class="sd">         Returns:</span>
<span class="sd">          None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="n">transformations_per_example</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="p">),</span> <span class="s2">&quot;transformations_per_example must be a positive integer&quot;</span>
        <span class="k">assert</span> <span class="mf">0.0</span> <span class="o">&lt;=</span> <span class="n">pct_words_to_swap</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;pct_words_to_swap must be in [0., 1.]&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transformation</span> <span class="o">=</span> <span class="n">transformation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pct_words_to_swap</span> <span class="o">=</span> <span class="n">pct_words_to_swap</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transformations_per_example</span> <span class="o">=</span> <span class="n">transformations_per_example</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">constraints</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pre_transformation_constraints</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">constraint</span> <span class="ow">in</span> <span class="n">constraints</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">constraint</span><span class="p">,</span> <span class="n">PreTransformationConstraint</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pre_transformation_constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">constraint</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">constraint</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_filter_transformations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transformed_texts</span><span class="p">,</span> <span class="n">current_text</span><span class="p">,</span> <span class="n">original_text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filters a list of AttackedText objects to include only the ones</span>
<span class="sd">        that pass self.constraints.</span>

<span class="sd">        Args:</span>
<span class="sd">          Transformed_text: List</span>
<span class="sd">            List of Strings corresponding to transformations</span>
<span class="sd">          Current_text: String</span>
<span class="sd">            String to be compared against for transformation</span>
<span class="sd">            when original does not meet constraint requirement</span>
<span class="sd">          Original_text: String</span>
<span class="sd">            Original Input String</span>

<span class="sd">        Returns:</span>
<span class="sd">          All possible transformations for a given string. Currently only</span>
<span class="sd">        supports transformations which are word swaps.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">C</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraints</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">transformed_texts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="n">C</span><span class="o">.</span><span class="n">compare_against_original</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">original_text</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Missing `original_text` argument when constraint </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="si">}</span><span class="s2"> is set to compare against &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;`original_text` &quot;</span>
                    <span class="p">)</span>

                <span class="n">transformed_texts</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">call_many</span><span class="p">(</span><span class="n">transformed_texts</span><span class="p">,</span> <span class="n">original_text</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">transformed_texts</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">call_many</span><span class="p">(</span><span class="n">transformed_texts</span><span class="p">,</span> <span class="n">current_text</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">transformed_texts</span>


    <span class="k">def</span> <span class="nf">augment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns all possible augmentations of text according to</span>
<span class="sd">        self.transformation.</span>

<span class="sd">        Args:</span>
<span class="sd">          text: String</span>
<span class="sd">            Text to be augmented via transformation</span>

<span class="sd">        Returns:</span>
<span class="sd">          Sorted list of all possible augmentations of text according to</span>
<span class="sd">          compatible self.transformation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">attacked_text</span> <span class="o">=</span> <span class="n">AttackedText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="n">original_text</span> <span class="o">=</span> <span class="n">attacked_text</span>
        <span class="n">all_transformed_texts</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">num_words_to_swap</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
            <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pct_words_to_swap</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">attacked_text</span><span class="o">.</span><span class="n">words</span><span class="p">)),</span> <span class="mi">1</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transformations_per_example</span><span class="p">):</span>
            <span class="n">current_text</span> <span class="o">=</span> <span class="n">attacked_text</span>
            <span class="n">words_swapped</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">current_text</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="s2">&quot;modified_indices&quot;</span><span class="p">])</span>

            <span class="k">while</span> <span class="n">words_swapped</span> <span class="o">&lt;</span> <span class="n">num_words_to_swap</span><span class="p">:</span>
                <span class="n">transformed_texts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformation</span><span class="p">(</span>
                    <span class="n">current_text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre_transformation_constraints</span>
                <span class="p">)</span>

                <span class="c1"># Get rid of transformations we already have</span>
                <span class="n">transformed_texts</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">transformed_texts</span> <span class="k">if</span> <span class="n">t</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_transformed_texts</span>
                <span class="p">]</span>

                <span class="c1"># Filter out transformations that don&#39;t match the constraints.</span>
                <span class="n">transformed_texts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filter_transformations</span><span class="p">(</span>
                    <span class="n">transformed_texts</span><span class="p">,</span> <span class="n">current_text</span><span class="p">,</span> <span class="n">original_text</span>
                <span class="p">)</span>

                <span class="c1"># if there&#39;s no more transformed texts after filter, terminate</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">transformed_texts</span><span class="p">):</span>
                    <span class="k">break</span>

                <span class="n">current_text</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">transformed_texts</span><span class="p">)</span>

                <span class="c1"># update words_swapped based on modified indices</span>
                <span class="n">words_swapped</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">current_text</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="s2">&quot;modified_indices&quot;</span><span class="p">]),</span>
                    <span class="n">words_swapped</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="n">all_transformed_texts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">current_text</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">at</span><span class="o">.</span><span class="n">printable_text</span><span class="p">()</span> <span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="n">all_transformed_texts</span><span class="p">])</span>


    <span class="k">def</span> <span class="nf">augment_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text_list</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns all possible augmentations of a list of strings according to</span>
<span class="sd">        self.transformation.</span>

<span class="sd">        Args:</span>
<span class="sd">          text_list: List of strings</span>
<span class="sd">            A list of strings for data augmentation</span>
<span class="sd">          show_progress: Boolean</span>
<span class="sd">            A variable that controls visibility of Augmentation progress</span>

<span class="sd">        Returns:</span>
<span class="sd">          A list(string) of augmented texts.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">show_progress</span><span class="p">:</span>
            <span class="n">text_list</span> <span class="o">=</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="n">text_list</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Augmenting data...&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">text_list</span><span class="p">]</span>


    <span class="k">def</span> <span class="nf">augment_text_with_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text_list</span><span class="p">,</span> <span class="n">id_list</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Supplements a list of text with more text data.</span>

<span class="sd">         Args:</span>
<span class="sd">          text_list: List of strings</span>
<span class="sd">            A list of strings for data augmentation</span>
<span class="sd">          id_list: List of indexes</span>
<span class="sd">            A list of indexes for corresponding strings</span>
<span class="sd">          show_progress: Boolean</span>
<span class="sd">            A variable that controls visibility of augmentation progress</span>

<span class="sd">        Returns:</span>
<span class="sd">          all_text_list, all_id_list: List, List</span>
<span class="sd">            The augmented text along with the corresponding IDs for</span>
<span class="sd">            each augmented example.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">text_list</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">id_list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;List of text must be same length as list of IDs&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformations_per_example</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">text_list</span><span class="p">,</span> <span class="n">id_list</span>
        <span class="n">all_text_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">all_id_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">show_progress</span><span class="p">:</span>
            <span class="n">text_list</span> <span class="o">=</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="n">text_list</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Augmenting data...&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">text</span><span class="p">,</span> <span class="n">_id</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">text_list</span><span class="p">,</span> <span class="n">id_list</span><span class="p">):</span>
            <span class="n">all_text_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
            <span class="n">all_id_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_id</span><span class="p">)</span>
            <span class="n">augmented_texts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
            <span class="n">all_text_list</span><span class="o">.</span><span class="n">extend</span>
            <span class="n">all_text_list</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">text</span><span class="p">]</span> <span class="o">+</span> <span class="n">augmented_texts</span><span class="p">)</span>
            <span class="n">all_id_list</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">_id</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">augmented_texts</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">all_text_list</span><span class="p">,</span> <span class="n">all_id_list</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">main_str</span> <span class="o">=</span> <span class="s2">&quot;Augmenter&quot;</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># self.transformation</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">add_indent</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(transformation):  </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">transformation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="c1"># self.constraints</span>
        <span class="n">constraints_lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">constraints</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraints</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre_transformation_constraints</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">constraints</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">constraint</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">constraints</span><span class="p">):</span>
                <span class="n">constraints_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">add_indent</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">constraint</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
            <span class="n">constraints_str</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">add_indent</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">constraints_lines</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">constraints_str</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">add_indent</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(constraints): </span><span class="si">{</span><span class="n">constraints_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">main_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">main_str</span> <span class="o">+=</span> <span class="s2">&quot;)&quot;</span>
        <span class="k">return</span> <span class="n">main_str</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="bonus-3-2-augment-the-original-review">
<h3>Bonus 3.2: Augment the original review<a class="headerlink" href="#bonus-3-2-augment-the-original-review" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Bonus 3.2: Augment the original review</span>

<span class="c1"># @markdown ---</span>
<span class="c1"># @markdown Word-level Augmentations</span>
<span class="n">word_swap_contract</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># @param {type:&quot;boolean&quot;}</span>
<span class="n">word_swap_extend</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># @param {type:&quot;boolean&quot;}</span>
<span class="n">word_swap_homoglyph_swap</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># @param {type:&quot;boolean&quot;}</span>

<span class="c1"># @markdown ---</span>
<span class="c1"># @markdown Character-level Augmentations</span>
<span class="n">word_swap_neighboring_character_swap</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># @param {type:&quot;boolean&quot;}</span>
<span class="n">word_swap_qwerty</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># @param {type:&quot;boolean&quot;}</span>
<span class="n">word_swap_random_character_deletion</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># @param {type:&quot;boolean&quot;}</span>
<span class="n">word_swap_random_character_insertion</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># @param {type:&quot;boolean&quot;}</span>
<span class="n">word_swap_random_character_substitution</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># @param {type:&quot;boolean&quot;}</span>
<span class="c1"># @markdown ---</span>

<span class="c1"># @markdown Check all the augmentations that you wish to apply!</span>

<span class="c1"># @markdown **NOTE:** *Try applying each augmentation individually, and observe the changes.*</span>

<span class="c1"># Apply augmentations</span>
<span class="n">augmentations</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">if</span> <span class="n">word_swap_contract</span><span class="p">:</span>
  <span class="n">augmentations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WordSwapContract</span><span class="p">())</span>
<span class="k">if</span> <span class="n">word_swap_extend</span><span class="p">:</span>
  <span class="n">augmentations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WordSwapExtend</span><span class="p">())</span>
<span class="k">if</span> <span class="n">word_swap_homoglyph_swap</span><span class="p">:</span>
  <span class="n">augmentations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WordSwapHomoglyphSwap</span><span class="p">())</span>
<span class="k">if</span> <span class="n">word_swap_neighboring_character_swap</span><span class="p">:</span>
  <span class="n">augmentations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WordSwapNeighboringCharacterSwap</span><span class="p">())</span>
<span class="k">if</span> <span class="n">word_swap_qwerty</span><span class="p">:</span>
  <span class="n">augmentations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WordSwapQWERTY</span><span class="p">())</span>
<span class="k">if</span> <span class="n">word_swap_random_character_deletion</span><span class="p">:</span>
  <span class="n">augmentations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WordSwapRandomCharacterDeletion</span><span class="p">())</span>
<span class="k">if</span> <span class="n">word_swap_random_character_insertion</span><span class="p">:</span>
  <span class="n">augmentations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WordSwapRandomCharacterInsertion</span><span class="p">())</span>
<span class="k">if</span> <span class="n">word_swap_random_character_substitution</span><span class="p">:</span>
  <span class="n">augmentations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WordSwapRandomCharacterSubstitution</span><span class="p">())</span>

<span class="n">transformation</span> <span class="o">=</span> <span class="n">CompositeTransformation</span><span class="p">(</span><span class="n">augmentations</span><span class="p">)</span>
<span class="n">augmenter</span> <span class="o">=</span> <span class="n">Augmenter</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="n">transformation</span><span class="p">,</span>
                      <span class="n">transformations_per_example</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">augmented_review</span> <span class="o">=</span> <span class="n">clean_text</span><span class="p">(</span><span class="n">augmenter</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">context</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Augmented review:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">augmented_review</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Augmented review:

(&#39;You only need to know three words walking into TEXAZ Girll: chicken fried &#39;
 &quot;steak. It&#39;s a huge monster, with a cirspy double dipped batter layer &quot;
 &#39;encasing a beautiful tenderized steak, smothered with a beautiful white &#39;
 &#39;gravy. Without a doubt TEXAZ Grlil has the best cihcken fried steak in the &#39;
 &#39;Phoenix area, perhaps even Arizona!  Portions are huge too! The dinner &#39;
 &#39;portino actually gives you two steaks while the lunch portion gives you one. &#39;
 &#39;The coleslwa and mashed potatoes on the side were huge as ewll.  The &#39;
 &#39;retsaurant is a bit small and hte parking lot a bit smaller, but the &#39;
 &#39;interior is definitely cozy and the staff is very friendly. tI really makes &#39;
 &#39;the meal worth it on top of the kick*** CFS. You NEED to try this out!&#39;)
</pre></div>
</div>
</div>
</div>
<p>We can now check the predictions for the original text and its augmented version! Try to find the perfect combination of perturbations to break the model, i.e., model giving incorrect prediction for the augmented text.</p>
</div>
<div class="section" id="bonus-3-3-check-model-predictions">
<h3>Bonus 3.3: Check model predictions<a class="headerlink" href="#bonus-3-3-check-model-predictions" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Bonus 3.3: Check model predictions</span>
<span class="k">def</span> <span class="nf">getPrediction</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Outputs model prediction based on the input text.</span>

<span class="sd">  Args:</span>
<span class="sd">    text: String</span>
<span class="sd">      Input text</span>

<span class="sd">  Returns:</span>
<span class="sd">    item of pred: Iterable</span>
<span class="sd">      Prediction on the input text</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">inputs</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;max_length&quot;</span><span class="p">,</span>
                     <span class="n">truncation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_tensors</span><span class="o">=</span><span class="s2">&quot;pt&quot;</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">inputs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">inputs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

  <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">inputs</span><span class="p">)</span>
  <span class="n">logits</span> <span class="o">=</span> <span class="n">outputs</span><span class="o">.</span><span class="n">logits</span>
  <span class="n">pred</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">pred</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;original Review:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Predicted Sentiment =&quot;</span><span class="p">,</span> <span class="n">getPrediction</span><span class="p">(</span><span class="n">context</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;########################################&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Augmented Review:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">augmented_review</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Predicted Sentiment =&quot;</span><span class="p">,</span> <span class="n">getPrediction</span><span class="p">(</span><span class="n">augmented_review</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;########################################&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>original Review:

(&#39;You only need to know three words walking into TEXAZ Grill: chicken fried &#39;
 &quot;steak. It&#39;s a huge monster, with a crispy double dipped batter layer &quot;
 &#39;encasing a beautiful tenderized steak, smothered with a beautiful white &#39;
 &#39;gravy. Without a doubt TEXAZ Grill has the best chicken fried steak in the &#39;
 &#39;Phoenix area, perhaps even Arizona!  Portions are huge too! The dinner &#39;
 &#39;portion actually gives you two steaks while the lunch portion gives you one. &#39;
 &#39;The coleslaw and mashed potatoes on the side were huge as well.  The &#39;
 &#39;restaurant is a bit small and the parking lot a bit smaller, but the &#39;
 &#39;interior is definitely cozy and the staff is very friendly. It really makes &#39;
 &#39;the meal worth it on top of the kick*** CFS. You NEED to try this out!&#39;)

Predicted Sentiment = 4
########################################

Augmented Review:

(&#39;You only need to know three words walking into TEXAZ Girll: chicken fried &#39;
 &quot;steak. It&#39;s a huge monster, with a cirspy double dipped batter layer &quot;
 &#39;encasing a beautiful tenderized steak, smothered with a beautiful white &#39;
 &#39;gravy. Without a doubt TEXAZ Grlil has the best cihcken fried steak in the &#39;
 &#39;Phoenix area, perhaps even Arizona!  Portions are huge too! The dinner &#39;
 &#39;portino actually gives you two steaks while the lunch portion gives you one. &#39;
 &#39;The coleslwa and mashed potatoes on the side were huge as ewll.  The &#39;
 &#39;retsaurant is a bit small and hte parking lot a bit smaller, but the &#39;
 &#39;interior is definitely cozy and the staff is very friendly. tI really makes &#39;
 &#39;the meal worth it on top of the kick*** CFS. You NEED to try this out!&#39;)

Predicted Sentiment = 4
########################################
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id4">
<h3>Submit your feedback<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Textattack_module_Interactive_Demos&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "796d8a64a75c4468b5385a19545e2848", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"00109c484fc94c67b39f8c0bca8bc763": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "TextareaModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "TextareaModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "TextareaView", "continuous_update": true, "description": "", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_634491ec681642e2a1873676cfbab461", "placeholder": "We want your feedback!", "rows": null, "style": "IPY_MODEL_200002de93d345e780afbc55132f0a51", "value": ""}}, "003e3cd390d344c1b406e15d6b0cf24e": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": "hidden", "width": null}}, "01597bb9763b47d58753295384b40a59": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0385a00fb89346a59eeffcee7a905173": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": ["happy"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude42", "disabled": false, "icon": "", "layout": "IPY_MODEL_a4bc8440f5b4461895e7555693fa5fce", "style": "IPY_MODEL_da8b7fd0e23c46ad9e566b1f6560983a", "tooltip": "Happy"}}, "05251ba55a834c4b819519ef6aee29a9": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_5821ed5202e74e3d879d568bbd95f089", "IPY_MODEL_97be477032f4443c95c8146ad89bde9c", "IPY_MODEL_078850e1070c4e28b2714391d66fc916"], "layout": "IPY_MODEL_0703693d721a438faadcef384ef03878"}}, "0703693d721a438faadcef384ef03878": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": "hidden", "width": null}}, "078850e1070c4e28b2714391d66fc916": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_2aaa89a1e5c34664a0b325e7dfcc7982", "placeholder": "\u200b", "style": "IPY_MODEL_1826ab5feb344dffa064bfd3af5bae86", "value": " 612000/650000 [00:01&lt;00:00, 443414.12 examples/s]"}}, "07fbbfde29254c8ca0dc81953e714291": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "0969934dbbf140c8bd699acc4d11db0f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#dddd77", "font_weight": ""}}, "0a30133c25a34611932fc4c4f2763006": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#ffaaaa", "font_weight": ""}}, "0b44be86ba5e42eb855800dec2a18279": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0b694cb04075439dab82fd04261735ec": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "LabelModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "LabelView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_cf7511dbe0cd4d518d5d5b777edf33f5", "placeholder": "\u200b", "style": "IPY_MODEL_94728122e7db4300b035a01a59e47341", "value": "Thanks for your feedback!"}}, "0c12ef1d95674e1594b87c04433f6b8e": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "LabelModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "LabelView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_959d43b7115747e581b35a7c86f2aa85", "placeholder": "\u200b", "style": "IPY_MODEL_7145c6fe139e4e91b4b43e8ef03f35c4", "value": ""}}, "0c328e580586427db5f47e4aa11c08b9": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0c664c3dd2bd4e489096721cc438cfd1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "0ceb6a70e8fd4579bf59ad5eb3300e6a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_9a30c680be4147138ddc011f5d072096", "max": 650000.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_f6e6d1aebf584120b4a2249025326af7", "value": 650000.0}}, "0d77dba3d29e4fe890d7297573197eec": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "TextareaModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "TextareaModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "TextareaView", "continuous_update": true, "description": "", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_31de9cbb452048bb880d09c25df009cb", "placeholder": "We want your feedback!", "rows": null, "style": "IPY_MODEL_ed7ce88b1d2a455f9ba4ffc78503dc88", "value": ""}}, "11b4f5ff0efc4a0abb434c415c38e478": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "11e61186c6e940c5873ad957106e7221": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "123964321765443db6138e1e9193df45": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "LabelModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "LabelView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_264745bfc499433dba2269264cfbe35c", "placeholder": "\u200b", "style": "IPY_MODEL_fd615be8d4a14a64b2930c0f15a87713", "value": ""}}, "13821a1f79a843af9b5c47348cf6d4db": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "13e87bda78a34246b30a6fd7caffb7d2": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "148b931f945049c586c99077ed3ae923": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_0385a00fb89346a59eeffcee7a905173", "IPY_MODEL_c4c1ceb2768a4b1e9e47c92a79901e0f", "IPY_MODEL_96c990533be645ca9c0d14e74070b98a"], "layout": "IPY_MODEL_6380e54a6fc34c6f8d62407a17b75413"}}, "150c1ea60f1345d184cc65cd181ef5ba": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_3d0482cc83e3427aaca8f632fe168de9", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "Video available at https://youtube.com/watch?v=hJdV2L2t4-c\n"}, {"data": {"image/jpeg": "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\n", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://www.youtube.com/embed/hJdV2L2t4-c?fs=1&rel=0\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ", "text/plain": "<IPython.lib.display.YouTubeVideo at 0x7ff104f13490>"}, "metadata": {}, "output_type": "display_data"}]}}, "15c388e840b948b4a06dcb9da9d53a23": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1632794b4e0c4884976d45a6be1b601b": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "16a44d2bb19f46789681a3c8d462c3e8": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "180f7af24c9d4a898fd7e7cb1fa9b401": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "1826ab5feb344dffa064bfd3af5bae86": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "1914d14590754bccb003cfa4bec4b0f6": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "19277c66bc8941ef8f7216cc24d1401e": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "TextareaModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "TextareaModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "TextareaView", "continuous_update": true, "description": "", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_11e61186c6e940c5873ad957106e7221", "placeholder": "We want your feedback!", "rows": null, "style": "IPY_MODEL_1f48c6ad76ca47bba26fe8e3b2831454", "value": ""}}, "19b499fc706e4b1faa6a64c9861de0f6": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_19277c66bc8941ef8f7216cc24d1401e", "IPY_MODEL_82eed001a9ad475188eec140de092388"], "layout": "IPY_MODEL_f9c8d8440d55420680a0e326b3d02a79"}}, "19ca5517c557455098154361f4331717": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1a2e3a57524a4dcf95eab4c08507d200": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "1a379cd5146b47c5a6f9c84f50694ab3": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "LabelModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "LabelView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_7b6e59a365f74b7695c641465cc5469a", "placeholder": "\u200b", "style": "IPY_MODEL_77128e459b98483bb3ded737c60661e2", "value": "Thanks for your feedback!"}}, "1a9f0dcf33d1401a9aa43835853e4b32": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": ["sad"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude41", "disabled": false, "icon": "", "layout": "IPY_MODEL_a619e77e8e3246b5a082fcf507f654c0", "style": "IPY_MODEL_5a4ffa85a7c746c2b5523263718bd5f7", "tooltip": "Sad"}}, "1b90cb96efef4c9581710fe294985ccd": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1c731dae03f043ccaf03a2559e829353": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "1d04eb5abf964ff484e3b506abd3062f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "1d11f61fcb9247178deb0e00b451806a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "1e4eaebf2f3242f38418f52f6c9d47c8": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1f48c6ad76ca47bba26fe8e3b2831454": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "1fad519856f5473db13f2a9c732e6dad": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_a164c0d63543465bb29338877256ba37", "placeholder": "\u200b", "style": "IPY_MODEL_ace30d35f6c9463186d57949df1afb22", "value": " 570/570 [00:00&lt;00:00, 111kB/s]"}}, "200002de93d345e780afbc55132f0a51": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "21ccf939c11d4ec791e41650570e9aaa": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2432caf0395149e7960e8c0ae6b6115e": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_598d6ee5e0774933b24b67f75749ad8c", "max": 570.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_680cbd39219f4af9aa470b68872fd1b6", "value": 570.0}}, "264745bfc499433dba2269264cfbe35c": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "26f338a2b41c4adeb1ceca47b90af0ad": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "28acaa7766fa45b4858ceac880de039e": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2916fc086eb94999a802338b573a80cc": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_0d77dba3d29e4fe890d7297573197eec", "IPY_MODEL_3a17c559db4941e1bc8cf47d1e8d9554"], "layout": "IPY_MODEL_c7fe42173a4c4e4c80d47b8dacc8f6e4"}}, "2a9fcd749f344860b357dc67b9e48734": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": "hidden", "width": null}}, "2aaa89a1e5c34664a0b325e7dfcc7982": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2b5195de000f44048601615143db16a0": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2e9bdaf414994739bb9809455ff3c9e8": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3062ae9562e14f429e8502dd808095a8": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "LabelModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "LabelView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_7dec8b94dd364bf2bca5fa7cfba5c0a5", "placeholder": "\u200b", "style": "IPY_MODEL_d50a596747eb4ca9a4f46ee397b937f5", "value": ""}}, "306e5c4920bf4bc6a2aa87103e24050d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_ae1815d46de94dedb801da389cab8cc1", "IPY_MODEL_95122b3a4b3246f69c596f24d5fdc9cc", "IPY_MODEL_1a9f0dcf33d1401a9aa43835853e4b32"], "layout": "IPY_MODEL_e9f6f5d549c44667b588fe81baca23de"}}, "31de9cbb452048bb880d09c25df009cb": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "326a018d3de04196a093a6c670dc437b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": ["sad"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude41", "disabled": false, "icon": "", "layout": "IPY_MODEL_c7d15ff49a7641c9a4e7aefbcc094812", "style": "IPY_MODEL_933b8234842741ab9cca4ddcb3b4353e", "tooltip": "Sad"}}, "32d0a74686e04e8ba7fde824db89c243": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "336f258a9b9542728cf5c4bbcdf8a577": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "33de8ebc174b4df09e69c2d909122e25": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "34e9c1a0d87a41b69842ee7007ae6531": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "VBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_123964321765443db6138e1e9193df45", "IPY_MODEL_306e5c4920bf4bc6a2aa87103e24050d", "IPY_MODEL_2916fc086eb94999a802338b573a80cc", "IPY_MODEL_0b694cb04075439dab82fd04261735ec"], "layout": "IPY_MODEL_28acaa7766fa45b4858ceac880de039e"}}, "3669ae77eb2f4ae6bc352c9640e68b21": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "379a151ae4ac47f69db01c3ee714f916": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_00109c484fc94c67b39f8c0bca8bc763", "IPY_MODEL_897f673f3746488da43a5f1a60f99e0c"], "layout": "IPY_MODEL_9a860566476648a3bf87a7046af3ce85"}}, "39973ca45a36412e81238a62e49688a8": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#aaffaa", "font_weight": ""}}, "39ba597f66cd425490e95d273fba836c": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3a17c559db4941e1bc8cf47d1e8d9554": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Submit", "disabled": false, "icon": "", "layout": "IPY_MODEL_c9a181c04c08464eb5059c9a6fb94084", "style": "IPY_MODEL_13821a1f79a843af9b5c47348cf6d4db", "tooltip": ""}}, "3aa00da2ecae4461b9e4b9e36a981ed8": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3c71ac727a42454b80532b9631dddc0f": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3d0482cc83e3427aaca8f632fe168de9": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3eb0895524fc4e3688bb1e2eec1e0890": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_85859fd0668343ef99eb6899652b3901", "max": 650000.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_fe679afd28b34cc299b4be146498eedb", "value": 650000.0}}, "3ed9ab9e34ae4a6f91d8db46ece0efeb": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_de56a66af8284ce981a4c1af1b9fe5b3", "placeholder": "\u200b", "style": "IPY_MODEL_9a08894b64784a4ea08dddd1925f87a6", "value": " 2/2 [00:00&lt;00:00, 224.29it/s]"}}, "3fbe54cafe1448358b9b21236c06be5d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "40806891b4a44e4e88d0b1621afda0c0": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": ["medium"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude10", "disabled": false, "icon": "", "layout": "IPY_MODEL_1632794b4e0c4884976d45a6be1b601b", "style": "IPY_MODEL_6d1f1ebd7eef425790ec2bad6e3173b6", "tooltip": "Medium"}}, "42204ad2935b43bfad79fab9fcab1147": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "42f61fe9bce14ed3a2d765aba650b7ef": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "443bf5682a9a4d5cb5b5bef3da11a7ef": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "4441189b7bb54e8287631ac7f2976471": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_4e7af5ba105740d783710461280d53f5", "IPY_MODEL_78be23d190eb42c69218b2f20306adf8", "IPY_MODEL_3ed9ab9e34ae4a6f91d8db46ece0efeb"], "layout": "IPY_MODEL_a59bbdb7c7c4464b9c42ef129c86f443"}}, "4493ba1886ff489fa5a9218d10a85ce4": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "44c2f7a7421e4234b25602d54c2e38a5": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "45ecb30e969048d4a6514b5808c8fde3": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "47e7891378a04cf8b926b986ea15ba90": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": ["medium"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude10", "disabled": false, "icon": "", "layout": "IPY_MODEL_1a2e3a57524a4dcf95eab4c08507d200", "style": "IPY_MODEL_5dc9ffdaa58f4256a0e5737ae41ecda4", "tooltip": "Medium"}}, "48e7d5c0582a4c5c8047620f1911e14f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": ["happy"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude42", "disabled": false, "icon": "", "layout": "IPY_MODEL_b08fda478fc447648b59b7f5df67f0b9", "style": "IPY_MODEL_a8cd4574203c4a2cb01218e3b4797e5b", "tooltip": "Happy"}}, "4b3a5885e38f47278d03f365be5f4aa7": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_9822fcc9f45747d5b4f8b056066a5452", "IPY_MODEL_47e7891378a04cf8b926b986ea15ba90", "IPY_MODEL_326a018d3de04196a093a6c670dc437b"], "layout": "IPY_MODEL_2e9bdaf414994739bb9809455ff3c9e8"}}, "4d45a86068e844a6a85cae564a29c461": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "VBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_0c12ef1d95674e1594b87c04433f6b8e", "IPY_MODEL_6e97de470205483bb33bd1a3a9847f88", "IPY_MODEL_a0dc2d699cfd41b68e7e937d69ff6010", "IPY_MODEL_ab83eeecc54040ecb2908a34bdf5e363"], "layout": "IPY_MODEL_728a76695e204024ac0adfdf8633c357"}}, "4d932b6797af480788019aa0fcd8ea47": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "TextareaModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "TextareaModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "TextareaView", "continuous_update": true, "description": "", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_c67c36e3cf654ea2a52fc21fa79a30a9", "placeholder": "We want your feedback!", "rows": null, "style": "IPY_MODEL_68493526d7e6484fb4db33505d6d2552", "value": ""}}, "4db4a8774ed644eaa0053e3edda9f6c5": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "4e7af5ba105740d783710461280d53f5": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_84a1ef701fce4cca9670bc52ac6fee93", "placeholder": "\u200b", "style": "IPY_MODEL_07fbbfde29254c8ca0dc81953e714291", "value": "100%"}}, "4ee8065ba1d24a26b7f4934863bb8db8": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": "hidden", "width": null}}, "4f8632bdbc484e9abcaeb6fe50fd23e4": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "54828cb8f19940ffbed733803b68f2dd": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_e0dd14947adc4efda020677be2f9b25f", "placeholder": "\u200b", "style": "IPY_MODEL_45ecb30e969048d4a6514b5808c8fde3", "value": " 650000/650000 [02:08&lt;00:00, 5194.25 examples/s]"}}, "55c9af95f06b4cf0bdbd34037e2d813f": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "57bbb1980faa46289f92decaf0e2a3bc": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "5821ed5202e74e3d879d568bbd95f089": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_c0e871cf0fd048ee8408fa19eb40337c", "placeholder": "\u200b", "style": "IPY_MODEL_d8d75b60e6404fab84bd17ea61553dc6", "value": "Filter:  94%"}}, "598d6ee5e0774933b24b67f75749ad8c": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "599bc84ef12541bbbd4409a97c644d74": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5a4ffa85a7c746c2b5523263718bd5f7": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#ffaaaa", "font_weight": ""}}, "5d0bb0b903444f8b8c3add91c7ee6ec2": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5dc9ffdaa58f4256a0e5737ae41ecda4": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#dddd77", "font_weight": ""}}, "5f301e26d2744057a0aa6543583e6d20": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "621fe807a1ed4a8bb9926e21e0126ecf": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "634491ec681642e2a1873676cfbab461": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "6380e54a6fc34c6f8d62407a17b75413": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "63ec806210804d9ba9aa78284052d23c": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "64d6fb60800043e88e51b845d2ab0fff": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "65c55358d90c4863b1f7a0ab27cf97a9": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "65e0f77d3117467990498e6bbf6848b9": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#ffaaaa", "font_weight": ""}}, "66d0c1557ccd4dfb986c9ae017476725": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "671e58b1ea714cefb919e96c98ff2684": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "680cbd39219f4af9aa470b68872fd1b6": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "68493526d7e6484fb4db33505d6d2552": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "6a6a28ede1414bb9908f86378fd7560e": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "6bf066a9d5ab45d89ded27579dc67fba": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "6d1f1ebd7eef425790ec2bad6e3173b6": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#dddd77", "font_weight": ""}}, "6e8d7519d4124ba0b03582a8f1f0192f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "LabelModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "LabelView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_42204ad2935b43bfad79fab9fcab1147", "placeholder": "\u200b", "style": "IPY_MODEL_11b4f5ff0efc4a0abb434c415c38e478", "value": "Thanks for your feedback!"}}, "6e97de470205483bb33bd1a3a9847f88": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_48e7d5c0582a4c5c8047620f1911e14f", "IPY_MODEL_b01c99382ecb4c97bae2411f790bb0b4", "IPY_MODEL_ae777cd371e94328861b3f9a8570c63b"], "layout": "IPY_MODEL_15c388e840b948b4a06dcb9da9d53a23"}}, "70d0a98cd7f14aa7a5196514b7522813": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "7145c6fe139e4e91b4b43e8ef03f35c4": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "728a76695e204024ac0adfdf8633c357": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "764dc28dddb349dcb77acf81a9560a06": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_e9492ff1ea684a468f362a3c68cf492d", "placeholder": "\u200b", "style": "IPY_MODEL_b6aff63d721243ac90a26338d41632b8", "value": "Downloading model.safetensors: 100%"}}, "77128e459b98483bb3ded737c60661e2": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "777891abfd3248b88d887af808e5a6dd": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "78be23d190eb42c69218b2f20306adf8": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_621fe807a1ed4a8bb9926e21e0126ecf", "max": 2.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_3fbe54cafe1448358b9b21236c06be5d", "value": 2.0}}, "79213de3579e4a0bb8d2ca71a05318df": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "796d8a64a75c4468b5385a19545e2848": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "VBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_b8c3b97b019b444297eebff1a6fcf356", "IPY_MODEL_fbdd243f227b49d5bb7079b197375c5d", "IPY_MODEL_b12ce737a9e1478897df790e5faef657", "IPY_MODEL_b10de779a4974b4db7688cb01afa89dd"], "layout": "IPY_MODEL_ef2b2a2df672412890506d34b6e17d8f"}}, "79c7ddd96a034c6faa6a9fb80ef3fa3d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_9d23e42b267e41d684cedd2d21c7b689", "placeholder": "\u200b", "style": "IPY_MODEL_a38c6f2f96934f9c8a09c2f08423d630", "value": " 638000/650000 [00:01&lt;00:00, 442877.35 examples/s]"}}, "7b1d11ffa7d548e29631f7413edb49fa": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "7b6e59a365f74b7695c641465cc5469a": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "7bef56eea0d4473b8e6134f8278a4fe8": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": "hidden", "width": null}}, "7dec8b94dd364bf2bca5fa7cfba5c0a5": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "7e51379bf2ee4f1496b7bf3126d86af0": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Submit", "disabled": false, "icon": "", "layout": "IPY_MODEL_57bbb1980faa46289f92decaf0e2a3bc", "style": "IPY_MODEL_d2f2c27fb78643ada291308b9fbfa78c", "tooltip": ""}}, "7f60a96ea73544efa76edb7d133d1b94": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "80ce865432a340288152c677022be992": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_64d6fb60800043e88e51b845d2ab0fff", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "Video available at https://www.bilibili.com/video/BV1CU4y1n7bV\n"}, {"data": {"text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://player.bilibili.com/player.html?bvid=BV1CU4y1n7bV&page=1?fs=1&autoplay=False\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ", "text/plain": "<__main__.PlayVideo at 0x7ff15ed73a00>"}, "metadata": {}, "output_type": "display_data"}]}}, "81fbd5116a2e4e5e90a6a06e21edee68": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": ["sad"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude41", "disabled": false, "icon": "", "layout": "IPY_MODEL_336f258a9b9542728cf5c4bbcdf8a577", "style": "IPY_MODEL_cdc160e02ec34806bda13e76d4b7c005", "tooltip": "Sad"}}, "82b4cd9075c24eb99b112360e3fed33a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "TextareaModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "TextareaModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "TextareaView", "continuous_update": true, "description": "", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_79213de3579e4a0bb8d2ca71a05318df", "placeholder": "We want your feedback!", "rows": null, "style": "IPY_MODEL_de28e157918549249aff50e8979c8eac", "value": ""}}, "82eed001a9ad475188eec140de092388": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Submit", "disabled": false, "icon": "", "layout": "IPY_MODEL_d98fa07c9e7044488e823e14c172e698", "style": "IPY_MODEL_66d0c1557ccd4dfb986c9ae017476725", "tooltip": ""}}, "82f11ddff2544c6692ecf8310d36513a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_dbf778b7f2e94ba3b692d95641dbec2c", "IPY_MODEL_9f3c871064ba477a8f3e980d49eedd6d", "IPY_MODEL_54828cb8f19940ffbed733803b68f2dd"], "layout": "IPY_MODEL_003e3cd390d344c1b406e15d6b0cf24e"}}, "831116a388a645978c4b5a0eee870117": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "84a1ef701fce4cca9670bc52ac6fee93": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "84e1e1547802475d841dab22fc1ca918": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_26f338a2b41c4adeb1ceca47b90af0ad", "placeholder": "\u200b", "style": "IPY_MODEL_443bf5682a9a4d5cb5b5bef3da11a7ef", "value": "Filter:  98%"}}, "85859fd0668343ef99eb6899652b3901": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "858a47e3f7ce4af0931f060099b3a406": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_3c71ac727a42454b80532b9631dddc0f", "placeholder": "\u200b", "style": "IPY_MODEL_ec7a68c335c34bf6981ff4d9525da93f", "value": "Filter: 100%"}}, "861172acc26940e2885f63284d2042f6": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "872de62de73e43d68e859af0d4935147": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "87f921c0c1cd4e4ca7b13dab9d121be1": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "88627aac8966432b9ae909fd894267e1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#dddd77", "font_weight": ""}}, "897f673f3746488da43a5f1a60f99e0c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Submit", "disabled": false, "icon": "", "layout": "IPY_MODEL_4db4a8774ed644eaa0053e3edda9f6c5", "style": "IPY_MODEL_fff512a4ea4240af952ce16cce906d18", "tooltip": ""}}, "89eebc589e5d4dafbb583e53723973c3": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8aa291b2f5ef443aafb7c5e02334c6da": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_21ccf939c11d4ec791e41650570e9aaa", "placeholder": "\u200b", "style": "IPY_MODEL_ac88568cfaae4513803f8d720c9c32c5", "value": " 626000/650000 [00:01&lt;00:00, 429474.51 examples/s]"}}, "8e672f0fe443426bb460e8d5170dc915": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8ed4af4a609e4521b227d760ca4e7e6f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "TabModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "TabModel", "_titles": {"0": "Youtube", "1": "Bilibili"}, "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "TabView", "box_style": "", "children": ["IPY_MODEL_cd1da46816714e15a5a51156de19c8c6", "IPY_MODEL_80ce865432a340288152c677022be992"], "layout": "IPY_MODEL_958b6a5f468f4e27a7a1fa3d89ef6b5c", "selected_index": 0}}, "8f12f3bda7f4470888a8842ae56c7bfc": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#aaffaa", "font_weight": ""}}, "8fc840af07f342a79ac8994296f0dfa0": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "916678773fbb4eefbf397a411bb11b3e": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "924a4a6e50e2473d97053106f397bd26": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "TabModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "TabModel", "_titles": {"0": "Youtube", "1": "Bilibili"}, "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "TabView", "box_style": "", "children": ["IPY_MODEL_150c1ea60f1345d184cc65cd181ef5ba", "IPY_MODEL_f9f01f6181674659aa45113f959f8350"], "layout": "IPY_MODEL_39ba597f66cd425490e95d273fba836c", "selected_index": 0}}, "933b8234842741ab9cca4ddcb3b4353e": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#ffaaaa", "font_weight": ""}}, "93cb6ea4f9994fbab3f13200e675faf6": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_e42a35b20a7a4fca8966fae85c14be23", "placeholder": "\u200b", "style": "IPY_MODEL_96459e9745524ba8a42eb46c9ca3e2ec", "value": " 50000/50000 [00:09&lt;00:00, 5081.39 examples/s]"}}, "94728122e7db4300b035a01a59e47341": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "95122b3a4b3246f69c596f24d5fdc9cc": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": ["medium"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude10", "disabled": false, "icon": "", "layout": "IPY_MODEL_55c9af95f06b4cf0bdbd34037e2d813f", "style": "IPY_MODEL_0969934dbbf140c8bd699acc4d11db0f", "tooltip": "Medium"}}, "956bd19c5b844590a02f02997e5614ef": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "958b6a5f468f4e27a7a1fa3d89ef6b5c": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "959d43b7115747e581b35a7c86f2aa85": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "96459e9745524ba8a42eb46c9ca3e2ec": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "96c990533be645ca9c0d14e74070b98a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": ["sad"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude41", "disabled": false, "icon": "", "layout": "IPY_MODEL_65c55358d90c4863b1f7a0ab27cf97a9", "style": "IPY_MODEL_65e0f77d3117467990498e6bbf6848b9", "tooltip": "Sad"}}, "97be477032f4443c95c8146ad89bde9c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_599bc84ef12541bbbd4409a97c644d74", "max": 650000.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_c1c6f3768afb4482b86f76249aded47d", "value": 650000.0}}, "9822fcc9f45747d5b4f8b056066a5452": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": ["happy"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude42", "disabled": false, "icon": "", "layout": "IPY_MODEL_fdc69d12d5334e8cb231a1081dcfcafc", "style": "IPY_MODEL_8f12f3bda7f4470888a8842ae56c7bfc", "tooltip": "Happy"}}, "994f53680f2847bcb96df3d9e18cad06": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": ["happy"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude42", "disabled": false, "icon": "", "layout": "IPY_MODEL_6bf066a9d5ab45d89ded27579dc67fba", "style": "IPY_MODEL_39973ca45a36412e81238a62e49688a8", "tooltip": "Happy"}}, "9a0878097ec9423892af282caf0eb3d8": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9a08894b64784a4ea08dddd1925f87a6": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "9a30c680be4147138ddc011f5d072096": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9a860566476648a3bf87a7046af3ce85": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9d23e42b267e41d684cedd2d21c7b689": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9f3c871064ba477a8f3e980d49eedd6d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_c5915784465a4f5b99a266c7f50ffb1e", "max": 650000.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_4f8632bdbc484e9abcaeb6fe50fd23e4", "value": 650000.0}}, "a0dc2d699cfd41b68e7e937d69ff6010": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_4d932b6797af480788019aa0fcd8ea47", "IPY_MODEL_7e51379bf2ee4f1496b7bf3126d86af0"], "layout": "IPY_MODEL_9a0878097ec9423892af282caf0eb3d8"}}, "a164c0d63543465bb29338877256ba37": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a1c911fbeab24c8790be26e30354592c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_13e87bda78a34246b30a6fd7caffb7d2", "placeholder": "\u200b", "style": "IPY_MODEL_0c664c3dd2bd4e489096721cc438cfd1", "value": "Map: 100%"}}, "a37ed2c87bf443edbd39d3adbdb1ef3f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Submit", "disabled": false, "icon": "", "layout": "IPY_MODEL_ebc612e009b44a4fa5afb39c8fe6d2e5", "style": "IPY_MODEL_bc00558500144e18ad3be00a16c8e3b3", "tooltip": ""}}, "a38c6f2f96934f9c8a09c2f08423d630": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "a3ef884202924d39906ff5e9852504fc": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_87f921c0c1cd4e4ca7b13dab9d121be1", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "Video available at https://youtube.com/watch?v=dMpvzEEDOwI\n"}, {"data": {"image/jpeg": "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\n", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://www.youtube.com/embed/dMpvzEEDOwI?fs=1&rel=0\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ", "text/plain": "<IPython.lib.display.YouTubeVideo at 0x7ff28803fb50>"}, "metadata": {}, "output_type": "display_data"}]}}, "a4bc8440f5b4461895e7555693fa5fce": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "a59bbdb7c7c4464b9c42ef129c86f443": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a5b95e8c2ee64dc9b9165813de9b45d4": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "VBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_d9e3727f84494c2cb93fd60c306c7ca7", "IPY_MODEL_4b3a5885e38f47278d03f365be5f4aa7", "IPY_MODEL_379a151ae4ac47f69db01c3ee714f916", "IPY_MODEL_1a379cd5146b47c5a6f9c84f50694ab3"], "layout": "IPY_MODEL_01597bb9763b47d58753295384b40a59"}}, "a611bfe981ee4d0cbe4cbf301d291f47": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_8e672f0fe443426bb460e8d5170dc915", "placeholder": "\u200b", "style": "IPY_MODEL_3669ae77eb2f4ae6bc352c9640e68b21", "value": " 650000/650000 [00:01&lt;00:00, 396280.50 examples/s]"}}, "a619e77e8e3246b5a082fcf507f654c0": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "a8cd4574203c4a2cb01218e3b4797e5b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#aaffaa", "font_weight": ""}}, "ab83eeecc54040ecb2908a34bdf5e363": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "LabelModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "LabelView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_5d0bb0b903444f8b8c3add91c7ee6ec2", "placeholder": "\u200b", "style": "IPY_MODEL_872de62de73e43d68e859af0d4935147", "value": "Thanks for your feedback!"}}, "ac88568cfaae4513803f8d720c9c32c5": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "ace30d35f6c9463186d57949df1afb22": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "adec8c4a71c946e78ee45cafa75cb0c9": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_764dc28dddb349dcb77acf81a9560a06", "IPY_MODEL_bbab2a42947f42c0b41ff7a17a19d63b", "IPY_MODEL_d0d72aa5f4a54410b9782c8061e49f08"], "layout": "IPY_MODEL_bf0695740caa4f6c91e60f5f11f343a4"}}, "ae1815d46de94dedb801da389cab8cc1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": ["happy"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude42", "disabled": false, "icon": "", "layout": "IPY_MODEL_777891abfd3248b88d887af808e5a6dd", "style": "IPY_MODEL_aff2cc837de84255b50552b57560bde2", "tooltip": "Happy"}}, "ae2eb1d07f2245d09222eb733aaf3e71": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_7b1d11ffa7d548e29631f7413edb49fa", "max": 50000.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_956bd19c5b844590a02f02997e5614ef", "value": 50000.0}}, "ae777cd371e94328861b3f9a8570c63b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": ["sad"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude41", "disabled": false, "icon": "", "layout": "IPY_MODEL_42f61fe9bce14ed3a2d765aba650b7ef", "style": "IPY_MODEL_0a30133c25a34611932fc4c4f2763006", "tooltip": "Sad"}}, "af128f7a539f4747a52ee97938c486db": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#dddd77", "font_weight": ""}}, "aff2cc837de84255b50552b57560bde2": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#aaffaa", "font_weight": ""}}, "b01c99382ecb4c97bae2411f790bb0b4": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": ["medium"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude10", "disabled": false, "icon": "", "layout": "IPY_MODEL_861172acc26940e2885f63284d2042f6", "style": "IPY_MODEL_88627aac8966432b9ae909fd894267e1", "tooltip": "Medium"}}, "b08fda478fc447648b59b7f5df67f0b9": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "b10de779a4974b4db7688cb01afa89dd": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "LabelModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "LabelView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_32d0a74686e04e8ba7fde824db89c243", "placeholder": "\u200b", "style": "IPY_MODEL_1c731dae03f043ccaf03a2559e829353", "value": "Thanks for your feedback!"}}, "b12ce737a9e1478897df790e5faef657": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_82b4cd9075c24eb99b112360e3fed33a", "IPY_MODEL_a37ed2c87bf443edbd39d3adbdb1ef3f"], "layout": "IPY_MODEL_f7bbe7a8e35545138dcfd9090b4c9cd9"}}, "b6aff63d721243ac90a26338d41632b8": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "b8c3b97b019b444297eebff1a6fcf356": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "LabelModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "LabelView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_16a44d2bb19f46789681a3c8d462c3e8", "placeholder": "\u200b", "style": "IPY_MODEL_7f60a96ea73544efa76edb7d133d1b94", "value": ""}}, "b9923d485e044ea1b526dd478ac129aa": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_19ca5517c557455098154361f4331717", "placeholder": "\u200b", "style": "IPY_MODEL_671e58b1ea714cefb919e96c98ff2684", "value": "Filter:  96%"}}, "bbab2a42947f42c0b41ff7a17a19d63b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_0c328e580586427db5f47e4aa11c08b9", "max": 435755784.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_1d04eb5abf964ff484e3b506abd3062f", "value": 435755784.0}}, "bc00558500144e18ad3be00a16c8e3b3": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "bf0695740caa4f6c91e60f5f11f343a4": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c07ed787358c4cc4866236a94a63bff0": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c0e871cf0fd048ee8408fa19eb40337c": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c1c6f3768afb4482b86f76249aded47d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "c1d4e251806d4bd49608d9e4fd1e74a2": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_0b44be86ba5e42eb855800dec2a18279", "placeholder": "\u200b", "style": "IPY_MODEL_33de8ebc174b4df09e69c2d909122e25", "value": " 638000/650000 [00:01&lt;00:00, 441916.21 examples/s]"}}, "c4ad213b45c34bd3a3c09b962d7b0cf3": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_b9923d485e044ea1b526dd478ac129aa", "IPY_MODEL_3eb0895524fc4e3688bb1e2eec1e0890", "IPY_MODEL_8aa291b2f5ef443aafb7c5e02334c6da"], "layout": "IPY_MODEL_ebfe56618b50439a89c2c65f2cda6e7a"}}, "c4c1ceb2768a4b1e9e47c92a79901e0f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": ["medium"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude10", "disabled": false, "icon": "", "layout": "IPY_MODEL_4493ba1886ff489fa5a9218d10a85ce4", "style": "IPY_MODEL_af128f7a539f4747a52ee97938c486db", "tooltip": "Medium"}}, "c5915784465a4f5b99a266c7f50ffb1e": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c5b83a42b26c45f597ec5f9d8d452fe2": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_a1c911fbeab24c8790be26e30354592c", "IPY_MODEL_ae2eb1d07f2245d09222eb733aaf3e71", "IPY_MODEL_93cb6ea4f9994fbab3f13200e675faf6"], "layout": "IPY_MODEL_2a9fcd749f344860b357dc67b9e48734"}}, "c67c36e3cf654ea2a52fc21fa79a30a9": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "c6a465f6c80e4f9995792e8c6d907cf0": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_63ec806210804d9ba9aa78284052d23c", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "If you want to download the slides: https://osf.io/download/6eudb/\n"}, {"data": {"text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://mfr.ca-1.osf.io/render?url=https://osf.io/6eudb/?direct%26mode=render%26action=download%26mode=render\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ", "text/plain": "<IPython.lib.display.IFrame at 0x7ff28811f040>"}, "metadata": {}, "output_type": "display_data"}]}}, "c723ba79622f47ba9e8f88809f5799b8": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "TabModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "TabModel", "_titles": {"0": "Youtube", "1": "Bilibili"}, "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "TabView", "box_style": "", "children": ["IPY_MODEL_a3ef884202924d39906ff5e9852504fc", "IPY_MODEL_c9db47169c53432b99bd4bf79313f7e3"], "layout": "IPY_MODEL_1b90cb96efef4c9581710fe294985ccd", "selected_index": 0}}, "c7d15ff49a7641c9a4e7aefbcc094812": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "c7fe42173a4c4e4c80d47b8dacc8f6e4": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c9a181c04c08464eb5059c9a6fb94084": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "c9db47169c53432b99bd4bf79313f7e3": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_e05ef4d54e614d83b8d4dac95a6595dd", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "Video available at https://www.bilibili.com/video/BV13q4y1X7Tt\n"}, {"data": {"text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://player.bilibili.com/player.html?bvid=BV13q4y1X7Tt&page=1?fs=1&autoplay=False\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ", "text/plain": "<__main__.PlayVideo at 0x7ff15f0a8b20>"}, "metadata": {}, "output_type": "display_data"}]}}, "cd1da46816714e15a5a51156de19c8c6": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_3aa00da2ecae4461b9e4b9e36a981ed8", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "Video available at https://youtube.com/watch?v=buZLOKdf7Qw\n"}, {"data": {"image/jpeg": "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\n", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://www.youtube.com/embed/buZLOKdf7Qw?fs=1&rel=0\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ", "text/plain": "<IPython.lib.display.YouTubeVideo at 0x7ff15ed14e20>"}, "metadata": {}, "output_type": "display_data"}]}}, "cdc160e02ec34806bda13e76d4b7c005": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#ffaaaa", "font_weight": ""}}, "cf7511dbe0cd4d518d5d5b777edf33f5": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d0d72aa5f4a54410b9782c8061e49f08": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_d2662425d9bb4803a1d97d04fb32625a", "placeholder": "\u200b", "style": "IPY_MODEL_180f7af24c9d4a898fd7e7cb1fa9b401", "value": " 436M/436M [00:05&lt;00:00, 84.5MB/s]"}}, "d2662425d9bb4803a1d97d04fb32625a": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d2f2c27fb78643ada291308b9fbfa78c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "d50a596747eb4ca9a4f46ee397b937f5": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "d8d75b60e6404fab84bd17ea61553dc6": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "d98fa07c9e7044488e823e14c172e698": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "d9e3727f84494c2cb93fd60c306c7ca7": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "LabelModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "LabelView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_44c2f7a7421e4234b25602d54c2e38a5", "placeholder": "\u200b", "style": "IPY_MODEL_1914d14590754bccb003cfa4bec4b0f6", "value": ""}}, "da8b7fd0e23c46ad9e566b1f6560983a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#aaffaa", "font_weight": ""}}, "db05dc83cdf244d8850f143c30add745": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_feecbae285ba4e58973d7b64baa91772", "IPY_MODEL_0ceb6a70e8fd4579bf59ad5eb3300e6a", "IPY_MODEL_79c7ddd96a034c6faa6a9fb80ef3fa3d"], "layout": "IPY_MODEL_7bef56eea0d4473b8e6134f8278a4fe8"}}, "dbf778b7f2e94ba3b692d95641dbec2c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_2b5195de000f44048601615143db16a0", "placeholder": "\u200b", "style": "IPY_MODEL_1d11f61fcb9247178deb0e00b451806a", "value": "Map: 100%"}}, "de28e157918549249aff50e8979c8eac": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "de56a66af8284ce981a4c1af1b9fe5b3": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "dfe326a7b4204bfb904f7136ebfc406b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_858a47e3f7ce4af0931f060099b3a406", "IPY_MODEL_f65df3d31e1f4882ab8eb62ca362eba2", "IPY_MODEL_a611bfe981ee4d0cbe4cbf301d291f47"], "layout": "IPY_MODEL_fcd627b2bb7c40b9b6a2827ef178658b"}}, "e05ef4d54e614d83b8d4dac95a6595dd": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e0dd14947adc4efda020677be2f9b25f": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e10802a1f043438cb4d41e0f7245d492": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e10ac461af5a420aa809dacac5b4f75a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_84e1e1547802475d841dab22fc1ca918", "IPY_MODEL_e78aced23b1442b18bc37023ea9b7c50", "IPY_MODEL_c1d4e251806d4bd49608d9e4fd1e74a2"], "layout": "IPY_MODEL_4ee8065ba1d24a26b7f4934863bb8db8"}}, "e1b414a4ae42448292bb1fdbdee2648c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_5f301e26d2744057a0aa6543583e6d20", "placeholder": "\u200b", "style": "IPY_MODEL_6a6a28ede1414bb9908f86378fd7560e", "value": "Downloading (\u2026)lve/main/config.json: 100%"}}, "e42a35b20a7a4fca8966fae85c14be23": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e78aced23b1442b18bc37023ea9b7c50": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_8fc840af07f342a79ac8994296f0dfa0", "max": 650000.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_faeac5b825e640939309223ed04f3593", "value": 650000.0}}, "e9492ff1ea684a468f362a3c68cf492d": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e9f6f5d549c44667b588fe81baca23de": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ebc612e009b44a4fa5afb39c8fe6d2e5": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "ebfe56618b50439a89c2c65f2cda6e7a": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": "hidden", "width": null}}, "ec7a68c335c34bf6981ff4d9525da93f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "ed630d808762480695dec2e239cd1eb1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_e1b414a4ae42448292bb1fdbdee2648c", "IPY_MODEL_2432caf0395149e7960e8c0ae6b6115e", "IPY_MODEL_1fad519856f5473db13f2a9c732e6dad"], "layout": "IPY_MODEL_c07ed787358c4cc4866236a94a63bff0"}}, "ed7ce88b1d2a455f9ba4ffc78503dc88": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "ef2b2a2df672412890506d34b6e17d8f": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ef92d541b6bf4c509e72729d4bddbe55": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "VBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_3062ae9562e14f429e8502dd808095a8", "IPY_MODEL_148b931f945049c586c99077ed3ae923", "IPY_MODEL_19b499fc706e4b1faa6a64c9861de0f6", "IPY_MODEL_6e8d7519d4124ba0b03582a8f1f0192f"], "layout": "IPY_MODEL_916678773fbb4eefbf397a411bb11b3e"}}, "f65df3d31e1f4882ab8eb62ca362eba2": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_e10802a1f043438cb4d41e0f7245d492", "max": 650000.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_70d0a98cd7f14aa7a5196514b7522813", "value": 650000.0}}, "f6e6d1aebf584120b4a2249025326af7": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "f7bbe7a8e35545138dcfd9090b4c9cd9": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f9c8d8440d55420680a0e326b3d02a79": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f9f01f6181674659aa45113f959f8350": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_1e4eaebf2f3242f38418f52f6c9d47c8", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "Video available at https://www.bilibili.com/video/BV1Y54y1E77J\n"}, {"data": {"text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://player.bilibili.com/player.html?bvid=BV1Y54y1E77J&page=1?fs=1&autoplay=False\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ", "text/plain": "<__main__.PlayVideo at 0x7ff1559efc70>"}, "metadata": {}, "output_type": "display_data"}]}}, "faeac5b825e640939309223ed04f3593": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "fbdd243f227b49d5bb7079b197375c5d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_994f53680f2847bcb96df3d9e18cad06", "IPY_MODEL_40806891b4a44e4e88d0b1621afda0c0", "IPY_MODEL_81fbd5116a2e4e5e90a6a06e21edee68"], "layout": "IPY_MODEL_89eebc589e5d4dafbb583e53723973c3"}}, "fcd627b2bb7c40b9b6a2827ef178658b": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": "hidden", "width": null}}, "fd615be8d4a14a64b2930c0f15a87713": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "fdc35551642a43c68376e69aaa41f9c8": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "fdc69d12d5334e8cb231a1081dcfcafc": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "fe679afd28b34cc299b4be146498eedb": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "feecbae285ba4e58973d7b64baa91772": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_831116a388a645978c4b5a0eee870117", "placeholder": "\u200b", "style": "IPY_MODEL_fdc35551642a43c68376e69aaa41f9c8", "value": "Filter:  98%"}}, "fff512a4ea4240af952ce16cce906d18": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./tutorials/W2D5_AttentionAndTransformers/instructor"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="W2D5_Tutorial1.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Tutorial 1: Learn how to work with Transformers</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/chapter_title.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Time Series And Natural Language Processing</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Neuromatch<br/>
  
    <div class="extra_footer">
      <div>
<a href="http://creativecommons.org/licenses/by/4.0/"><img src="https://i.creativecommons.org/l/by/4.0/88x31.png"></a>
<a href="https://opensource.org/licenses/BSD-3-Clause"><img src="https://camo.githubusercontent.com/9b9ea65d95c9ef878afa1987df65731d47681336/68747470733a2f2f696d672e736869656c64732e696f2f707970692f6c2f736561626f726e2e737667"></a>
The contents of this repository are shared under the <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
Software elements are additionally licensed under the <a href="https://opensource.org/licenses/BSD-3-Clause">BSD (3-Clause) License</a>.
</div>

    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>