
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bonus Tutorial: Planning with Monte Carlo Tree Search &#8212; Neuromatch Academy: Deep Learning (instructor&#39;s version)</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script >const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="shortcut icon" href="../../../_static/nma-dl-logo-square-4xp.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Bonus Lecture: Amita Kapoor" href="W3D5_BonusLecture.html" />
    <link rel="prev" title="Tutorial 2: Deep Learning Thinking 3" href="W3D5_Tutorial2.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/nma-dl-logo-square-4xp.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Neuromatch Academy: Deep Learning (instructor's version)</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../tatraining/TA_Training_DL.html">
   TA Training: Deep Learning (DL)
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Schedule/schedule_intro.html">
   Schedule
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Schedule/daily_schedules.html">
     General schedule
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Schedule/shared_calendars.html">
     Shared calendars
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Schedule/timezone_widget.html">
     Timezone widget
    </a>
   </li>
  </ul>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../TechnicalHelp/tech_intro.html">
   Technical Help
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../TechnicalHelp/Jupyterbook.html">
     Using jupyterbook
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../TechnicalHelp/Tutorial_colab.html">
       Using Google Colab
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../TechnicalHelp/Tutorial_kaggle.html">
       Using Kaggle
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../TechnicalHelp/Discord.html">
     Using Discord
    </a>
   </li>
  </ul>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../TechnicalHelp/Links_Policy.html">
   Quick links and policies
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../prereqs/DeepLearning.html">
   Prerequisites and preparatory materials for NMA Deep Learning
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Basics Module
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W1D1_BasicsAndPytorch/chapter_title.html">
   Basics And Pytorch (W1D1)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D1_BasicsAndPytorch/instructor/W1D1_Tutorial1.html">
     Tutorial 1: PyTorch
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W1D2_LinearDeepLearning/chapter_title.html">
   Linear Deep Learning (W1D2)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D2_LinearDeepLearning/instructor/W1D2_Tutorial1.html">
     Tutorial 1: Gradient Descent and AutoGrad
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D2_LinearDeepLearning/instructor/W1D2_Tutorial2.html">
     Tutorial 2: Learning Hyperparameters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D2_LinearDeepLearning/instructor/W1D2_Tutorial3.html">
     Tutorial 3: Deep linear neural networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D2_LinearDeepLearning/instructor/W1D2_BonusLecture.html">
     Bonus Lecture: Yoshua Bengio
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W1D3_MultiLayerPerceptrons/chapter_title.html">
   Multi Layer Perceptrons (W1D3)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D3_MultiLayerPerceptrons/instructor/W1D3_Tutorial1.html">
     Tutorial 1: Biological vs. Artificial Neural Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D3_MultiLayerPerceptrons/instructor/W1D3_Tutorial2.html">
     Tutorial 2: Deep MLPs
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Fine Tuning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W1D5_Optimization/chapter_title.html">
   Optimization (W1D5)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W1D5_Optimization/instructor/W1D5_Tutorial1.html">
     Tutorial 1: Optimization techniques
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W2D1_Regularization/chapter_title.html">
   Regularization (W2D1)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D1_Regularization/instructor/W2D1_Tutorial1.html">
     Tutorial 1: Regularization techniques part 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D1_Regularization/instructor/W2D1_Tutorial2.html">
     Tutorial 2: Regularization techniques part 2
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Module_WrapUps/FineTuning.html">
   Deep Learning: The Basics and Fine Tuning Wrap-up
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  ConvNets and Generative Models
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W2D2_ConvnetsAndDlThinking/chapter_title.html">
   Convnets And Dl Thinking (W2D2)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D2_ConvnetsAndDlThinking/instructor/W2D2_Tutorial1.html">
     Tutorial 1: Introduction to CNNs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D2_ConvnetsAndDlThinking/instructor/W2D2_Tutorial2.html">
     Tutorial 2: Deep Learning Thinking 1: Cost Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D2_ConvnetsAndDlThinking/instructor/W2D2_BonusLecture.html">
     Bonus Lecture: Kyunghyun Cho
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W2D3_ModernConvnets/chapter_title.html">
   Modern Convnets (W2D3)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D3_ModernConvnets/instructor/W2D3_Tutorial1.html">
     Tutorial 1: Learn how to use modern convnets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D3_ModernConvnets/instructor/W2D3_Tutorial2.html">
     Bonus Tutorial: Facial recognition using modern convnets
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W2D4_GenerativeModels/chapter_title.html">
   Generative Models (W2D4)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D4_GenerativeModels/instructor/W2D4_Tutorial1.html">
     Tutorial 1: Variational Autoencoders (VAEs)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D4_GenerativeModels/instructor/W2D4_Tutorial2.html">
     Tutorial 2: Diffusion models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D4_GenerativeModels/instructor/W2D4_Tutorial3.html">
     Tutorial 3: Image, Conditional Diffusion and Beyond
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D4_GenerativeModels/instructor/W2D4_BonusLecture.html">
     Bonus Lecture: Geoffrey Hinton
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Natural Language Processing
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W2D5_AttentionAndTransformers/chapter_title.html">
   Attention And Transformers (W2D5)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D5_AttentionAndTransformers/instructor/W2D5_Tutorial1.html">
     Tutorial 1: Learn how to work with Transformers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W2D5_AttentionAndTransformers/instructor/W2D5_Tutorial2.html">
     Bonus Tutorial: Understanding Pre-training, Fine-tuning and Robustness of Transformers
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/chapter_title.html">
   Time Series And Natural Language Processing (W3D1)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/instructor/W3D1_Tutorial1.html">
     Tutorial 1: Introduction to processing time series
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/instructor/W3D1_Tutorial2.html">
     Tutorial 2: Natural Language Processing and LLMs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/instructor/W3D1_Tutorial3.html">
     Bonus Tutorial: Multilingual Embeddings
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W3D2_DlThinking2/chapter_title.html">
   Dl Thinking2 (W3D2)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D2_DlThinking2/instructor/W3D2_Tutorial1.html">
     Tutorial 1: Deep Learning Thinking 2: Architectures and Multimodal DL thinking
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Module_WrapUps/NaturalLanguageProcessing.html">
   Deep Learning: Convnets and NLP
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Unsupervised and Reinforcement Learning
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W3D3_UnsupervisedAndSelfSupervisedLearning/chapter_title.html">
   Unsupervised And Self Supervised Learning (W3D3)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D3_UnsupervisedAndSelfSupervisedLearning/instructor/W3D3_Tutorial1.html">
     Tutorial 1: Un/Self-supervised learning methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D3_UnsupervisedAndSelfSupervisedLearning/instructor/W3D3_BonusLecture.html">
     Bonus Lecture: Melanie Mitchell
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../W3D4_BasicReinforcementLearning/chapter_title.html">
   Basic Reinforcement Learning (W3D4)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D4_BasicReinforcementLearning/instructor/W3D4_Tutorial1.html">
     Tutorial 1: Basic Reinforcement Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../W3D4_BasicReinforcementLearning/instructor/W3D4_BonusLecture.html">
     Bonus Lecture: Chealsea Finn
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../chapter_title.html">
   Reinforcement Learning For Games And Dl Thinking3 (W3D5)
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="W3D5_Tutorial1.html">
     Tutorial 1: Reinforcement Learning For Games
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="W3D5_Tutorial2.html">
     Tutorial 2: Deep Learning Thinking 3
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Bonus Tutorial: Planning with Monte Carlo Tree Search
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="W3D5_BonusLecture.html">
     Bonus Lecture: Amita Kapoor
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Deploy Models on the Web
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Bonus_DeployModels/chapter_title.html">
   Deploy Models (Bonus)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
  <label for="toctree-checkbox-18">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Bonus_DeployModels/instructor/Bonus_Tutorial1.html">
     Bonus Tutorial: Deploying Neural Networks on the Web
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Project Booklet
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../projects/README.html">
   Introduction to projects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../projects/docs/project_guidance.html">
   Daily guide for projects
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../projects/modelingsteps/intro.html">
   Modeling Step-by-Step Guide
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
  <label for="toctree-checkbox-19">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_1through2_DL.html">
     Modeling Steps 1 - 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_3through4_DL.html">
     Modeling Steps 3 - 4
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_5through6_DL.html">
     Modeling Steps 5 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_7through9_DL.html">
     Modeling Steps 7 - 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_10_DL.html">
     Modeling Steps 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionDataProjectDL.html">
     Example Data Project: the Train Illusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionModelingProjectDL.html">
     Example Model Project: the Train Illusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../projects/modelingsteps/Example_Deep_Learning_Project.html">
     Example Deep Learning Project
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../projects/docs/projects_overview.html">
   Project Templates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
  <label for="toctree-checkbox-20">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../projects/ComputerVision/README.html">
     Computer Vision
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
    <label for="toctree-checkbox-21">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ComputerVision/slides.html">
       Slides
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ComputerVision/ideas_and_datasets.html">
       Ideas
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ComputerVision/em_synapses.html">
       Knowledge Extraction from a Convolutional Neural Network
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ComputerVision/spectrogram_analysis.html">
       Music classification and generation with spectrograms
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ComputerVision/screws.html">
       Something Screwy - image recognition, detection, and classification of screws
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ComputerVision/data_augmentation.html">
       Data Augmentation in image classification models
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ComputerVision/transfer_learning.html">
       Transfer Learning
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../projects/ReinforcementLearning/README.html">
     Reinforcement Learning
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
    <label for="toctree-checkbox-22">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ReinforcementLearning/slides.html">
       Slides
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ReinforcementLearning/ideas_and_datasets.html">
       Ideas
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ReinforcementLearning/robolympics.html">
       NMA Robolympics: Controlling robots using reinforcement learning
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ReinforcementLearning/lunar_lander.html">
       Performance Analysis of DQN Algorithm on the Lunar Lander task
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/ReinforcementLearning/human_rl.html">
       Using RL to Model Cognitive Tasks
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../projects/NaturalLanguageProcessing/README.html">
     Natural Language Processing
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
    <label for="toctree-checkbox-23">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/NaturalLanguageProcessing/slides.html">
       Slides
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/NaturalLanguageProcessing/ideas_and_datasets.html">
       Ideas
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/NaturalLanguageProcessing/sentiment_analysis.html">
       Twitter Sentiment Analysis
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/NaturalLanguageProcessing/machine_translation.html">
       Machine Translation
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../projects/Neuroscience/README.html">
     Neuroscience
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/>
    <label for="toctree-checkbox-24">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/Neuroscience/slides.html">
       Slides
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/Neuroscience/ideas_and_datasets.html">
       Ideas
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/Neuroscience/pose_estimation.html">
       Animal Pose Estimation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/Neuroscience/cellular_segmentation.html">
       Segmentation and Denoising
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/Neuroscience/algonauts_videos.html">
       Load algonauts videos
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/Neuroscience/blurry_vision.html">
       Vision with Lost Glasses: Modelling how the brain deals with noisy input
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/Neuroscience/finetuning_fmri.html">
       Moving beyond Labels: Finetuning CNNs on BOLD response
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../projects/Neuroscience/neuro_seq_to_seq.html">
       Focus on what matters: inferring low-dimensional dynamics from neural recordings
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../projects/docs/datasets_and_models.html">
   Models and Data sets
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/NeuromatchAcademy/instructor-course-content-dl"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/NeuromatchAcademy/instructor-course-content-dl/issues/new?title=Issue%20on%20page%20%2Ftutorials/W3D5_ReinforcementLearningForGamesAndDlThinking3/instructor/W3D5_Tutorial3.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../_sources/tutorials/W3D5_ReinforcementLearningForGamesAndDlThinking3/instructor/W3D5_Tutorial3.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Bonus Tutorial: Planning with Monte Carlo Tree Search
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install-dependencies">
     Install dependencies
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install-and-import-feedback-gadget">
     Install and import feedback gadget
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-random-seed">
     Set random seed
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-device-gpu-or-cpu-execute-set-device">
     Set device (GPU or CPU). Execute
     <code class="docutils literal notranslate">
      <span class="pre">
       set_device()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#download-the-modules">
     Download the modules
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#helper-functions-from-previous-tutorials">
     Helper functions from previous tutorials
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-1-plan-using-monte-carlo-tree-search-mcts">
   Section 1: Plan using Monte Carlo Tree Search (MCTS)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#video-1-plan-with-mcts">
     Video 1: Plan with MCTS
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#submit-your-feedback">
     Submit your feedback
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#coding-exercise-1-mcts-planner">
     Coding Exercise 1: MCTS planner
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Submit your feedback
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-2-use-mcts-to-play-games">
   Section 2: Use MCTS to play games
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#video-2-play-with-mcts">
     Video 2: Play with MCTS
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Submit your feedback
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#coding-exercise-2-agent-that-uses-an-mcts-planner">
     Coding Exercise 2: Agent that uses an MCTS planner
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#load-in-trained-value-and-policy-networks">
       Load in trained value and policy networks
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mcts-player-against-value-based-player">
       MCTS player against Value-based player
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mcts-player-against-policy-based-player">
       MCTS player against Policy-based player
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mcts-player-against-monte-carlo-player">
       MCTS player against Monte-Carlo player
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id3">
         Submit your feedback
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Bonus Tutorial: Planning with Monte Carlo Tree Search</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Bonus Tutorial: Planning with Monte Carlo Tree Search
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install-dependencies">
     Install dependencies
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install-and-import-feedback-gadget">
     Install and import feedback gadget
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-random-seed">
     Set random seed
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-device-gpu-or-cpu-execute-set-device">
     Set device (GPU or CPU). Execute
     <code class="docutils literal notranslate">
      <span class="pre">
       set_device()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#download-the-modules">
     Download the modules
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#helper-functions-from-previous-tutorials">
     Helper functions from previous tutorials
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-1-plan-using-monte-carlo-tree-search-mcts">
   Section 1: Plan using Monte Carlo Tree Search (MCTS)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#video-1-plan-with-mcts">
     Video 1: Plan with MCTS
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#submit-your-feedback">
     Submit your feedback
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#coding-exercise-1-mcts-planner">
     Coding Exercise 1: MCTS planner
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Submit your feedback
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-2-use-mcts-to-play-games">
   Section 2: Use MCTS to play games
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#video-2-play-with-mcts">
     Video 2: Play with MCTS
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Submit your feedback
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#coding-exercise-2-agent-that-uses-an-mcts-planner">
     Coding Exercise 2: Agent that uses an MCTS planner
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#load-in-trained-value-and-policy-networks">
       Load in trained value and policy networks
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mcts-player-against-value-based-player">
       MCTS player against Value-based player
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mcts-player-against-policy-based-player">
       MCTS player against Policy-based player
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mcts-player-against-monte-carlo-player">
       MCTS player against Monte-Carlo player
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id3">
         Submit your feedback
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <p><a href="https://colab.research.google.com/github/NeuromatchAcademy/course-content-dl/blob/main/tutorials/W3D5_ReinforcementLearningForGamesAndDlThinking3/instructor/W3D5_Tutorial3.ipynb" target="_blank"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a>   <a href="https://kaggle.com/kernels/welcome?src=https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W3D5_ReinforcementLearningForGamesAndDlThinking3/instructor/W3D5_Tutorial3.ipynb" target="_blank"><img alt="Open in Kaggle" src="https://kaggle.com/static/images/open-in-kaggle.svg" /></a></p>
<div class="section" id="bonus-tutorial-planning-with-monte-carlo-tree-search">
<h1>Bonus Tutorial: Planning with Monte Carlo Tree Search<a class="headerlink" href="#bonus-tutorial-planning-with-monte-carlo-tree-search" title="Permalink to this headline">¶</a></h1>
<p><strong>Week 3, Day 5: Reinforcement Learning for Games &amp; DL Thinking 3</strong></p>
<p><strong>By Neuromatch Academy</strong></p>
<p><strong>Content creators:</strong> Mandana Samiei, Raymond Chua, Kushaan Gupta, Tim Lilicrap, Blake Richards</p>
<p><strong>Content reviewers:</strong> Arush Tagade, Lily Cheng, Melvin Selim Atay, Kelson Shilling-Scrivo</p>
<p><strong>Content editors:</strong> Melvin Selim Atay, Spiros Chavlis, Gunnar Blohm</p>
<p><strong>Production editors:</strong> Namrata Bafna, Gagana B, Spiros Chavlis</p>
</div>
<hr class="docutils" />
<div class="section" id="tutorial-objectives">
<h1>Tutorial Objectives<a class="headerlink" href="#tutorial-objectives" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial, you will learn about Monte Carlo Tree Search (MCTS) and compare its performance to policy-based, value-based players, and Monte Carlo planners.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "07fe32a219784c55b5f7f6f850dab2d7", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<p>These are the slides for the videos in the tutorial. If you want to locally download the slides, click <a class="reference external" href="https://osf.io/h4utj/download">here</a>.</p>
</div>
<hr class="docutils" />
<div class="section" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h1>
<div class="section" id="install-dependencies">
<h2>Install dependencies<a class="headerlink" href="#install-dependencies" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Install dependencies</span>
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>coloredlogs<span class="w"> </span>--quiet
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="install-and-import-feedback-gadget">
<h2>Install and import feedback gadget<a class="headerlink" href="#install-and-import-feedback-gadget" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Install and import feedback gadget</span>

<span class="o">!</span>pip3<span class="w"> </span>install<span class="w"> </span>vibecheck<span class="w"> </span>datatops<span class="w"> </span>--quiet

<span class="kn">from</span> <span class="nn">vibecheck</span> <span class="kn">import</span> <span class="n">DatatopsContentReviewContainer</span>
<span class="k">def</span> <span class="nf">content_review</span><span class="p">(</span><span class="n">notebook_section</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">DatatopsContentReviewContainer</span><span class="p">(</span>
        <span class="s2">&quot;&quot;</span><span class="p">,</span>  <span class="c1"># No text prompt</span>
        <span class="n">notebook_section</span><span class="p">,</span>
        <span class="p">{</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://pmyvdlilci.execute-api.us-east-1.amazonaws.com/klab&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;neuromatch_dl&quot;</span><span class="p">,</span>
            <span class="s2">&quot;user_key&quot;</span><span class="p">:</span> <span class="s2">&quot;f379rz8y&quot;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">)</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>


<span class="n">feedback_prefix</span> <span class="o">=</span> <span class="s2">&quot;W3D5_T3_Bonus&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imports</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">coloredlogs</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="nn">optim</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>

<span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span>

<span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">coloredlogs</span><span class="o">.</span><span class="n">install</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;INFO&#39;</span><span class="p">)</span>  <span class="c1"># Change this to DEBUG to see more info.</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="set-random-seed">
<h2>Set random seed<a class="headerlink" href="#set-random-seed" title="Permalink to this headline">¶</a></h2>
<p>Executing <code class="docutils literal notranslate"><span class="pre">set_seed(seed=seed)</span></code> you are setting the seed</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Set random seed</span>

<span class="c1"># @markdown Executing `set_seed(seed=seed)` you are setting the seed</span>

<span class="c1"># For DL its critical to set the random seed so that students can have a</span>
<span class="c1"># baseline to compare their results to expected results.</span>
<span class="c1"># Read more here: https://pytorch.org/docs/stable/notes/randomness.html</span>

<span class="c1"># Call `set_seed` function in the exercises to ensure reproducibility.</span>
<span class="k">def</span> <span class="nf">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed_torch</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Function that controls randomness. NumPy and random modules must be imported.</span>

<span class="sd">  Args:</span>
<span class="sd">    seed : Integer</span>
<span class="sd">      A non-negative integer that defines the random state. Default is `None`.</span>
<span class="sd">    seed_torch : Boolean</span>
<span class="sd">      If `True` sets the random seed for pytorch tensors, so pytorch module</span>
<span class="sd">      must be imported. Default is `True`.</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="mi">32</span><span class="p">)</span>
  <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">seed_torch</span><span class="p">:</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">manual_seed_all</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">cudnn</span><span class="o">.</span><span class="n">benchmark</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">cudnn</span><span class="o">.</span><span class="n">deterministic</span> <span class="o">=</span> <span class="kc">True</span>

  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Random seed </span><span class="si">{</span><span class="n">seed</span><span class="si">}</span><span class="s1"> has been set.&#39;</span><span class="p">)</span>


<span class="c1"># In case that `DataLoader` is used</span>
<span class="k">def</span> <span class="nf">seed_worker</span><span class="p">(</span><span class="n">worker_id</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  DataLoader will reseed workers following randomness in</span>
<span class="sd">  multi-process data loading algorithm.</span>

<span class="sd">  Args:</span>
<span class="sd">    worker_id: integer</span>
<span class="sd">      ID of subprocess to seed. 0 means that</span>
<span class="sd">      the data will be loaded in the main process</span>
<span class="sd">      Refer: https://pytorch.org/docs/stable/data.html#data-loading-randomness for more details</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">worker_seed</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">initial_seed</span><span class="p">()</span> <span class="o">%</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span>
  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">worker_seed</span><span class="p">)</span>
  <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">worker_seed</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="set-device-gpu-or-cpu-execute-set-device">
<h2>Set device (GPU or CPU). Execute <code class="docutils literal notranslate"><span class="pre">set_device()</span></code><a class="headerlink" href="#set-device-gpu-or-cpu-execute-set-device" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Set device (GPU or CPU). Execute `set_device()`</span>
<span class="c1"># especially if torch modules used.</span>

<span class="c1"># Inform the user if the notebook uses GPU or CPU.</span>

<span class="k">def</span> <span class="nf">set_device</span><span class="p">():</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Set the device. CUDA if available, CPU otherwise</span>

<span class="sd">  Args:</span>
<span class="sd">    None</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">device</span> <span class="o">=</span> <span class="s2">&quot;cuda&quot;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;cpu&quot;</span>
  <span class="k">if</span> <span class="n">device</span> <span class="o">!=</span> <span class="s2">&quot;cuda&quot;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: For this notebook to perform best, &quot;</span>
        <span class="s2">&quot;if possible, in the menu under `Runtime` -&gt; &quot;</span>
        <span class="s2">&quot;`Change runtime type.`  select `GPU` &quot;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;GPU is enabled in this notebook.&quot;</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">device</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SEED</span> <span class="o">=</span> <span class="mi">2023</span>
<span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
<span class="n">DEVICE</span> <span class="o">=</span> <span class="n">set_device</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Random seed 2023 has been set.
GPU is enabled in this notebook.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="download-the-modules">
<h2>Download the modules<a class="headerlink" href="#download-the-modules" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Download the modules</span>

<span class="c1"># @markdown Run this cell!</span>

<span class="c1"># @markdown Download from OSF. The original repo is https://github.com/raymondchua/nma_rl_games.git</span>

<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">io</span><span class="o">,</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">shutil</span><span class="o">,</span> <span class="nn">zipfile</span>
<span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span>

<span class="c1"># download from github repo directly</span>
<span class="c1">#!git clone git://github.com/raymondchua/nma_rl_games.git --quiet</span>
<span class="n">REPO_PATH</span> <span class="o">=</span> <span class="s1">&#39;nma_rl_games&#39;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">REPO_PATH</span><span class="p">):</span>
  <span class="n">download_string</span> <span class="o">=</span> <span class="s2">&quot;Downloading&quot;</span>
  <span class="n">zipurl</span> <span class="o">=</span> <span class="s1">&#39;https://osf.io/kf4p9/download&#39;</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">download_string</span><span class="si">}</span><span class="s2"> and unzipping the file... Please wait.&quot;</span><span class="p">)</span>
  <span class="k">with</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">zipurl</span><span class="p">)</span> <span class="k">as</span> <span class="n">zipresp</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">zipresp</span><span class="o">.</span><span class="n">read</span><span class="p">()))</span> <span class="k">as</span> <span class="n">zfile</span><span class="p">:</span>
      <span class="n">zfile</span><span class="o">.</span><span class="n">extractall</span><span class="p">()</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Download completed.&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Add the </span><span class="si">{</span><span class="n">REPO_PATH</span><span class="si">}</span><span class="s2"> in the path and import the modules.&quot;</span><span class="p">)</span>
<span class="c1"># add the repo in the path</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;nma_rl_games/alpha-zero&#39;</span><span class="p">)</span>

<span class="c1"># @markdown Import modules designed for use in this notebook</span>
<span class="kn">import</span> <span class="nn">Arena</span>

<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">Game</span> <span class="kn">import</span> <span class="n">Game</span>
<span class="kn">from</span> <span class="nn">MCTS</span> <span class="kn">import</span> <span class="n">MCTS</span>
<span class="kn">from</span> <span class="nn">NeuralNet</span> <span class="kn">import</span> <span class="n">NeuralNet</span>

<span class="c1"># from othello.OthelloPlayers import *</span>
<span class="kn">from</span> <span class="nn">othello.OthelloLogic</span> <span class="kn">import</span> <span class="n">Board</span>
<span class="c1"># from othello.OthelloGame import OthelloGame</span>
<span class="kn">from</span> <span class="nn">othello.pytorch.NNet</span> <span class="kn">import</span> <span class="n">NNetWrapper</span> <span class="k">as</span> <span class="n">NNet</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading and unzipping the file... Please wait.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Download completed.
Add the nma_rl_games in the path and import the modules.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="helper-functions-from-previous-tutorials">
<h2>Helper functions from previous tutorials<a class="headerlink" href="#helper-functions-from-previous-tutorials" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Helper functions from previous tutorials</span>

<span class="k">def</span> <span class="nf">loadTrainExamples</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Helper function to load training examples</span>

<span class="sd">  Args:</span>
<span class="sd">    folder: string</span>
<span class="sd">      Path specifying training examples</span>
<span class="sd">    filename: string</span>
<span class="sd">      File name of training examples</span>

<span class="sd">  Returns:</span>
<span class="sd">    trainExamplesHistory: list</span>
<span class="sd">      Returns examples based on the model were already collected (loaded)</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">trainExamplesHistory</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">modelFile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
  <span class="n">examplesFile</span> <span class="o">=</span> <span class="n">modelFile</span> <span class="o">+</span> <span class="s2">&quot;.examples&quot;</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">examplesFile</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;File &quot;</span><span class="si">{</span><span class="n">examplesFile</span><span class="si">}</span><span class="s1">&quot; with trainExamples not found!&#39;</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Continue? [y|n]&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">r</span> <span class="o">!=</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
      <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;File with train examples found. Loading it...&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">examplesFile</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
      <span class="n">trainExamplesHistory</span> <span class="o">=</span> <span class="n">Unpickler</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Loading done!&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">trainExamplesHistory</span>


<span class="k">def</span> <span class="nf">save_model_checkpoint</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">nnet</span><span class="p">):</span>
  <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

  <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">folder</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Checkpoint Directory does not exist! Making directory </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">folder</span><span class="p">))</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Checkpoint Directory exists!&quot;</span><span class="p">)</span>

  <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">({</span><span class="s1">&#39;state_dict&#39;</span><span class="p">:</span> <span class="n">nnet</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()},</span> <span class="n">filepath</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Model saved!&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">load_model_checkpoint</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">nnet</span><span class="p">,</span> <span class="n">device</span><span class="p">):</span>
  <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

  <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;No model in path </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filepath</span><span class="p">))</span>

  <span class="n">checkpoint</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">map_location</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
  <span class="n">nnet</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">[</span><span class="s1">&#39;state_dict&#39;</span><span class="p">])</span>


<span class="k">class</span> <span class="nc">OthelloGame</span><span class="p">(</span><span class="n">Game</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Othello game board</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">square_content</span> <span class="o">=</span> <span class="p">{</span>
      <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;X&quot;</span><span class="p">,</span>
      <span class="o">+</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span>
      <span class="o">+</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;O&quot;</span>
      <span class="p">}</span>

  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">getSquarePiece</span><span class="p">(</span><span class="n">piece</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">OthelloGame</span><span class="o">.</span><span class="n">square_content</span><span class="p">[</span><span class="n">piece</span><span class="p">]</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>

  <span class="k">def</span> <span class="nf">getInitBoard</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">Board</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">pieces</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">getBoardSize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">getActionSize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Return number of actions, n is the board size and +1 is for no-op action</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>

  <span class="k">def</span> <span class="nf">getCanonicalForm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
    <span class="c1"># Return state if player==1, else return -state if player==-1</span>
    <span class="k">return</span> <span class="n">player</span> <span class="o">*</span> <span class="n">board</span>

  <span class="k">def</span> <span class="nf">stringRepresentation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">board</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">stringRepresentationReadable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">):</span>
    <span class="n">board_s</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">square_content</span><span class="p">[</span><span class="n">square</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">board</span> <span class="k">for</span> <span class="n">square</span> <span class="ow">in</span> <span class="n">row</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">board_s</span>

  <span class="k">def</span> <span class="nf">getScore</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">Board</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
    <span class="n">b</span><span class="o">.</span><span class="n">pieces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">b</span><span class="o">.</span><span class="n">countDiff</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>

  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="n">board</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">board</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-----------------------&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="s2">&quot;|&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>    <span class="c1"># Print the row</span>
      <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">piece</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>    <span class="c1"># Get the piece to print</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">OthelloGame</span><span class="o">.</span><span class="n">square_content</span><span class="p">[</span><span class="n">piece</span><span class="p">],</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-----------------------&quot;</span><span class="p">)</span>

  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">displayValidMoves</span><span class="p">(</span><span class="n">moves</span><span class="p">):</span>
    <span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">moves</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">board</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">board</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;possible moves&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-----------------------&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="s2">&quot;|&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>    <span class="c1"># Print the row</span>
      <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">piece</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>    <span class="c1"># Get the piece to print</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">OthelloGame</span><span class="o">.</span><span class="n">square_content</span><span class="p">[</span><span class="n">piece</span><span class="p">],</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-----------------------&quot;</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">getNextState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Make valid move. If player takes action on board, return next (board,player)</span>
<span class="sd">    and action must be a valid move</span>

<span class="sd">    Args:</span>
<span class="sd">      board: np.ndarray</span>
<span class="sd">        Board of size n x n [6x6 in this case]</span>
<span class="sd">      player: Integer</span>
<span class="sd">        ID of current player</span>
<span class="sd">      action: np.ndarray</span>
<span class="sd">        Space of actions</span>

<span class="sd">    Returns:</span>
<span class="sd">      (board, player): tuple</span>
<span class="sd">        Next state representation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">:</span>
      <span class="k">return</span> <span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="o">-</span><span class="n">player</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">Board</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
    <span class="n">b</span><span class="o">.</span><span class="n">pieces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
    <span class="n">move</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">action</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">),</span> <span class="n">action</span><span class="o">%</span><span class="k">self</span>.n)
    <span class="n">b</span><span class="o">.</span><span class="n">execute_move</span><span class="p">(</span><span class="n">move</span><span class="p">,</span> <span class="n">player</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">pieces</span><span class="p">,</span> <span class="o">-</span><span class="n">player</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">getValidMoves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get all valid moves for player</span>

<span class="sd">    Args:</span>
<span class="sd">      board: np.ndarray</span>
<span class="sd">        Board of size n x n [6x6 in this case]</span>
<span class="sd">      player: Integer</span>
<span class="sd">        ID of current player</span>
<span class="sd">      action: np.ndarray</span>
<span class="sd">        Space of action</span>

<span class="sd">    Returns:</span>
<span class="sd">      valids: np.ndarray</span>
<span class="sd">        Valid moves for player</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">valids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">getActionSize</span><span class="p">()</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">Board</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
    <span class="n">b</span><span class="o">.</span><span class="n">pieces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
    <span class="n">legalMoves</span> <span class="o">=</span>  <span class="n">b</span><span class="o">.</span><span class="n">get_legal_moves</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">legalMoves</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
      <span class="n">valids</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
      <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">valids</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">legalMoves</span><span class="p">:</span>
      <span class="n">valids</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">valids</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">getGameEnded</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if game ended</span>

<span class="sd">    Args:</span>
<span class="sd">      board: np.ndarray</span>
<span class="sd">        Board of size n x n [6x6 in this case]</span>
<span class="sd">      player: Integer</span>
<span class="sd">        ID of current player</span>

<span class="sd">    Returns:</span>
<span class="sd">      0 if not ended, 1 if player 1 won, -1 if player 1 lost</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">Board</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
    <span class="n">b</span><span class="o">.</span><span class="n">pieces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">b</span><span class="o">.</span><span class="n">has_legal_moves</span><span class="p">(</span><span class="n">player</span><span class="p">):</span>
      <span class="k">return</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">b</span><span class="o">.</span><span class="n">has_legal_moves</span><span class="p">(</span><span class="o">-</span><span class="n">player</span><span class="p">):</span>
      <span class="k">return</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">b</span><span class="o">.</span><span class="n">countDiff</span><span class="p">(</span><span class="n">player</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">return</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

  <span class="k">def</span> <span class="nf">getSymmetries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">pi</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get mirror/rotational configurations of board</span>

<span class="sd">    Args:</span>
<span class="sd">      board: np.ndarray</span>
<span class="sd">        Board of size n x n [6x6 in this case]</span>
<span class="sd">      pi: np.ndarray</span>
<span class="sd">        Dimension of board</span>

<span class="sd">    Returns:</span>
<span class="sd">      l: list</span>
<span class="sd">        90 degree of board, 90 degree of pi_board</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># 1 for pass</span>
    <span class="n">pi_board</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">pi</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">))</span>
    <span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
      <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]:</span>
        <span class="n">newB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">newPi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">pi_board</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">j</span><span class="p">:</span>
          <span class="n">newB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fliplr</span><span class="p">(</span><span class="n">newB</span><span class="p">)</span>
          <span class="n">newPi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fliplr</span><span class="p">(</span><span class="n">newPi</span><span class="p">)</span>
        <span class="n">l</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">newB</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">newPi</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span> <span class="o">+</span> <span class="p">[</span><span class="n">pi</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])]</span>
    <span class="k">return</span> <span class="n">l</span>


<span class="k">class</span> <span class="nc">RandomPlayer</span><span class="p">():</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="n">game</span>

  <span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulates game play</span>

<span class="sd">    Args:</span>
<span class="sd">      board: np.ndarray</span>
<span class="sd">        Board of size n x n [6x6 in this case]</span>

<span class="sd">    Returns:</span>
<span class="sd">      a: int</span>
<span class="sd">        Randomly chosen move</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Compute the valid moves using getValidMoves()</span>
    <span class="n">valids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getValidMoves</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Compute the probability of each move being played (random player means this should</span>
    <span class="c1"># be uniform for valid moves, 0 for others)</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="n">valids</span><span class="o">/</span><span class="n">valids</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="c1"># Pick an action based on the probabilities (hint: np.choice is useful)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getActionSize</span><span class="p">(),</span> <span class="n">p</span><span class="o">=</span><span class="n">prob</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">a</span>


<span class="k">class</span> <span class="nc">OthelloNNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialise game parameters</span>

<span class="sd">    Args:</span>
<span class="sd">      game: OthelloGame instance</span>
<span class="sd">        Instance of the OthelloGame class above;</span>
<span class="sd">      args: dictionary</span>
<span class="sd">        Instantiates number of iterations and episodes, controls temperature threshold, queue length,</span>
<span class="sd">        arena, checkpointing, and neural network parameters:</span>
<span class="sd">        learning-rate: 0.001, dropout: 0.3, epochs: 10, batch_size: 64,</span>
<span class="sd">        num_channels: 512</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">board_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">board_y</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">getBoardSize</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">action_size</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">getActionSize</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>

    <span class="nb">super</span><span class="p">(</span><span class="n">OthelloNNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">num_channels</span><span class="p">,</span>
                           <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">num_channels</span><span class="p">,</span>
                           <span class="n">out_channels</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">num_channels</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                           <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">conv3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">num_channels</span><span class="p">,</span>
                           <span class="n">out_channels</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">num_channels</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                           <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">conv4</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">num_channels</span><span class="p">,</span>
                           <span class="n">out_channels</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">num_channels</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                           <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">bn1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm2d</span><span class="p">(</span><span class="n">num_features</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">num_channels</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bn2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm2d</span><span class="p">(</span><span class="n">num_features</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">num_channels</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bn3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm2d</span><span class="p">(</span><span class="n">num_features</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">num_channels</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bn4</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm2d</span><span class="p">(</span><span class="n">num_features</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">num_channels</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">num_channels</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board_x</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board_y</span> <span class="o">-</span> <span class="mi">4</span><span class="p">),</span>
                         <span class="n">out_features</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fc_bn1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm1d</span><span class="p">(</span><span class="n">num_features</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">fc2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">512</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fc_bn2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm1d</span><span class="p">(</span><span class="n">num_features</span><span class="o">=</span><span class="mi">512</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">fc3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">action_size</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">fc4</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Controls forward pass of OthelloNNet</span>

<span class="sd">    Args:</span>
<span class="sd">      s: np.ndarray</span>
<span class="sd">        Array of size (batch_size x board_x x board_y)</span>

<span class="sd">    Returns:</span>
<span class="sd">      prob, v: tuple of torch.Tensor</span>
<span class="sd">        Probability distribution over actions at the current state and the value</span>
<span class="sd">        of the current state.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">board_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">board_y</span><span class="p">)</span>                <span class="c1"># batch_size x 1 x board_x x board_y</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bn1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv1</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>                          <span class="c1"># batch_size x num_channels x board_x x board_y</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bn2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv2</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>                          <span class="c1"># batch_size x num_channels x board_x x board_y</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bn3</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv3</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>                          <span class="c1"># batch_size x num_channels x (board_x-2) x (board_y-2)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bn4</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv4</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>                          <span class="c1"># batch_size x num_channels x (board_x-4) x (board_y-4)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">num_channels</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board_x</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board_y</span> <span class="o">-</span> <span class="mi">4</span><span class="p">))</span>

    <span class="n">s</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc_bn1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc1</span><span class="p">(</span><span class="n">s</span><span class="p">))),</span> <span class="n">p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">training</span><span class="p">)</span>  <span class="c1"># batch_size x 1024</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc_bn2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc2</span><span class="p">(</span><span class="n">s</span><span class="p">))),</span> <span class="n">p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">training</span><span class="p">)</span>  <span class="c1"># batch_size x 512</span>

    <span class="n">pi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc3</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>  <span class="c1"># batch_size x action_size</span>
    <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc4</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>   <span class="c1"># batch_size x 1</span>

    <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">ValueNetwork</span><span class="p">(</span><span class="n">NeuralNet</span><span class="p">):</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      game: OthelloGame</span>
<span class="sd">        Instance of the OthelloGame class above</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span> <span class="o">=</span> <span class="n">OthelloNNet</span><span class="p">(</span><span class="n">game</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">board_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">board_y</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">getBoardSize</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">action_size</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">getActionSize</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">games</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      games: list</span>
<span class="sd">        List of examples with each example is of form (board, pi, v)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nnet</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">examples</span> <span class="ow">in</span> <span class="n">games</span><span class="p">:</span>
      <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">epochs</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;EPOCH ::: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">epoch</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
        <span class="n">v_losses</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># To store the losses per epoch</span>
        <span class="n">batch_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">examples</span><span class="p">)</span> <span class="o">/</span> <span class="n">args</span><span class="o">.</span><span class="n">batch_size</span><span class="p">)</span>  <span class="c1"># len(examples)=200, batch-size=64, batch_count=3</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">batch_count</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Training Value Network&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">t</span><span class="p">:</span>
          <span class="n">sample_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">examples</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">batch_size</span><span class="p">)</span>  <span class="c1"># Read the ground truth information from MCTS simulation using the loaded examples</span>
          <span class="n">boards</span><span class="p">,</span> <span class="n">pis</span><span class="p">,</span> <span class="n">vs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">examples</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sample_ids</span><span class="p">]))</span>  <span class="c1"># Length of boards, pis, vis = 64</span>
          <span class="n">boards</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">boards</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">))</span>
          <span class="n">target_vs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vs</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">))</span>

          <span class="c1"># Predict</span>
          <span class="c1"># To run on GPU if available</span>
          <span class="n">boards</span><span class="p">,</span> <span class="n">target_vs</span> <span class="o">=</span> <span class="n">boards</span><span class="o">.</span><span class="n">contiguous</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">device</span><span class="p">),</span> <span class="n">target_vs</span><span class="o">.</span><span class="n">contiguous</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

          <span class="c1"># Compute output</span>
          <span class="n">_</span><span class="p">,</span> <span class="n">out_v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span><span class="p">(</span><span class="n">boards</span><span class="p">)</span>
          <span class="n">l_v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_v</span><span class="p">(</span><span class="n">target_vs</span><span class="p">,</span> <span class="n">out_v</span><span class="p">)</span>  <span class="c1"># Total loss</span>

          <span class="c1"># Record loss</span>
          <span class="n">v_losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l_v</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
          <span class="n">t</span><span class="o">.</span><span class="n">set_postfix</span><span class="p">(</span><span class="n">Loss_v</span><span class="o">=</span><span class="n">l_v</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>

          <span class="c1"># Compute gradient and do SGD step</span>
          <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
          <span class="n">l_v</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
          <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      board: np.ndarray</span>
<span class="sd">        Board of size n x n [6x6 in this case]</span>

<span class="sd">    Returns:</span>
<span class="sd">      v: OthelloNet instance</span>
<span class="sd">        Data of the OthelloNet class instance above;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Timing</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="c1"># Preparing input</span>
    <span class="n">board</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">board</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">))</span>
    <span class="n">board</span> <span class="o">=</span> <span class="n">board</span><span class="o">.</span><span class="n">contiguous</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
    <span class="n">board</span> <span class="o">=</span> <span class="n">board</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">board_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">board_y</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">v</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

  <span class="k">def</span> <span class="nf">loss_v</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">outputs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      targets: np.ndarray</span>
<span class="sd">        Ground Truth variables corresponding to input</span>
<span class="sd">      outputs: np.ndarray</span>
<span class="sd">        Predictions of Network</span>

<span class="sd">    Returns:</span>
<span class="sd">      MSE Loss averaged across the whole dataset</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Mean squared error (MSE)</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">targets</span> <span class="o">-</span> <span class="n">outputs</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">targets</span><span class="o">.</span><span class="n">size</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

  <span class="k">def</span> <span class="nf">save_checkpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="s1">&#39;checkpoint&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;checkpoint.pth.tar&#39;</span><span class="p">):</span>
    <span class="n">save_model_checkpoint</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">load_checkpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="s1">&#39;checkpoint&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;checkpoint.pth.tar&#39;</span><span class="p">):</span>
    <span class="n">load_model_checkpoint</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ValueBasedPlayer</span><span class="p">():</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">vnet</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      game: OthelloGame instance</span>
<span class="sd">        Instance of the OthelloGame class</span>
<span class="sd">      vnet: Value Network instance</span>
<span class="sd">        Instance of the Value Network class</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="n">game</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vnet</span> <span class="o">=</span> <span class="n">vnet</span>

  <span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      board: np.ndarray</span>
<span class="sd">        Board of size n x n [6x6 in this case]</span>

<span class="sd">    Returns:</span>
<span class="sd">      candidates: List</span>
<span class="sd">        Collection of tuples describing action and values of future predicted</span>
<span class="sd">        states</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">valids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getValidMoves</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">candidates</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">max_num_actions</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">va</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">valids</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">va_list</span> <span class="o">=</span> <span class="n">va</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">va_list</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">va_list</span><span class="p">:</span>
      <span class="c1"># Return next board state using getNextState() function</span>
      <span class="n">nextBoard</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getNextState</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
      <span class="c1"># Predict the value of next state using value network</span>
      <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vnet</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">nextBoard</span><span class="p">)</span>
      <span class="c1"># Add the value and the action as a tuple to the candidate lists, note that you might need to change the sign of the value based on the player</span>
      <span class="n">candidates</span> <span class="o">+=</span> <span class="p">[(</span><span class="o">-</span><span class="n">value</span><span class="p">,</span> <span class="n">a</span><span class="p">)]</span>

      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span> <span class="o">==</span> <span class="n">max_num_actions</span><span class="p">:</span>
        <span class="k">break</span>

    <span class="c1"># Sort by the values</span>
    <span class="n">candidates</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="c1"># Return action associated with highest value</span>
    <span class="k">return</span> <span class="n">candidates</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>


<span class="k">class</span> <span class="nc">PolicyNetwork</span><span class="p">(</span><span class="n">NeuralNet</span><span class="p">):</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      game: OthelloGame</span>
<span class="sd">        Instance of the OthelloGame class</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span> <span class="o">=</span> <span class="n">OthelloNNet</span><span class="p">(</span><span class="n">game</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">board_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">board_y</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">getBoardSize</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">action_size</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">getActionSize</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">games</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      games: list</span>
<span class="sd">        List of examples where each example is of form (board, pi, v)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nnet</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>

    <span class="k">for</span> <span class="n">examples</span> <span class="ow">in</span> <span class="n">games</span><span class="p">:</span>
      <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">epochs</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;EPOCH ::: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">epoch</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
        <span class="n">pi_losses</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">batch_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">examples</span><span class="p">)</span> <span class="o">/</span> <span class="n">args</span><span class="o">.</span><span class="n">batch_size</span><span class="p">)</span>

        <span class="n">t</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">batch_count</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Training Policy Network&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">t</span><span class="p">:</span>
          <span class="n">sample_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">examples</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">batch_size</span><span class="p">)</span>
          <span class="n">boards</span><span class="p">,</span> <span class="n">pis</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">examples</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sample_ids</span><span class="p">]))</span>
          <span class="n">boards</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">boards</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">))</span>
          <span class="n">target_pis</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pis</span><span class="p">))</span>

          <span class="c1"># Predict</span>
          <span class="n">boards</span><span class="p">,</span> <span class="n">target_pis</span> <span class="o">=</span> <span class="n">boards</span><span class="o">.</span><span class="n">contiguous</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">device</span><span class="p">),</span> <span class="n">target_pis</span><span class="o">.</span><span class="n">contiguous</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

          <span class="c1"># Compute output</span>
          <span class="n">out_pi</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span><span class="p">(</span><span class="n">boards</span><span class="p">)</span>
          <span class="n">l_pi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_pi</span><span class="p">(</span><span class="n">target_pis</span><span class="p">,</span> <span class="n">out_pi</span><span class="p">)</span>

          <span class="c1"># Record loss</span>
          <span class="n">pi_losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l_pi</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
          <span class="n">t</span><span class="o">.</span><span class="n">set_postfix</span><span class="p">(</span><span class="n">Loss_pi</span><span class="o">=</span><span class="n">l_pi</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>

          <span class="c1"># Compute gradient and do SGD step</span>
          <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
          <span class="n">l_pi</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
          <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      board: np.ndarray</span>
<span class="sd">        Board of size n x n [6x6 in this case]</span>

<span class="sd">    Returns:</span>
<span class="sd">      Data from the OthelloNet instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Timing</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="c1"># Preparing input</span>
    <span class="n">board</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">board</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">))</span>
    <span class="n">board</span> <span class="o">=</span> <span class="n">board</span><span class="o">.</span><span class="n">contiguous</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
    <span class="n">board</span> <span class="o">=</span> <span class="n">board</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">board_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">board_y</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
      <span class="n">pi</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

  <span class="k">def</span> <span class="nf">loss_pi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">outputs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates Negative Log Likelihood(NLL) of Targets</span>

<span class="sd">    Args:</span>
<span class="sd">      targets: np.ndarray</span>
<span class="sd">        Ground Truth variables corresponding to input</span>
<span class="sd">      outputs: np.ndarray</span>
<span class="sd">        Predictions of Network</span>

<span class="sd">    Returns:</span>
<span class="sd">      Negative Log Likelihood calculated as: When training a model, we aspire to</span>
<span class="sd">      find the minima of a loss function given a set of parameters (in a neural</span>
<span class="sd">      network, these are the weights and biases).</span>
<span class="sd">      Sum the loss function to all the correct classes. So, whenever the network</span>
<span class="sd">      assigns high confidence at the correct class, the NLL is low, but when the</span>
<span class="sd">      network assigns low confidence at the correct class, the NLL is high.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">## For more information, here is a reference that connects the expression to</span>
    <span class="c1"># the neg-log-prob: https://gombru.github.io/2018/05/23/cross_entropy_loss/</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">targets</span> <span class="o">*</span> <span class="n">outputs</span><span class="p">)</span> <span class="o">/</span> <span class="n">targets</span><span class="o">.</span><span class="n">size</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

  <span class="k">def</span> <span class="nf">save_checkpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="s1">&#39;checkpoint&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;checkpoint.pth.tar&#39;</span><span class="p">):</span>
    <span class="n">save_model_checkpoint</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">load_checkpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="s1">&#39;checkpoint&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;checkpoint.pth.tar&#39;</span><span class="p">):</span>
    <span class="n">load_model_checkpoint</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">PolicyBasedPlayer</span><span class="p">():</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">pnet</span><span class="p">,</span> <span class="n">greedy</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      game: OthelloGame instance</span>
<span class="sd">        Instance of the OthelloGame class above;</span>
<span class="sd">      pnet: Policy Network instance</span>
<span class="sd">        Instance of the Policy Network class above</span>
<span class="sd">      greedy: Boolean</span>
<span class="sd">        If true, implement greedy approach</span>
<span class="sd">        Else, implement random sample policy based player</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="n">game</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pnet</span> <span class="o">=</span> <span class="n">pnet</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">greedy</span> <span class="o">=</span> <span class="n">greedy</span>

  <span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      board: np.ndarray</span>
<span class="sd">        Board of size n x n [6x6 in this case]</span>

<span class="sd">    Returns:</span>
<span class="sd">      a: np.ndarray</span>
<span class="sd">        If greedy, implement greedy policy player</span>
<span class="sd">        Else, implement random sample policy based player</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">valids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getValidMoves</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">action_probs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pnet</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
    <span class="n">vap</span> <span class="o">=</span> <span class="n">action_probs</span><span class="o">*</span><span class="n">valids</span>  <span class="c1"># Masking invalid moves</span>
    <span class="n">sum_vap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vap</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sum_vap</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">vap</span> <span class="o">/=</span> <span class="n">sum_vap</span>  <span class="c1"># Renormalize</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="c1"># If all valid moves were masked we make all valid moves equally probable</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All valid moves were masked, doing a workaround.&quot;</span><span class="p">)</span>
      <span class="n">vap</span> <span class="o">=</span> <span class="n">vap</span> <span class="o">+</span> <span class="n">valids</span>
      <span class="n">vap</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vap</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">greedy</span><span class="p">:</span>
      <span class="c1"># Greedy policy player</span>
      <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">vap</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">vap</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="c1"># Sample-based policy player</span>
      <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getActionSize</span><span class="p">(),</span> <span class="n">p</span><span class="o">=</span><span class="n">vap</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">a</span>


<span class="k">class</span> <span class="nc">MonteCarlo</span><span class="p">():</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">nnet</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      game: OthelloGame instance</span>
<span class="sd">        Instance of the OthelloGame class above;</span>
<span class="sd">      nnet: OthelloNet instance</span>
<span class="sd">        Instance of the OthelloNNet class above;</span>
<span class="sd">      args: dictionary</span>
<span class="sd">        Instantiates number of iterations and episodes, controls temperature threshold, queue length,</span>
<span class="sd">        arena, checkpointing, and neural network parameters:</span>
<span class="sd">        learning-rate: 0.001, dropout: 0.3, epochs: 10, batch_size: 64,</span>
<span class="sd">        num_channels: 512</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="n">game</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span> <span class="o">=</span> <span class="n">nnet</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Stores initial policy (returned by neural net)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Es</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Stores game.getGameEnded ended for board s</span>

  <span class="c1"># Call this rollout</span>
  <span class="k">def</span> <span class="nf">simulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">canonicalBoard</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate one Monte Carlo rollout</span>

<span class="sd">    Args:</span>
<span class="sd">      canonicalBoard: np.ndarray</span>
<span class="sd">        Canonical Board of size n x n [6x6 in this case]</span>

<span class="sd">    Returns:</span>
<span class="sd">      temp_v:</span>
<span class="sd">        Terminal State</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">stringRepresentation</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">)</span>
    <span class="n">init_start_state</span> <span class="o">=</span> <span class="n">s</span>
    <span class="n">temp_v</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">isfirstAction</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">current_player</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># opponent&#39;s turn (the agent has already taken an action before the simulation)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">],</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">maxDepth</span><span class="p">):</span>  <span class="c1"># maxDepth</span>

      <span class="k">if</span> <span class="n">s</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Es</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Es</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getGameEnded</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Es</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># Terminal state</span>
        <span class="n">temp_v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Es</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">*</span> <span class="n">current_player</span>
        <span class="k">break</span>

      <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">],</span> <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">)</span>
      <span class="n">valids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getValidMoves</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">*</span> <span class="n">valids</span>  <span class="c1"># Masking invalid moves</span>
      <span class="n">sum_Ps_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">])</span>

      <span class="k">if</span> <span class="n">sum_Ps_s</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">/=</span> <span class="n">sum_Ps_s</span>  <span class="c1"># Renormalize</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="c1"># If all valid moves were masked make all valid moves equally probable</span>
        <span class="c1"># NB! All valid moves may be masked if either your NNet architecture is insufficient or you&#39;ve get overfitting or something else.</span>
        <span class="c1"># If you have got dozens or hundreds of these messages you should pay attention to your NNet and/or training process.</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;All valid moves were masked, doing a workaround.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">+</span> <span class="n">valids</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">])</span>

      <span class="c1"># Choose action according to the policy distribution</span>
      <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getActionSize</span><span class="p">(),</span> <span class="n">p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">])</span>
      <span class="c1"># Find the next state and the next player</span>
      <span class="n">next_s</span><span class="p">,</span> <span class="n">next_player</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getNextState</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
      <span class="n">canonicalBoard</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getCanonicalForm</span><span class="p">(</span><span class="n">next_s</span><span class="p">,</span> <span class="n">next_player</span><span class="p">)</span>
      <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">stringRepresentation</span><span class="p">(</span><span class="n">next_s</span><span class="p">)</span>
      <span class="n">current_player</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
      <span class="c1"># Initial policy</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">],</span> <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">)</span>
      <span class="n">temp_v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">*</span> <span class="n">current_player</span>

    <span class="k">return</span> <span class="n">temp_v</span>


<span class="k">class</span> <span class="nc">MonteCarloBasedPlayer</span><span class="p">():</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Simulate Player based on Monte Carlo Algorithm</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">nnet</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      game: OthelloGame instance</span>
<span class="sd">        Instance of the OthelloGame class above;</span>
<span class="sd">      nnet: OthelloNet instance</span>
<span class="sd">        Instance of the OthelloNNet class above;</span>
<span class="sd">      args: dictionary</span>
<span class="sd">        Instantiates number of iterations and episodes, controls temperature threshold, queue length,</span>
<span class="sd">        arena, checkpointing, and neural network parameters:</span>
<span class="sd">        learning-rate: 0.001, dropout: 0.3, epochs: 10, batch_size: 64,</span>
<span class="sd">        num_channels: 512</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="n">game</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span> <span class="o">=</span> <span class="n">nnet</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mc</span> <span class="o">=</span> <span class="n">MonteCarlo</span><span class="p">(</span><span class="n">game</span><span class="p">,</span> <span class="n">nnet</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">K</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">mc_topk</span>

  <span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">canonicalBoard</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate Play on Canonical Board</span>

<span class="sd">    Args:</span>
<span class="sd">      canonicalBoard: np.ndarray</span>
<span class="sd">        Canonical Board of size n x n [6x6 in this case]</span>

<span class="sd">    Returns:</span>
<span class="sd">      best_action: tuple</span>
<span class="sd">        (avg_value, action) i.e., Average value associated with corresponding action</span>
<span class="sd">        i.e., Action with the highest topK probability</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">qsa</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">stringRepresentation</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">)</span>
    <span class="n">Ps</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">)</span>
    <span class="n">valids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getValidMoves</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">Ps</span> <span class="o">=</span> <span class="n">Ps</span> <span class="o">*</span> <span class="n">valids</span>  <span class="c1"># Masking invalid moves</span>
    <span class="n">sum_Ps_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Ps</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sum_Ps_s</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">Ps</span> <span class="o">/=</span> <span class="n">sum_Ps_s</span>  <span class="c1"># Renormalize</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="c1"># If all valid moves were masked make all valid moves equally probable</span>
      <span class="c1"># NB! All valid moves may be masked if either your NNet architecture is insufficient or you&#39;ve get overfitting or something else.</span>
      <span class="c1"># If you have got dozens or hundreds of these messages you should pay attention to your NNet and/or training process.</span>
      <span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
      <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;All valid moves were masked, doing a workaround.&quot;</span><span class="p">)</span>
      <span class="n">Ps</span> <span class="o">=</span> <span class="n">Ps</span> <span class="o">+</span> <span class="n">valids</span>
      <span class="n">Ps</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Ps</span><span class="p">)</span>

    <span class="n">num_valid_actions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">Ps</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">num_valid_actions</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="p">:</span>
      <span class="n">top_k_actions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argpartition</span><span class="p">(</span><span class="n">Ps</span><span class="p">,</span><span class="o">-</span><span class="n">num_valid_actions</span><span class="p">)[</span><span class="o">-</span><span class="n">num_valid_actions</span><span class="p">:]</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">top_k_actions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argpartition</span><span class="p">(</span><span class="n">Ps</span><span class="p">,</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="p">)[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="p">:]</span>  <span class="c1"># To get actions that belongs to top k prob</span>

    <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">top_k_actions</span><span class="p">:</span>
      <span class="n">next_s</span><span class="p">,</span> <span class="n">next_player</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getNextState</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
      <span class="n">next_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getCanonicalForm</span><span class="p">(</span><span class="n">next_s</span><span class="p">,</span> <span class="n">next_player</span><span class="p">)</span>

      <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>

      <span class="c1"># Do some rollouts</span>
      <span class="k">for</span> <span class="n">rollout</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">numMCsims</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mc</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">next_s</span><span class="p">)</span>
        <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

      <span class="c1"># Average out values</span>
      <span class="n">avg_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">qsa</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">avg_value</span><span class="p">,</span> <span class="n">action</span><span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">qsa</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">qsa</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
    <span class="n">best_action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qsa</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">best_action</span>

  <span class="k">def</span> <span class="nf">getActionProb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">canonicalBoard</span><span class="p">,</span> <span class="n">temp</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get probabilities associated with each action</span>

<span class="sd">    Args:</span>
<span class="sd">      canonicalBoard: np.ndarray</span>
<span class="sd">        Canonical Board of size n x n [6x6 in this case]</span>
<span class="sd">      temp: Integer</span>
<span class="sd">        Signifies if game is in terminal state</span>

<span class="sd">    Returns:</span>
<span class="sd">      action_probs: List</span>
<span class="sd">        Probability associated with corresponding action</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getGameEnded</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getActionSize</span><span class="p">()))</span>

    <span class="k">else</span><span class="p">:</span>
      <span class="n">action_probs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getActionSize</span><span class="p">()))</span>
      <span class="n">best_action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">)</span>
      <span class="n">action_probs</span><span class="p">[</span><span class="n">best_action</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">action_probs</span>
</pre></div>
</div>
</div>
</div>
<p>The hyperparameters used throughout the notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">args</span> <span class="o">=</span> <span class="n">dotdict</span><span class="p">({</span>
    <span class="s1">&#39;numIters&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1"># In training, number of iterations = 1000 and num of episodes = 100</span>
    <span class="s1">&#39;numEps&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1"># Number of complete self-play games to simulate during a new iteration.</span>
    <span class="s1">&#39;tempThreshold&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>  <span class="c1"># To control exploration and exploitation</span>
    <span class="s1">&#39;updateThreshold&#39;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">,</span>  <span class="c1"># During arena playoff, new neural net will be accepted if threshold or more of games are won.</span>
    <span class="s1">&#39;maxlenOfQueue&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>  <span class="c1"># Number of game examples to train the neural networks.</span>
    <span class="s1">&#39;numMCTSSims&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>  <span class="c1"># Number of games moves for MCTS to simulate.</span>
    <span class="s1">&#39;arenaCompare&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>  <span class="c1"># Number of games to play during arena play to determine if new net will be accepted.</span>
    <span class="s1">&#39;cpuct&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;maxDepth&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span>  <span class="c1"># Maximum number of rollouts</span>
    <span class="s1">&#39;numMCsims&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>  <span class="c1"># Number of monte carlo simulations</span>
    <span class="s1">&#39;mc_topk&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>  <span class="c1"># Top k actions for monte carlo rollout</span>

    <span class="s1">&#39;checkpoint&#39;</span><span class="p">:</span> <span class="s1">&#39;./temp/&#39;</span><span class="p">,</span>
    <span class="s1">&#39;load_model&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;load_folder_file&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;/dev/models/8x100x50&#39;</span><span class="p">,</span><span class="s1">&#39;best.pth.tar&#39;</span><span class="p">),</span>
    <span class="s1">&#39;numItersForTrainExamplesHistory&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>

    <span class="c1"># Define neural network arguments</span>
    <span class="s1">&#39;lr&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>  <span class="c1"># learning rate</span>
    <span class="s1">&#39;dropout&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
    <span class="s1">&#39;epochs&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s1">&#39;batch_size&#39;</span><span class="p">:</span> <span class="mi">64</span><span class="p">,</span>
    <span class="s1">&#39;device&#39;</span><span class="p">:</span> <span class="n">DEVICE</span><span class="p">,</span>
    <span class="s1">&#39;num_channels&#39;</span><span class="p">:</span> <span class="mi">512</span><span class="p">,</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="section-1-plan-using-monte-carlo-tree-search-mcts">
<h1>Section 1: Plan using Monte Carlo Tree Search (MCTS)<a class="headerlink" href="#section-1-plan-using-monte-carlo-tree-search-mcts" title="Permalink to this headline">¶</a></h1>
<p><em>Time estimate: ~30 mins</em></p>
<p><strong>Goal:</strong> Teach students to understand the core ideas behind Monte Carlo Tree Search (MCTS).</p>
<div class="section" id="video-1-plan-with-mcts">
<h2>Video 1: Plan with MCTS<a class="headerlink" href="#video-1-plan-with-mcts" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "ad8f2150ce7a4f53b63b64cffeb94697", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</div>
<div class="section" id="submit-your-feedback">
<h2>Submit your feedback<a class="headerlink" href="#submit-your-feedback" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Plan_with_MCTS_Video&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "6723426d260f488dba277e5dd0c4a907", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</div>
<div class="section" id="coding-exercise-1-mcts-planner">
<h2>Coding Exercise 1: MCTS planner<a class="headerlink" href="#coding-exercise-1-mcts-planner" title="Permalink to this headline">¶</a></h2>
<p>In building the MCTS planner, we will focus on the action selection part, particularly the objective function used. MCTS will use a combination of the current action-value function <span class="math notranslate nohighlight">\(Q\)</span> and the policy prior as follows:</p>
<div class="amsmath math notranslate nohighlight" id="equation-74492143-5204-4208-9feb-6d279bf60ebf">
<span class="eqno">(125)<a class="headerlink" href="#equation-74492143-5204-4208-9feb-6d279bf60ebf" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\underset{a}{\operatorname{argmax}} (Q(s_t, a)+u(s_t, a))
\end{equation}\]</div>
<p>with <span class="math notranslate nohighlight">\(u(s_t, a)=c_{puct} \cdot P(s,a) \cdot \frac{\sqrt{\sum_b N(s,b)}}{1+N(s,a)}\)</span>. This effectively implements an Upper Confidence bound applied to Trees (UCT). UCT balances exploration and exploitation by taking the values stored from the MCTS into account. The trade-off is parametrized by <span class="math notranslate nohighlight">\(c_{puct}\)</span>.</p>
<p><strong>Note</strong>: Polynomial Upper Confidence Trees (PUCT) is the technical term for the alorithm below in which we sequentially run MCTS and store/use information from previous runs to explore and find optimal actions).</p>
<br>
<p><strong>Exercise</strong>:</p>
<ul class="simple">
<li><p>Finish the MCTS planner by using UCT to select actions to build the tree.</p></li>
<li><p>Deploy the MCTS planner to build a tree search for a given board position, producing value estimates and action counts for that position.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MCTS</span><span class="p">():</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">nnet</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      game: OthelloGame instance</span>
<span class="sd">        Instance of the OthelloGame class above;</span>
<span class="sd">      nnet: OthelloNet instance</span>
<span class="sd">        Instance of the OthelloNNet class above;</span>
<span class="sd">      args: dictionary</span>
<span class="sd">        Instantiates number of iterations and episodes, controls temperature threshold, queue length,</span>
<span class="sd">        arena, checkpointing, and neural network parameters:</span>
<span class="sd">        learning-rate: 0.001, dropout: 0.3, epochs: 10, batch_size: 64,</span>
<span class="sd">        num_channels: 512</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="n">game</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span> <span class="o">=</span> <span class="n">nnet</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Qsa</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Stores Q values for s,a (as defined in the paper)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Nsa</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Stores #times edge s,a was visited</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Ns</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Stores #times board s was visited</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Stores initial policy (returned by neural net)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Es</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Stores game.getGameEnded ended for board s</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Vs</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Stores game.getValidMoves for board s</span>

  <span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">canonicalBoard</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform one iteration of MCTS.</span>

<span class="sd">    It is recursively called till a leaf node is found. The action chosen at</span>
<span class="sd">    each node is one that has the maximum upper confidence bound.</span>
<span class="sd">    Once a leaf node is found, the neural network is called to return an</span>
<span class="sd">    initial policy P and a value v for the state. This value is propagated</span>
<span class="sd">    up the search path. In case the leaf node is a terminal state, the</span>
<span class="sd">    outcome is propagated up the search path. The values of Ns, Nsa, Qsa are</span>
<span class="sd">    updated.</span>
<span class="sd">    NOTE: the return values are the negative of the value of the current</span>
<span class="sd">    state. This is done since v is in [-1,1] and if v is the value of a</span>
<span class="sd">    state for the current player, then its value is -v for the other player.</span>

<span class="sd">    Args:</span>
<span class="sd">      canonicalBoard: np.ndarray</span>
<span class="sd">        Canonical Board of size n x n [6x6 in this case]</span>

<span class="sd">    Returns:</span>
<span class="sd">        v: Float</span>
<span class="sd">          The negative of the value of the current canonicalBoard</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">stringRepresentation</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">s</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Es</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">Es</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getGameEnded</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Es</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
      <span class="c1"># Terminal node</span>
      <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Es</span><span class="p">[</span><span class="n">s</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">s</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">:</span>
      <span class="c1"># Leaf node</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">],</span> <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">)</span>
      <span class="n">valids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getValidMoves</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">*</span> <span class="n">valids</span>  <span class="c1"># Masking invalid moves</span>
      <span class="n">sum_Ps_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">])</span>
      <span class="k">if</span> <span class="n">sum_Ps_s</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">/=</span> <span class="n">sum_Ps_s</span>  <span class="c1"># Renormalize</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="c1"># If all valid moves were masked make all valid moves equally probable</span>
        <span class="c1"># NB! All valid moves may be masked if either your NNet architecture is</span>
        <span class="c1"># insufficient or you&#39;ve get overfitting or something else.</span>
        <span class="c1"># If you have got dozens or hundreds of these messages you should</span>
        <span class="c1"># pay attention to your NNet and/or training process.</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;All valid moves were masked, doing a workaround.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">+</span> <span class="n">valids</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">])</span>

      <span class="bp">self</span><span class="o">.</span><span class="n">Vs</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">valids</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">Ns</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

      <span class="k">return</span> <span class="o">-</span><span class="n">v</span>

    <span class="n">valids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Vs</span><span class="p">[</span><span class="n">s</span><span class="p">]</span>
    <span class="n">cur_best</span> <span class="o">=</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
    <span class="n">best_act</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="c1">############################################################################</span>
    <span class="c1">## TODO for students:</span>
    <span class="c1">#  Implement the highest upper confidence bound depending whether we observed</span>
    <span class="c1">#  the state-action pair which is stored in self.Qsa[(s, a)].</span>
    <span class="c1">#  You can find the formula in the slide 52 in video 8 above.</span>
    <span class="c1">#  Fill out function and remove</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Complete the for loop&quot;</span><span class="p">)</span>
    <span class="c1">############################################################################</span>
    <span class="c1"># Pick the action with the highest upper confidence bound</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getActionSize</span><span class="p">()):</span>
      <span class="k">if</span> <span class="n">valids</span><span class="p">[</span><span class="n">a</span><span class="p">]:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Qsa</span><span class="p">:</span>
          <span class="n">u</span> <span class="o">=</span> <span class="o">...</span> <span class="o">+</span> <span class="o">...</span> <span class="o">*</span> <span class="o">...</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="o">...</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="o">...</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">u</span> <span class="o">=</span> <span class="o">...</span> <span class="o">*</span> <span class="o">...</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="o">...</span> <span class="o">+</span> <span class="mf">1e-8</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">u</span> <span class="o">&gt;</span> <span class="n">cur_best</span><span class="p">:</span>
          <span class="n">cur_best</span> <span class="o">=</span> <span class="n">u</span>
          <span class="n">best_act</span> <span class="o">=</span> <span class="n">a</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">best_act</span>
    <span class="n">next_s</span><span class="p">,</span> <span class="n">next_player</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getNextState</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
    <span class="n">next_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getCanonicalForm</span><span class="p">(</span><span class="n">next_s</span><span class="p">,</span> <span class="n">next_player</span><span class="p">)</span>

    <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">next_s</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Qsa</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">Qsa</span><span class="p">[(</span><span class="n">s</span><span class="p">,</span> <span class="n">a</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsa</span><span class="p">[(</span><span class="n">s</span><span class="p">,</span> <span class="n">a</span><span class="p">)]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Qsa</span><span class="p">[(</span><span class="n">s</span><span class="p">,</span> <span class="n">a</span><span class="p">)]</span> <span class="o">+</span> <span class="n">v</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsa</span><span class="p">[(</span><span class="n">s</span><span class="p">,</span> <span class="n">a</span><span class="p">)]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">Nsa</span><span class="p">[(</span><span class="n">s</span><span class="p">,</span> <span class="n">a</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">Qsa</span><span class="p">[(</span><span class="n">s</span><span class="p">,</span> <span class="n">a</span><span class="p">)]</span> <span class="o">=</span> <span class="n">v</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">Nsa</span><span class="p">[(</span><span class="n">s</span><span class="p">,</span> <span class="n">a</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">Ns</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">v</span>

  <span class="k">def</span> <span class="nf">getNsa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nsa</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>
<span class="k">class</span> <span class="nc">MCTS</span><span class="p">():</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">nnet</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      game: OthelloGame instance</span>
<span class="sd">        Instance of the OthelloGame class above;</span>
<span class="sd">      nnet: OthelloNet instance</span>
<span class="sd">        Instance of the OthelloNNet class above;</span>
<span class="sd">      args: dictionary</span>
<span class="sd">        Instantiates number of iterations and episodes, controls temperature threshold, queue length,</span>
<span class="sd">        arena, checkpointing, and neural network parameters:</span>
<span class="sd">        learning-rate: 0.001, dropout: 0.3, epochs: 10, batch_size: 64,</span>
<span class="sd">        num_channels: 512</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="n">game</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span> <span class="o">=</span> <span class="n">nnet</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Qsa</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Stores Q values for s,a (as defined in the paper)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Nsa</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Stores #times edge s,a was visited</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Ns</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Stores #times board s was visited</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Stores initial policy (returned by neural net)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Es</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Stores game.getGameEnded ended for board s</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Vs</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Stores game.getValidMoves for board s</span>

  <span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">canonicalBoard</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform one iteration of MCTS.</span>

<span class="sd">    It is recursively called till a leaf node is found. The action chosen at</span>
<span class="sd">    each node is one that has the maximum upper confidence bound.</span>
<span class="sd">    Once a leaf node is found, the neural network is called to return an</span>
<span class="sd">    initial policy P and a value v for the state. This value is propagated</span>
<span class="sd">    up the search path. In case the leaf node is a terminal state, the</span>
<span class="sd">    outcome is propagated up the search path. The values of Ns, Nsa, Qsa are</span>
<span class="sd">    updated.</span>
<span class="sd">    NOTE: the return values are the negative of the value of the current</span>
<span class="sd">    state. This is done since v is in [-1,1] and if v is the value of a</span>
<span class="sd">    state for the current player, then its value is -v for the other player.</span>

<span class="sd">    Args:</span>
<span class="sd">      canonicalBoard: np.ndarray</span>
<span class="sd">        Canonical Board of size n x n [6x6 in this case]</span>

<span class="sd">    Returns:</span>
<span class="sd">        v: Float</span>
<span class="sd">          The negative of the value of the current canonicalBoard</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">stringRepresentation</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">s</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Es</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">Es</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getGameEnded</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Es</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
      <span class="c1"># Terminal node</span>
      <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Es</span><span class="p">[</span><span class="n">s</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">s</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">:</span>
      <span class="c1"># Leaf node</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">],</span> <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">)</span>
      <span class="n">valids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getValidMoves</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">*</span> <span class="n">valids</span>  <span class="c1"># Masking invalid moves</span>
      <span class="n">sum_Ps_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">])</span>
      <span class="k">if</span> <span class="n">sum_Ps_s</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">/=</span> <span class="n">sum_Ps_s</span>  <span class="c1"># Renormalize</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="c1"># If all valid moves were masked make all valid moves equally probable</span>
        <span class="c1"># NB! All valid moves may be masked if either your NNet architecture is</span>
        <span class="c1"># insufficient or you&#39;ve get overfitting or something else.</span>
        <span class="c1"># If you have got dozens or hundreds of these messages you should</span>
        <span class="c1"># pay attention to your NNet and/or training process.</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;All valid moves were masked, doing a workaround.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">+</span> <span class="n">valids</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">])</span>

      <span class="bp">self</span><span class="o">.</span><span class="n">Vs</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">valids</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">Ns</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

      <span class="k">return</span> <span class="o">-</span><span class="n">v</span>

    <span class="n">valids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Vs</span><span class="p">[</span><span class="n">s</span><span class="p">]</span>
    <span class="n">cur_best</span> <span class="o">=</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
    <span class="n">best_act</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="c1"># Pick the action with the highest upper confidence bound</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getActionSize</span><span class="p">()):</span>
      <span class="k">if</span> <span class="n">valids</span><span class="p">[</span><span class="n">a</span><span class="p">]:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Qsa</span><span class="p">:</span>
          <span class="n">u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Qsa</span><span class="p">[(</span><span class="n">s</span><span class="p">,</span> <span class="n">a</span><span class="p">)]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">cpuct</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">a</span><span class="p">]</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ns</span><span class="p">[</span><span class="n">s</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nsa</span><span class="p">[(</span><span class="n">s</span><span class="p">,</span> <span class="n">a</span><span class="p">)])</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">cpuct</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ps</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">a</span><span class="p">]</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ns</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1e-8</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">u</span> <span class="o">&gt;</span> <span class="n">cur_best</span><span class="p">:</span>
          <span class="n">cur_best</span> <span class="o">=</span> <span class="n">u</span>
          <span class="n">best_act</span> <span class="o">=</span> <span class="n">a</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">best_act</span>
    <span class="n">next_s</span><span class="p">,</span> <span class="n">next_player</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getNextState</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
    <span class="n">next_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getCanonicalForm</span><span class="p">(</span><span class="n">next_s</span><span class="p">,</span> <span class="n">next_player</span><span class="p">)</span>

    <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">next_s</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Qsa</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">Qsa</span><span class="p">[(</span><span class="n">s</span><span class="p">,</span> <span class="n">a</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsa</span><span class="p">[(</span><span class="n">s</span><span class="p">,</span> <span class="n">a</span><span class="p">)]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Qsa</span><span class="p">[(</span><span class="n">s</span><span class="p">,</span> <span class="n">a</span><span class="p">)]</span> <span class="o">+</span> <span class="n">v</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsa</span><span class="p">[(</span><span class="n">s</span><span class="p">,</span> <span class="n">a</span><span class="p">)]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">Nsa</span><span class="p">[(</span><span class="n">s</span><span class="p">,</span> <span class="n">a</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">Qsa</span><span class="p">[(</span><span class="n">s</span><span class="p">,</span> <span class="n">a</span><span class="p">)]</span> <span class="o">=</span> <span class="n">v</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">Nsa</span><span class="p">[(</span><span class="n">s</span><span class="p">,</span> <span class="n">a</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">Ns</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">v</span>

  <span class="k">def</span> <span class="nf">getNsa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nsa</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id1">
<h3>Submit your feedback<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_MCTS_Planner_Exercise&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "9dcc0274abdc4d618c6d260573897277", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="section-2-use-mcts-to-play-games">
<h1>Section 2: Use MCTS to play games<a class="headerlink" href="#section-2-use-mcts-to-play-games" title="Permalink to this headline">¶</a></h1>
<p><em>Time estimate: ~10 mins</em></p>
<p><strong>Goal:</strong> Learn how to use the results of MCTS to play games.</p>
<p><strong>Exercise:</strong></p>
<ul class="simple">
<li><p>Plug the MCTS planner into an agent.</p></li>
<li><p>Play games against other agents.</p></li>
<li><p>Explore the contributions of prior network, value function, number of simulations/time to play and explore/exploit parameters.</p></li>
</ul>
<div class="section" id="video-2-play-with-mcts">
<h2>Video 2: Play with MCTS<a class="headerlink" href="#video-2-play-with-mcts" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "6ce738220a154cc6b4b0b4cf46440ede", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</div>
<div class="section" id="id2">
<h2>Submit your feedback<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Play_with_MCTS_Video&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "8aa0375dbaba4240a830bbb7ee647686", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</div>
<div class="section" id="coding-exercise-2-agent-that-uses-an-mcts-planner">
<h2>Coding Exercise 2: Agent that uses an MCTS planner<a class="headerlink" href="#coding-exercise-2-agent-that-uses-an-mcts-planner" title="Permalink to this headline">¶</a></h2>
<p>Now we can use the MCTS planner and play the game! We will again let the MCTS planner play against players with other policies.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load MCTS model from the repository</span>
<span class="n">mcts_model_save_name</span> <span class="o">=</span> <span class="s1">&#39;MCTS.pth.tar&#39;</span>
<span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;nma_rl_games/alpha-zero/pretrained_models/models/&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MonteCarloTreeSearchBasedPlayer</span><span class="p">():</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">nnet</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      game: OthelloGame instance</span>
<span class="sd">        Instance of the OthelloGame class above;</span>
<span class="sd">      nnet: OthelloNet instance</span>
<span class="sd">        Instance of the OthelloNNet class above;</span>
<span class="sd">      args: dictionary</span>
<span class="sd">        Instantiates number of iterations and episodes, controls temperature threshold, queue length,</span>
<span class="sd">        arena, checkpointing, and neural network parameters:</span>
<span class="sd">        learning-rate: 0.001, dropout: 0.3, epochs: 10, batch_size: 64,</span>
<span class="sd">        num_channels: 512</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="n">game</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span> <span class="o">=</span> <span class="n">nnet</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mcts</span> <span class="o">=</span> <span class="n">MCTS</span><span class="p">(</span><span class="n">game</span><span class="p">,</span> <span class="n">nnet</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">canonicalBoard</span><span class="p">,</span> <span class="n">temp</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      canonicalBoard: np.ndarray</span>
<span class="sd">        Canonical Board of size n x n [6x6 in this case]</span>
<span class="sd">      temp: Integer</span>
<span class="sd">        Signifies if game is in terminal state</span>

<span class="sd">    Returns:</span>
<span class="sd">      List of probabilities for all actions if temp is 0</span>
<span class="sd">      Best action based on max probability otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">numMCTSSims</span><span class="p">):</span>

      <span class="c1">##########################################################################</span>
      <span class="c1">## TODO for students:</span>
      <span class="c1">#  Run MCTS search function.</span>
      <span class="c1">#  Fill out function and remove</span>
      <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Plug the planner&quot;</span><span class="p">)</span>
      <span class="c1">##########################################################################</span>
      <span class="o">...</span>

    <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">stringRepresentation</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">)</span>
    <span class="c1">############################################################################</span>
    <span class="c1">## TODO for students:</span>
    <span class="c1">#  Call the Nsa function from MCTS class and store it in the self.Nsa</span>
    <span class="c1">#  Fill out function and remove</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Compute Nsa (number of times edge s,a was visited)&quot;</span><span class="p">)</span>
    <span class="c1">############################################################################</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Nsa</span> <span class="o">=</span> <span class="o">...</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">counts</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsa</span><span class="p">[(</span><span class="n">s</span><span class="p">,</span> <span class="n">a</span><span class="p">)]</span> <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nsa</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getActionSize</span><span class="p">())]</span>

    <span class="k">if</span> <span class="n">temp</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">bestAs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">)))</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
      <span class="n">bestA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">bestAs</span><span class="p">)</span>
      <span class="n">probs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">)</span>
      <span class="n">probs</span><span class="p">[</span><span class="n">bestA</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="k">return</span> <span class="n">probs</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">counts</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">**</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">temp</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">counts_sum</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">))</span>
    <span class="n">probs</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts_sum</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">getActionProb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">canonicalBoard</span><span class="p">,</span> <span class="n">temp</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      canonicalBoard: np.ndarray</span>
<span class="sd">        Canonical Board of size n x n [6x6 in this case]</span>
<span class="sd">      temp: Integer</span>
<span class="sd">        Signifies if game is in terminal state</span>

<span class="sd">    Returns:</span>
<span class="sd">      action_probs: List</span>
<span class="sd">        Probability associated with corresponding action</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">action_probs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getActionSize</span><span class="p">()))</span>
    <span class="n">best_action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">)</span>
    <span class="n">action_probs</span><span class="p">[</span><span class="n">best_action</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">action_probs</span>


<span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
<span class="n">game</span> <span class="o">=</span> <span class="n">OthelloGame</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">rp</span> <span class="o">=</span> <span class="n">RandomPlayer</span><span class="p">(</span><span class="n">game</span><span class="p">)</span><span class="o">.</span><span class="n">play</span>  <span class="c1"># All players</span>
<span class="n">num_games</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># Games</span>
<span class="n">n1</span> <span class="o">=</span> <span class="n">NNet</span><span class="p">(</span><span class="n">game</span><span class="p">)</span>  <span class="c1"># nnet players</span>
<span class="n">n1</span><span class="o">.</span><span class="n">load_checkpoint</span><span class="p">(</span><span class="n">folder</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">mcts_model_save_name</span><span class="p">)</span>
<span class="n">args1</span> <span class="o">=</span> <span class="n">dotdict</span><span class="p">({</span><span class="s1">&#39;numMCTSSims&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;cpuct&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">})</span>

<span class="c1">## Uncomment below to check your agent!</span>
<span class="c1"># print(&#39;\n******MCTS player versus random player******&#39;)</span>
<span class="c1"># mcts1 = MonteCarloTreeSearchBasedPlayer(game, n1, args1)</span>
<span class="c1"># n1p = lambda x: np.argmax(mcts1.getActionProb(x, temp=0))</span>
<span class="c1"># arena = Arena.Arena(n1p, rp, game, display=OthelloGame.display)</span>
<span class="c1"># MCTS_result = arena.playGames(num_games, verbose=False)</span>
<span class="c1"># print(f&quot;\nNumber of games won by player1 = {MCTS_result[0]}, &quot;</span>
<span class="c1">#       f&quot;number of games won by player2 = {MCTS_result[1]}, out of {num_games} games&quot;)</span>
<span class="c1"># win_rate_player1 = MCTS_result[0]/num_games</span>
<span class="c1"># print(f&quot;\nWin rate for player1 over {num_games} games: {round(win_rate_player1*100, 1)}%&quot;)</span>

</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Number</span> <span class="n">of</span> <span class="n">games</span> <span class="n">won</span> <span class="n">by</span> <span class="n">player1</span> <span class="o">=</span> <span class="mi">19</span><span class="p">,</span> <span class="n">num</span> <span class="n">of</span> <span class="n">games</span> <span class="n">won</span> <span class="n">by</span> <span class="n">player2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">out</span> <span class="n">of</span> <span class="mi">20</span> <span class="n">games</span>

<span class="n">Win</span> <span class="n">rate</span> <span class="k">for</span> <span class="n">player1</span> <span class="n">over</span> <span class="mi">20</span> <span class="n">games</span><span class="p">:</span> <span class="mf">95.0</span><span class="o">%</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>
<span class="k">class</span> <span class="nc">MonteCarloTreeSearchBasedPlayer</span><span class="p">():</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">nnet</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      game: OthelloGame instance</span>
<span class="sd">        Instance of the OthelloGame class above;</span>
<span class="sd">      nnet: OthelloNet instance</span>
<span class="sd">        Instance of the OthelloNNet class above;</span>
<span class="sd">      args: dictionary</span>
<span class="sd">        Instantiates number of iterations and episodes, controls temperature threshold, queue length,</span>
<span class="sd">        arena, checkpointing, and neural network parameters:</span>
<span class="sd">        learning-rate: 0.001, dropout: 0.3, epochs: 10, batch_size: 64,</span>
<span class="sd">        num_channels: 512</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game</span> <span class="o">=</span> <span class="n">game</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nnet</span> <span class="o">=</span> <span class="n">nnet</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mcts</span> <span class="o">=</span> <span class="n">MCTS</span><span class="p">(</span><span class="n">game</span><span class="p">,</span> <span class="n">nnet</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">canonicalBoard</span><span class="p">,</span> <span class="n">temp</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      canonicalBoard: np.ndarray</span>
<span class="sd">        Canonical Board of size n x n [6x6 in this case]</span>
<span class="sd">      temp: Integer</span>
<span class="sd">        Signifies if game is in terminal state</span>

<span class="sd">    Returns:</span>
<span class="sd">      List of probabilities for all actions if temp is 0</span>
<span class="sd">      Best action based on max probability otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">numMCTSSims</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">mcts</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">)</span>

    <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">stringRepresentation</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Nsa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcts</span><span class="o">.</span><span class="n">getNsa</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">counts</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsa</span><span class="p">[(</span><span class="n">s</span><span class="p">,</span> <span class="n">a</span><span class="p">)]</span> <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nsa</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getActionSize</span><span class="p">())]</span>

    <span class="k">if</span> <span class="n">temp</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">bestAs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">)))</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
      <span class="n">bestA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">bestAs</span><span class="p">)</span>
      <span class="n">probs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">)</span>
      <span class="n">probs</span><span class="p">[</span><span class="n">bestA</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="k">return</span> <span class="n">probs</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">counts</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">**</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">temp</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">counts_sum</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">))</span>
    <span class="n">probs</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts_sum</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">getActionProb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">canonicalBoard</span><span class="p">,</span> <span class="n">temp</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">      canonicalBoard: np.ndarray</span>
<span class="sd">        Canonical Board of size n x n [6x6 in this case]</span>
<span class="sd">      temp: Integer</span>
<span class="sd">        Signifies if game is in terminal state</span>

<span class="sd">    Returns:</span>
<span class="sd">      action_probs: List</span>
<span class="sd">        Probability associated with corresponding action</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">action_probs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">game</span><span class="o">.</span><span class="n">getActionSize</span><span class="p">()))</span>
    <span class="n">best_action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">canonicalBoard</span><span class="p">)</span>
    <span class="n">action_probs</span><span class="p">[</span><span class="n">best_action</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">action_probs</span>


<span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
<span class="n">game</span> <span class="o">=</span> <span class="n">OthelloGame</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">rp</span> <span class="o">=</span> <span class="n">RandomPlayer</span><span class="p">(</span><span class="n">game</span><span class="p">)</span><span class="o">.</span><span class="n">play</span>  <span class="c1"># All players</span>
<span class="n">num_games</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># Games</span>
<span class="n">n1</span> <span class="o">=</span> <span class="n">NNet</span><span class="p">(</span><span class="n">game</span><span class="p">)</span>  <span class="c1"># nnet players</span>
<span class="n">n1</span><span class="o">.</span><span class="n">load_checkpoint</span><span class="p">(</span><span class="n">folder</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">mcts_model_save_name</span><span class="p">)</span>
<span class="n">args1</span> <span class="o">=</span> <span class="n">dotdict</span><span class="p">({</span><span class="s1">&#39;numMCTSSims&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;cpuct&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">})</span>

<span class="c1">## Uncomment below to check your agent!</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">******MCTS player versus random player******&#39;</span><span class="p">)</span>
<span class="n">mcts1</span> <span class="o">=</span> <span class="n">MonteCarloTreeSearchBasedPlayer</span><span class="p">(</span><span class="n">game</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">args1</span><span class="p">)</span>
<span class="n">n1p</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">mcts1</span><span class="o">.</span><span class="n">getActionProb</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">temp</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="n">arena</span> <span class="o">=</span> <span class="n">Arena</span><span class="o">.</span><span class="n">Arena</span><span class="p">(</span><span class="n">n1p</span><span class="p">,</span> <span class="n">rp</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="n">OthelloGame</span><span class="o">.</span><span class="n">display</span><span class="p">)</span>
<span class="n">MCTS_result</span> <span class="o">=</span> <span class="n">arena</span><span class="o">.</span><span class="n">playGames</span><span class="p">(</span><span class="n">num_games</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Number of games won by player1 = </span><span class="si">{</span><span class="n">MCTS_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;number of games won by player2 = </span><span class="si">{</span><span class="n">MCTS_result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">, out of </span><span class="si">{</span><span class="n">num_games</span><span class="si">}</span><span class="s2"> games&quot;</span><span class="p">)</span>
<span class="n">win_rate_player1</span> <span class="o">=</span> <span class="n">MCTS_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">num_games</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Win rate for player1 over </span><span class="si">{</span><span class="n">num_games</span><span class="si">}</span><span class="s2"> games: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">win_rate_player1</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Random seed 2023 has been set.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>******MCTS player versus random player******
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of games won by player1 = 19, number of games won by player2 = 1, out of 20 games

Win rate for player1 over 20 games: 95.0%
</pre></div>
</div>
</div>
</div>
<div class="section" id="load-in-trained-value-and-policy-networks">
<h3>Load in trained value and policy networks<a class="headerlink" href="#load-in-trained-value-and-policy-networks" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Load in trained value and policy networks</span>
<span class="n">model_save_name</span> <span class="o">=</span> <span class="s1">&#39;ValueNetwork.pth.tar&#39;</span>
<span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;nma_rl_games/alpha-zero/pretrained_models/models/&quot;</span>
<span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
<span class="n">game</span> <span class="o">=</span> <span class="n">OthelloGame</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">vnet</span> <span class="o">=</span> <span class="n">ValueNetwork</span><span class="p">(</span><span class="n">game</span><span class="p">)</span>
<span class="n">vnet</span><span class="o">.</span><span class="n">load_checkpoint</span><span class="p">(</span><span class="n">folder</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">model_save_name</span><span class="p">)</span>


<span class="n">model_save_name</span> <span class="o">=</span> <span class="s1">&#39;PolicyNetwork.pth.tar&#39;</span>
<span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;nma_rl_games/alpha-zero/pretrained_models/models/&quot;</span>
<span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
<span class="n">game</span> <span class="o">=</span> <span class="n">OthelloGame</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">pnet</span> <span class="o">=</span> <span class="n">PolicyNetwork</span><span class="p">(</span><span class="n">game</span><span class="p">)</span>
<span class="n">pnet</span><span class="o">.</span><span class="n">load_checkpoint</span><span class="p">(</span><span class="n">folder</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">model_save_name</span><span class="p">)</span>


<span class="c1"># Alternative if the downloading of trained model didn&#39;t work (will train the model)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;nma_rl_games/alpha-zero/pretrained_models/models/&#39;</span><span class="p">):</span>
  <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;nma_rl_games/alpha-zero/pretrained_models/data/&quot;</span>
  <span class="n">loaded_games</span> <span class="o">=</span> <span class="n">loadTrainExamples</span><span class="p">(</span><span class="n">folder</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;checkpoint_1.pth.tar&#39;</span><span class="p">)</span>

  <span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
  <span class="n">game</span> <span class="o">=</span> <span class="n">OthelloGame</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
  <span class="n">vnet</span> <span class="o">=</span> <span class="n">ValueNetwork</span><span class="p">(</span><span class="n">game</span><span class="p">)</span>
  <span class="n">vnet</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">loaded_games</span><span class="p">)</span>

  <span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
  <span class="n">game</span> <span class="o">=</span> <span class="n">OthelloGame</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
  <span class="n">pnet</span> <span class="o">=</span> <span class="n">PolicyNetwork</span><span class="p">(</span><span class="n">game</span><span class="p">)</span>
  <span class="n">pnet</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">loaded_games</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Random seed 2023 has been set.
Random seed 2023 has been set.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="mcts-player-against-value-based-player">
<h3>MCTS player against Value-based player<a class="headerlink" href="#mcts-player-against-value-based-player" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">******MCTS player versus value-based player******&#39;</span><span class="p">)</span>
<span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
<span class="n">vp</span> <span class="o">=</span> <span class="n">ValueBasedPlayer</span><span class="p">(</span><span class="n">game</span><span class="p">,</span> <span class="n">vnet</span><span class="p">)</span><span class="o">.</span><span class="n">play</span>  <span class="c1"># Value-based player</span>
<span class="n">arena</span> <span class="o">=</span> <span class="n">Arena</span><span class="o">.</span><span class="n">Arena</span><span class="p">(</span><span class="n">n1p</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="n">OthelloGame</span><span class="o">.</span><span class="n">display</span><span class="p">)</span>
<span class="n">MC_result</span> <span class="o">=</span> <span class="n">arena</span><span class="o">.</span><span class="n">playGames</span><span class="p">(</span><span class="n">num_games</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Number of games won by player1 = </span><span class="si">{</span><span class="n">MC_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;number of games won by player2 = </span><span class="si">{</span><span class="n">MC_result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">, out of </span><span class="si">{</span><span class="n">num_games</span><span class="si">}</span><span class="s2"> games&quot;</span><span class="p">)</span>
<span class="n">win_rate_player1</span> <span class="o">=</span> <span class="n">MC_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">num_games</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Win rate for player1 over </span><span class="si">{</span><span class="n">num_games</span><span class="si">}</span><span class="s2"> games: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">win_rate_player1</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>******MCTS player versus value-based player******
Random seed 2023 has been set.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of games won by player1 = 16, number of games won by player2 = 4, out of 20 games

Win rate for player1 over 20 games: 80.0%
</pre></div>
</div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Number</span> <span class="n">of</span> <span class="n">games</span> <span class="n">won</span> <span class="n">by</span> <span class="n">player1</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span> <span class="n">number</span> <span class="n">of</span> <span class="n">games</span> <span class="n">won</span> <span class="n">by</span> <span class="n">player2</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">out</span> <span class="n">of</span> <span class="mi">20</span> <span class="n">games</span>

<span class="n">Win</span> <span class="n">rate</span> <span class="k">for</span> <span class="n">player1</span> <span class="n">over</span> <span class="mi">20</span> <span class="n">games</span><span class="p">:</span> <span class="mf">85.0</span><span class="o">%</span>
</pre></div>
</div>
</div>
<div class="section" id="mcts-player-against-policy-based-player">
<h3>MCTS player against Policy-based player<a class="headerlink" href="#mcts-player-against-policy-based-player" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">******MCTS player versus policy-based player******&#39;</span><span class="p">)</span>
<span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
<span class="n">pp</span> <span class="o">=</span> <span class="n">PolicyBasedPlayer</span><span class="p">(</span><span class="n">game</span><span class="p">,</span> <span class="n">pnet</span><span class="p">)</span><span class="o">.</span><span class="n">play</span>  <span class="c1"># Policy-based player</span>
<span class="n">arena</span> <span class="o">=</span> <span class="n">Arena</span><span class="o">.</span><span class="n">Arena</span><span class="p">(</span><span class="n">n1p</span><span class="p">,</span> <span class="n">pp</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="n">OthelloGame</span><span class="o">.</span><span class="n">display</span><span class="p">)</span>
<span class="n">MC_result</span> <span class="o">=</span> <span class="n">arena</span><span class="o">.</span><span class="n">playGames</span><span class="p">(</span><span class="n">num_games</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Number of games won by player1 = </span><span class="si">{</span><span class="n">MC_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;number of games won by player2 = </span><span class="si">{</span><span class="n">MC_result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">, out of </span><span class="si">{</span><span class="n">num_games</span><span class="si">}</span><span class="s2"> games&quot;</span><span class="p">)</span>
<span class="n">win_rate_player1</span> <span class="o">=</span> <span class="n">MC_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">num_games</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Win rate for player1 over </span><span class="si">{</span><span class="n">num_games</span><span class="si">}</span><span class="s2"> games: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">win_rate_player1</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>******MCTS player versus policy-based player******
Random seed 2023 has been set.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of games won by player1 = 20, number of games won by player2 = 0, out of 20 games

Win rate for player1 over 20 games: 100.0%
</pre></div>
</div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Number</span> <span class="n">of</span> <span class="n">games</span> <span class="n">won</span> <span class="n">by</span> <span class="n">player1</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">number</span> <span class="n">of</span> <span class="n">games</span> <span class="n">won</span> <span class="n">by</span> <span class="n">player2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">out</span> <span class="n">of</span> <span class="mi">20</span> <span class="n">games</span>

<span class="n">Win</span> <span class="n">rate</span> <span class="k">for</span> <span class="n">player1</span> <span class="n">over</span> <span class="mi">20</span> <span class="n">games</span><span class="p">:</span> <span class="mf">100.0</span><span class="o">%</span>
</pre></div>
</div>
</div>
<div class="section" id="mcts-player-against-monte-carlo-player">
<h3>MCTS player against Monte-Carlo player<a class="headerlink" href="#mcts-player-against-monte-carlo-player" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mc_model_save_name</span> <span class="o">=</span> <span class="s1">&#39;MC.pth.tar&#39;</span>
<span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;nma_rl_games/alpha-zero/pretrained_models/models/&quot;</span>

<span class="n">n2</span> <span class="o">=</span> <span class="n">NNet</span><span class="p">(</span><span class="n">game</span><span class="p">)</span>  <span class="c1"># nNet players</span>
<span class="n">n2</span><span class="o">.</span><span class="n">load_checkpoint</span><span class="p">(</span><span class="n">folder</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">mc_model_save_name</span><span class="p">)</span>
<span class="n">args2</span> <span class="o">=</span> <span class="n">dotdict</span><span class="p">({</span><span class="s1">&#39;numMCsims&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;maxRollouts&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;maxDepth&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;mc_topk&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">******MCTS player versus MC player******&#39;</span><span class="p">)</span>
<span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
<span class="n">mc</span> <span class="o">=</span> <span class="n">MonteCarloBasedPlayer</span><span class="p">(</span><span class="n">game</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">args2</span><span class="p">)</span>
<span class="n">n2p</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">mc</span><span class="o">.</span><span class="n">getActionProb</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">arena</span> <span class="o">=</span> <span class="n">Arena</span><span class="o">.</span><span class="n">Arena</span><span class="p">(</span><span class="n">n1p</span><span class="p">,</span> <span class="n">n2p</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="n">OthelloGame</span><span class="o">.</span><span class="n">display</span><span class="p">)</span>
<span class="n">MC_result</span> <span class="o">=</span> <span class="n">arena</span><span class="o">.</span><span class="n">playGames</span><span class="p">(</span><span class="n">num_games</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Number of games won by player1 = </span><span class="si">{</span><span class="n">MC_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;number of games won by player2 = </span><span class="si">{</span><span class="n">MC_result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">, out of </span><span class="si">{</span><span class="n">num_games</span><span class="si">}</span><span class="s2"> games&quot;</span><span class="p">)</span>
<span class="n">win_rate_player1</span> <span class="o">=</span> <span class="n">MC_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">num_games</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Win rate for player1 over </span><span class="si">{</span><span class="n">num_games</span><span class="si">}</span><span class="s2"> games: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">win_rate_player1</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>******MCTS player versus MC player******
Random seed 2023 has been set.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of games won by player1 = 13, number of games won by player2 = 7, out of 20 games

Win rate for player1 over 20 games: 65.0%
</pre></div>
</div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Number</span> <span class="n">of</span> <span class="n">games</span> <span class="n">won</span> <span class="n">by</span> <span class="n">player1</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="n">number</span> <span class="n">of</span> <span class="n">games</span> <span class="n">won</span> <span class="n">by</span> <span class="n">player2</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">out</span> <span class="n">of</span> <span class="mi">20</span> <span class="n">games</span>

<span class="n">Win</span> <span class="n">rate</span> <span class="k">for</span> <span class="n">player1</span> <span class="n">over</span> <span class="mi">20</span> <span class="n">games</span><span class="p">:</span> <span class="mf">80.0</span><span class="o">%</span>
</pre></div>
</div>
<div class="section" id="id3">
<h4>Submit your feedback<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Play_Games_MCTS_Exercise&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "4e8c00b114ab4a9698eaa07cda901c4b", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial, you have learned about players with Monte Carlo Tree Search planner and compared them to random, value-based, policy-based, and Monte-Carlo players.</p>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"03b940649f9c41949c171210115ad76e": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "049dca388e224011ae79b667040eb3d2": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "04e4ed2d93894098959af9b889c4b513": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": ["medium"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude10", "disabled": false, "icon": "", "layout": "IPY_MODEL_bd4f11e661be4793807c140386e46d34", "style": "IPY_MODEL_c11497cdd67e4e50aa623bcbcea198b3", "tooltip": "Medium"}}, "0596d5e841614c688128099074d139c4": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "0794e8ce5cf74c62838b451a5fb28019": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "07fe32a219784c55b5f7f6f850dab2d7": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_eb2f5c677ba24151a2da84c1889e5f1d", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "If you want to download the slides: https://osf.io/download/h4utj/\n"}, {"data": {"text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://mfr.ca-1.osf.io/render?url=https://osf.io/h4utj/?direct%26mode=render%26action=download%26mode=render\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ", "text/plain": "<IPython.lib.display.IFrame at 0x7fbfeff53790>"}, "metadata": {}, "output_type": "display_data"}]}}, "0ca4f2cbbc97412c98336de3ab3932da": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": ["happy"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude42", "disabled": false, "icon": "", "layout": "IPY_MODEL_fd83fb07e7b44b9cab8bdeb2b7c1831a", "style": "IPY_MODEL_74db907959ae47588ff374c99d6d82f6", "tooltip": "Happy"}}, "0e4d25bd7c2144f0af975b4b6917121f": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_527754e01af6425fbe1c23298f2d1fc8", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "Video available at https://youtube.com/watch?v=1BRXb-igKAU\n"}, {"data": {"image/jpeg": "/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEABALDBoXFhoaGRoeHRofIyglIiIgIjIrMSYtLic7MjItNjY3QFBCNThLPy01RWFFS19WW1xbMkFlbWRYbFBZW1cBERISGRYZJRsbLVdCNT1XV1dXV11XV1dXY1daXVdXV1dXV1dXV1dXYFdXXV1fV1dXV1dXZF1XV1dXV1ddV1dXV//AABEIAWgB4AMBIgACEQEDEQH/xAAbAAEAAQUBAAAAAAAAAAAAAAAABAECAwUHBv/EAEgQAAIBAgIGBwYEAwYEBQUAAAABAgMRBBIFEyExUZIXMkFTcZHSFRYiUmGBBhRUoyOhsTNCcqLh8IKywfEkYoOT0SU1Q3N0/8QAGAEBAQEBAQAAAAAAAAAAAAAAAAIBAwT/xAAdEQEBAQEAAwEBAQAAAAAAAAAAARECEiExAxNB/9oADAMBAAIRAxEAPwDn4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPX9HGN73D80/QOjjG97h+afoA8gD1/Rxje9w/NP0Do4xve4fmn6APIA9f0cY3vcPzT9A6OMb3uH5p+gDyAPX9HGN73D80/QOjjG97h+afoA8gD1/Rxje9w/NP0Do4xve4fmn6APIA9f0cY3vcPzT9A6OMb3uH5p+gDyAPX9HGN73D80/QOjjG97h+afoA8gD1/Rxje9w/NP0Do4xve4fmn6APIA9f0cY3vcPzT9A6OMb3uH5p+gDyAPX9HGN73D80/QOjjG97h+afoA8gD1/Rxje9w/NP0Do4xve4fmn6APIA9f0cY3vcPzT9A6OMb3uH5p+gDyAPX9HGN73D80/QOjjG97h+afoA8gD1/Rxje9w/NP0Do4xve4fmn6APIA9f0cY3vcPzT9A6OMb3uH5p+gDyAM0cNJpO6K/lZcUBgBn/Ky4oflZcUBgBn/ACsuKH5WXFAYAZ/ysuKH5WXFAYAZ/wArLih+VlxQGAGf8rLih+VlxQGAGf8AKy4oflZcUBgBn/Ky4oflZcUBgBn/ACsuKH5WXFAYAenX4FxT/wDyUOaXpK+4eL7yhzS9JnlDHlwep9wcX3lDml6SvuBi+8oc0vSPKDyoPUe4eL7yhzS9JZL8D4pb6lDml6RsHmgegX4RrN2VbDt8M8vSX+5eJ7yjzS9I2DzgPRe5uJ+ejzS9Jb7n4n56PNL0jYPPg3/ujiPnpc0vSU90sR89Lml6RsHRPfDR/wCo/bqeke+Gj/1H7dT0nLcy4rzJukMTh5qnqo5bdbs+318RqpzLLddF98NH/qP26npHvjo/9R+3U9JzR1qWeDteKazLir7UZNJ4ihOonRSjG1n2XfgN94jfeOj++Gj/ANR+3U9I98NH/qP26npOWZlxXmVzLivM1rqXvho/9R+3U9I98NH/AKj9up6TluZcV5lMy4rzA6n74aP/AFH7dT0j3w0f+o/bqek5ZnXFeYzrivMDqfvho/8AUft1PSPfDR/6j9up6TlmdcV5jMuK8wOp++Gj/wBR+3U9I98NH/qP26npOW5lxXmUzLivMDqfvho/9R+3U9I98NH/AKj9up6TlmZcV5jMuK8wOp++Gj/1H7dT0j3w0f8AqP26npOWZ1xXmM64rzA6n74aP/Uft1PSPfDR/wCo/bqek5ZmXFeYzLivMDqfvho/9R+3U9I98NH/AKj9up6TlmdcV5jMuK8wOp++Gj/1H7dT0j3w0f8AqP26npOWZlxXmVzLivMDqXvho/8AUft1PSPfDR/6j9up6TluZcUMy4rzA6l74aP/AFH7dT0j3w0f+o/bqek5bmXFDMuK8wOpe+Gj/wBR+3U9I98NH/qP26npOW5lxXmMy4oCtONopbN3Eut4eZaAYut4eYt4eZaAYut4eYt4FoBi63h5i3h5loBi63h5i3h5loBi63h5i3h5loBi63h5i3h5loBi6wt4eZaAYut4C3h5loBjqeHqZopkqEbmhoaRpZ3SU0pJfYpQr4ieIp55pU4bb07pS29t/wDU5WN8npoUzJqy2hiITXwyT+5mbS3tIic2t1ErQsrnldPaQzfwoS/xWN1+IMSlHJmtG15W/oeJxeLjaWXY35nfj88m1HXSJKcITV5yjJSdtnDtPU6M0tGslBv47ef1PFYmqp552232eRHw2JlSqRnF7Yu5tkI6XJljZrqGl41IKag7NfNH/qy/2in/AHJecf8A5Oa0tlGUhPMk12hgeg9l0u7hyor7Lpd3DlROB0Sg+y6Xdw5UPZdLu4cqJwAgey6Xdw5UPZdLu4cqJ4Agey6Xdw5UV9l0u7hyonACD7Lpd3DlRT2XS7uHKieAIHsul3cOVFfZdLu4cqJwAgey6Xdw5UPZdLu4cqJ4Agey6Xdw5UV9l0u7hyonACD7Lpd3DlQ9l0u7hyonACB7Lpd3DlQ9l0u7hyongCB7Lpd3DlQ9l0u7hyongCB7Lpd3DlQ9l0u7hyongCB7Lpd3DlQ9l0u7hyongCB7Lpd3DlQ9l0u7hyongCB7Lpd3DlQ9mUu7hyonlAOIU18K8EXZSlLqx8EXBKmUZSoAplGUqAKZRlKgCmUZSoAplGUqAKZRlKgCmUZSoAplCjtKhAZ6dV6xuL+JSe21/vusT8bJzpU4yqTdafU3Jb9t91jWTqWlUaVlmb2795jlOrKDinLK99tz4XMliJ9bfAU8XKcJSlU+G15N2SS+naRK2Ik607yfWe9/Uz4TEKrUjhI66EnKyaktskrWy7OHE9roj8NUqFKf5uFCrJNy1jhtt23bMvc5+r8bWjrVs+HjTppzkopt2NL7Mr1JdRrxR63RleksTWjShFQeZQlF7JZX2eCkS6tVXK/p5RfP5vJS/DU3FfEkzVaU0PLDJOTunwPe57mv0vgY4mnkk7dqsc/J6P5zPTxuFwsqlNTvaN7XZMwuDcatNuS6y48TZ+zsmHpUpXVrtZY3v/u4p6ObnGSVWTTT3W/qNrl1znpusN/Zx8C6bJmA0RUlCOZqOzt2mHS/4eqSismIyJO/U2u21du4al6oAHRIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQqUA4jT6q8EXFtLqx8EXBIAAAAAAAAAAAAAAAAAAABVbzRN0xhsnxwtJbp+f+0ayOKnd28bcET8ROrOjKLu6ebavrfZ9iFiMFUUnFUpNtJppPdbgZcRx7+t9oGeGrYiGJqz/juVnBKyzZdk7/AF/q0ex0ri//AAtf/wDXP/lPEfh/B1aTnOacIpqyk+1dv+pttJaQawk1kk4uLWdNbLrY2jh1ztd5cTK9bLPR72bHl5qf+hTGYydKdpw8rmt0vWhCNCq5WalBq3Bb2bZaRp16MakLtbryjb77TpOcbz1tR8VVqrLaLyvfbYzNQg7Xat9C7SGkaOZQjLb2f6lIYpSTSadt9jK9POIWO0i6U4rKnaOy7+rIr09WXVyR/wCG/wDU2OJw0akdq222PgeSddSvF7GmdPzvNjy/vz1Otb9/irGJWVRLwijLT/FVZQUZ2nbbtvd/e5r9GYCFfZOtGG7Y+37lmk8LCjU1abUtmxu919jpZz8xxnl9dWABzdAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAChUoBxGn1V4IuLaXVXgi4JAAAAAAAAAAAAAAAAAAAAAHoKtSMsP1fjksqS7b9v2M+jKMsTLJSbzpWlUXVh2v/saOOJg5QzxkoQatGDs7dtm+18T0tP8aUqdLVUsK4R22tJdv22s21HHGf6ux2hqWTZUqykneU6k9j47NyRp6blXlOhQatJWnN7VaP8AQtx+nHWoypWlHNvd1uvexl0dpylhcO6VKjLNLrzcleX03bEuBtk9SNk6vVt9LqmBo00s16ku3M3lv4F8cTKUKlldRV3FfKnZ/wBTVYjH5+xoyYDSaozUsrlHapLimrNfzL3n4nOvrcywkJxhUjLY/rYzxcc1o9i2s8rPEN9WUo7TNDSlVJpyW6yajtvx3nK8yvVz+uT23ukdIxo0229r3LizyNO7bb7dpdVUqks05uT+q/1LopL/ALG8yRH6d3pnpzM0ZJu72viRVJfUyU6sU/izW+li9jnjswAOawAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAChUoBxGl1Y+CLi2n1V4IuCQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB20ABQAAAAAAACgKTTaaTs7bHw+p53EU8XDFYeh+em1VjUblqqd1kS+n1A9GCHgqmWToTrOrWhFTk3FR+GTdtyt2NfYj6U01Cjh8TODzVKN42cZNKeTMk7dm1bd31A2hUgQ0tR/LqvOWSGxPNFx28Emrv6cSuC0tRrzcIOSqJXyVIShK3FKSTa+oE0EGlpihUqaqE81TNKLSi3lcb3zbNi2Pfv7DFhtJwhhaVWtWjPPsUoQazu7sow2u9lu+gGzBDwOk6WIco03JShbNGcJQkr7naSTt9TH+HsTOvgqFWo805xvJ2td3+gGwBq9OaT1EMkM+tqOMYONNySu9r3WbSTdvoQ1p5qlja6U5QpX1ScJRTUEk7trfnvs7EgPQFTz2IWNw+HeKeJVVwjrKlJ04qDileSi18SdtzbZvqVRTjGUd0kmvBq4F4AAAAAAABQqUA4jS6sfBFxbT6q8EXBIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7aAAoAAAAAAAANNpB/wD1LA/4K/8ASJuSllvttA0U8XToaTqutONNTw9PK5uyllnO9m+F0QnUVXDaalC7UnO2x7f/AA8T1E6cZWzRTtuur2LrLbs37wPOYzF0pLAYlTjUw9GVqkovMoN07Rk7cL/a5lxOKp4nG4NYeUakqUpzqTg7qMHBrK2uLa2fQ3kKcYqyikuCVhCnGKtGKivorAaj8OL+FifrisRf/wBxmtwmKlTwOjoqpqadRtTq2Xw7G0k3sWZ7Ls9Wkl2FHBNZWk48LbANDgJp6SklW1yWGtm2X/tNzcdjJP4T/wDt2F/wf9WbWMErWSVtmxFUrbFsQHnNL4musRKUXSccNDNFOL69S8ILf1rX5jZYHBOlhNTXyTiotSyxfxK3xXW27bv5mwyrgi4DxeLeEeGdLD4iriJzjko4d1HLLJ7FeO9KN7/FuseuwlHV0qdO98kYxv4KxeqcU21FJve0tpcBUAAAAAAAAoVKAcRpdWPgi4tp9VeCLgkbN7HQVNWpzqVnXdNTapUXONPMrxUrbbv6GiN5hvxLKnkm6MZV4RUFV1ko3S6ueK2TtftAgrQ+IdHXZFlyudsyzZFvll32M2G0FVlOjnyqnUqQg5QnGTg5brpPYy5acagv4MdeqLoKtmeyD/8ALuvt3kmp+KZtr+ClapTqW1jaTp7lFW+FPgg1qMXhJUrN2yyc8rum2oycdqW7cUdBfl1VvtdWVO3hBSv/AJhia0Z2apqEryc2pN53KV9t91r2L8PioxpulUp6yDlnVpuDUrWe1J7Gktn0DGepoiedxhKOW9ON5yUbynTUlFX7dpTB6JnUlHO4wUs9k5LM8id7R7UmreZbW0nKbu4RX8WFVJPYskcqj4WW8yx0us0ZyoqVSGfLLO1ZTcnZq222d2Yai/kamRT+Hqxk45lmUZWtJx3pbV5oyVNF1YZszpxyvK71I9bb8N79bZuL6ml5ypxi8+ZRhFtVZKLUbLqbtqVn2dtiuH0rkq1amRt1JubiqjUXdt5ZRtaa2gY6mjZRdNayl/EpqpdzSUU+x/748CsNE1nJxtCLU9X8U4q87J5Vt23TVi6npTLGK1bTVJUnKFRxlZSzJp2+Hg99ytXS8pVIzyK8ayrWzPa1GKt/k3/UCzC6MnOzk4wThUmk5LM1CMndR32vGxHwVDW1qVNu2ecY34XdiVHSa+GUqKlUjCVOM87XwyUluttaU2RMJX1VWnUSu4SjKz7bO9gxm9m1LxSyNSUnmU4uKUOtme5Wur+KEtG1U0klK7gk4yTTz3ytPg8r2/Qrh8fkgoOClD+IpK9syqKN1fstkTuZYaXlBvJBRhqtXGLd8vxZlO/bJNt/cCJWws6avNJfHKG19sLKX2V95Kr6HnCpOGem4xypzc1GN5K6jdvf9PuYMdjZV9XmSWSCjs/vPtk/qyRW0nCpmVShmjJxk0qjXxxjlunbc12fzDUT8rPPODjaUFJyT7FBXl/QyU9H1JLN8EY5YyzTmoq0m1Ha+1uL8i5aQbr1K04qWsU1KKdtk4uLSfZsf8jNS0soTjKNOUVCEYJRrNXUZN/FstJPNtTXYGI0MBUcMyy7VJxi5LNJR3uK7UrPyZfg9H62GfPFLW06bV1f43vS/wB328DM9MTdNQtKLSko6urKEUm27ZVsdrtdmzfcj4PGaqLi4Zvjp1F8VrODduzatrAvq6LqRlaOSScpxupppZNrzP8Au2W1kevh5U2ruLUleMotSjJXtsa+qaJWG0rKk3ljvqVJv4mtk4ZXFNbVs7TBjcW60k3nslZKdRzf12vd9gI4AAAADtoACgAAChUoBpVpHF1K+Ip0KVBxozUL1JyTd4qXYnxLXp6aoYiU6SjXoThGcM118TVmn2pp/wAiNg6OJli8fqK9OlHXRup0s93qo7b5lYu0po38vgcTKVR1atWdOVSbSV2pxSSS3JJAb+viIU1epOMFxlJL+pdrY2i80bS6u1bfDiabFLX46dOnRoudKnHNOsnLZNu0Yrs3O78CBh8FKeExUKcVGpQxMp0Yxd1GUbSyr6O7XhID1MppWu0ruyu974CU0rXaV3ZXe9miwuJjj8VRqR20aFNVP/VqR2LxjG/MiX+I6TeFlUirzoONaNuNN5mvuk19wNlnV7XV7XtfbYj4zFOEf4cYzkpRTi5qNlJ79v0227TQyrqdf2hF/wAKnUhRTvsdNq05c81yGGrHNgZYh78Ri6VRf4NdGMP8qXmB6GOk6bxMsPdZoxUr5lZ3bWXjfYYsDpaFSnKdWUKdqtSmrySvkm49vbsItHC0/a1V6uF1QhJPKus5yvLx+pg0Lo6jUw+Jc6UJuVbEJuSvs1ktivu+wHojTLTjWkZYSUEoWWWpffJxzZWvBS8jP+GpN6PwrbbeqhtfgafG4SVXEaRdP+1pfl6tP/FCMnb7q6+4Gy/Emm3gqcHCCqVJN/C3a0Uvik/DZ5mfSOlHRdOnTpuriKvUpp2VlvlJ9kUebxtdY3C43GpPV6uNKjfheMpvm2f8JuKk1R0nSnUdoVqGrhJ7lNSzZb9jaf8AICRDF42E4a7D0505NJuhJtwv2tSSuvqjBpPSWNw9nqsO4Sqxpw/iSv8AFK0W/hNviMTTpZdZOMM0lGOZ2u3uS+pq/wAT/wBlh/8A+qh/zgX19JV8PQnUxNOnmzRjTjSm3mcnZJuSVtrKwxOOjKGsw9GUJNKWqqPNC/b8SSaXaStK06E6Lp4lxVObUfill2t7LPjfcabG06+jowq08TOtRzwg6Na0m1KSj8MlZ3V+2+4D0hUAAAABQqUA4jS6sfBFxbT6q8EXBISvZ1a6vC1459soq0dnxNt7FtW1kU2VLSuWpUbi1GpCnB5WrrJGKTWZNf3dzXaBG9n1ryWS2V2d5RW217K7+LZt2X2FkcLNu2V9WM/CMmkpf5l5k+lpZKU3NVKkXa0JSg4tKNkpLJ/ONuH1Ma0hBQ/s5azUwot51ltCUWmla93kXaBTEaHqQtlyyTnVgviS/s3tk7vYtje3d5ER4eaqKnlvNtJKLUrt7rW2PeT3pSLkpZakZKrWmnCaWyq7tbYu9vJq5gePSxUa8IJZWvh2LNZWbdkkm9u5doF+H0RUlUUJ2iss55lKLTUFtSeaze5WvsvtLMJo/XUsRUjL+ySai1tmndvt2NKLZfHHwpwVOlCWrUaq+OSbbqQUL7ElZJLZ2mPA6QdBPKrtzpz39kM14/dSsBnjoaTp0JucVrVOUrr+zhGObM+N4tO31XEjypYe6tXm47U/4XxLg+tZp+N/oSZaZbd3TTi51G432OnOChq/paMVZ/REKvKjZKlCad7uVSab8EkkrfXeGp8tEQ11anGpUnqU8+WleTall+GKltXa3ssQ6WE1mIjRpTzZpKKlJZPNPdYyTxlOeIq1ZxqLPJyi6c8soNu+x2sytXSWbFU6+V/A6eyUrylkttk7bZO212DGKOjqzUmoXSclslHbl62VX+K30uY8PhZ1VJwSajbM3JRSvuu20uwm0tJU4OnJU5uVFy1V5q1pScln2bbNvda+4wYKpSVDEQq5mpaqyi0m7Sd2rprYBR6OqKO1WnrJU3B2VssFJttu1vi/kY62DqQV5QsrxV0008yvGzW+6Ts1wJ/tlOd3T2ZpNWabinSjTja6tmShe/1MuH0rFznUlbLClCMYTd3OpCV4S2Lse/6N8QNXDB1JVJU1H443zJtJRy7Hdt2SRk9m1s+TKlK0XtnFXzdWzbs79liujaizVI1GstWDjJyllfWUrqVmr3it+zeTqukqVOeWmm4xhRipwkrvJHbG7jti770lu4AQKejK843jTbXxdqT+F2lsbvs7eBT2dWzOOVJpJtucVG0uq818u3s27TNW0nmd8lvhxEd/fNvh2ZvuZKGllGGrcZZclKN45b3pqSv8UWrPM9gEN4GqlJuFlFyTzNJ/D1rJu7t22I5snpS8Kimp1HPM0pyi43aspdW6a2dW17GvqZczyJqPYpNN+aSAtAAAAAAAB20ABQAABQqAMNHDQhKcoxtKo803xdrX8kVxOHhVg4VI5ou114O6/oZQBExWjaVWaqTi86Vs0ZOLtwbi1dfQt1Cw1OX5agpNyzZItRu3sbu9iJhUDW6C0d+WoZZKKqTnKpUy7s0ney+i2L7GxaurPcyoAiw0dRjQ/LqnFUbOOTss96Lp4KlKnGk4LVxy5Y9iytOPlZEgARK+jqNSrCtKH8SG6SbWy97O29X4mWhhoU4uMIqMZOUmuLk7t/dszADFh6EKUI06ccsIq0UuxFKeGhGpOpGKU6mXO+OXd/UzFAI0tH0XRdDVrVO94dm13f8AMyYnCU61N06sIzg98ZK6MwA12F0HhaM1UhSWddVybk4+F27fYl4jCwqqKqRUlGSmr9kou6ZmAGLEYeFWDhUjGcJb4yV0yFhtAYWlOM4UVmj1btyy+Cb2GyAFCoAAAAChUoBxGn1Y+CLi2l1Y+CLgkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAdtAAUAAAAABjq1owV5yjFcZO39TIa/SzsqNnFPWrbPd1Zb9wEylWjNXhKMlxi0/wCheaP8xKDxEoyg5N0lKdOyiottdt0pLbdviiQ8ROMZpydm4KLzxck5Pam7WS3bXt3/AEA2lwaVzlLZOpJavERjfMnvgntdtu1k/H1WtXFNpzlZWajuTe1tO27sAlSmlvaW97Xw3lU1a99hpVVc1ByeZqOJjfZts0uzYSMbG+CXxONowd19gNipJtpNXW9cCpp62aP5qcask4KLVrbWqad3s2l1fE1XOtaWVwayLNFLqppu+1pttfbZtA2xSUkrXaV3bbxIukarjCDU8l5wTls2Jvbv2EOVR53DO6kI1aVpOzs3e8brfayf3A24NRDEzlUp2qSUas5xs5RbSUZPdbY04/X6j89VlCbj16NOWsVt9TcvtscvugNuDT1MRUjSqyjUulRlJOUoyaaWySt2b/puMmMnOk7urJxjG8rSgpra/is1ZrsS+naBs4zTbSabWx27C4i4SNp13dfFNPY//JHfwJQAAAAAAKFSgHEafVXgi4tpdWPgi4JAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHbQAFAAAAAAWzgpK0kmvqrlwAtjTilZJJcEi1UYqOVRiovssreRkAGPUxtlyxtwsrF04KStJJrg1cuAFqprgvLiHFNWsrbrFwAsVOKVrK261hKlFtNxTa3NrcXgDFXoKoop3+GSl5F0acUklFJLcki8AWKlFNtRSb7bK/iWYfDqmpbXKUnmlJ2u39vokvsZgBjjRirpRir77JbSsqcZNNxTa3XV7F4AoopXst+8qAAAAAAAChUoBxGn1V4IuLaXVj4IuCQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB20ABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQqUA4jT6q8EXFtLqx8EXBIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7aAAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAoVKAcRp9VeCLi2n1Y+CLgkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAdsBA1kuL8ymslxfmFNgDX6yXF+ZXWS4vzAnggayXF+ZTWS4vzA2ANfrJcX5ldZLi/MCeDX6yXF+ZXWS4vzAnggayXF+Y1kuL8wJ4IGslxfmU1kuL8wNgCBrJcX5lNZLi/MDYAgayXF+Y1kuL8wJ4IGslxfmNZLi/MCeCBrJcX5jWS4vzAnggayXF+Y1kuL8wJ4IGslxfmNZLi/MCeCBrJcX5jWS4vzAnggayXF+ZhxWLdODldt9ivvf+1f7Acpp0J5V8E9y/usu1M/knys6RVxlbVOrCrKe9rKlGKcL3Tcnez3cdnYZNE160qMXV+GW3NHNKTUszzXb7OAZjmepn8k+VjUz+SfKzrWsl8z8xrJfM/MGOS6mfyT5WNTP5J8rOtayXzPzGsl8z8wY5LqZ/JPlY1M/knys61rJfM/MayXzPzBjkupn8k+VjUz+SfKzrWsl8z8xrJfM/MGOS6mfyT5WNTP5J8rOtayXzPzGsl8z8wY5LqZ/JPlY1M/knys61rJfM/MayXzPzBjkupn8k+VjUz+SfKzrWsl8z8xrJfM/MGOS6mfyT5WNTP5J8rOtayXzPzGsl8z8wY5LqZ/JPlY1M/knys61rJfM/MayXzPzBjkupn8k+VjUz+SfKzrWsl8z8xrJfM/MGOS6mfyT5WNTP5J8rOtayXzPzGsl8z8wY5LqZ/JPlY1M/knys61rJfM/MayXzPzBjkupn8k+VjUz+SfKzrWsl8z8xrJfM/MGOS6mfyT5WNTP5J8rOtayXzPzGsl8z8wYhaTw2uw9WCScnF5b7Pits8Npr62BxEdmHerjkXVcd6pz2bb/AN9xPR5FwGRcA152dHGppKcmszs7w4xd5bNsesrLaYcPgMVCebWTVskW3OLzR183Ls+SSt2nqMi4DIuAHnKUcTWwU3O7qSccserdQktu21s1nLbxRTG4SvWlOahkzLYnKN18DW9PiekyLgMi4Aea/L4yMZqLaeWq6eWUFFSc5uOa6u98LW+/bemLWNhKbjKbppKMWsjk3eFnu39fst/09NkXAZFwA00MPiZUFF1XSq575moyeTM7Rdtl7W2oh4vRlaWKlVjbI5bLO0ranLvv1c29W+p6XIuAyLgBoKmFrVcFCi4ypzWqjJZ4vMoyjmd1fZZPYWUaGMzpSnKMMyzO8Nycurs2RtlVnt/qeiyLgMi4AedxmCrvFayMFO86bjOUtkIq2aNrprtd1e97PcY1R0hKErzcZbWrOG/I9nbszW4fY9NkXAZFwA87KjjlOCVRuCk7tqDdsye3dstmWzaTNFxrqElXu5Zvhbau1Zdi2Lbf/TcbbIuAyLgBHBIyLgMi4ARwSMi4DIuAEcEjIuAyLgBHBIyLgMi4ARwSMi4DIuAEcEjIuAyLgBHNdpjEunTzRhOpOHxKMYt3unHfa1/iNzkXAtnQhJWlFNJp/dO6YHn5Si458yVWSVoTkpZ1a0m4RXW3qy7TaYWLUW5KzlJytwvuXja33JqpRW6KXgVyLgBHBIyLgMi4ARwSMi4DIuAEcEjIuAyLgBHBIyLgMi4ARwSMi4DIuAEcEjIuAyLgBHBIyLgMi4ARwSMi4DIuAEcEjIuAyLgBHBIyLgMi4ARwSMi4DIuAEcEjIuAyLgBHBIyLgMi4ARwSMi4DIuAFwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOadIWM7vD8s/UOkLGd3h+WfqA6WDmnSFjO7w/LP1DpCxnd4fln6gOlg5p0hYzu8Pyz9Q6QsZ3eH5Z+oDpYOadIWM7vD8s/UOkLGd3h+WfqA6WDmnSFjO7w/LP1DpCxnd4fln6gOlg5p0hYzu8Pyz9Q6QsZ3eH5Z+oDpYOadIWM7vD8s/UOkLGd3h+WfqA6WDmnSFjO7w/LP1DpCxnd4fln6gOlg5p0hYzu8Pyz9Q6QsZ3eH5Z+oDpYOadIWM7vD8s/UOkLGd3h+WfqA6WDmnSFjO7w/LP1DpCxnd4fln6gOlg5p0hYzu8Pyz9Q6QsZ3eH5Z+oDpYOadIWM7vD8s/UOkLGd3h+WfqA6WDmnSFjO7w/LP1DpCxnd4fln6gOlg5p0hYzu8Pyz9Q6QsZ3eH5Z+oDpYOadIWM7vD8s/UOkLGd3h+WfqA6WDmnSFjO7w/LP1DpCxnd4fln6gOlg5p0hYzu8Pyz9Q6QsZ3eH5Z+oDpYOadIWM7vD8s/UOkLGd3h+WfqA6WDmnSFjO7w/LP1DpCxnd4fln6gOlg5p0hYzu8Pyz9Q6QsZ3eH5Z+oDpYOadIWM7vD8s/UOkLGd3h+WfqA6WDmnSFjO7w/LP1DpCxnd4fln6gOlg5p0hYzu8Pyz9Q6QsZ3eH5Z+oDpYOadIWM7vD8s/UOkLGd3h+WfqA6WDmnSFjO7w/LP1DpCxnd4fln6gOlg5p0hYzu8Pyz9Q6QsZ3eH5Z+oDpYOadIWM7vD8s/UOkLGd3h+WfqA6WDmnSFjO7w/LP1DpCxnd4fln6gOlg5p0hYzu8Pyz9Q6QsZ3eH5Z+oDyYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP//Z", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://www.youtube.com/embed/1BRXb-igKAU?fs=1&rel=0\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ", "text/plain": "<IPython.lib.display.YouTubeVideo at 0x7fbf2e0a3250>"}, "metadata": {}, "output_type": "display_data"}]}}, "0e962ab65356441cb22d84d4a4db9a93": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "109feb0ca5844493a56db4222ceebbcf": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "11103522435b4fc7922df1020bd919c0": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "12697c27f9214636ac08b887c6a31d3a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "12f18380007f4462a9c8b6526c27d8e8": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "13fecca5294043b0865c7323e3496878": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_0ca4f2cbbc97412c98336de3ab3932da", "IPY_MODEL_1ccaedcfae6040bcb114bb6c64e3a3f5", "IPY_MODEL_1faa7ccb748b4f42bcf65fd87514a166"], "layout": "IPY_MODEL_d6bb6ae0b14549be82588ea2f26ec331"}}, "162669e2752e485e9a1d0ef29752d105": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "16c829f1997d40ba820966378e0e5e0a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_aa304eecfcd24af5b338b8bf976426e4", "IPY_MODEL_d3ed193d61164eb8b01c166f4f8c5e77"], "layout": "IPY_MODEL_c6f54cf4c74a4235986a77f6d0caef27"}}, "1a01e5ef6a234fc081b89bfb9b1bdd92": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": ["happy"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude42", "disabled": false, "icon": "", "layout": "IPY_MODEL_0596d5e841614c688128099074d139c4", "style": "IPY_MODEL_9ef4d2341b1e426abc39bb255c2632d9", "tooltip": "Happy"}}, "1a8c81821b17485fb504ad3128a39901": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#ffaaaa", "font_weight": ""}}, "1ccaedcfae6040bcb114bb6c64e3a3f5": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": ["medium"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude10", "disabled": false, "icon": "", "layout": "IPY_MODEL_ad16ec8c47144f33b46dcb7d67e6ab9a", "style": "IPY_MODEL_fcb2eaf80925461fa8cef841676f9c41", "tooltip": "Medium"}}, "1cf1206cc0c84e7ea35d49982699be64": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1f1b2770a78246729bd8bf9eed549d9b": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "1faa7ccb748b4f42bcf65fd87514a166": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": ["sad"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude41", "disabled": false, "icon": "", "layout": "IPY_MODEL_2c460c63b85c4b809cba31ba0db7cbf4", "style": "IPY_MODEL_dacf2094fb9b4c4f9d658d45dad7dc65", "tooltip": "Sad"}}, "22672e75590a451c98539219663d29ac": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "23f4c0810fef454db8dcdfce9f4a279c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "LabelModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "LabelView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_b9deb27f16e147ab884ee2f44d07cce3", "placeholder": "\u200b", "style": "IPY_MODEL_876750f97b4f431abc7fd7f2b587c615", "value": "Thanks for your feedback!"}}, "24b6a067dd5d4a6499b891380b3bcbf2": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2572e68ea5b94756a40717716cc3f7b6": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "2c460c63b85c4b809cba31ba0db7cbf4": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "2d0621b85daa411fb3a07703343376d1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": ["sad"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude41", "disabled": false, "icon": "", "layout": "IPY_MODEL_69bd38a1c3a54677b802a571eb424ce1", "style": "IPY_MODEL_b1774ab11216458ea86f585b052b5d86", "tooltip": "Sad"}}, "2ddae2f98a9e4495bcc30f536faa31cf": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_53fb8f3fe2e74e96a04aabb83dc6819a", "IPY_MODEL_6c6fc1dd43a34d8dbf52fecc32d7d5b3", "IPY_MODEL_947fed14151044eb804c33cb8f4ca0cc"], "layout": "IPY_MODEL_22672e75590a451c98539219663d29ac"}}, "3208f60b8ef347abb66f8e21d2c674e1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_38631c723ae045f68d5b5df4dc1979af", "IPY_MODEL_69a6435f79ca4d3d8721ea1032e9a756"], "layout": "IPY_MODEL_1cf1206cc0c84e7ea35d49982699be64"}}, "33e0ea7e674f420bbcc22ab24fb5c3e4": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "TextareaModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "TextareaModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "TextareaView", "continuous_update": true, "description": "", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_c18c136c2127450c8dedafe0ac3a22e6", "placeholder": "We want your feedback!", "rows": null, "style": "IPY_MODEL_7ebdd8164a5b4067bd13e4e39a0be0ec", "value": ""}}, "36ca9402791c48859b0231605a31e9ec": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "38631c723ae045f68d5b5df4dc1979af": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "TextareaModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "TextareaModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "TextareaView", "continuous_update": true, "description": "", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_593a8cf37ad34902be580f9f8ad0cfa3", "placeholder": "We want your feedback!", "rows": null, "style": "IPY_MODEL_4b8a1f2b6862430dadf7b04113d40324", "value": ""}}, "394d6d14db61427b9f9ae0789b9a56a2": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3dcbc5a8a4eb45d1a46b37a247bee2de": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_6c72653f526e45bf9265e0c563c83101", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "Video available at https://youtube.com/watch?v=Hhw6Ed0Zmco\n"}, {"data": {"image/jpeg": "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", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://www.youtube.com/embed/Hhw6Ed0Zmco?fs=1&rel=0\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ", "text/plain": "<IPython.lib.display.YouTubeVideo at 0x7fbf0dd54130>"}, "metadata": {}, "output_type": "display_data"}]}}, "3fad20810cf940b8a1e568f15d666a23": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "LabelModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "LabelView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_92688549927d431d8aa8627e73709eac", "placeholder": "\u200b", "style": "IPY_MODEL_12f18380007f4462a9c8b6526c27d8e8", "value": ""}}, "407e127bd31d449eb94253f3ba99f13e": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "43e90615caee464fb2ff413e053676e7": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "498691a66da544de8f1b14cafb6aa853": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4b77d67651c54cc0875af9fe22cba26d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "LabelModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "LabelView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_0e962ab65356441cb22d84d4a4db9a93", "placeholder": "\u200b", "style": "IPY_MODEL_a4f10e7e112e404f8b695fd833f488af", "value": ""}}, "4b8a1f2b6862430dadf7b04113d40324": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "4bbb1380ef494578bb8f1bfb0789a26b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "4e8c00b114ab4a9698eaa07cda901c4b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "VBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_719e35c3a87c4728a25cb7e3a3b9b08c", "IPY_MODEL_13fecca5294043b0865c7323e3496878", "IPY_MODEL_16c829f1997d40ba820966378e0e5e0a", "IPY_MODEL_9388940c595f47a3bf2de6c410136f5e"], "layout": "IPY_MODEL_24b6a067dd5d4a6499b891380b3bcbf2"}}, "527754e01af6425fbe1c23298f2d1fc8": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5307c589f71541c98a2d4af272689906": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "53fb8f3fe2e74e96a04aabb83dc6819a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": ["happy"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude42", "disabled": false, "icon": "", "layout": "IPY_MODEL_9d8ca45a206d4e4ca604e67ca5478220", "style": "IPY_MODEL_d73485d9e8c14048a2e06bda7e87000d", "tooltip": "Happy"}}, "55b82f9a41854eea8024a5d74db5d214": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "593355d1b13747c08a8da965f136157b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "LabelModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "LabelView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_e81565384f2e4978b75c1a6bdd9a398c", "placeholder": "\u200b", "style": "IPY_MODEL_e0b6632fb0c642d6a483450ffe9cf128", "value": "Thanks for your feedback!"}}, "593a8cf37ad34902be580f9f8ad0cfa3": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "5d8b7b5c53f44f8ba30edf4bf29b37ef": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": ["happy"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude42", "disabled": false, "icon": "", "layout": "IPY_MODEL_55b82f9a41854eea8024a5d74db5d214", "style": "IPY_MODEL_caaa7357661646ff94636e7dd07161a2", "tooltip": "Happy"}}, "5e8a6cc64f6e45478612c4a8bac42170": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#dddd77", "font_weight": ""}}, "5edb2d0a4f964049986244b5dfcbd724": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_1a01e5ef6a234fc081b89bfb9b1bdd92", "IPY_MODEL_dc7143fe0341425a8c40982d243cbf4f", "IPY_MODEL_967e59dd9a6e4b46bdadf441e3d590c5"], "layout": "IPY_MODEL_d6a1662ae8a34d9ca63478903e92521c"}}, "5f76158cf8cc44fbb5ba84655c72533a": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6136234c910f488b93bf68000d580010": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "623ab4c3a9894d6fa8053471e1b5427b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "6723426d260f488dba277e5dd0c4a907": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "VBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_3fad20810cf940b8a1e568f15d666a23", "IPY_MODEL_5edb2d0a4f964049986244b5dfcbd724", "IPY_MODEL_3208f60b8ef347abb66f8e21d2c674e1", "IPY_MODEL_23f4c0810fef454db8dcdfce9f4a279c"], "layout": "IPY_MODEL_ec8245258c974c119c9da646297ac9a9"}}, "68e4d67e5d82415194f83d242ab71863": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "69a6435f79ca4d3d8721ea1032e9a756": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Submit", "disabled": false, "icon": "", "layout": "IPY_MODEL_2572e68ea5b94756a40717716cc3f7b6", "style": "IPY_MODEL_f79312a30c2b4834b7ae6ff06c8c1f03", "tooltip": ""}}, "69bd38a1c3a54677b802a571eb424ce1": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "6c6fc1dd43a34d8dbf52fecc32d7d5b3": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": ["medium"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude10", "disabled": false, "icon": "", "layout": "IPY_MODEL_68e4d67e5d82415194f83d242ab71863", "style": "IPY_MODEL_5e8a6cc64f6e45478612c4a8bac42170", "tooltip": "Medium"}}, "6c72653f526e45bf9265e0c563c83101": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6ce738220a154cc6b4b0b4cf46440ede": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "TabModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "TabModel", "_titles": {"0": "Youtube", "1": "Bilibili"}, "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "TabView", "box_style": "", "children": ["IPY_MODEL_0e4d25bd7c2144f0af975b4b6917121f", "IPY_MODEL_a90584e981d24429ae7459bfbecdcc30"], "layout": "IPY_MODEL_03b940649f9c41949c171210115ad76e", "selected_index": 0}}, "6ef9821011884c73bca733a45a10bb9c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_fb117969d634479a9f323c02bb606aab", "IPY_MODEL_a8e082ab942a48fab79edd0d719c3de7"], "layout": "IPY_MODEL_ae86495762f44b289b1299c65ab39464"}}, "719e35c3a87c4728a25cb7e3a3b9b08c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "LabelModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "LabelView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_e6ab57059ed443f6bc9ab920b3221950", "placeholder": "\u200b", "style": "IPY_MODEL_43e90615caee464fb2ff413e053676e7", "value": ""}}, "74979aa376464e138bc2cd5a0564e327": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "74db907959ae47588ff374c99d6d82f6": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#aaffaa", "font_weight": ""}}, "76efbf9d49f146cdb208b4ecef8e6d70": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "7ebdd8164a5b4067bd13e4e39a0be0ec": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "83069d2a91314d56b2c8f29e7e4e6df9": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "876750f97b4f431abc7fd7f2b587c615": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "8920d086bd504f17abcd2f2a8efdae36": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8aa0375dbaba4240a830bbb7ee647686": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "VBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_4b77d67651c54cc0875af9fe22cba26d", "IPY_MODEL_9e8e18e4c4f44420a97504358523c401", "IPY_MODEL_fea3c665d657405bae2539f2203c9482", "IPY_MODEL_e8641c16cb54425785368b58dbf1bff2"], "layout": "IPY_MODEL_5f76158cf8cc44fbb5ba84655c72533a"}}, "92688549927d431d8aa8627e73709eac": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9388940c595f47a3bf2de6c410136f5e": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "LabelModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "LabelView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_394d6d14db61427b9f9ae0789b9a56a2", "placeholder": "\u200b", "style": "IPY_MODEL_623ab4c3a9894d6fa8053471e1b5427b", "value": "Thanks for your feedback!"}}, "947fed14151044eb804c33cb8f4ca0cc": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": ["sad"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude41", "disabled": false, "icon": "", "layout": "IPY_MODEL_36ca9402791c48859b0231605a31e9ec", "style": "IPY_MODEL_d99e0e65a8904afb99e277d172450302", "tooltip": "Sad"}}, "967e59dd9a6e4b46bdadf441e3d590c5": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": ["sad"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude41", "disabled": false, "icon": "", "layout": "IPY_MODEL_6136234c910f488b93bf68000d580010", "style": "IPY_MODEL_1a8c81821b17485fb504ad3128a39901", "tooltip": "Sad"}}, "98b68fbbee3f44019600d8260293236f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "LabelModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "LabelView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_83069d2a91314d56b2c8f29e7e4e6df9", "placeholder": "\u200b", "style": "IPY_MODEL_162669e2752e485e9a1d0ef29752d105", "value": ""}}, "98eed280cfa248babfc9d7308974ed45": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Submit", "disabled": false, "icon": "", "layout": "IPY_MODEL_1f1b2770a78246729bd8bf9eed549d9b", "style": "IPY_MODEL_4bbb1380ef494578bb8f1bfb0789a26b", "tooltip": ""}}, "9d8ca45a206d4e4ca604e67ca5478220": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "9dcc0274abdc4d618c6d260573897277": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "VBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_98b68fbbee3f44019600d8260293236f", "IPY_MODEL_2ddae2f98a9e4495bcc30f536faa31cf", "IPY_MODEL_6ef9821011884c73bca733a45a10bb9c", "IPY_MODEL_593355d1b13747c08a8da965f136157b"], "layout": "IPY_MODEL_11103522435b4fc7922df1020bd919c0"}}, "9e7f3346229f4ce59985cbc8850b4035": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9e8e18e4c4f44420a97504358523c401": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_5d8b7b5c53f44f8ba30edf4bf29b37ef", "IPY_MODEL_04e4ed2d93894098959af9b889c4b513", "IPY_MODEL_2d0621b85daa411fb3a07703343376d1"], "layout": "IPY_MODEL_498691a66da544de8f1b14cafb6aa853"}}, "9ef4d2341b1e426abc39bb255c2632d9": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#aaffaa", "font_weight": ""}}, "9ff31a4c125c4100b6fce9045bc2535f": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "a0414005758041aabc6470d7dc5753cc": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#dddd77", "font_weight": ""}}, "a4f10e7e112e404f8b695fd833f488af": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "a8e082ab942a48fab79edd0d719c3de7": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Submit", "disabled": false, "icon": "", "layout": "IPY_MODEL_049dca388e224011ae79b667040eb3d2", "style": "IPY_MODEL_bf9fc384874d436a92e3361355c9062e", "tooltip": ""}}, "a90584e981d24429ae7459bfbecdcc30": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_8920d086bd504f17abcd2f2a8efdae36", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "Video available at https://www.bilibili.com/video/BV1ng411M7Gz\n"}, {"data": {"text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://player.bilibili.com/player.html?bvid=BV1ng411M7Gz&page=1?fs=1&autoplay=False\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ", "text/plain": "<__main__.PlayVideo at 0x7fbf0dd47dc0>"}, "metadata": {}, "output_type": "display_data"}]}}, "aa304eecfcd24af5b338b8bf976426e4": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "TextareaModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "TextareaModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "TextareaView", "continuous_update": true, "description": "", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_407e127bd31d449eb94253f3ba99f13e", "placeholder": "We want your feedback!", "rows": null, "style": "IPY_MODEL_76efbf9d49f146cdb208b4ecef8e6d70", "value": ""}}, "ad16ec8c47144f33b46dcb7d67e6ab9a": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "ad8f2150ce7a4f53b63b64cffeb94697": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "TabModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "TabModel", "_titles": {"0": "Youtube", "1": "Bilibili"}, "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "TabView", "box_style": "", "children": ["IPY_MODEL_3dcbc5a8a4eb45d1a46b37a247bee2de", "IPY_MODEL_c54c60bbf9294305b5ad9807a9640785"], "layout": "IPY_MODEL_9e7f3346229f4ce59985cbc8850b4035", "selected_index": 0}}, "ae86495762f44b289b1299c65ab39464": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b1774ab11216458ea86f585b052b5d86": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#ffaaaa", "font_weight": ""}}, "b9deb27f16e147ab884ee2f44d07cce3": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "bd4f11e661be4793807c140386e46d34": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "bf9fc384874d436a92e3361355c9062e": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "c11497cdd67e4e50aa623bcbcea198b3": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#dddd77", "font_weight": ""}}, "c18c136c2127450c8dedafe0ac3a22e6": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "c54c60bbf9294305b5ad9807a9640785": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_d2ecd758744e47d6a51b4ba59433adc9", "msg_id": "", "outputs": [{"name": "stdout", "output_type": "stream", "text": "Video available at https://www.bilibili.com/video/BV1yQ4y127Sr\n"}, {"data": {"text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://player.bilibili.com/player.html?bvid=BV1yQ4y127Sr&page=1?fs=1&autoplay=False\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ", "text/plain": "<__main__.PlayVideo at 0x7fbf05ac3100>"}, "metadata": {}, "output_type": "display_data"}]}}, "c5edd0fb96704bbd97b6a8c983e93456": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "c6f54cf4c74a4235986a77f6d0caef27": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "caaa7357661646ff94636e7dd07161a2": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#aaffaa", "font_weight": ""}}, "d2ecd758744e47d6a51b4ba59433adc9": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d3ed193d61164eb8b01c166f4f8c5e77": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Submit", "disabled": false, "icon": "", "layout": "IPY_MODEL_109feb0ca5844493a56db4222ceebbcf", "style": "IPY_MODEL_12697c27f9214636ac08b887c6a31d3a", "tooltip": ""}}, "d6a1662ae8a34d9ca63478903e92521c": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d6bb6ae0b14549be82588ea2f26ec331": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d73485d9e8c14048a2e06bda7e87000d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#aaffaa", "font_weight": ""}}, "d99e0e65a8904afb99e277d172450302": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#ffaaaa", "font_weight": ""}}, "dacf2094fb9b4c4f9d658d45dad7dc65": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#ffaaaa", "font_weight": ""}}, "dc7143fe0341425a8c40982d243cbf4f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonModel", "state": {"_dom_classes": ["medium"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude10", "disabled": false, "icon": "", "layout": "IPY_MODEL_9ff31a4c125c4100b6fce9045bc2535f", "style": "IPY_MODEL_a0414005758041aabc6470d7dc5753cc", "tooltip": "Medium"}}, "e0b6632fb0c642d6a483450ffe9cf128": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "e6ab57059ed443f6bc9ab920b3221950": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e81565384f2e4978b75c1a6bdd9a398c": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e8641c16cb54425785368b58dbf1bff2": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "LabelModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "LabelView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_5307c589f71541c98a2d4af272689906", "placeholder": "\u200b", "style": "IPY_MODEL_fbd54839f28e42ffa9831ea5b1db29e7", "value": "Thanks for your feedback!"}}, "eb2f5c677ba24151a2da84c1889e5f1d": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ec8245258c974c119c9da646297ac9a9": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f79312a30c2b4834b7ae6ff06c8c1f03": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "fb117969d634479a9f323c02bb606aab": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "TextareaModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "TextareaModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "TextareaView", "continuous_update": true, "description": "", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_c5edd0fb96704bbd97b6a8c983e93456", "placeholder": "We want your feedback!", "rows": null, "style": "IPY_MODEL_0794e8ce5cf74c62838b451a5fb28019", "value": ""}}, "fbd54839f28e42ffa9831ea5b1db29e7": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "fcb2eaf80925461fa8cef841676f9c41": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": "#dddd77", "font_weight": ""}}, "fd83fb07e7b44b9cab8bdeb2b7c1831a": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "fea3c665d657405bae2539f2203c9482": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_33e0ea7e674f420bbcc22ab24fb5c3e4", "IPY_MODEL_98eed280cfa248babfc9d7308974ed45"], "layout": "IPY_MODEL_74979aa376464e138bc2cd5a0564e327"}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./tutorials/W3D5_ReinforcementLearningForGamesAndDlThinking3/instructor"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="W3D5_Tutorial2.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Tutorial 2: Deep Learning Thinking 3</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="W3D5_BonusLecture.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Bonus Lecture: Amita Kapoor</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Neuromatch<br/>
  
    <div class="extra_footer">
      <div>
<a href="http://creativecommons.org/licenses/by/4.0/"><img src="https://i.creativecommons.org/l/by/4.0/88x31.png"></a>
<a href="https://opensource.org/licenses/BSD-3-Clause"><img src="https://camo.githubusercontent.com/9b9ea65d95c9ef878afa1987df65731d47681336/68747470733a2f2f696d672e736869656c64732e696f2f707970692f6c2f736561626f726e2e737667"></a>
The contents of this repository are shared under the <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
Software elements are additionally licensed under the <a href="https://opensource.org/licenses/BSD-3-Clause">BSD (3-Clause) License</a>.
</div>

    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>